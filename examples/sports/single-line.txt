association

coach

match

stadium

team

association[(association['president'] != 'p')]

association[['association_name']]

association[['founded_year']]

association[['national_name']]

coach[['coach_id']]

coach[['experience_years']]

coach[['name']]

coach[['role']]

match[['match_id']]

stadium[(stadium['capacity'] != 62068)]

stadium[(stadium['city'].str.startswith('a'))]

stadium[(stadium['location'].str.startswith('n'))]

stadium[(stadium['name'].str.startswith('s'))]

stadium[['capacity']]

stadium[['location']]

stadium[['year_built']]

team[(team['group'] != 'b')]

team[(team['group'] != 'c')]

team[(team['group'] != 'f')]

team[(team['group'].isin(['g']))]

team[(team['national_name'] == 't')]

team[(team['national_name'].str.startswith('t'))]

team[(team['number_player'] != 21)]

team[(team['number_player'] < 23)]

team[(team['number_player'] <= 18)]

team[['group']]

team[['national_name']]

team[['number_player']]

association.merge(team, left_on='national_name', right_on='national_name')

association[['association_name', 'founded_year']]

coach.groupby(by=['coach_id']).agg('min', numeric_only=True)

coach.groupby(by=['experience_years']).agg('count')

coach[['name', 'experience_years']]

match.merge(team, left_on='team2_id', right_on='national_name')

stadium.groupby(by=['capacity']).agg('count')

stadium.groupby(by=['capacity']).agg('max', numeric_only=True)

stadium.groupby(by=['city']).agg('mean', numeric_only=True)

stadium.groupby(by=['location']).agg('sum', numeric_only=True)

stadium.groupby(by=['name']).agg('min', numeric_only=True)

stadium.groupby(by=['year_built']).agg('mean', numeric_only=True)

stadium.groupby(by=['year_built']).agg('min', numeric_only=True)

stadium[(stadium['capacity'] < 68619) | (stadium['name'] != 's')]

stadium[(stadium['capacity'] <= 50872) | (stadium['location'].str.startswith('n'))]

stadium[(stadium['location'] != 'c') & (stadium['city'] != 'd')]

stadium[(stadium['name'] == 's') & (stadium['year_built'] == 1996)]

stadium[(stadium['name'] == 's') | (stadium['stadium_id'] == 8)]

stadium[(stadium['stadium_id'] == 3) | (stadium['stadium_id'] < 1)]

stadium[['city', 'stadium_id']]

stadium[['location', 'capacity']]

stadium[['location', 'name']]

stadium[['stadium_id', 'year_built']]

stadium[['year_built', 'stadium_id']]

team.groupby(by=['national_name']).agg('max', numeric_only=True)

team.groupby(by=['national_name']).agg('mean', numeric_only=True)

team.groupby(by=['national_name']).agg('min', numeric_only=True)

team.groupby(by=['number_player']).agg('min', numeric_only=True)

team.groupby(by=['number_player']).agg('sum', numeric_only=True)

team[(team['group'] != 'a') & (team['group'].isin(['h', 'c', 'd', 'g']))]

team[(team['group'] == 'h') | (team['group'].isin(['c', 'd', 'a', 'g', 'f']))]

team[(team['group'].isin(['a', 'e', 'g', 'h', 'c'])) | (team['number_player'] <= 22)]

team[(team['group'].isin(['f', 'g', 'a', 'b', 'h'])) & (team['group'] == 'e')]

team[(team['group'].isin(['f'])) & (team['number_player'] < 20)]

team[(team['national_name'].str.startswith('t')) & (team['number_player'] > 24)]

team[(team['number_player'] != 20) & (team['national_name'] != 't')]

team[(team['number_player'] < 19) | (team['national_name'] == 't')]

team[(team['number_player'] <= 21) & (team['group'] != 'c')]

team[(team['number_player'] == 18) | (team['national_name'] == 't')]

team[(team['number_player'] >= 19) | (team['number_player'] >= 18)]

team[['group', 'national_name']]

team[['group', 'number_player']]

team[['national_name', 'number_player']]

team[['number_player', 'group']]

team[['number_player', 'national_name']]

association[['association_name', 'president', 'founded_year']]

coach[(coach['role'].isin(['fitness coach', 'assistant coach', 'head coach'])) | (coach['experience_years'] != 18) & (coach['role'] != 'head coach')]

coach[['role', 'experience_years', 'coach_id']]

match[['match_date', 'attendance', 'round']]

match[['round', 'match_id', 'duration_minutes']]

stadium.groupby(by=['name', 'year_built']).agg('mean', numeric_only=True)

stadium.groupby(by=['stadium_id', 'capacity']).agg('max', numeric_only=True)

stadium.groupby(by=['stadium_id', 'capacity']).agg('sum', numeric_only=True)

stadium.groupby(by=['stadium_id', 'city']).agg('max', numeric_only=True)

stadium.groupby(by=['stadium_id', 'year_built']).agg('count')

stadium[(stadium['year_built'] < 1977) | (stadium['city'] == 'd') & (stadium['location'] != 'w')]

stadium[(stadium['year_built'] < 1985) & (stadium['stadium_id'] > 8) | (stadium['capacity'] < 50521)]

stadium[['city', 'capacity', 'year_built']]

stadium[['location', 'name', 'city']]

stadium[['stadium_id', 'year_built', 'name']]

team.groupby(by=['group', 'national_name']).agg('max', numeric_only=True)

team.groupby(by=['group', 'number_player']).agg('mean', numeric_only=True)

team.groupby(by=['group', 'number_player']).agg('min', numeric_only=True)

team.groupby(by=['national_name', 'group']).agg('count')

team.groupby(by=['national_name', 'group']).agg('max', numeric_only=True)

team.groupby(by=['number_player', 'group']).agg('count')

team.groupby(by=['number_player', 'group']).agg('sum', numeric_only=True)

team.groupby(by=['number_player', 'national_name']).agg('count')

team.groupby(by=['number_player', 'national_name']).agg('sum', numeric_only=True)

team[(team['group'].isin(['e', 'h', 'a', 'd', 'f', 'b', 'c', 'g'])) & (team['number_player'] <= 25) & (team['group'] == 'e')]

team[(team['national_name'] != 't') | (team['number_player'] < 23) & (team['number_player'] < 22)]

team[(team['national_name'].str.startswith('t')) & (team['group'] != 'c') | (team['national_name'] != 't')]

team[(team['national_name'].str.startswith('t')) & (team['national_name'] == 't') & (team['national_name'].str.startswith('t'))]

team[(team['national_name'].str.startswith('t')) | (team['national_name'] == 't') & (team['number_player'] == 22)]

team[(team['number_player'] < 23) & (team['group'] != 'h') & (team['group'] != 'f')]

team[(team['number_player'] == 22) & (team['number_player'] < 18) & (team['national_name'].str.startswith('t'))]

team[['group', 'national_name', 'number_player']]

team[['number_player', 'national_name', 'group']]

association.groupby(by=['national_name', 'president', 'association_name']).agg('sum', numeric_only=True)

association[(association['association_name'].str.startswith('f'))][['president']]

association[(association['national_name'] == 't')][['president']]

association[(association['president'] != 'p')][['association_name']]

association[['association_name', 'national_name', 'president', 'founded_year']]

coach.groupby(by=['coach_id', 'role', 'experience_years']).agg('min', numeric_only=True)

coach[['coach_id', 'experience_years', 'role', 'name']]

coach[['role', 'name', 'coach_id', 'experience_years']]

match.groupby(by=['score_team1', 'team2_id', 'match_date']).agg('mean', numeric_only=True)

match.groupby(by=['team1_id', 'score_team2', 'round']).agg('sum', numeric_only=True)

match[['match_date', 'attendance', 'match_time', 'match_id']]

match[['round', 'match_id', 'duration_minutes', 'attendance']]

stadium.groupby(by=['capacity', 'stadium_id', 'year_built']).agg('min', numeric_only=True)

stadium.groupby(by=['location', 'year_built', 'city']).agg('sum', numeric_only=True)

stadium.groupby(by=['name', 'capacity', 'city']).agg('sum', numeric_only=True)

stadium.groupby(by=['name', 'location', 'stadium_id']).agg('sum', numeric_only=True)

stadium.groupby(by=['stadium_id', 'city', 'location']).agg('mean', numeric_only=True)

stadium.groupby(by=['year_built', 'location', 'city']).agg('mean', numeric_only=True)

stadium.groupby(by=['year_built', 'location', 'city']).agg('sum', numeric_only=True)

stadium[(stadium['city'].str.startswith('a'))][['capacity']]

stadium[(stadium['city'].str.startswith('l')) & (stadium['stadium_id'] != 4) & (stadium['city'] == 'l') | (stadium['city'] != 'l')]

stadium[(stadium['year_built'] <= 2018) & (stadium['location'] == 'n') | (stadium['city'].str.startswith('d')) | (stadium['year_built'] >= 2005)]

stadium[(stadium['year_built'] > 1989) & (stadium['city'].str.startswith('a')) & (stadium['city'] != 'a') & (stadium['city'] != 'a')]

stadium[(stadium['year_built'] >= 2009) & (stadium['year_built'] != 1967) | (stadium['year_built'] == 2006) | (stadium['name'].str.startswith('s'))]

stadium[['capacity', 'stadium_id', 'name', 'location']]

stadium[['city', 'stadium_id', 'capacity', 'year_built']]

stadium[['location', 'city', 'year_built', 'capacity']]

stadium[['stadium_id', 'capacity', 'city', 'year_built']]

stadium[['year_built', 'location', 'name', 'city']]

team.groupby(by=['group', 'national_name', 'number_player']).agg('max', numeric_only=True)

team.groupby(by=['group', 'national_name', 'number_player']).agg('mean', numeric_only=True)

team.groupby(by=['group', 'national_name', 'number_player']).agg('min', numeric_only=True)

team.groupby(by=['group', 'number_player', 'national_name']).agg('count')

team.groupby(by=['group', 'number_player', 'national_name']).agg('min', numeric_only=True)

team.groupby(by=['group', 'number_player', 'national_name']).agg('sum', numeric_only=True)

team.groupby(by=['national_name', 'group', 'number_player']).agg('sum', numeric_only=True)

team.groupby(by=['national_name', 'number_player', 'group']).agg('min', numeric_only=True)

team.groupby(by=['number_player', 'national_name', 'group']).agg('count')

team.groupby(by=['number_player', 'national_name', 'group']).agg('min', numeric_only=True)

team[(team['group'] != 'c')][['number_player']]

team[(team['group'] == 'c')][['group']]

team[(team['national_name'].str.startswith('t'))][['group']]

association[(association['association_name'] != 'f')][['association_name', 'founded_year']]

association[(association['association_name'] != 'f')][['founded_year', 'association_name']]

association[(association['association_name'].str.startswith('f')) & (association['association_name'] != 'f')][['founded_year']]

association[(association['association_name'].str.startswith('f'))][['president', 'association_name']]

association[(association['president'] != 'p')][['president', 'founded_year']]

association[['association_name']].groupby(by=['association_name']).agg('min', numeric_only=True)

association[['founded_year']].groupby(by=['founded_year']).agg('sum', numeric_only=True)

association[['national_name']].groupby(by=['national_name']).agg('max', numeric_only=True)

association[['president']].groupby(by=['president']).agg('count')

association[['president']].groupby(by=['president']).agg('mean', numeric_only=True)

coach.groupby(by=['coach_id', 'experience_years', 'national_name', 'name']).agg('count')

coach.groupby(by=['experience_years', 'national_name', 'name', 'coach_id']).agg('mean', numeric_only=True)

coach.merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name')

coach[(coach['national_name'] == 't') | (coach['national_name'].str.startswith('t'))][['national_name']]

coach[(coach['role'] != 'head coach') | (coach['name'] != 'c')][['experience_years']]

coach[['experience_years', 'coach_id', 'name', 'national_name', 'role']]

coach[['name', 'role', 'national_name', 'coach_id', 'experience_years']]

coach[['role']].groupby(by=['role']).agg('max', numeric_only=True)

match.merge(team[(team['national_name'].str.startswith('t')) | (team['national_name'] == 't')], left_on='team1_id', right_on='national_name')

match.merge(team[['number_player', 'national_name']], left_on='team1_id', right_on='national_name')

match[['duration_minutes']].groupby(by=['duration_minutes']).agg('min', numeric_only=True)

match[['match_time']].groupby(by=['match_time']).agg('mean', numeric_only=True)

stadium.groupby(by=['city', 'stadium_id', 'capacity', 'year_built']).agg('sum', numeric_only=True)

stadium.groupby(by=['location', 'capacity', 'name', 'stadium_id']).agg('sum', numeric_only=True)

stadium.groupby(by=['location', 'stadium_id', 'name', 'capacity']).agg('mean', numeric_only=True)

stadium.groupby(by=['name', 'city', 'year_built', 'capacity']).agg('max', numeric_only=True)

stadium.groupby(by=['year_built', 'location', 'city', 'stadium_id']).agg('min', numeric_only=True)

stadium[(stadium['capacity'] > 64449) | (stadium['location'] != 'e') & (stadium['year_built'] == 1995) | (stadium['year_built'] == 1989) | (stadium['name'] == 's')]

stadium[(stadium['location'] == 'c') & (stadium['stadium_id'] <= 6) | (stadium['location'] != 's') | (stadium['year_built'] >= 1987) | (stadium['location'].str.startswith('c'))]

stadium[(stadium['stadium_id'] <= 10) & (stadium['name'].str.startswith('s'))][['year_built']]

stadium[(stadium['stadium_id'] > 10) | (stadium['city'].str.startswith('a')) | (stadium['location'].str.startswith('n')) | (stadium['capacity'] > 76549) | (stadium['name'] == 's')]

stadium[(stadium['stadium_id'] >= 2) | (stadium['location'] != 'e') | (stadium['stadium_id'] > 6) | (stadium['year_built'] > 1961) & (stadium['year_built'] < 1979)]

stadium[(stadium['year_built'] >= 1995) | (stadium['city'] == 'a') & (stadium['city'] == 'd') | (stadium['capacity'] >= 85270) | (stadium['location'] != 'w')]

stadium[['capacity']].groupby(by=['capacity']).agg('count')

stadium[['capacity']].groupby(by=['capacity']).agg('min', numeric_only=True)

stadium[['capacity']].groupby(by=['capacity']).agg('sum', numeric_only=True)

stadium[['city', 'name', 'capacity', 'year_built', 'stadium_id']]

stadium[['city', 'name', 'year_built', 'capacity', 'stadium_id']]

stadium[['year_built']].groupby(by=['year_built']).agg('min', numeric_only=True)

team[(team['group'] != 'c') & (team['number_player'] <= 18)][['group']]

team[(team['group'] == 'c')][['national_name', 'group']]

team[(team['group'] == 'h')].groupby(by=['national_name']).agg('mean', numeric_only=True)

team[(team['group'].isin(['a', 'b', 'h', 'c', 'd', 'f']))].groupby(by=['group']).agg('min', numeric_only=True)

team[(team['group'].isin(['h', 'a', 'g', 'd', 'b', 'f', 'c', 'e'])) | (team['group'].isin(['f', 'c']))][['group']]

team[(team['national_name'] != 't') & (team['group'] == 'd')][['national_name']]

team[(team['national_name'] != 't') & (team['national_name'].str.startswith('t'))][['number_player']]

team[(team['national_name'] != 't')][['national_name', 'number_player']]

team[(team['national_name'].str.startswith('t'))].groupby(by=['national_name']).agg('sum', numeric_only=True)

team[(team['number_player'] < 23)].groupby(by=['number_player']).agg('sum', numeric_only=True)

team[(team['number_player'] >= 22) | (team['national_name'] == 't')][['number_player']]

team[(team['number_player'] >= 24)].groupby(by=['national_name']).agg('mean', numeric_only=True)

team[['national_name']].groupby(by=['national_name']).agg('max', numeric_only=True)

team[['number_player']].groupby(by=['number_player']).agg('max', numeric_only=True)

team[['number_player']].groupby(by=['number_player']).agg('mean', numeric_only=True)

association[(association['association_name'] != 'f')][['president', 'association_name', 'founded_year']]

association[(association['association_name'] == 'f') & (association['association_name'] != 'f')][['founded_year', 'president']]

association[(association['founded_year'] <= 1905)].groupby(by=['president', 'founded_year']).agg('max', numeric_only=True)

association[(association['founded_year'] == 1938) & (association['president'] == 'p') | (association['national_name'].str.startswith('t'))][['association_name']]

association[(association['national_name'] == 't')][['association_name', 'founded_year', 'president']]

association[(association['president'].str.startswith('p'))][['president', 'association_name', 'founded_year']]

association[(association['president'].str.startswith('p'))][['president', 'founded_year', 'association_name']]

association[['association_name', 'founded_year']].groupby(by=['association_name']).agg('count')

coach.merge(team, left_on='national_name', right_on='national_name').groupby(by=['number_player']).agg('count')

coach[(coach['name'] == 'c')][['name', 'coach_id', 'role']]

coach[(coach['national_name'] == 't')][['role', 'name', 'experience_years']]

coach[(coach['role'].isin(['goalkeeper coach', 'assistant coach', 'fitness coach', 'head coach'])) & (coach['coach_id'] <= 6) | (coach['role'] != 'fitness coach')][['role']]

coach[['experience_years', 'coach_id']].groupby(by=['experience_years']).agg('count')

coach[['role', 'coach_id']].groupby(by=['role']).agg('count')

match.merge(stadium, left_on='stadium_id', right_on='stadium_id').groupby(by=['city']).agg('mean', numeric_only=True)

match.merge(team, left_on='team2_id', right_on='national_name').groupby(by=['national_name']).agg('sum', numeric_only=True)

match.merge(team[['group', 'number_player', 'national_name']], left_on='team1_id', right_on='national_name')

match.merge(team[['national_name', 'number_player', 'group']], left_on='team2_id', right_on='national_name')

match.merge(team[['number_player', 'group', 'national_name']], left_on='team1_id', right_on='national_name')

stadium.groupby(by=['capacity', 'year_built', 'name', 'stadium_id', 'city']).agg('mean', numeric_only=True)

stadium.groupby(by=['name', 'location', 'capacity', 'city', 'year_built']).agg('mean', numeric_only=True)

stadium.groupby(by=['year_built', 'city', 'location', 'name', 'capacity']).agg('count')

stadium[(stadium['capacity'] >= 57944) | (stadium['year_built'] <= 1999) | (stadium['year_built'] <= 1951) | (stadium['name'] != 's') & (stadium['stadium_id'] < 11) & (stadium['year_built'] == 2018)]

stadium[(stadium['city'] == 'd') & (stadium['city'] != 'a') | (stadium['name'] != 's') | (stadium['stadium_id'] > 6) | (stadium['capacity'] < 46733) | (stadium['city'] != 'a')]

stadium[(stadium['location'] == 's') & (stadium['year_built'] != 1951) & (stadium['stadium_id'] == 3) & (stadium['city'].str.startswith('a')) | (stadium['name'].str.startswith('s')) | (stadium['year_built'] != 1990)]

stadium[(stadium['location'].str.startswith('e'))].groupby(by=['year_built', 'city']).agg('min', numeric_only=True)

stadium[(stadium['location'].str.startswith('n'))].groupby(by=['stadium_id', 'location']).agg('max', numeric_only=True)

stadium[(stadium['stadium_id'] == 10) & (stadium['stadium_id'] < 1) | (stadium['location'] != 's') & (stadium['year_built'] != 2006) & (stadium['stadium_id'] <= 2) | (stadium['year_built'] < 1972)]

stadium[(stadium['stadium_id'] >= 9) | (stadium['location'] == 'c') | (stadium['capacity'] <= 66059) | (stadium['stadium_id'] > 7) & (stadium['location'].str.startswith('n')) & (stadium['location'] != 'e')]

stadium[(stadium['year_built'] != 2010) & (stadium['year_built'] == 1985) | (stadium['year_built'] <= 1985) & (stadium['city'] != 'd') & (stadium['name'].str.startswith('s')) | (stadium['year_built'] != 1964)]

stadium[(stadium['year_built'] > 2018) | (stadium['stadium_id'] > 5) | (stadium['capacity'] != 78589) | (stadium['name'].str.startswith('s')) & (stadium['city'] != 'r') & (stadium['year_built'] >= 2013)]

stadium[['city', 'name', 'location', 'capacity', 'stadium_id', 'year_built']]

stadium[['location', 'name']].groupby(by=['name']).agg('mean', numeric_only=True)

stadium[['name', 'year_built']].groupby(by=['year_built']).agg('sum', numeric_only=True)

stadium[['year_built', 'name', 'location', 'stadium_id', 'city', 'capacity']]

team[(team['group'] != 'b') & (team['number_player'] < 22)].groupby(by=['group']).agg('sum', numeric_only=True)

team[(team['group'] != 'c')].groupby(by=['group', 'national_name']).agg('max', numeric_only=True)

team[(team['group'] != 'g') & (team['national_name'] != 't')][['group', 'number_player']]

team[(team['group'] == 'f')][['national_name', 'number_player', 'group']]

team[(team['group'] == 'g') | (team['number_player'] > 18)][['group', 'number_player']]

team[(team['national_name'] == 't') & (team['group'] != 'h')][['number_player', 'group']]

team[(team['national_name'] == 't') | (team['number_player'] >= 23)][['group', 'number_player']]

team[(team['national_name'].str.startswith('t'))].groupby(by=['number_player', 'group']).agg('count')

team[(team['number_player'] != 24)].groupby(by=['number_player', 'national_name']).agg('min', numeric_only=True)

team[(team['number_player'] <= 19) | (team['national_name'] != 't')].groupby(by=['group']).agg('sum', numeric_only=True)

team[(team['number_player'] <= 24)].groupby(by=['group', 'number_player']).agg('max', numeric_only=True)

team[(team['number_player'] > 20) & (team['national_name'] != 't')].groupby(by=['number_player']).agg('count')

team[(team['number_player'] > 21) & (team['national_name'].str.startswith('t')) | (team['number_player'] > 19)][['national_name']]

team[['national_name', 'number_player']].groupby(by=['national_name']).agg('count')

team[['national_name', 'number_player']].groupby(by=['national_name']).agg('sum', numeric_only=True)

team[['national_name', 'number_player']].groupby(by=['number_player']).agg('sum', numeric_only=True)

association[(association['association_name'] != 'f') & (association['association_name'].str.startswith('f')) & (association['association_name'] != 'f') | (association['president'] != 'p')][['founded_year']]

association[(association['national_name'] == 't') | (association['association_name'].str.startswith('f')) & (association['national_name'] != 't')].groupby(by=['founded_year']).agg('min', numeric_only=True)

association[['national_name', 'founded_year']].groupby(by=['founded_year', 'national_name']).agg('min', numeric_only=True)

association[['national_name', 'president', 'association_name']].groupby(by=['president']).agg('mean', numeric_only=True)

coach.merge(team, left_on='national_name', right_on='national_name').groupby(by=['number_player', 'group']).agg('mean', numeric_only=True)

coach[(coach['national_name'] != 't') | (coach['name'].str.startswith('c')) & (coach['coach_id'] < 14)][['name', 'role']]

coach[['role', 'coach_id']].groupby(by=['role', 'coach_id']).agg('mean', numeric_only=True)

match[['score_team2', 'attendance']].groupby(by=['attendance', 'score_team2']).agg('count')

match[['score_team2', 'match_id']].groupby(by=['match_id', 'score_team2']).agg('count')

stadium[(stadium['capacity'] <= 76075)][['name', 'stadium_id', 'year_built', 'location']]

stadium[(stadium['capacity'] > 78259) & (stadium['stadium_id'] != 11)].groupby(by=['year_built', 'city']).agg('min', numeric_only=True)

stadium[(stadium['name'] == 's') & (stadium['capacity'] != 63532)][['stadium_id', 'capacity', 'year_built']]

stadium[(stadium['name'].str.startswith('s')) & (stadium['name'] == 's') & (stadium['city'] == 'a')].groupby(by=['name']).agg('max', numeric_only=True)

stadium[(stadium['stadium_id'] > 8) & (stadium['stadium_id'] == 9)].groupby(by=['name', 'year_built']).agg('mean', numeric_only=True)

stadium[['capacity', 'year_built', 'city']].groupby(by=['city']).agg('sum', numeric_only=True)

stadium[['city', 'location', 'name']].groupby(by=['city']).agg('count')

stadium[['name', 'stadium_id']].groupby(by=['name', 'stadium_id']).agg('mean', numeric_only=True)

stadium[['stadium_id', 'city']].groupby(by=['city', 'stadium_id']).agg('min', numeric_only=True)

team[(team['group'] == 'g') & (team['number_player'] != 18)][['group', 'number_player', 'national_name']]

team[(team['group'] == 'h') | (team['national_name'].str.startswith('t'))][['group', 'number_player', 'national_name']]

team[(team['group'] == 'h')].groupby(by=['number_player', 'group', 'national_name']).agg('min', numeric_only=True)

team[(team['group'].isin(['b'])) & (team['number_player'] != 21) | (team['number_player'] != 20)].groupby(by=['group']).agg('count')

team[(team['group'].isin(['e', 'a', 'f', 'd'])) | (team['group'] == 'g') | (team['number_player'] > 24)][['group', 'national_name']]

team[(team['national_name'] != 't') & (team['number_player'] != 22)].groupby(by=['national_name', 'group']).agg('mean', numeric_only=True)

team[(team['national_name'] != 't')].groupby(by=['group', 'number_player', 'national_name']).agg('mean', numeric_only=True)

team[(team['national_name'].str.startswith('t')) & (team['national_name'] != 't')][['national_name', 'number_player', 'group']]

team[(team['national_name'].str.startswith('t')) | (team['group'] != 'g') & (team['national_name'] != 't')][['number_player', 'group']]

team[(team['number_player'] != 24) & (team['national_name'] != 't')][['group', 'national_name', 'number_player']]

team[(team['number_player'] == 22) | (team['number_player'] < 25) & (team['national_name'].str.startswith('t'))][['national_name', 'group']]

team[(team['number_player'] > 24) | (team['national_name'] != 't')].groupby(by=['national_name', 'group']).agg('min', numeric_only=True)

team[['group', 'national_name', 'number_player']].groupby(by=['number_player']).agg('max', numeric_only=True)

team[['group', 'number_player', 'national_name']].groupby(by=['group']).agg('mean', numeric_only=True)

team[['national_name', 'group', 'number_player']].groupby(by=['number_player']).agg('mean', numeric_only=True)

team[['national_name', 'number_player', 'group']].groupby(by=['number_player']).agg('max', numeric_only=True)

team[['national_name', 'number_player']].groupby(by=['number_player', 'national_name']).agg('max', numeric_only=True)

team[['national_name', 'number_player']].groupby(by=['number_player', 'national_name']).agg('sum', numeric_only=True)

team[['number_player', 'group', 'national_name']].groupby(by=['national_name']).agg('min', numeric_only=True)

team[['number_player', 'national_name', 'group']].groupby(by=['number_player']).agg('sum', numeric_only=True)

association.merge(team[(team['group'] != 'a')], left_on='national_name', right_on='national_name').groupby(by=['group']).agg('sum', numeric_only=True)

association[(association['founded_year'] < 1907) & (association['association_name'].str.startswith('f')) | (association['founded_year'] > 1966) | (association['founded_year'] != 1981)][['president', 'founded_year']]

association[(association['founded_year'] < 1978)][['national_name']].groupby(by=['national_name']).agg('min', numeric_only=True)

association[(association['founded_year'] == 1922) | (association['national_name'].str.startswith('t')) & (association['association_name'] != 'f')][['association_name', 'president', 'founded_year']]

association[(association['founded_year'] == 1947) | (association['association_name'] == 'f') & (association['founded_year'] == 1970)].groupby(by=['founded_year', 'president']).agg('max', numeric_only=True)

coach.merge(team[(team['number_player'] > 21)], left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('mean', numeric_only=True)

coach[(coach['coach_id'] >= 45)].groupby(by=['role', 'national_name', 'name', 'experience_years']).agg('count')

coach[(coach['name'] != 'c')][['role']].groupby(by=['role']).agg('sum', numeric_only=True)

coach[(coach['national_name'] == 't') | (coach['national_name'] == 't') & (coach['experience_years'] > 27) | (coach['coach_id'] != 45)][['role', 'name']]

coach[(coach['role'] != 'assistant coach') | (coach['coach_id'] <= 68) & (coach['role'] != 'head coach') | (coach['coach_id'] == 16)].merge(team, left_on='national_name', right_on='national_name')

match.merge(team[(team['group'] == 'c') | (team['number_player'] > 25)][['national_name', 'number_player']], left_on='team2_id', right_on='national_name')

match[(match['attendance'] < 49282)][['match_time']].groupby(by=['match_time']).agg('count')

match[(match['attendance'] >= 79503) & (match['match_id'] >= 49) & (match['round'] == 'group stage') & (match['score_team1'] != 5)].merge(team, left_on='team1_id', right_on='national_name')

match[(match['score_team2'] != 3) | (match['match_id'] != 2) & (match['match_date'] <= '2022-12-18') | (match['stadium_id'] >= 8)].groupby(by=['team1_id']).agg('sum', numeric_only=True)

match[(match['team2_id'] != 't')].merge(team[(team['group'] != 'f') | (team['number_player'] >= 22)], left_on='team2_id', right_on='national_name')

match[['team1_id', 'score_team2', 'duration_minutes', 'round']].merge(team, left_on='team1_id', right_on='national_name')

match[['team2_id']].merge(team[['group', 'national_name']], left_on='team2_id', right_on='national_name')

stadium[(stadium['capacity'] < 77891) | (stadium['name'] == 's')].groupby(by=['location', 'capacity', 'stadium_id']).agg('min', numeric_only=True)

stadium[(stadium['capacity'] <= 48545) | (stadium['capacity'] != 66944) & (stadium['stadium_id'] <= 7) & (stadium['year_built'] < 2011) & (stadium['capacity'] == 40428)][['location']]

stadium[(stadium['capacity'] <= 63968) | (stadium['name'] == 's') | (stadium['name'] != 's')].groupby(by=['capacity', 'city']).agg('max', numeric_only=True)

stadium[(stadium['capacity'] == 76689)].groupby(by=['year_built', 'capacity', 'stadium_id', 'name']).agg('sum', numeric_only=True)

stadium[(stadium['location'] != 'e') & (stadium['city'].str.startswith('d'))][['year_built', 'capacity', 'name', 'stadium_id']]

stadium[(stadium['location'] != 'w') | (stadium['capacity'] > 67506) | (stadium['capacity'] >= 67428)][['name', 'location', 'year_built']]

stadium[(stadium['stadium_id'] != 9) & (stadium['year_built'] > 1972) & (stadium['city'] != 'l')].groupby(by=['city', 'capacity']).agg('min', numeric_only=True)

stadium[(stadium['stadium_id'] <= 6)][['city']].groupby(by=['city']).agg('max', numeric_only=True)

stadium[(stadium['year_built'] != 2010)][['year_built']].groupby(by=['year_built']).agg('count')

stadium[['city', 'name', 'capacity', 'location']].groupby(by=['city']).agg('mean', numeric_only=True)

stadium[['city', 'stadium_id', 'location']].groupby(by=['location', 'stadium_id']).agg('max', numeric_only=True)

stadium[['location', 'name', 'city']].groupby(by=['name', 'city']).agg('sum', numeric_only=True)

stadium[['location', 'stadium_id', 'city']].groupby(by=['stadium_id', 'city']).agg('mean', numeric_only=True)

team[(team['national_name'] != 't') & (team['group'] != 'f') | (team['number_player'] <= 20)][['number_player', 'national_name', 'group']]

team[(team['national_name'].str.startswith('t')) & (team['group'] == 'd') & (team['national_name'] == 't')][['group', 'number_player', 'national_name']]

team[(team['national_name'].str.startswith('t')) | (team['national_name'].str.startswith('t'))].groupby(by=['group', 'national_name', 'number_player']).agg('mean', numeric_only=True)

team[(team['national_name'].str.startswith('t')) | (team['number_player'] > 18) & (team['group'] == 'a')][['national_name', 'number_player', 'group']]

team[(team['national_name'].str.startswith('t'))][['national_name']].groupby(by=['national_name']).agg('max', numeric_only=True)

team[(team['number_player'] < 18) | (team['group'] == 'c')].groupby(by=['group', 'national_name', 'number_player']).agg('count')

team[(team['number_player'] <= 20) & (team['group'] == 'e')].groupby(by=['group', 'number_player', 'national_name']).agg('min', numeric_only=True)

team[(team['number_player'] <= 23)][['number_player']].groupby(by=['number_player']).agg('mean', numeric_only=True)

team[(team['number_player'] == 18) & (team['number_player'] == 25) & (team['group'] == 'g')][['national_name', 'number_player', 'group']]

team[(team['number_player'] == 25) | (team['national_name'] != 't') | (team['number_player'] >= 25)][['number_player', 'national_name', 'group']]

team[['group', 'national_name', 'number_player']].groupby(by=['group', 'national_name']).agg('sum', numeric_only=True)

team[['group', 'number_player', 'national_name']].groupby(by=['number_player', 'group']).agg('count')

association[(association['association_name'] == 'f') | (association['national_name'].str.startswith('t'))].merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name')

association[(association['founded_year'] != 1959) | (association['national_name'].str.startswith('t'))].groupby(by=['association_name', 'founded_year', 'president', 'national_name']).agg('mean', numeric_only=True)

association[(association['national_name'] != 't') | (association['founded_year'] < 1938)][['president']].groupby(by=['president']).agg('count')

association[(association['national_name'] != 't') | (association['founded_year'] >= 1932)][['president']].groupby(by=['president']).agg('sum', numeric_only=True)

association[(association['national_name'].str.startswith('t')) | (association['president'].str.startswith('p'))].groupby(by=['founded_year', 'president', 'national_name', 'association_name']).agg('sum', numeric_only=True)

association[(association['president'] != 'p') & (association['national_name'].str.startswith('t')) | (association['association_name'] == 'f')].groupby(by=['founded_year', 'president', 'national_name']).agg('mean', numeric_only=True)

association[(association['president'] != 'p') | (association['association_name'] != 'f')][['president']].groupby(by=['president']).agg('max', numeric_only=True)

association[(association['president'] == 'p')].merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

association[(association['president'].str.startswith('p')) & (association['association_name'] == 'f')][['founded_year']].groupby(by=['founded_year']).agg('mean', numeric_only=True)

coach.merge(team, left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name')

coach.merge(team[(team['number_player'] == 25) & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

coach.merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('min', numeric_only=True)

coach[(coach['experience_years'] < 19) & (coach['name'] != 'c') | (coach['coach_id'] < 27) | (coach['role'].isin(['head coach'])) | (coach['role'] == 'goalkeeper coach')][['coach_id', 'experience_years']]

coach[(coach['name'].str.startswith('c')) & (coach['coach_id'] != 24) & (coach['name'] == 'c')][['role', 'coach_id', 'name', 'experience_years']]

coach[(coach['national_name'].str.startswith('t')) & (coach['experience_years'] <= 32)][['national_name', 'name', 'experience_years', 'role', 'coach_id']]

coach[(coach['national_name'].str.startswith('t')) & (coach['name'] != 'c') | (coach['role'] == 'fitness coach') & (coach['coach_id'] < 32) | (coach['name'] != 'c')][['experience_years', 'name']]

coach[['name', 'experience_years', 'role', 'national_name']].groupby(by=['name', 'national_name']).agg('min', numeric_only=True)

match.merge(team[(team['group'].isin(['a', 'f', 'g', 'c', 'd', 'h', 'b'])) | (team['group'] != 'd')][['number_player', 'national_name', 'group']], left_on='team2_id', right_on='national_name')

match.merge(team[(team['national_name'] == 't')], left_on='team1_id', right_on='national_name').groupby(by=['number_player', 'national_name']).agg('mean', numeric_only=True)

match.merge(team[['national_name', 'number_player']], left_on='team2_id', right_on='national_name').groupby(by=['number_player']).agg('mean', numeric_only=True)

match[(match['score_team1'] <= 6) | (match['attendance'] < 42360) & (match['attendance'] <= 75386) | (match['duration_minutes'] <= 138) & (match['match_time'] != '2')].groupby(by=['score_team2']).agg('min', numeric_only=True)

stadium[(stadium['city'].str.startswith('r')) | (stadium['capacity'] == 57465) | (stadium['capacity'] < 78502) & (stadium['stadium_id'] <= 9)].groupby(by=['stadium_id', 'year_built']).agg('sum', numeric_only=True)

stadium[(stadium['location'] == 's') & (stadium['year_built'] >= 1985)][['city']].groupby(by=['city']).agg('sum', numeric_only=True)

stadium[(stadium['name'].str.startswith('s')) & (stadium['stadium_id'] > 6)].groupby(by=['location', 'name', 'stadium_id', 'city']).agg('sum', numeric_only=True)

stadium[(stadium['stadium_id'] != 11) & (stadium['location'] != 'e') | (stadium['year_built'] == 1984) | (stadium['name'].str.startswith('s')) & (stadium['location'] != 's') & (stadium['stadium_id'] != 10)][['year_built']]

stadium[(stadium['year_built'] > 1961) | (stadium['capacity'] != 72338) | (stadium['name'] != 's')].groupby(by=['capacity', 'city', 'stadium_id']).agg('count')

stadium[['capacity', 'stadium_id', 'location', 'name']].groupby(by=['name', 'location']).agg('count')

stadium[['city', 'location', 'name', 'year_built']].groupby(by=['year_built', 'name']).agg('min', numeric_only=True)

stadium[['name', 'location', 'city']].groupby(by=['city', 'location', 'name']).agg('mean', numeric_only=True)

stadium[['stadium_id', 'name', 'location', 'city']].groupby(by=['name', 'location']).agg('max', numeric_only=True)

team[(team['national_name'] != 't') & (team['number_player'] >= 20)][['group']].groupby(by=['group']).agg('mean', numeric_only=True)

team[(team['national_name'] == 't') & (team['national_name'] != 't') | (team['national_name'] == 't')].groupby(by=['group', 'number_player', 'national_name']).agg('sum', numeric_only=True)

team[(team['national_name'].str.startswith('t')) & (team['group'].isin(['d', 'c', 'e', 'f', 'a', 'g', 'b', 'h']))][['national_name']].groupby(by=['national_name']).agg('min', numeric_only=True)

team[(team['national_name'].str.startswith('t')) & (team['number_player'] >= 22) | (team['number_player'] != 20)].groupby(by=['group', 'number_player', 'national_name']).agg('count')

team[['national_name', 'group', 'number_player']].groupby(by=['national_name', 'number_player', 'group']).agg('mean', numeric_only=True)

team[['national_name', 'number_player', 'group']].groupby(by=['group', 'number_player', 'national_name']).agg('min', numeric_only=True)

team[['number_player', 'national_name', 'group']].groupby(by=['number_player', 'group', 'national_name']).agg('max', numeric_only=True)

association.merge(team, left_on='national_name', right_on='national_name').merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name')

association.merge(team[(team['group'].isin(['g', 'b', 'h', 'c', 'a', 'f', 'd', 'e']))], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 18)], left_on='national_name', right_on='national_name')

association[(association['founded_year'] == 1969) & (association['association_name'].str.startswith('f')) | (association['association_name'].str.startswith('f'))][['association_name']].groupby(by=['association_name']).agg('sum', numeric_only=True)

association[(association['national_name'] != 't') | (association['association_name'] != 'f') | (association['founded_year'] >= 1986)].merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name')

association[(association['national_name'].str.startswith('t')) & (association['national_name'].str.startswith('t')) | (association['president'] != 'p')].groupby(by=['association_name', 'president', 'founded_year', 'national_name']).agg('sum', numeric_only=True)

association[(association['president'] != 'p')][['president', 'association_name']].groupby(by=['president', 'association_name']).agg('max', numeric_only=True)

coach.merge(team[(team['group'] == 'b')], left_on='national_name', right_on='national_name').groupby(by=['group', 'number_player', 'national_name']).agg('count')

coach.merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').groupby(by=['group']).agg('mean', numeric_only=True)

coach[(coach['coach_id'] != 51) & (coach['name'] != 'c') | (coach['experience_years'] < 28)][['name']].groupby(by=['name']).agg('mean', numeric_only=True)

coach[(coach['coach_id'] < 19) | (coach['name'] != 'c') | (coach['national_name'].str.startswith('t'))][['role']].groupby(by=['role']).agg('count')

coach[(coach['coach_id'] > 26) & (coach['role'] == 'assistant coach') | (coach['coach_id'] > 21)][['role']].groupby(by=['role']).agg('mean', numeric_only=True)

coach[(coach['coach_id'] >= 7) | (coach['experience_years'] == 15) & (coach['national_name'].str.startswith('t'))][['coach_id']].groupby(by=['coach_id']).agg('sum', numeric_only=True)

coach[['name', 'coach_id', 'role', 'national_name']].merge(team[(team['number_player'] <= 18)], left_on='national_name', right_on='national_name')

coach[['name', 'experience_years', 'coach_id', 'role']].groupby(by=['coach_id', 'name', 'role']).agg('mean', numeric_only=True)

match.merge(team[['national_name', 'number_player']], left_on='team1_id', right_on='national_name').groupby(by=['national_name', 'number_player']).agg('sum', numeric_only=True)

match.merge(team[['number_player', 'group', 'national_name']], left_on='team1_id', right_on='national_name').groupby(by=['group']).agg('sum', numeric_only=True)

match[(match['round'] != 'semi-final')][['round', 'match_time']].groupby(by=['round', 'match_time']).agg('count')

match[(match['score_team2'] != 6) & (match['match_id'] <= 62) & (match['match_time'] == '2')].merge(team[['number_player', 'national_name']], left_on='team2_id', right_on='national_name')

match[(match['score_team2'] <= 6) | (match['match_id'] <= 23) & (match['duration_minutes'] != 137) & (match['stadium_id'] <= 9) | (match['team1_id'] == 't') | (match['stadium_id'] <= 8)].merge(team, left_on='team1_id', right_on='national_name')

match[['duration_minutes', 'score_team1', 'round', 'team1_id', 'team2_id', 'stadium_id', 'attendance', 'match_date', 'score_team2', 'match_id']]

match[['match_date', 'round', 'score_team1', 'team1_id', 'match_id', 'team2_id']].merge(team, left_on='team1_id', right_on='national_name')

match[['round', 'stadium_id', 'team2_id']].merge(team[['national_name', 'number_player']], left_on='team2_id', right_on='national_name')

match[['team2_id', 'match_id']].merge(team[['national_name', 'group', 'number_player']], left_on='team2_id', right_on='national_name')

stadium[(stadium['capacity'] <= 56946) & (stadium['name'].str.startswith('s')) | (stadium['city'].str.startswith('r'))].groupby(by=['city', 'location', 'stadium_id', 'name']).agg('max', numeric_only=True)

stadium[(stadium['city'] != 'a') & (stadium['capacity'] == 55281) | (stadium['capacity'] <= 71752)][['location']].groupby(by=['location']).agg('min', numeric_only=True)

stadium[(stadium['city'].str.startswith('l')) | (stadium['location'] != 'c')][['capacity', 'city']].groupby(by=['city']).agg('mean', numeric_only=True)

stadium[(stadium['city'].str.startswith('l')) | (stadium['name'] != 's') & (stadium['stadium_id'] > 10)].groupby(by=['name', 'city', 'stadium_id', 'capacity']).agg('min', numeric_only=True)

stadium[(stadium['location'] == 'c') & (stadium['capacity'] != 83692) & (stadium['stadium_id'] < 4)].groupby(by=['city', 'capacity', 'stadium_id', 'location']).agg('min', numeric_only=True)

stadium[(stadium['stadium_id'] != 6) & (stadium['year_built'] != 1999) | (stadium['year_built'] != 1981) & (stadium['city'].str.startswith('l'))].groupby(by=['name', 'location', 'stadium_id']).agg('mean', numeric_only=True)

stadium[(stadium['year_built'] != 1953) | (stadium['name'] == 's') & (stadium['city'] == 'l')].groupby(by=['location', 'name', 'year_built', 'capacity']).agg('max', numeric_only=True)

stadium[(stadium['year_built'] <= 2003) | (stadium['stadium_id'] >= 10) | (stadium['year_built'] >= 1955) & (stadium['city'].str.startswith('r'))].groupby(by=['year_built', 'stadium_id', 'capacity']).agg('count')

stadium[(stadium['year_built'] == 2007) & (stadium['location'] != 'c') & (stadium['capacity'] <= 58140) | (stadium['capacity'] != 65933) & (stadium['stadium_id'] < 3)].groupby(by=['location', 'year_built']).agg('count')

stadium[['capacity', 'name', 'location', 'city', 'stadium_id', 'year_built']].groupby(by=['year_built']).agg('min', numeric_only=True)

stadium[['location', 'city', 'stadium_id', 'year_built']].groupby(by=['city', 'location', 'year_built']).agg('min', numeric_only=True)

stadium[['stadium_id', 'name', 'city', 'year_built']].groupby(by=['stadium_id', 'year_built', 'city']).agg('min', numeric_only=True)

team[(team['group'] != 'a') & (team['group'] != 'e')][['group', 'national_name']].groupby(by=['national_name']).agg('min', numeric_only=True)

team[(team['group'] != 'c') & (team['number_player'] <= 20) | (team['number_player'] > 25)][['national_name']].groupby(by=['national_name']).agg('min', numeric_only=True)

team[(team['group'].isin(['f', 'e', 'b', 'c', 'd', 'a']))][['group', 'national_name']].groupby(by=['national_name', 'group']).agg('min', numeric_only=True)

association[['national_name', 'president', 'founded_year']].merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

coach.merge(team[(team['number_player'] == 24) & (team['number_player'] <= 25) | (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').groupby(by=['number_player', 'group']).agg('min', numeric_only=True)

coach[(coach['national_name'] == 't') & (coach['coach_id'] == 16) | (coach['coach_id'] >= 17) & (coach['role'] != 'head coach')][['name']].groupby(by=['name']).agg('max', numeric_only=True)

match.merge(team[(team['group'].isin(['d', 'c', 'a', 'e', 'f'])) | (team['number_player'] > 23) | (team['number_player'] >= 25)], left_on='team1_id', right_on='national_name').groupby(by=['number_player', 'national_name']).agg('sum', numeric_only=True)

match[(match['duration_minutes'] <= 115) | (match['stadium_id'] < 2) | (match['attendance'] <= 67453) & (match['team1_id'] != 't') | (match['attendance'] == 39622)].merge(team[(team['number_player'] == 25)], left_on='team2_id', right_on='national_name')

match[(match['duration_minutes'] >= 108) & (match['score_team2'] == 5) | (match['duration_minutes'] == 121) & (match['match_date'] > '2022-12-18')].merge(team[(team['number_player'] != 23) & (team['number_player'] == 21)], left_on='team2_id', right_on='national_name')

match[(match['match_id'] != 37) | (match['score_team1'] < 5) & (match['stadium_id'] == 7) & (match['score_team1'] < 1) & (match['match_time'] != '1') & (match['match_date'] < '2022-12-18') | (match['match_date'] < '2022-12-18')][['duration_minutes', 'match_date']]

match[(match['score_team1'] > 0) | (match['score_team2'] <= 4) | (match['match_id'] <= 57) & (match['team2_id'].str.startswith('t')) & (match['score_team1'] != 5)][['match_date', 'score_team1', 'match_time', 'attendance']]

match[(match['score_team1'] >= 6) | (match['score_team2'] <= 2)].merge(team[(team['national_name'].str.startswith('t'))][['number_player', 'national_name']], left_on='team1_id', right_on='national_name')

match[(match['score_team2'] < 2) | (match['match_id'] == 38) | (match['match_time'] != '2') & (match['attendance'] == 34909) | (match['team2_id'].str.startswith('t')) | (match['match_time'].str.startswith('1')) & (match['match_time'] == '2')].merge(team, left_on='team2_id', right_on='national_name')

match[(match['team1_id'] != 't') | (match['score_team1'] > 4) | (match['round'] != 'round of 16')][['score_team1', 'match_time']].groupby(by=['score_team1']).agg('mean', numeric_only=True)

match[(match['team2_id'] == 't') | (match['duration_minutes'] <= 122) | (match['match_id'] <= 7)].merge(team, left_on='team1_id', right_on='national_name').groupby(by=['national_name']).agg('sum', numeric_only=True)

match[['score_team2', 'match_date', 'duration_minutes', 'match_time']].groupby(by=['duration_minutes', 'score_team2', 'match_time', 'match_date']).agg('max', numeric_only=True)

match[['team1_id', 'stadium_id']].merge(team, left_on='team1_id', right_on='national_name').groupby(by=['group', 'number_player']).agg('min', numeric_only=True)

stadium[(stadium['capacity'] != 74908) | (stadium['year_built'] == 1955) | (stadium['location'].str.startswith('s')) | (stadium['location'] != 'c')].groupby(by=['year_built', 'city', 'name', 'capacity']).agg('max', numeric_only=True)

stadium[(stadium['city'] != 'r') & (stadium['capacity'] < 47775)][['location', 'city']].groupby(by=['city', 'location']).agg('sum', numeric_only=True)

stadium[(stadium['location'].str.startswith('c')) | (stadium['capacity'] < 52099) & (stadium['capacity'] == 84345) & (stadium['stadium_id'] > 6)][['city', 'name', 'location', 'capacity', 'year_built']]

stadium[(stadium['name'] != 's') | (stadium['stadium_id'] >= 10) | (stadium['name'].str.startswith('s')) | (stadium['stadium_id'] <= 1)][['location', 'name', 'city', 'capacity', 'stadium_id']]

stadium[(stadium['name'].str.startswith('s')) & (stadium['city'].str.startswith('a')) & (stadium['year_built'] == 1969) & (stadium['name'] != 's')].groupby(by=['city', 'name', 'location', 'capacity']).agg('sum', numeric_only=True)

stadium[(stadium['stadium_id'] == 8)][['city', 'location', 'stadium_id', 'year_built']].groupby(by=['year_built']).agg('sum', numeric_only=True)

stadium[(stadium['stadium_id'] > 1) | (stadium['year_built'] == 1985) | (stadium['name'] != 's') | (stadium['location'].str.startswith('e')) | (stadium['location'] != 'e')].groupby(by=['location', 'capacity', 'city']).agg('sum', numeric_only=True)

stadium[(stadium['year_built'] <= 2006) | (stadium['location'] != 'n') & (stadium['capacity'] >= 83760) | (stadium['location'] == 'n')][['location']].groupby(by=['location']).agg('mean', numeric_only=True)

stadium[['name', 'stadium_id', 'capacity', 'location']].groupby(by=['capacity', 'stadium_id', 'name', 'location']).agg('min', numeric_only=True)

stadium[['stadium_id', 'city', 'name', 'year_built']].groupby(by=['year_built', 'stadium_id', 'name', 'city']).agg('min', numeric_only=True)

stadium[['year_built', 'stadium_id', 'name', 'capacity', 'location']].groupby(by=['name', 'stadium_id', 'location']).agg('min', numeric_only=True)

team[(team['group'] != 'b') & (team['number_player'] >= 22) & (team['national_name'].str.startswith('t'))][['national_name', 'group']].groupby(by=['group']).agg('max', numeric_only=True)

team[(team['group'].isin(['b'])) & (team['national_name'] != 't') & (team['national_name'] != 't')][['national_name', 'number_player']].groupby(by=['national_name']).agg('max', numeric_only=True)

association[(association['association_name'] == 'f') | (association['president'] != 'p') & (association['president'] != 'p')][['founded_year', 'president', 'association_name']].groupby(by=['president']).agg('max', numeric_only=True)

association[(association['association_name'] == 'f')][['association_name', 'national_name', 'founded_year', 'president']].groupby(by=['president', 'association_name']).agg('min', numeric_only=True)

association[(association['president'] == 'p') | (association['national_name'] == 't') | (association['national_name'] == 't') & (association['association_name'].str.startswith('f'))][['association_name', 'president']].groupby(by=['president']).agg('count')

association[['association_name', 'national_name', 'president', 'founded_year']].merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name')

coach[(coach['experience_years'] != 12) | (coach['role'] != 'goalkeeper coach')][['name', 'role', 'national_name']].groupby(by=['name', 'national_name']).agg('mean', numeric_only=True)

coach[(coach['experience_years'] != 19) | (coach['name'].str.startswith('c'))][['national_name', 'experience_years', 'coach_id', 'name']].groupby(by=['national_name']).agg('min', numeric_only=True)

coach[(coach['national_name'].str.startswith('t')) & (coach['experience_years'] <= 2) | (coach['coach_id'] < 2) & (coach['role'] != 'head coach')][['experience_years', 'coach_id']].groupby(by=['coach_id']).agg('min', numeric_only=True)

match.merge(team[(team['group'] == 'a') & (team['number_player'] <= 25) | (team['group'].isin(['b', 'd']))], left_on='team2_id', right_on='national_name').groupby(by=['national_name', 'group', 'number_player']).agg('sum', numeric_only=True)

match.merge(team[(team['group'] == 'e') & (team['group'] == 'a') & (team['number_player'] <= 18)], left_on='team2_id', right_on='national_name').groupby(by=['national_name', 'group', 'number_player']).agg('sum', numeric_only=True)

match.merge(team[['group', 'number_player', 'national_name']], left_on='team2_id', right_on='national_name').groupby(by=['group', 'national_name', 'number_player']).agg('min', numeric_only=True)

match[(match['team2_id'].str.startswith('t'))][['team1_id', 'duration_minutes', 'score_team1', 'match_date', 'score_team2']].merge(team, left_on='team1_id', right_on='national_name')

match[['match_date', 'round', 'team2_id', 'match_time', 'match_id', 'team1_id', 'duration_minutes', 'score_team2']].merge(team, left_on='team1_id', right_on='national_name')

match[['match_id', 'match_time', 'stadium_id', 'round', 'team1_id', 'team2_id']].merge(team[(team['national_name'] == 't')], left_on='team1_id', right_on='national_name')

match[['round', 'match_date', 'score_team2', 'duration_minutes', 'team2_id']].merge(team[['national_name', 'group']], left_on='team2_id', right_on='national_name')

stadium[(stadium['capacity'] > 68939) & (stadium['name'] == 's') | (stadium['capacity'] == 81015) | (stadium['city'].str.startswith('a'))][['location', 'name', 'city', 'capacity', 'year_built', 'stadium_id']]

stadium[(stadium['city'] != 'd') | (stadium['name'] == 's') & (stadium['location'] != 'e') | (stadium['name'] != 's') & (stadium['capacity'] == 71642) | (stadium['year_built'] == 2002)][['year_built', 'city', 'location', 'name']]

stadium[(stadium['city'] != 'l') & (stadium['capacity'] == 53872) | (stadium['year_built'] >= 1987) | (stadium['year_built'] >= 1999) & (stadium['stadium_id'] <= 4)][['name', 'stadium_id', 'location', 'capacity', 'year_built']]

stadium[(stadium['city'] != 'l') & (stadium['city'].str.startswith('d')) & (stadium['year_built'] != 1950) & (stadium['year_built'] >= 2019) & (stadium['year_built'] != 1976)][['year_built']].groupby(by=['year_built']).agg('count')

stadium[(stadium['city'] == 'r') | (stadium['name'].str.startswith('s')) | (stadium['stadium_id'] == 7) & (stadium['name'] != 's') | (stadium['year_built'] >= 1952)][['city', 'location', 'capacity', 'year_built', 'stadium_id']]

stadium[(stadium['location'] == 'e') & (stadium['stadium_id'] != 6) & (stadium['capacity'] < 83245)][['name', 'city']].groupby(by=['name', 'city']).agg('sum', numeric_only=True)

stadium[(stadium['location'].str.startswith('w')) & (stadium['name'] == 's') | (stadium['stadium_id'] == 9) & (stadium['capacity'] > 76763) & (stadium['year_built'] == 1981)][['name']].groupby(by=['name']).agg('max', numeric_only=True)

stadium[(stadium['name'] != 's') | (stadium['capacity'] < 68555) | (stadium['stadium_id'] <= 3) | (stadium['location'] == 's')][['capacity', 'name', 'city', 'year_built', 'location', 'stadium_id']]

stadium[(stadium['stadium_id'] < 9) & (stadium['name'] == 's') & (stadium['name'] != 's') & (stadium['name'] != 's') & (stadium['year_built'] > 2017)][['location']].groupby(by=['location']).agg('min', numeric_only=True)

stadium[(stadium['year_built'] <= 1980) & (stadium['capacity'] >= 68202) & (stadium['year_built'] >= 1977) | (stadium['stadium_id'] <= 6)].groupby(by=['location', 'name', 'stadium_id', 'capacity', 'year_built']).agg('max', numeric_only=True)

stadium[(stadium['year_built'] > 1989) | (stadium['year_built'] <= 1960) | (stadium['city'].str.startswith('r')) | (stadium['city'] == 'r') | (stadium['location'].str.startswith('e'))][['stadium_id']].groupby(by=['stadium_id']).agg('sum', numeric_only=True)

stadium[['capacity', 'location', 'year_built', 'stadium_id', 'city']].groupby(by=['stadium_id', 'year_built', 'city', 'location']).agg('count')

stadium[['capacity', 'name', 'year_built', 'location', 'stadium_id']].groupby(by=['year_built', 'stadium_id', 'name', 'location']).agg('min', numeric_only=True)

stadium[['location', 'year_built', 'capacity', 'name', 'stadium_id', 'city']].groupby(by=['stadium_id', 'location', 'city']).agg('mean', numeric_only=True)

stadium[['name', 'capacity', 'location', 'year_built', 'stadium_id', 'city']].groupby(by=['year_built', 'name', 'city']).agg('sum', numeric_only=True)

team[(team['number_player'] < 18) | (team['number_player'] <= 20) | (team['group'].isin(['f', 'd', 'b', 'c', 'a', 'h', 'g']))][['national_name', 'number_player']].groupby(by=['number_player', 'national_name']).agg('count')

association.merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name')

association[(association['association_name'] != 'f') & (association['national_name'] != 't') & (association['president'].str.startswith('p')) & (association['president'] != 'p')].merge(team, left_on='national_name', right_on='national_name').groupby(by=['number_player', 'group']).agg('sum', numeric_only=True)

coach[(coach['experience_years'] >= 4) & (coach['name'].str.startswith('c')) & (coach['experience_years'] != 35) | (coach['experience_years'] > 3) | (coach['name'].str.startswith('c'))].merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

match.merge(team[(team['number_player'] < 21) | (team['national_name'] == 't') & (team['group'] != 'f')][['number_player', 'national_name']], left_on='team2_id', right_on='national_name').groupby(by=['national_name']).agg('count')

match[(match['match_time'] == '2') | (match['round'] != 'group stage') | (match['match_time'] != '2') & (match['round'] == 'round of 16')].merge(team[(team['national_name'] == 't')][['national_name', 'group']], left_on='team2_id', right_on='national_name')

match[(match['team2_id'].str.startswith('t')) & (match['duration_minutes'] == 97) & (match['attendance'] != 40517) | (match['team2_id'] == 't') | (match['match_time'].str.startswith('2')) | (match['round'] == 'final') & (match['stadium_id'] == 9) | (match['stadium_id'] < 1)][['attendance', 'match_id', 'match_date']]

match[['round', 'match_date', 'score_team2', 'duration_minutes', 'team2_id', 'attendance']].merge(team[['national_name', 'number_player']], left_on='team2_id', right_on='national_name')

match[['team1_id']].merge(team[(team['group'] == 'g') | (team['number_player'] != 22) | (team['group'].isin(['d', 'h', 'g', 'c']))], left_on='team1_id', right_on='national_name').groupby(by=['number_player']).agg('count')

match[['team2_id', 'match_time', 'match_id', 'attendance', 'duration_minutes', 'score_team2', 'round']].merge(team[(team['group'] != 'g')], left_on='team2_id', right_on='national_name')

stadium[(stadium['capacity'] < 44187) | (stadium['stadium_id'] < 1) | (stadium['year_built'] == 2015) | (stadium['city'] == 'r') & (stadium['capacity'] < 52509) | (stadium['stadium_id'] > 11)].groupby(by=['name', 'capacity', 'city', 'location']).agg('max', numeric_only=True)

stadium[(stadium['capacity'] >= 47287) & (stadium['name'] != 's') & (stadium['city'] == 'd') & (stadium['location'] != 'e') & (stadium['name'].str.startswith('s'))][['capacity', 'year_built']].groupby(by=['capacity']).agg('count')

stadium[(stadium['city'] == 'a') | (stadium['location'].str.startswith('s')) | (stadium['name'] == 's') & (stadium['stadium_id'] > 7) & (stadium['location'] != 'c')].groupby(by=['location', 'capacity', 'stadium_id', 'year_built', 'city']).agg('mean', numeric_only=True)

stadium[(stadium['name'] != 's') & (stadium['name'] != 's') & (stadium['city'] == 'r') & (stadium['location'] == 's') | (stadium['stadium_id'] >= 6)][['location', 'name', 'city', 'capacity', 'year_built', 'stadium_id']]

stadium[(stadium['stadium_id'] != 8) | (stadium['year_built'] != 1984) | (stadium['capacity'] >= 71524) & (stadium['capacity'] >= 75594)][['location', 'capacity']].groupby(by=['location', 'capacity']).agg('min', numeric_only=True)

stadium[['capacity', 'location', 'name', 'stadium_id', 'city', 'year_built']].groupby(by=['city', 'name', 'year_built', 'stadium_id']).agg('mean', numeric_only=True)

stadium[['year_built', 'stadium_id', 'city', 'capacity', 'location']].groupby(by=['location', 'stadium_id', 'capacity', 'city', 'year_built']).agg('max', numeric_only=True)

team[(team['national_name'].str.startswith('t')) | (team['national_name'] == 't') | (team['national_name'] == 't')][['number_player', 'national_name', 'group']].groupby(by=['number_player', 'national_name']).agg('sum', numeric_only=True)

team[(team['number_player'] == 24) | (team['group'].isin(['b']))][['national_name', 'number_player', 'group']].groupby(by=['national_name', 'number_player', 'group']).agg('sum', numeric_only=True)

association.merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').groupby(by=['group', 'national_name']).agg('mean', numeric_only=True)

association.merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 21) | (team['group'].isin(['c', 'd', 'b', 'f'])) | (team['national_name'] != 't')], left_on='national_name', right_on='national_name')

association[(association['association_name'] != 'f') & (association['president'].str.startswith('p'))][['association_name', 'national_name']].merge(team, left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('count')

coach.merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

coach[(coach['coach_id'] == 81)][['coach_id', 'national_name', 'role', 'name']].groupby(by=['national_name', 'name', 'coach_id', 'role']).agg('mean', numeric_only=True)

coach[(coach['experience_years'] != 2) | (coach['experience_years'] != 30) | (coach['coach_id'] >= 1)][['role', 'name', 'experience_years']].groupby(by=['role', 'name', 'experience_years']).agg('min', numeric_only=True)

coach[(coach['role'] != 'fitness coach') & (coach['coach_id'] > 71) | (coach['name'] == 'c')].merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name')

match.merge(team[(team['national_name'] == 't') | (team['group'] != 'a')][['number_player', 'group', 'national_name']], left_on='team1_id', right_on='national_name').groupby(by=['national_name', 'number_player']).agg('max', numeric_only=True)

match[(match['attendance'] > 64809)][['score_team1', 'match_id', 'team1_id', 'match_time', 'duration_minutes', 'stadium_id', 'match_date']].merge(team, left_on='team1_id', right_on='national_name')

match[(match['match_date'] == '2022-12-18') & (match['team1_id'].str.startswith('t')) | (match['duration_minutes'] >= 127) & (match['score_team2'] != 6) & (match['duration_minutes'] == 121) | (match['match_date'] >= '2022-12-18')].merge(team[(team['group'] == 'h') & (team['group'].isin(['h', 'b', 'f', 'e', 'c', 'd', 'a'])) | (team['national_name'] != 't')], left_on='team1_id', right_on='national_name')

match[(match['match_time'].str.startswith('2')) | (match['duration_minutes'] == 133) & (match['attendance'] == 62280) | (match['match_id'] != 17) & (match['stadium_id'] >= 1) & (match['attendance'] > 63042)].merge(team[(team['group'] == 'e') | (team['group'] != 'f') & (team['national_name'].str.startswith('t'))], left_on='team1_id', right_on='national_name')

match[(match['score_team1'] < 5) & (match['match_date'] < '2022-11-20') | (match['match_date'] < '2022-12-18') & (match['round'] == 'round of 16') & (match['match_date'] <= '2022-11-20')][['score_team2', 'round']].groupby(by=['score_team2', 'round']).agg('max', numeric_only=True)

match[(match['score_team1'] == 4) | (match['stadium_id'] >= 8) & (match['score_team2'] == 0) | (match['stadium_id'] == 1) | (match['team1_id'].str.startswith('t')) | (match['team1_id'] != 't')].merge(team, left_on='team2_id', right_on='national_name').groupby(by=['national_name']).agg('count')

match[(match['stadium_id'] <= 4) & (match['match_time'] == '2') & (match['attendance'] >= 86680) & (match['duration_minutes'] >= 126) | (match['team1_id'] != 't') | (match['duration_minutes'] == 99)].merge(team, left_on='team1_id', right_on='national_name').groupby(by=['number_player']).agg('sum', numeric_only=True)

match[(match['team1_id'] != 't') | (match['stadium_id'] == 1) & (match['match_id'] <= 52) | (match['score_team1'] == 5) | (match['stadium_id'] > 11) & (match['attendance'] != 71986)].merge(team[['national_name', 'number_player', 'group']], left_on='team2_id', right_on='national_name')

match[['round', 'team1_id', 'score_team2']].merge(team[['national_name', 'group']], left_on='team1_id', right_on='national_name').groupby(by=['group']).agg('min', numeric_only=True)

match[['score_team1', 'match_date', 'stadium_id', 'team1_id', 'attendance', 'duration_minutes', 'round']].merge(team[['number_player', 'national_name']], left_on='team1_id', right_on='national_name')

match[['stadium_id', 'team1_id', 'score_team2', 'match_id', 'score_team1']].merge(team[(team['group'].isin(['a', 'd', 'g']))][['national_name', 'group']], left_on='team1_id', right_on='national_name')

stadium[(stadium['capacity'] != 60126) & (stadium['year_built'] < 2005) | (stadium['capacity'] < 70310) & (stadium['location'] == 'w') | (stadium['capacity'] > 71142) & (stadium['location'].str.startswith('s'))].groupby(by=['city', 'name', 'stadium_id', 'capacity', 'location']).agg('sum', numeric_only=True)

stadium[(stadium['capacity'] <= 83008) & (stadium['city'] != 'd') | (stadium['stadium_id'] == 10) | (stadium['city'] == 'r')][['capacity', 'name', 'city']].groupby(by=['city', 'name']).agg('sum', numeric_only=True)

stadium[(stadium['location'] == 'c')][['city', 'stadium_id', 'capacity', 'location']].groupby(by=['capacity', 'location', 'city', 'stadium_id']).agg('max', numeric_only=True)

stadium[(stadium['name'] != 's') | (stadium['year_built'] > 1980) & (stadium['city'] == 'r')][['stadium_id', 'year_built', 'capacity']].groupby(by=['year_built', 'capacity', 'stadium_id']).agg('count')

team[(team['group'] != 'c') | (team['national_name'] == 't') | (team['national_name'] != 't')][['number_player', 'group', 'national_name']].groupby(by=['number_player', 'national_name', 'group']).agg('max', numeric_only=True)

team[(team['group'].isin(['f', 'g'])) & (team['number_player'] <= 20) | (team['group'] != 'd')][['national_name', 'number_player', 'group']].groupby(by=['number_player', 'group', 'national_name']).agg('sum', numeric_only=True)

team[(team['national_name'] != 't') & (team['number_player'] != 23) & (team['national_name'].str.startswith('t'))][['national_name', 'number_player', 'group']].groupby(by=['number_player', 'group', 'national_name']).agg('sum', numeric_only=True)

association.merge(team[(team['group'] != 'a') & (team['number_player'] > 22) & (team['group'].isin(['e', 'g', 'd', 'b', 'c', 'a', 'h', 'f']))][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'b')], left_on='national_name', right_on='national_name')

association[(association['association_name'].str.startswith('f')) | (association['national_name'] != 't')].merge(team[(team['group'] == 'f') | (team['group'] != 'f')], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'number_player', 'group']).agg('max', numeric_only=True)

association[(association['founded_year'] == 1934) | (association['national_name'] == 't') & (association['founded_year'] >= 1992) | (association['founded_year'] != 1971)][['founded_year', 'president', 'association_name']].groupby(by=['founded_year', 'association_name', 'president']).agg('min', numeric_only=True)

association[(association['national_name'].str.startswith('t')) | (association['president'] != 'p')].merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['national_name', 'group']).agg('sum', numeric_only=True)

association[['president', 'association_name', 'national_name']].merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

coach.merge(team[(team['number_player'] > 20) | (team['group'].isin(['d', 'c', 'a']))][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['number_player', 'national_name', 'group']).agg('sum', numeric_only=True)

coach[['national_name']].merge(team[(team['national_name'] != 't') & (team['number_player'] <= 24)], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name')

match[(match['match_date'] != '2022-11-20') & (match['match_date'] >= '2022-12-18')][['round', 'team2_id', 'match_id', 'score_team2', 'stadium_id', 'team1_id', 'duration_minutes']].merge(team, left_on='team2_id', right_on='national_name')

match[(match['round'] != 'final') | (match['match_date'] < '2022-11-20') & (match['match_time'] == '1') | (match['duration_minutes'] <= 97) | (match['stadium_id'] < 1) | (match['stadium_id'] == 6) | (match['match_date'] > '2022-11-20')].merge(team, left_on='team1_id', right_on='national_name').groupby(by=['national_name']).agg('count')

match[(match['team1_id'].str.startswith('t')) & (match['team2_id'] != 't') | (match['score_team2'] < 4) & (match['score_team2'] >= 3) | (match['match_date'] != '2022-11-20') | (match['duration_minutes'] < 91) & (match['match_date'] != '2022-12-18') | (match['match_date'] < '2022-12-18') & (match['team1_id'].str.startswith('t'))].merge(team[(team['national_name'].str.startswith('t'))], left_on='team2_id', right_on='national_name')

match[['round', 'match_date', 'score_team2', 'duration_minutes', 'match_id', 'match_time', 'attendance']].groupby(by=['score_team2', 'round', 'attendance', 'duration_minutes', 'match_date']).agg('min', numeric_only=True)

match[['round', 'score_team1', 'match_time', 'duration_minutes', 'match_date', 'score_team2', 'match_id']].groupby(by=['match_id', 'duration_minutes', 'score_team2', 'match_time', 'score_team1']).agg('sum', numeric_only=True)

match[['team1_id', 'score_team1', 'round', 'team2_id', 'stadium_id', 'match_date', 'attendance', 'duration_minutes']].merge(team[(team['number_player'] == 22) | (team['group'] == 'a')], left_on='team1_id', right_on='national_name')

stadium[(stadium['name'] != 's') | (stadium['capacity'] != 41372) | (stadium['name'] == 's') | (stadium['capacity'] > 86634) & (stadium['name'] != 's') | (stadium['city'].str.startswith('l'))][['location', 'capacity', 'city']].groupby(by=['city']).agg('max', numeric_only=True)

stadium[(stadium['year_built'] < 1977) | (stadium['capacity'] > 62824)][['city', 'location', 'capacity', 'year_built', 'name', 'stadium_id']].groupby(by=['stadium_id', 'city']).agg('max', numeric_only=True)

coach[(coach['experience_years'] > 5)].merge(team[(team['group'] == 'a') | (team['group'] == 'f')], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name')

coach[(coach['experience_years'] > 7) | (coach['national_name'].str.startswith('t')) & (coach['role'] != 'assistant coach')][['role', 'experience_years', 'name', 'coach_id', 'national_name']].merge(team[(team['number_player'] < 19)], left_on='national_name', right_on='national_name')

match[(match['duration_minutes'] == 110) | (match['stadium_id'] != 9) | (match['team2_id'] == 't')][['match_date', 'round', 'team2_id', 'match_time']].merge(team[(team['national_name'].str.startswith('t')) | (team['number_player'] > 25)], left_on='team2_id', right_on='national_name')

match[(match['match_date'] <= '2022-11-20') | (match['match_time'].str.startswith('1'))].merge(team[['group', 'number_player', 'national_name']], left_on='team1_id', right_on='national_name').groupby(by=['group', 'number_player', 'national_name']).agg('min', numeric_only=True)

match[(match['round'] == 'round of 16') | (match['score_team1'] > 0) | (match['attendance'] == 66761) & (match['score_team1'] < 1) & (match['attendance'] <= 45506) & (match['duration_minutes'] == 128) | (match['match_time'] == '2') | (match['match_id'] >= 53) | (match['stadium_id'] >= 3)].merge(team[['national_name', 'group']], left_on='team1_id', right_on='national_name')

match[(match['round'].isin(['quarter-final', 'final', 'group stage', 'semi-final'])) & (match['team1_id'] == 't') & (match['match_date'] > '2022-12-18') & (match['team2_id'].str.startswith('t')) | (match['team1_id'] != 't') & (match['match_time'] != '2') & (match['team1_id'].str.startswith('t')) & (match['match_id'] != 45) & (match['stadium_id'] > 1)].merge(team[(team['national_name'].str.startswith('t')) | (team['national_name'] == 't')], left_on='team1_id', right_on='national_name')

match[(match['score_team1'] == 5)].merge(team[(team['number_player'] != 24) & (team['national_name'].str.startswith('t'))][['national_name', 'number_player', 'group']], left_on='team1_id', right_on='national_name').groupby(by=['national_name']).agg('min', numeric_only=True)

match[(match['team2_id'] == 't') | (match['team1_id'].str.startswith('t')) & (match['score_team2'] <= 4) | (match['match_date'] > '2022-11-20') | (match['score_team2'] > 5)].merge(team[(team['national_name'].str.startswith('t'))], left_on='team1_id', right_on='national_name').groupby(by=['national_name', 'number_player']).agg('sum', numeric_only=True)

match[['round', 'attendance', 'match_id', 'score_team2', 'match_date', 'score_team1', 'team1_id', 'duration_minutes', 'team2_id']].merge(team[(team['number_player'] > 18) & (team['group'] != 'g')], left_on='team2_id', right_on='national_name')

match[['round', 'score_team1', 'match_date', 'team2_id', 'attendance', 'stadium_id', 'duration_minutes']].merge(team, left_on='team2_id', right_on='national_name').groupby(by=['group', 'number_player']).agg('min', numeric_only=True)

stadium[(stadium['capacity'] > 82295) & (stadium['year_built'] > 1978) & (stadium['capacity'] <= 54613)][['city', 'location', 'name', 'year_built', 'capacity', 'stadium_id']].groupby(by=['stadium_id', 'location']).agg('mean', numeric_only=True)

stadium[(stadium['name'] == 's') | (stadium['city'] != 'r')][['location', 'name', 'city', 'capacity', 'year_built', 'stadium_id']].groupby(by=['capacity', 'stadium_id', 'location']).agg('min', numeric_only=True)

stadium[(stadium['year_built'] < 1975) | (stadium['capacity'] > 68804) | (stadium['location'].str.startswith('e')) & (stadium['capacity'] < 67594)][['location', 'capacity', 'year_built', 'city']].groupby(by=['year_built', 'city', 'capacity']).agg('mean', numeric_only=True)

stadium[(stadium['year_built'] >= 2000) & (stadium['stadium_id'] >= 9) & (stadium['stadium_id'] != 5) & (stadium['city'].str.startswith('a'))][['stadium_id', 'capacity', 'year_built', 'location']].groupby(by=['year_built', 'location', 'stadium_id']).agg('mean', numeric_only=True)

association[(association['founded_year'] <= 1920) | (association['national_name'] != 't') | (association['national_name'] != 't') | (association['founded_year'] < 1924)].merge(team[(team['national_name'] == 't') | (team['national_name'] == 't')], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'group', 'number_player']).agg('max', numeric_only=True)

association[(association['founded_year'] > 1907) & (association['president'] == 'p') | (association['founded_year'] == 1937)].merge(team[(team['group'].isin(['h', 'g', 'b', 'd', 'a', 'f', 'e']))], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name')

association[['association_name', 'national_name', 'founded_year']].merge(team[(team['number_player'] < 18) | (team['number_player'] > 22)][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

coach.merge(team[(team['group'] == 'h') | (team['group'].isin(['a', 'c', 'f', 'h', 'd', 'g', 'b', 'e']))], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'group']).agg('count')

coach[(coach['coach_id'] >= 42) | (coach['experience_years'] >= 32)][['experience_years', 'coach_id', 'national_name']].merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')], left_on='national_name', right_on='national_name')

coach[(coach['experience_years'] == 15) | (coach['coach_id'] == 53)].merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').groupby(by=['group']).agg('max', numeric_only=True)

match[(match['duration_minutes'] < 110) | (match['match_id'] >= 41) | (match['round'] == 'quarter-final') | (match['round'] == 'final') & (match['stadium_id'] <= 7) & (match['stadium_id'] >= 6) & (match['round'] == 'group stage') | (match['match_id'] == 2) | (match['match_time'].str.startswith('1'))].merge(team, left_on='team1_id', right_on='national_name').groupby(by=['group']).agg('min', numeric_only=True)

match[(match['match_date'] > '2022-12-18') & (match['match_time'] != '2')][['team1_id', 'match_id']].merge(team[(team['group'] != 'g') & (team['group'] == 'e')][['national_name', 'number_player', 'group']], left_on='team1_id', right_on='national_name')

match[(match['match_date'] >= '2022-12-18') | (match['match_time'] == '2') | (match['attendance'] > 63484) & (match['score_team2'] != 2)][['score_team1', 'match_time', 'team2_id', 'match_id']].merge(team[(team['group'] == 'g') & (team['national_name'] == 't')], left_on='team2_id', right_on='national_name')

match[(match['round'].isin(['semi-final', 'group stage', 'quarter-final', 'final'])) & (match['duration_minutes'] != 119) | (match['team2_id'].str.startswith('t')) & (match['team2_id'] != 't') | (match['match_id'] <= 47) & (match['stadium_id'] != 11) | (match['match_time'].str.startswith('1')) & (match['match_date'] != '2022-11-20') | (match['team1_id'].str.startswith('t'))].merge(team[(team['group'] == 'b') | (team['group'].isin(['a', 'h', 'e', 'g', 'c', 'b'])) | (team['national_name'] == 't')], left_on='team2_id', right_on='national_name')

match[(match['score_team2'] >= 4) & (match['attendance'] == 69395) & (match['attendance'] != 77698) | (match['match_date'] > '2022-12-18') | (match['team1_id'].str.startswith('t'))].merge(team[(team['number_player'] == 25)], left_on='team2_id', right_on='national_name').groupby(by=['national_name', 'number_player', 'group']).agg('max', numeric_only=True)

match[['duration_minutes', 'attendance', 'match_time', 'round', 'team1_id', 'match_date']].merge(team[(team['number_player'] <= 22) | (team['national_name'] == 't')][['group', 'national_name', 'number_player']], left_on='team1_id', right_on='national_name')

stadium[(stadium['capacity'] != 76899) & (stadium['capacity'] < 45215) & (stadium['stadium_id'] >= 9) & (stadium['name'] != 's') & (stadium['capacity'] == 62737)][['city', 'name', 'location', 'capacity', 'stadium_id', 'year_built']].groupby(by=['city']).agg('sum', numeric_only=True)

stadium[(stadium['city'].str.startswith('d')) | (stadium['stadium_id'] >= 7) & (stadium['year_built'] != 2016) & (stadium['city'].str.startswith('d')) | (stadium['city'] == 'r') & (stadium['location'].str.startswith('w'))][['capacity', 'name', 'city']].groupby(by=['capacity', 'name', 'city']).agg('sum', numeric_only=True)

association.merge(team[(team['national_name'] == 't') | (team['national_name'] != 't') | (team['group'].isin(['c', 'e', 'b', 'f', 'g']))][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name')

association[(association['president'].str.startswith('p'))].merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 22)][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name')

coach.merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name')

coach[(coach['coach_id'] >= 48) & (coach['experience_years'] <= 9) | (coach['name'] != 'c') & (coach['coach_id'] == 87) & (coach['coach_id'] > 18)][['national_name']].merge(team[(team['number_player'] == 21)], left_on='national_name', right_on='national_name').groupby(by=['number_player']).agg('mean', numeric_only=True)

coach[(coach['experience_years'] >= 16) & (coach['role'] == 'head coach') & (coach['experience_years'] == 14) & (coach['coach_id'] >= 69)].merge(team[(team['group'] == 'c') | (team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'g') | (team['group'] == 'd')], left_on='national_name', right_on='national_name')

match[(match['match_time'] != '1') | (match['round'].isin(['round of 16', 'quarter-final', 'final', 'semi-final'])) & (match['score_team1'] <= 5) & (match['match_id'] < 61) | (match['score_team1'] != 1) | (match['match_id'] <= 49) | (match['team1_id'] == 't') & (match['match_date'] == '2022-12-18') | (match['match_date'] != '2022-11-20')][['score_team2', 'attendance']].groupby(by=['attendance', 'score_team2']).agg('count')

match[(match['score_team2'] != 5) | (match['team1_id'] == 't') & (match['match_id'] < 5) & (match['match_date'] == '2022-11-20') | (match['attendance'] != 73822)][['match_time', 'team1_id', 'score_team2', 'match_date', 'round', 'match_id', 'score_team1']].merge(team, left_on='team1_id', right_on='national_name')

match[(match['stadium_id'] < 11) | (match['duration_minutes'] == 135) | (match['round'].isin(['quarter-final', 'round of 16', 'final'])) & (match['team2_id'] == 't') & (match['match_id'] != 40) & (match['round'] == 'round of 16') | (match['match_id'] != 44) | (match['team1_id'] == 't') & (match['score_team2'] >= 3)][['score_team2', 'match_id', 'score_team1', 'attendance', 'match_time', 'round', 'match_date']]

match[['round', 'duration_minutes', 'team2_id', 'match_date', 'score_team2', 'attendance', 'team1_id', 'score_team1', 'stadium_id']].merge(team, left_on='team1_id', right_on='national_name').groupby(by=['number_player', 'group']).agg('min', numeric_only=True)

match[['round', 'score_team1', 'match_time', 'team1_id', 'stadium_id', 'match_date', 'attendance', 'match_id']].merge(team[(team['national_name'] != 't') & (team['national_name'].str.startswith('t'))][['national_name', 'group']], left_on='team1_id', right_on='national_name')

stadium[(stadium['city'] != 'r') & (stadium['name'] != 's')][['city', 'location', 'name', 'year_built', 'capacity', 'stadium_id']].groupby(by=['capacity', 'stadium_id', 'name', 'city', 'location']).agg('mean', numeric_only=True)

stadium[(stadium['city'].str.startswith('a')) & (stadium['stadium_id'] != 5) | (stadium['year_built'] < 1955) & (stadium['name'] == 's')][['city', 'name', 'location', 'capacity', 'stadium_id', 'year_built']].groupby(by=['stadium_id', 'capacity', 'year_built']).agg('mean', numeric_only=True)

association[['founded_year', 'national_name', 'president']].merge(team[(team['number_player'] < 20)][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['group', 'number_player', 'national_name']).agg('min', numeric_only=True)

match[(match['match_time'].str.startswith('1')) & (match['team1_id'] == 't') | (match['score_team1'] != 6) & (match['match_date'] < '2022-11-20')][['score_team2', 'team1_id', 'match_date', 'match_id']].merge(team, left_on='team1_id', right_on='national_name').groupby(by=['group', 'national_name']).agg('sum', numeric_only=True)

match[(match['round'] == 'quarter-final') | (match['team1_id'] == 't') | (match['duration_minutes'] >= 116)][['score_team1', 'score_team2', 'match_id', 'team2_id', 'match_time', 'attendance', 'duration_minutes']].merge(team[['national_name', 'group']], left_on='team2_id', right_on='national_name')

match[(match['score_team2'] >= 1)][['score_team1', 'team1_id', 'stadium_id', 'match_date', 'match_id', 'team2_id', 'match_time', 'duration_minutes', 'round']].merge(team[['number_player', 'national_name']], left_on='team1_id', right_on='national_name')

match[(match['team1_id'] == 't')][['round', 'duration_minutes', 'match_date', 'match_time', 'stadium_id', 'score_team2']].merge(stadium, left_on='stadium_id', right_on='stadium_id').groupby(by=['name', 'year_built', 'capacity']).agg('min', numeric_only=True)

match[(match['team1_id'].str.startswith('t')) & (match['match_time'] != '2') | (match['stadium_id'] > 2) & (match['stadium_id'] > 5) & (match['duration_minutes'] < 124) | (match['team2_id'].str.startswith('t')) | (match['match_time'] != '2') | (match['attendance'] >= 43540) | (match['score_team2'] > 0)][['score_team1', 'attendance', 'team2_id', 'match_date']].merge(team, left_on='team2_id', right_on='national_name')

match[['stadium_id', 'match_date', 'attendance', 'round', 'team2_id', 'match_time', 'team1_id', 'match_id', 'duration_minutes', 'score_team2']].merge(team, left_on='team2_id', right_on='national_name').groupby(by=['national_name', 'group']).agg('sum', numeric_only=True)

stadium[(stadium['location'].str.startswith('c')) | (stadium['name'] != 's') | (stadium['year_built'] > 2002) & (stadium['stadium_id'] >= 4) | (stadium['capacity'] == 70063) | (stadium['capacity'] < 86099)][['capacity', 'stadium_id', 'location', 'year_built', 'name', 'city']].groupby(by=['year_built', 'stadium_id']).agg('count')

association.merge(team[(team['national_name'].str.startswith('t')) | (team['group'] != 'c') | (team['national_name'].str.startswith('t'))][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['number_player', 'group', 'national_name']).agg('count')

association.merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'h')], left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name')

association[['association_name', 'national_name']].merge(team[(team['group'].isin(['d', 'h', 'f', 'a', 'e', 'c'])) & (team['number_player'] < 22)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 25) | (team['national_name'].str.startswith('t')) & (team['group'].isin(['h', 'f', 'b', 'g']))][['group', 'national_name']], left_on='national_name', right_on='national_name')

match[(match['attendance'] == 32696) & (match['team1_id'].str.startswith('t')) & (match['duration_minutes'] >= 131) | (match['match_date'] == '2022-12-18')].merge(team[(team['national_name'].str.startswith('t')) | (team['number_player'] < 23)][['national_name', 'number_player', 'group']], left_on='team1_id', right_on='national_name').groupby(by=['group', 'national_name']).agg('min', numeric_only=True)

match[(match['attendance'] >= 84652) & (match['duration_minutes'] < 97) & (match['duration_minutes'] <= 91) | (match['duration_minutes'] >= 137) | (match['team2_id'].str.startswith('t')) | (match['score_team2'] == 3) | (match['match_time'] != '2') | (match['team2_id'] != 't') | (match['score_team2'] > 1) | (match['match_id'] >= 51)].merge(team[(team['number_player'] != 20)], left_on='team1_id', right_on='national_name').groupby(by=['national_name']).agg('count')

match[(match['match_date'] != '2022-11-20') & (match['score_team2'] >= 2) & (match['round'] == 'group stage') & (match['match_date'] <= '2022-11-20') & (match['match_time'] != '2') & (match['team1_id'] != 't') & (match['stadium_id'] < 2) | (match['round'] != 'semi-final') | (match['match_date'] >= '2022-11-20') | (match['round'] != 'semi-final')].merge(team[(team['national_name'] == 't')][['number_player', 'national_name', 'group']], left_on='team1_id', right_on='national_name')

match[(match['match_id'] < 13) & (match['score_team2'] == 2) & (match['team1_id'].str.startswith('t')) | (match['team2_id'].str.startswith('t')) | (match['match_id'] <= 21) & (match['match_time'] == '2') & (match['score_team1'] < 4) | (match['score_team2'] != 5)].merge(team[['national_name', 'group']], left_on='team1_id', right_on='national_name').groupby(by=['national_name', 'group']).agg('min', numeric_only=True)

match[(match['round'] != 'group stage') & (match['team2_id'] == 't') | (match['stadium_id'] < 8) & (match['stadium_id'] != 6) & (match['round'].isin(['group stage'])) | (match['team2_id'] != 't') | (match['match_date'] <= '2022-11-20') & (match['team1_id'].str.startswith('t'))].merge(team[(team['number_player'] >= 23) & (team['group'].isin(['a', 'b', 'd', 'g', 'f']))], left_on='team2_id', right_on='national_name').groupby(by=['national_name', 'group']).agg('mean', numeric_only=True)

match[(match['round'].isin(['semi-final']))][['team1_id', 'duration_minutes', 'match_date', 'score_team2', 'team2_id']].merge(team[(team['national_name'] == 't') | (team['group'].isin(['c', 'e'])) & (team['number_player'] != 19)], left_on='team1_id', right_on='national_name').groupby(by=['group']).agg('max', numeric_only=True)

match[['score_team1', 'match_date', 'team2_id', 'score_team2', 'round', 'team1_id', 'match_time', 'match_id', 'stadium_id']].merge(team[['group', 'national_name']], left_on='team1_id', right_on='national_name').groupby(by=['national_name']).agg('min', numeric_only=True)

association.merge(team[(team['number_player'] <= 25)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 19) | (team['number_player'] >= 19)][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 20) & (team['group'] != 'a')], left_on='national_name', right_on='national_name')

association.merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['number_player'] <= 25)], left_on='national_name', right_on='national_name')

coach.merge(team[(team['national_name'] == 't') & (team['number_player'] < 20)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').groupby(by=['number_player']).agg('min', numeric_only=True)

coach.merge(team[(team['number_player'] > 23) & (team['group'] != 'c')][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['national_name', 'number_player']).agg('sum', numeric_only=True)

match[(match['attendance'] > 50161) & (match['score_team2'] >= 5) | (match['score_team1'] <= 4) & (match['team2_id'] == 't') | (match['match_id'] == 63)][['round', 'duration_minutes', 'team2_id', 'match_time', 'match_id', 'team1_id', 'score_team1', 'stadium_id']].merge(team[(team['group'] == 'a')], left_on='team2_id', right_on='national_name')

match[(match['round'] == 'group stage') | (match['team2_id'] == 't') & (match['stadium_id'] <= 6) | (match['match_id'] == 5) & (match['match_date'] < '2022-11-20')][['round', 'score_team1', 'match_time', 'team2_id', 'score_team2', 'stadium_id']].merge(team[['number_player', 'national_name', 'group']], left_on='team2_id', right_on='national_name')

match[(match['score_team1'] <= 6) & (match['score_team2'] >= 2) & (match['score_team1'] <= 4) | (match['stadium_id'] >= 1) | (match['score_team2'] >= 0) & (match['score_team1'] != 6) & (match['score_team2'] != 2) | (match['match_id'] < 36) & (match['match_time'] != '2') & (match['match_date'] < '2022-12-18')].merge(team[(team['number_player'] < 25) & (team['number_player'] > 20)][['group', 'national_name', 'number_player']], left_on='team2_id', right_on='national_name')

match[(match['score_team1'] > 5) | (match['team1_id'].str.startswith('t')) & (match['stadium_id'] > 1) & (match['round'] != 'group stage') | (match['stadium_id'] != 2) & (match['stadium_id'] == 9) & (match['team2_id'].str.startswith('t'))][['match_id', 'team2_id']].merge(team[(team['number_player'] < 25)][['group', 'national_name', 'number_player']], left_on='team2_id', right_on='national_name')

match[(match['team1_id'] != 't') & (match['stadium_id'] == 10) | (match['attendance'] <= 61573) & (match['attendance'] <= 49330) | (match['stadium_id'] == 5) & (match['score_team2'] != 3) & (match['stadium_id'] > 6)].merge(team[['national_name', 'number_player', 'group']], left_on='team1_id', right_on='national_name').groupby(by=['group', 'national_name', 'number_player']).agg('sum', numeric_only=True)

match[['score_team1', 'score_team2', 'team1_id', 'match_date', 'match_id', 'attendance', 'match_time', 'team2_id', 'round']].merge(team[['number_player', 'national_name']], left_on='team1_id', right_on='national_name').groupby(by=['national_name', 'number_player']).agg('count')

match[['team2_id', 'stadium_id', 'match_time', 'score_team2', 'round']].merge(team[(team['number_player'] >= 21) & (team['national_name'] == 't')][['group', 'number_player', 'national_name']], left_on='team2_id', right_on='national_name').groupby(by=['national_name', 'group']).agg('max', numeric_only=True)

association[(association['national_name'] == 't') & (association['founded_year'] > 1926) & (association['association_name'] != 'f')].merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['group'].isin(['b', 'g', 'h', 'f', 'c', 'e', 'd']))][['number_player', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'number_player']).agg('mean', numeric_only=True)

association[(association['president'] != 'p') & (association['founded_year'] < 1961)].merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) | (team['number_player'] >= 24)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 21)], left_on='national_name', right_on='national_name')

match[(match['match_id'] != 11) | (match['match_time'].str.startswith('1')) | (match['attendance'] >= 71447) & (match['match_time'] == '1') & (match['stadium_id'] != 7) | (match['match_time'] == '2')].merge(team[(team['national_name'] == 't') | (team['group'].isin(['f', 'a'])) | (team['group'].isin(['e', 'b', 'c', 'a', 'd']))][['national_name', 'group']], left_on='team2_id', right_on='national_name').groupby(by=['group', 'national_name']).agg('count')

match[(match['match_id'] != 33)][['match_date', 'attendance', 'team2_id', 'score_team2', 'round', 'team1_id', 'match_time', 'match_id']].merge(team[['number_player', 'national_name']], left_on='team1_id', right_on='national_name').groupby(by=['number_player']).agg('mean', numeric_only=True)

match[(match['match_time'] != '2') & (match['match_date'] >= '2022-11-20') & (match['duration_minutes'] > 140) | (match['team1_id'] != 't') | (match['score_team2'] != 6) | (match['team2_id'] != 't') | (match['match_id'] > 48) & (match['score_team2'] < 2) | (match['score_team1'] == 3) | (match['duration_minutes'] >= 131)].merge(team[['national_name', 'group']], left_on='team1_id', right_on='national_name').groupby(by=['national_name', 'group']).agg('mean', numeric_only=True)

match[(match['round'] == 'group stage') | (match['team2_id'] != 't') & (match['stadium_id'] > 11) | (match['match_date'] >= '2022-12-18')][['match_id', 'round', 'team2_id', 'match_time']].merge(team[(team['national_name'] == 't') | (team['number_player'] < 25) & (team['number_player'] == 20)], left_on='team2_id', right_on='national_name').groupby(by=['group']).agg('mean', numeric_only=True)

match[(match['team1_id'] == 't') | (match['duration_minutes'] > 138) & (match['stadium_id'] < 7) | (match['team2_id'] != 't') & (match['duration_minutes'] == 101) | (match['match_date'] > '2022-12-18') & (match['round'].isin(['final', 'round of 16', 'group stage', 'quarter-final'])) & (match['team2_id'].str.startswith('t')) | (match['duration_minutes'] <= 104)].merge(team[(team['national_name'] != 't') & (team['group'] == 'e') & (team['national_name'] == 't')], left_on='team1_id', right_on='national_name').groupby(by=['group', 'number_player']).agg('min', numeric_only=True)

match[(match['team2_id'] != 't') | (match['score_team2'] != 5) | (match['attendance'] != 43154)][['match_id', 'score_team1', 'match_date', 'round', 'team1_id', 'team2_id', 'attendance']].merge(team, left_on='team2_id', right_on='national_name').groupby(by=['number_player', 'group', 'national_name']).agg('mean', numeric_only=True)

association.merge(team[(team['national_name'] == 't') & (team['number_player'] == 18)][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'e') | (team['number_player'] != 20) & (team['group'].isin(['c']))][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

association.merge(team[(team['national_name'].str.startswith('t'))][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 25)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 23)], left_on='national_name', right_on='national_name')

association[(association['association_name'] != 'f') | (association['founded_year'] < 1907)].merge(team[(team['national_name'] == 't')][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'a') & (team['number_player'] == 21)][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name')

association[(association['founded_year'] > 1915) & (association['national_name'] == 't') | (association['association_name'] == 'f')].merge(team[(team['national_name'].str.startswith('t'))][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 25)], left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('max', numeric_only=True)

association[['association_name', 'founded_year', 'national_name', 'president']].merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'h')][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'number_player']).agg('mean', numeric_only=True)

coach.merge(team[(team['number_player'] != 23)][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('sum', numeric_only=True)

coach[(coach['national_name'].str.startswith('t')) & (coach['experience_years'] < 12) | (coach['role'] != 'fitness coach') | (coach['role'] == 'fitness coach')].merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'group']).agg('sum', numeric_only=True)

coach[(coach['role'] == 'fitness coach')][['name', 'experience_years', 'national_name', 'coach_id']].merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 23) & (team['national_name'] != 't') | (team['number_player'] < 20)], left_on='national_name', right_on='national_name')

coach[['experience_years', 'role', 'national_name', 'name']].merge(team[(team['group'].isin(['f', 'e']))], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 21)], left_on='national_name', right_on='national_name')

match[(match['match_date'] > '2022-12-18') & (match['duration_minutes'] >= 113) & (match['attendance'] != 82637) & (match['team2_id'].str.startswith('t'))][['round', 'duration_minutes', 'match_time', 'score_team1', 'team1_id', 'stadium_id', 'match_date', 'attendance', 'score_team2', 'match_id']].merge(team[['national_name', 'group']], left_on='team1_id', right_on='national_name')

match[(match['match_id'] != 9) & (match['match_date'] > '2022-11-20')][['team1_id', 'duration_minutes', 'match_id', 'match_time', 'score_team1']].merge(team[['national_name', 'number_player', 'group']], left_on='team1_id', right_on='national_name').groupby(by=['group', 'number_player', 'national_name']).agg('sum', numeric_only=True)

match[['duration_minutes', 'score_team1', 'team2_id', 'match_date', 'match_time', 'match_id', 'score_team2']].merge(team[(team['national_name'] == 't') | (team['group'] == 'f')][['national_name', 'number_player', 'group']], left_on='team2_id', right_on='national_name').groupby(by=['number_player', 'group']).agg('sum', numeric_only=True)

association.merge(team[(team['national_name'].str.startswith('t')) & (team['national_name'] != 't') | (team['number_player'] <= 23)][['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'd') | (team['group'] != 'h') & (team['group'] == 'b')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 22)], left_on='national_name', right_on='national_name')

coach.merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'h') | (team['national_name'].str.startswith('t')) | (team['national_name'] != 't')][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('max', numeric_only=True)

coach.merge(team[(team['group'].isin(['h', 'c'])) | (team['national_name'].str.startswith('t')) | (team['national_name'] != 't')][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 21) & (team['number_player'] != 24) & (team['group'] != 'a')][['number_player', 'national_name']], left_on='national_name', right_on='national_name')

coach[(coach['name'] != 'c') | (coach['national_name'] != 't') | (coach['national_name'] == 't') | (coach['name'] != 'c')].merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name')

coach[['role', 'national_name']].merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['f', 'c', 'h', 'b'])) & (team['national_name'] == 't') | (team['group'] != 'a')], left_on='national_name', right_on='national_name').groupby(by=['group', 'national_name', 'number_player']).agg('count')

match[(match['duration_minutes'] != 115) | (match['duration_minutes'] < 139) & (match['match_id'] <= 22) | (match['team2_id'].str.startswith('t')) & (match['duration_minutes'] < 120) | (match['team2_id'].str.startswith('t')) | (match['stadium_id'] != 3)][['stadium_id']].merge(stadium[(stadium['year_built'] < 2000) | (stadium['city'] == 'd') & (stadium['stadium_id'] < 11)], left_on='stadium_id', right_on='stadium_id').groupby(by=['stadium_id', 'name', 'city']).agg('count')

match[(match['match_date'] < '2022-12-18') | (match['score_team1'] >= 4) & (match['team2_id'] == 't') | (match['duration_minutes'] != 109) | (match['match_date'] > '2022-12-18')][['team1_id', 'score_team1', 'match_date', 'attendance', 'match_time']].merge(team[['number_player', 'group', 'national_name']], left_on='team1_id', right_on='national_name').groupby(by=['national_name']).agg('count')

match[(match['match_time'].str.startswith('1'))].merge(stadium[(stadium['location'].str.startswith('c')) | (stadium['city'].str.startswith('l'))], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['city'] == 'r') & (stadium['year_built'] < 1972) & (stadium['capacity'] < 50520) & (stadium['capacity'] > 65959)], left_on='stadium_id', right_on='stadium_id').groupby(by=['name', 'capacity', 'location', 'city']).agg('sum', numeric_only=True)

match[['score_team1', 'score_team2', 'team1_id', 'stadium_id', 'match_date', 'team2_id', 'match_time', 'attendance', 'duration_minutes', 'round']].merge(team[['number_player', 'group', 'national_name']], left_on='team2_id', right_on='national_name').groupby(by=['national_name', 'group', 'number_player']).agg('count')

association.merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 24) | (team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

association.merge(team[(team['national_name'] == 't') | (team['group'] != 'h')], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'b') & (team['group'].isin(['e', 'd'])) | (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['group']).agg('mean', numeric_only=True)

association[(association['association_name'] != 'f') | (association['founded_year'] == 1978)].merge(team[(team['group'] != 'g') | (team['number_player'] <= 18)][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'b') & (team['national_name'].str.startswith('t')) | (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'group']).agg('count')

association[(association['founded_year'] <= 1995)][['association_name', 'national_name', 'president']].merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'number_player']).agg('min', numeric_only=True)

coach[(coach['coach_id'] <= 42) & (coach['experience_years'] >= 31)].merge(team[(team['group'] == 'c') & (team['group'] == 'b')][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 18) & (team['group'] != 'f') | (team['number_player'] != 21)], left_on='national_name', right_on='national_name').groupby(by=['group']).agg('mean', numeric_only=True)

coach[(coach['role'] == 'assistant coach') & (coach['experience_years'] >= 11) & (coach['role'] != 'fitness coach')].merge(team[(team['group'] == 'g') & (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['national_name'].str.startswith('t')) | (team['number_player'] <= 20)], left_on='national_name', right_on='national_name')

match[(match['duration_minutes'] == 121) & (match['team1_id'] != 't') | (match['match_date'] <= '2022-12-18')][['round', 'duration_minutes', 'team2_id', 'match_date', 'match_time', 'match_id', 'score_team2', 'attendance', 'team1_id']].merge(team[['national_name', 'group']], left_on='team1_id', right_on='national_name').groupby(by=['national_name']).agg('mean', numeric_only=True)

match[(match['stadium_id'] >= 11)][['score_team1', 'score_team2', 'team1_id', 'stadium_id', 'match_date', 'match_id', 'match_time', 'round']].merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[['name', 'capacity', 'stadium_id', 'city', 'location']], left_on='stadium_id', right_on='stadium_id')

association.merge(team[(team['group'] != 'a') | (team['group'].isin(['g']))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['group']).agg('sum', numeric_only=True)

association[(association['president'].str.startswith('p')) | (association['president'] != 'p')].merge(team[(team['national_name'] == 't')][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 23)][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').groupby(by=['group', 'number_player']).agg('count')

association[['association_name', 'national_name']].merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['group']).agg('min', numeric_only=True)

coach.merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

coach.merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['group'] == 'c') & (team['number_player'] < 19)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['national_name', 'group']).agg('sum', numeric_only=True)

coach[(coach['coach_id'] != 31) & (coach['coach_id'] <= 42) & (coach['role'] == 'fitness coach') & (coach['national_name'].str.startswith('t')) | (coach['role'].isin(['goalkeeper coach', 'assistant coach', 'fitness coach']))][['role', 'national_name', 'name', 'experience_years']].merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['national_name'].str.startswith('t')) & (team['group'].isin(['d', 'g', 'h', 'c']))][['number_player', 'national_name']], left_on='national_name', right_on='national_name')

association.merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 18)][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'e') | (team['group'].isin(['g', 'f'])) | (team['national_name'] == 't')][['group', 'national_name']], left_on='national_name', right_on='national_name')

association.merge(team[(team['national_name'].str.startswith('t')) | (team['national_name'] != 't') & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'd')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 20) | (team['national_name'] != 't') | (team['number_player'] < 20)], left_on='national_name', right_on='national_name')

association.merge(team[(team['number_player'] > 25)], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'd') & (team['number_player'] > 21) & (team['number_player'] != 24)][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').groupby(by=['group', 'number_player']).agg('max', numeric_only=True)

association.merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['c', 'f', 'h', 'a', 'g', 'e', 'b'])) & (team['group'] != 'a')][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

coach.merge(team[(team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['group'] == 'a') | (team['national_name'] != 't')][['group', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('sum', numeric_only=True)

coach[['experience_years', 'coach_id', 'national_name', 'role']].merge(team[(team['national_name'] == 't') | (team['national_name'] != 't') | (team['national_name'] != 't')][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['number_player'] == 21) & (team['number_player'] >= 21)][['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name')

match[(match['score_team2'] > 6) | (match['score_team2'] == 2) & (match['match_id'] >= 59) & (match['score_team1'] < 3) & (match['attendance'] <= 63056) & (match['attendance'] != 66046) & (match['team1_id'] == 't')][['score_team1', 'match_date', 'team1_id', 'match_id', 'stadium_id', 'duration_minutes']].merge(team[['group', 'national_name']], left_on='team1_id', right_on='national_name').groupby(by=['group', 'national_name']).agg('mean', numeric_only=True)

association.merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['f', 'g']))][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

association[(association['president'] != 'p') & (association['association_name'] != 'f')].merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'c')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['national_name'] == 't') & (team['number_player'] != 25)][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name')

coach.merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['national_name', 'group', 'number_player']).agg('sum', numeric_only=True)

coach.merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 24) & (team['group'].isin(['f', 'g', 'b', 'd', 'e', 'h', 'c']))][['national_name', 'number_player']], left_on='national_name', right_on='national_name')

match.merge(stadium[(stadium['location'] != 'e')][['capacity', 'stadium_id', 'location']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[['year_built', 'stadium_id', 'location']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').groupby(by=['capacity']).agg('max', numeric_only=True)

match[(match['match_time'] != '1') & (match['match_id'] >= 14)][['round', 'match_date', 'team1_id', 'match_id', 'team2_id', 'duration_minutes', 'stadium_id', 'match_time', 'attendance', 'score_team1']].merge(team[(team['group'] != 'e') | (team['group'].isin(['c', 'b', 'g', 'e'])) & (team['national_name'] == 't')], left_on='team2_id', right_on='national_name').groupby(by=['number_player', 'national_name', 'group']).agg('mean', numeric_only=True)

match[(match['match_time'] == '2') & (match['round'].isin(['semi-final', 'round of 16', 'final', 'quarter-final'])) | (match['round'] != 'semi-final') | (match['stadium_id'] == 6) & (match['match_id'] <= 4) | (match['team2_id'] != 't') | (match['score_team2'] > 0)][['team2_id', 'match_time', 'team1_id', 'match_date', 'attendance', 'duration_minutes', 'score_team2']].merge(team[(team['group'] != 'd') & (team['group'] != 'a')], left_on='team2_id', right_on='national_name').groupby(by=['group', 'number_player']).agg('mean', numeric_only=True)

match[['team1_id', 'round', 'team2_id', 'match_time', 'score_team2', 'match_id', 'stadium_id', 'match_date', 'attendance', 'duration_minutes']].merge(team[(team['group'] != 'a') | (team['group'] != 'g') | (team['number_player'] != 23)][['number_player', 'group', 'national_name']], left_on='team1_id', right_on='national_name').groupby(by=['national_name', 'group', 'number_player']).agg('sum', numeric_only=True)

association.merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

association[['national_name', 'association_name', 'president']].merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').groupby(by=['number_player', 'group']).agg('mean', numeric_only=True)

association[['national_name', 'founded_year']].merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'a')][['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['number_player', 'group']).agg('min', numeric_only=True)

match[(match['stadium_id'] == 3) & (match['match_id'] >= 21) & (match['team1_id'] == 't') & (match['match_date'] < '2022-12-18') | (match['attendance'] == 64829)][['match_id', 'score_team1', 'match_time', 'stadium_id', 'match_date', 'round', 'team1_id', 'attendance', 'team2_id', 'duration_minutes']].merge(team[['group', 'national_name']], left_on='team2_id', right_on='national_name').groupby(by=['group', 'national_name']).agg('max', numeric_only=True)

association[(association['national_name'].str.startswith('t')) & (association['association_name'] != 'f')][['president', 'founded_year', 'association_name', 'national_name']].merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['group', 'number_player', 'national_name']).agg('count')

coach[(coach['experience_years'] < 4) | (coach['national_name'] != 't') | (coach['coach_id'] < 11) & (coach['name'].str.startswith('c'))].merge(team[(team['group'] != 'f')], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name')

coach[(coach['role'] != 'fitness coach')].merge(team, left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['g', 'd', 'f', 'e'])) & (team['national_name'].str.startswith('t'))][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

coach[(coach['role'] == 'goalkeeper coach')].merge(team[(team['group'] != 'g')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['group'] == 'h')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) | (team['group'].isin(['a', 'd'])) & (team['number_player'] >= 21)][['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

match[(match['duration_minutes'] < 110) | (match['round'] == 'round of 16') | (match['score_team2'] >= 4) & (match['match_date'] != '2022-11-20') | (match['match_id'] >= 4) & (match['round'].isin(['round of 16'])) | (match['round'] == 'quarter-final') | (match['match_time'] == '1') | (match['match_date'] != '2022-12-18') & (match['match_id'] >= 2)][['match_time', 'attendance', 'team2_id', 'team1_id', 'score_team2', 'round', 'duration_minutes']].merge(team[['national_name', 'group']], left_on='team1_id', right_on='national_name').groupby(by=['group']).agg('min', numeric_only=True)

match[(match['match_id'] < 57) & (match['match_date'] != '2022-11-20') | (match['match_date'] != '2022-12-18') & (match['attendance'] < 46601) | (match['match_id'] >= 10) | (match['score_team1'] <= 3) | (match['round'].isin(['quarter-final', 'round of 16', 'final', 'group stage'])) | (match['duration_minutes'] == 92) & (match['round'] == 'final')][['duration_minutes', 'team2_id', 'team1_id', 'match_date', 'score_team2', 'stadium_id', 'match_id']].merge(stadium[['location', 'stadium_id', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id')

match[(match['score_team1'] == 6) & (match['team2_id'] != 't') | (match['team2_id'] != 't') | (match['match_time'] == '2') | (match['score_team1'] >= 1) | (match['duration_minutes'] == 122) & (match['score_team2'] > 3) | (match['match_time'].str.startswith('2'))][['match_date', 'team2_id', 'match_id', 'score_team2', 'attendance', 'team1_id', 'duration_minutes']].merge(team[(team['number_player'] >= 19) | (team['number_player'] >= 19) & (team['national_name'] == 't')], left_on='team2_id', right_on='national_name').groupby(by=['number_player', 'national_name']).agg('max', numeric_only=True)

match[(match['score_team2'] == 5) | (match['team2_id'].str.startswith('t')) & (match['team2_id'].str.startswith('t')) | (match['match_date'] == '2022-11-20') | (match['team1_id'] != 't') | (match['round'] == 'final') & (match['team1_id'].str.startswith('t')) & (match['team1_id'].str.startswith('t')) | (match['stadium_id'] < 8)][['team1_id', 'attendance']].merge(team[(team['national_name'] == 't') | (team['number_player'] != 19) & (team['national_name'].str.startswith('t'))][['group', 'national_name', 'number_player']], left_on='team1_id', right_on='national_name').groupby(by=['number_player', 'group']).agg('count')

association[(association['association_name'] == 'f')].merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['group'].isin(['f']))][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['number_player']).agg('min', numeric_only=True)

association[['national_name']].merge(team[(team['national_name'] == 't')][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

coach[(coach['coach_id'] >= 82) & (coach['name'].str.startswith('c'))][['experience_years', 'coach_id', 'name', 'national_name']].merge(team[(team['number_player'] < 22) & (team['group'].isin(['c', 'f'])) | (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'f')], left_on='national_name', right_on='national_name').groupby(by=['number_player', 'group']).agg('min', numeric_only=True)

coach[(coach['name'] != 'c') | (coach['coach_id'] < 30) | (coach['experience_years'] <= 2)][['national_name']].merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['f', 'h', 'b', 'e', 'd', 'a', 'c']))][['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['national_name'] != 't')], left_on='national_name', right_on='national_name')

match[(match['match_id'] == 62) & (match['team1_id'] == 't') & (match['match_id'] < 15) | (match['round'] != 'semi-final') | (match['round'] != 'final')].merge(stadium[['location', 'name', 'stadium_id', 'capacity', 'year_built']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[['stadium_id', 'location', 'year_built']], left_on='stadium_id', right_on='stadium_id')

association[(association['founded_year'] != 1989) | (association['association_name'].str.startswith('f'))].merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['number_player'] != 20) | (team['number_player'] <= 19)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 24) & (team['group'].isin(['a', 'c', 'h', 'd', 'b', 'e', 'f', 'g'])) & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

match[(match['match_time'].str.startswith('1')) & (match['attendance'] >= 42454) & (match['stadium_id'] < 1) & (match['score_team1'] > 4)][['team2_id', 'match_time', 'attendance', 'duration_minutes', 'stadium_id', 'match_date']].merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['stadium_id'] <= 1) & (stadium['name'] != 's')], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').groupby(by=['capacity', 'location']).agg('sum', numeric_only=True)

match[(match['stadium_id'] >= 7) | (match['attendance'] > 69615) & (match['match_time'] != '2') & (match['round'] != 'group stage') | (match['match_id'] < 5) | (match['attendance'] > 52183) | (match['duration_minutes'] != 109) & (match['duration_minutes'] > 113) & (match['match_date'] != '2022-11-20') & (match['team2_id'] == 't')][['score_team1', 'round', 'match_date', 'team2_id', 'attendance', 'team1_id', 'stadium_id']].merge(team[(team['group'] != 'a') | (team['number_player'] <= 19) & (team['number_player'] == 23)], left_on='team1_id', right_on='national_name').groupby(by=['group', 'national_name']).agg('min', numeric_only=True)

association[(association['association_name'] != 'f') | (association['national_name'].str.startswith('t')) & (association['president'] == 'p') & (association['founded_year'] > 1982)].merge(team[(team['number_player'] != 19)][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['group'].isin(['d', 'f'])) & (team['national_name'] != 't')][['national_name', 'group']], left_on='national_name', right_on='national_name').groupby(by=['group']).agg('count')

association[['national_name']].merge(team[(team['group'] == 'h') | (team['group'].isin(['b', 'h', 'a', 'f', 'd'])) | (team['number_player'] < 22)], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('count')

coach[(coach['coach_id'] > 36)][['role', 'national_name', 'name', 'experience_years']].merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'h')][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

coach[['coach_id', 'experience_years', 'role', 'national_name']].merge(team[(team['national_name'].str.startswith('t')) | (team['number_player'] > 22)], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'c') & (team['group'] == 'd') | (team['national_name'] != 't')][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['group', 'number_player', 'national_name']).agg('mean', numeric_only=True)

match.merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['city'] != 'r') | (stadium['city'].str.startswith('a')) | (stadium['name'] == 's') | (stadium['stadium_id'] == 6)][['stadium_id', 'capacity', 'name', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['name'].str.startswith('s'))], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').groupby(by=['location', 'stadium_id', 'year_built', 'city']).agg('mean', numeric_only=True)

association[(association['association_name'] == 'f') | (association['founded_year'] == 1938) & (association['association_name'] == 'f')].merge(team[(team['national_name'] != 't') | (team['number_player'] != 21)][['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 23) & (team['number_player'] <= 21)], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('count')

association[(association['president'] == 'p') & (association['national_name'] != 't')][['association_name', 'national_name']].merge(team[(team['number_player'] != 25)][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'g') | (team['number_player'] > 18)][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name')

coach.merge(team[(team['group'] == 'a')][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 22)][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['group'] != 'f')], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name')

coach[(coach['experience_years'] <= 32) & (coach['name'].str.startswith('c')) | (coach['role'].isin(['head coach', 'assistant coach', 'goalkeeper coach']))][['role', 'coach_id', 'experience_years', 'name', 'national_name']].merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) | (team['national_name'] == 't') & (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

coach[(coach['role'] != 'assistant coach') | (coach['national_name'] == 't')].merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').groupby(by=['group', 'national_name', 'number_player']).agg('count')

coach[['experience_years', 'coach_id', 'national_name']].merge(team[(team['number_player'] < 19) & (team['national_name'].str.startswith('t')) | (team['group'] == 'g')][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['h'])) | (team['national_name'].str.startswith('t'))][['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name')

match.merge(stadium[(stadium['capacity'] < 81463) | (stadium['capacity'] < 54058)][['stadium_id', 'capacity']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['stadium_id', 'name', 'city', 'location', 'capacity']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['year_built'] <= 2003)], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['year_built'] <= 1964) & (stadium['city'].str.startswith('d')) & (stadium['year_built'] <= 1963) & (stadium['city'].str.startswith('d')) | (stadium['stadium_id'] != 10)], left_on='stadium_id', right_on='stadium_id')

match[(match['stadium_id'] < 1) & (match['score_team1'] < 3) & (match['team1_id'] != 't') | (match['team1_id'] != 't') | (match['team2_id'] != 't') & (match['attendance'] != 39659) | (match['match_id'] < 28) | (match['match_date'] != '2022-11-20')][['team1_id', 'round', 'team2_id', 'match_id', 'stadium_id', 'score_team2', 'match_date', 'attendance', 'duration_minutes']].merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['city'] == 'r') | (stadium['location'].str.startswith('n')) & (stadium['name'] == 's') | (stadium['year_built'] == 1979) & (stadium['stadium_id'] > 6) | (stadium['location'] != 'c')], left_on='stadium_id', right_on='stadium_id')

association.merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 19) | (team['group'].isin(['e']))][['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['group'] != 'e') | (team['number_player'] <= 22)], left_on='national_name', right_on='national_name')

coach[(coach['role'].isin(['goalkeeper coach', 'head coach', 'fitness coach', 'assistant coach'])) & (coach['role'] == 'head coach') & (coach['coach_id'] <= 80)][['national_name', 'experience_years', 'coach_id', 'name', 'role']].merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) | (team['number_player'] == 25) | (team['group'].isin(['g', 'f', 'b', 'h']))][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')], left_on='national_name', right_on='national_name')

coach[['national_name', 'experience_years', 'coach_id', 'name', 'role']].merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'h')][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 25) & (team['number_player'] < 19)][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) | (team['group'] != 'h')], left_on='national_name', right_on='national_name')

coach[['national_name', 'name', 'experience_years', 'role', 'coach_id']].merge(team[(team['national_name'].str.startswith('t')) | (team['national_name'].str.startswith('t')) & (team['national_name'].str.startswith('t'))][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('count')

match[['round', 'duration_minutes', 'team2_id', 'match_date', 'match_time', 'match_id', 'score_team2', 'attendance', 'score_team1', 'stadium_id']].merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[['name', 'year_built', 'stadium_id', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id')

association[(association['founded_year'] == 1914)].merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'c') | (team['group'] == 'g') | (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('max', numeric_only=True)

association[(association['president'].str.startswith('p')) | (association['association_name'].str.startswith('f'))][['national_name', 'founded_year']].merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').groupby(by=['group']).agg('min', numeric_only=True)

coach.merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['group'] == 'h')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['number_player'] >= 21) & (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name')

coach.merge(team[(team['group'].isin(['f', 'h', 'c', 'd', 'e', 'b'])) | (team['number_player'] <= 22)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['group', 'national_name', 'number_player']).agg('min', numeric_only=True)

coach[(coach['name'] != 'c')][['experience_years', 'national_name', 'name', 'role', 'coach_id']].merge(team[(team['national_name'] != 't')][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

coach[(coach['role'].isin(['fitness coach'])) | (coach['experience_years'] < 36) & (coach['name'] == 'c') & (coach['name'].str.startswith('c')) | (coach['national_name'] != 't')].merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['group'] != 'f')][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'a') | (team['national_name'] == 't') & (team['group'] == 'a')], left_on='national_name', right_on='national_name').groupby(by=['group', 'national_name', 'number_player']).agg('min', numeric_only=True)

match[['score_team2', 'match_id', 'score_team1', 'stadium_id', 'match_date', 'team1_id', 'match_time', 'round', 'duration_minutes']].merge(stadium[(stadium['name'] != 's') | (stadium['capacity'] < 70842) | (stadium['name'] != 's') & (stadium['name'] == 's')], left_on='stadium_id', right_on='stadium_id').merge(stadium[['year_built', 'stadium_id', 'name', 'city', 'capacity', 'location']], left_on='stadium_id', right_on='stadium_id').groupby(by=['name', 'year_built', 'capacity', 'stadium_id']).agg('max', numeric_only=True)

match[['stadium_id', 'match_time', 'duration_minutes']].merge(stadium[(stadium['city'].str.startswith('d')) & (stadium['capacity'] < 58926) | (stadium['city'].str.startswith('l')) | (stadium['year_built'] >= 1978) | (stadium['year_built'] == 1992) & (stadium['capacity'] <= 73387)], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['year_built'] == 1987) | (stadium['year_built'] >= 1996)][['name', 'capacity', 'year_built', 'stadium_id', 'city', 'location']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id')

association.merge(team[(team['group'] != 'e') | (team['national_name'].str.startswith('t')) & (team['group'].isin(['f', 'h', 'a']))][['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 18)], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'f')][['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 25) & (team['number_player'] <= 24) | (team['group'].isin(['h', 'g', 'a', 'b', 'd', 'e']))][['national_name', 'number_player']], left_on='national_name', right_on='national_name')

coach[(coach['name'] == 'c')][['national_name', 'experience_years', 'coach_id', 'name', 'role']].merge(team[(team['group'] == 'g') & (team['national_name'] != 't') | (team['number_player'] == 20)], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['number_player'] > 18)], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').groupby(by=['number_player', 'national_name', 'group']).agg('count')

association[(association['national_name'] != 't')][['association_name', 'national_name']].merge(team[(team['group'].isin(['g', 'h'])) & (team['group'] != 'g')][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['h', 'c', 'd', 'f'])) | (team['number_player'] > 18)], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'b')], left_on='national_name', right_on='national_name').groupby(by=['group', 'number_player', 'national_name']).agg('count')

association[['national_name', 'founded_year']].merge(team[(team['group'] != 'g')], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('count')

association.merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 22) | (team['group'] == 'h') & (team['number_player'] != 25)][['number_player', 'national_name']], left_on='national_name', right_on='national_name')

association[(association['association_name'].str.startswith('f')) | (association['president'] == 'p')].merge(team[(team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'g')][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['group'] == 'f') & (team['group'].isin(['f', 'a', 'b', 'e', 'c', 'g', 'h', 'd']))], left_on='national_name', right_on='national_name').groupby(by=['group', 'national_name', 'number_player']).agg('mean', numeric_only=True)

association[(association['president'].str.startswith('p')) | (association['national_name'] == 't') & (association['national_name'] == 't')].merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) | (team['national_name'] != 't')][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['b', 'e', 'a', 'f', 'g', 'd', 'c'])) | (team['number_player'] == 20)][['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name')

coach.merge(team[(team['number_player'] != 24) | (team['number_player'] >= 21)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').groupby(by=['group']).agg('mean', numeric_only=True)

match[(match['stadium_id'] < 1) | (match['team1_id'] != 't') | (match['score_team1'] < 1) | (match['round'].isin(['semi-final', 'quarter-final', 'final', 'round of 16']))].merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[['location', 'capacity', 'year_built', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['stadium_id'] == 9) | (stadium['year_built'] == 2006) | (stadium['year_built'] > 1965) & (stadium['stadium_id'] == 11) | (stadium['capacity'] > 68880)], left_on='stadium_id', right_on='stadium_id').groupby(by=['capacity', 'name', 'city', 'location', 'stadium_id']).agg('max', numeric_only=True)

match[['team1_id', 'round', 'score_team1', 'attendance', 'match_time', 'stadium_id', 'score_team2', 'match_id', 'team2_id', 'duration_minutes']].merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] != 48054) & (stadium['stadium_id'] == 7) & (stadium['year_built'] == 1973) | (stadium['capacity'] == 42062) & (stadium['year_built'] > 1959) & (stadium['name'] != 's')][['stadium_id', 'location', 'city', 'year_built']], left_on='stadium_id', right_on='stadium_id').groupby(by=['location', 'stadium_id']).agg('mean', numeric_only=True)

match.merge(stadium[['city', 'location', 'name', 'capacity', 'year_built', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] != 64393) & (stadium['stadium_id'] > 10) | (stadium['stadium_id'] != 3) & (stadium['year_built'] == 2004)], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['location'] != 'c') & (stadium['city'].str.startswith('r'))], left_on='stadium_id', right_on='stadium_id').groupby(by=['location', 'capacity', 'name', 'city']).agg('max', numeric_only=True)

match.merge(stadium[(stadium['year_built'] != 2018)][['location', 'name', 'city', 'capacity', 'year_built', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['city'] != 'd')][['location', 'name', 'capacity', 'year_built', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['name', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').groupby(by=['name', 'year_built', 'capacity', 'city']).agg('min', numeric_only=True)

match[(match['round'].isin(['quarter-final'])) | (match['stadium_id'] >= 3) | (match['stadium_id'] == 9) | (match['duration_minutes'] != 107) | (match['match_id'] >= 5) | (match['score_team1'] > 6)].merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['name'] != 's') & (stadium['stadium_id'] != 1)][['stadium_id', 'location', 'city', 'year_built']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['stadium_id'] <= 11) | (stadium['name'] == 's') | (stadium['city'] == 'd') | (stadium['capacity'] >= 71493) | (stadium['location'] != 'w')][['stadium_id', 'name', 'city', 'year_built']], left_on='stadium_id', right_on='stadium_id').groupby(by=['stadium_id']).agg('count')

association.merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['national_name'] != 't') & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'a')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['national_name'].str.startswith('t'))][['national_name', 'group']], left_on='national_name', right_on='national_name')

association.merge(team[(team['group'] == 'c')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['national_name'] == 't') | (team['number_player'] < 18)][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['number_player'] >= 24)][['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name')

association.merge(team[(team['national_name'] != 't') | (team['national_name'] == 't') | (team['number_player'] != 22)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'h') & (team['group'].isin(['g', 'f', 'a', 'd', 'e'])) & (team['number_player'] > 20)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 19)][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('sum', numeric_only=True)

association[['association_name', 'national_name', 'founded_year', 'president']].merge(team, left_on='national_name', right_on='national_name').merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['group'] != 'b') | (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'g')][['group', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'group']).agg('sum', numeric_only=True)

association[['national_name']].merge(team[(team['group'] != 'f') & (team['number_player'] == 21)], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['f', 'c', 'g', 'h', 'a', 'd', 'b'])) | (team['number_player'] == 24) | (team['national_name'] == 't')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['number_player'] <= 19)], left_on='national_name', right_on='national_name')

coach[(coach['name'] != 'c')].merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['e', 'a', 'h'])) & (team['number_player'] >= 20) | (team['group'] != 'g')][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name')

match[(match['attendance'] > 71224) & (match['round'] != 'quarter-final') & (match['stadium_id'] != 2) & (match['score_team1'] >= 1)][['round', 'duration_minutes', 'team1_id', 'team2_id', 'stadium_id', 'attendance', 'match_date', 'score_team2', 'match_id']].merge(stadium[(stadium['location'] == 'w') & (stadium['location'] != 'c') | (stadium['capacity'] >= 85969) | (stadium['city'] != 'd') | (stadium['city'] == 'l') & (stadium['capacity'] < 40231)][['stadium_id', 'name', 'city', 'year_built', 'location', 'capacity']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').groupby(by=['location', 'stadium_id']).agg('sum', numeric_only=True)

association.merge(team[(team['group'].isin(['g', 'h', 'c', 'a', 'b', 'e', 'd'])) | (team['group'] != 'c')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['group'].isin(['e', 'f'])) | (team['group'].isin(['e', 'b', 'h', 'd', 'f', 'g', 'c']))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 19) & (team['group'] == 'f')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 25) & (team['national_name'] != 't')], left_on='national_name', right_on='national_name')

association[(association['founded_year'] <= 1942) | (association['association_name'] != 'f') & (association['national_name'] == 't') & (association['founded_year'] != 1909)].merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'e') & (team['number_player'] == 25)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 24) | (team['group'] == 'd')][['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

association[(association['president'].str.startswith('p')) | (association['president'] == 'p') & (association['association_name'] == 'f') | (association['president'] != 'p')][['national_name', 'president']].merge(team[(team['group'].isin(['c', 'g', 'a', 'd'])) | (team['national_name'].str.startswith('t'))][['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 21) | (team['group'].isin(['c', 'a', 'g', 'h'])) | (team['group'] != 'e')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name')

association[['association_name', 'national_name', 'founded_year', 'president']].merge(team[(team['national_name'].str.startswith('t')) | (team['national_name'] != 't') & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) | (team['national_name'].str.startswith('t')) | (team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 19)][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').groupby(by=['group', 'national_name', 'number_player']).agg('min', numeric_only=True)

coach.merge(team[(team['number_player'] == 18) | (team['group'].isin(['g', 'b', 'a', 'e', 'f', 'd']))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'b') | (team['national_name'].str.startswith('t'))][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['group'] == 'h') & (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 22) & (team['number_player'] < 20) | (team['number_player'] != 24)][['national_name', 'group']], left_on='national_name', right_on='national_name')

coach.merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['group'] == 'b')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['group'] == 'e')][['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 25)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

association.merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 21) & (team['group'] == 'f')][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['national_name', 'group']).agg('mean', numeric_only=True)

association[(association['founded_year'] < 1985)][['national_name', 'association_name', 'founded_year']].merge(team[(team['national_name'] != 't') | (team['group'] != 'e') | (team['number_player'] > 25)][['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 21) & (team['national_name'] != 't')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['number_player']).agg('min', numeric_only=True)

association[(association['founded_year'] >= 1925) | (association['founded_year'] > 1917)].merge(team[(team['number_player'] == 22) & (team['national_name'].str.startswith('t')) | (team['number_player'] < 20)], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['national_name'].str.startswith('t')) | (team['number_player'] > 22)][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'd') & (team['number_player'] <= 23)], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name')

association[(association['national_name'].str.startswith('t'))].merge(team[(team['group'] == 'f') & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['group'].isin(['g'])) | (team['group'].isin(['h']))][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['national_name', 'number_player']).agg('count')

coach.merge(team[(team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 18) | (team['group'] == 'g')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 20) & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 20) | (team['number_player'] > 23)][['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name')

match[(match['stadium_id'] >= 10) & (match['match_date'] > '2022-11-20') & (match['match_time'] != '1')][['round', 'score_team1', 'attendance', 'match_time', 'match_id', 'stadium_id', 'match_date', 'team2_id', 'duration_minutes']].merge(stadium[(stadium['city'].str.startswith('a')) & (stadium['city'] == 'r') | (stadium['capacity'] <= 57226) | (stadium['capacity'] > 52358) & (stadium['stadium_id'] <= 8)], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['city'].str.startswith('l')) | (stadium['location'].str.startswith('e')) & (stadium['capacity'] <= 72666) | (stadium['capacity'] != 74197) & (stadium['city'] == 'd') & (stadium['capacity'] != 57028)], left_on='stadium_id', right_on='stadium_id').merge(stadium[['name', 'stadium_id', 'location', 'capacity']], left_on='stadium_id', right_on='stadium_id')

coach.merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 18)], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['a', 'b', 'f'])) & (team['group'] != 'b') | (team['group'] != 'g')][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['national_name'].str.startswith('t')) & (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name')

coach[['name', 'national_name', 'role']].merge(team[(team['number_player'] < 22)][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'a')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name')

match[(match['score_team2'] < 5) | (match['score_team2'] > 6) & (match['match_time'].str.startswith('1')) & (match['score_team2'] == 6)][['score_team1', 'match_date', 'attendance', 'duration_minutes', 'score_team2', 'round', 'team2_id', 'team1_id', 'match_id', 'stadium_id']].merge(stadium[(stadium['name'] == 's') & (stadium['stadium_id'] >= 6) & (stadium['location'].str.startswith('s'))][['location', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] != 51973) | (stadium['capacity'] >= 72360) | (stadium['name'].str.startswith('s')) | (stadium['capacity'] == 81225) | (stadium['name'] != 's')][['capacity', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').groupby(by=['stadium_id', 'capacity']).agg('count')

match[['match_time', 'round', 'team1_id', 'score_team2', 'duration_minutes', 'stadium_id', 'team2_id']].merge(stadium[(stadium['capacity'] == 79514) | (stadium['capacity'] == 44775) & (stadium['name'] != 's') & (stadium['name'].str.startswith('s')) | (stadium['stadium_id'] != 2)], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['city'] != 'r') | (stadium['capacity'] < 56916)], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] >= 79778) & (stadium['capacity'] != 50861)][['stadium_id', 'location', 'name', 'capacity']], left_on='stadium_id', right_on='stadium_id').groupby(by=['name', 'stadium_id']).agg('mean', numeric_only=True)

association[['national_name']].merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 24)][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 19) & (team['group'] == 'c')][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'c') | (team['group'] != 'g')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

coach.merge(team[(team['national_name'].str.startswith('t'))][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) | (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 20)], left_on='national_name', right_on='national_name')

association.merge(team[(team['national_name'] != 't') & (team['number_player'] <= 22) | (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 23)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 19) & (team['number_player'] != 20)][['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 18)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'd')][['national_name', 'group']], left_on='national_name', right_on='national_name').groupby(by=['group', 'national_name']).agg('mean', numeric_only=True)

association.merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['b', 'c'])) & (team['national_name'].str.startswith('t')) | (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'g') & (team['national_name'].str.startswith('t'))][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) | (team['number_player'] < 20) & (team['group'] == 'd')][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 21) | (team['number_player'] >= 18) & (team['group'] != 'h')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

association[(association['national_name'] != 't') | (association['founded_year'] < 1942) & (association['national_name'] != 't') | (association['national_name'] == 't')].merge(team[(team['national_name'] == 't') | (team['national_name'] == 't') | (team['number_player'] <= 22)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['h', 'b', 'd', 'c', 'f', 'g', 'e', 'a']))][['national_name', 'group']], left_on='national_name', right_on='national_name')

association[(association['president'] != 'p') & (association['founded_year'] != 1926) & (association['president'] != 'p')][['association_name', 'national_name', 'founded_year', 'president']].merge(team[(team['national_name'].str.startswith('t')) | (team['national_name'] == 't') | (team['number_player'] >= 23)][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 21) & (team['group'] == 'a')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) | (team['group'] != 'h') | (team['number_player'] <= 23)][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name')

association[['association_name', 'national_name', 'president', 'founded_year']].merge(team, left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 24) & (team['national_name'].str.startswith('t')) & (team['number_player'] > 23)][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').groupby(by=['group', 'number_player']).agg('sum', numeric_only=True)

association[['national_name', 'president', 'founded_year']].merge(team[(team['group'] != 'd') | (team['group'] != 'c')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 20) | (team['number_player'] != 21)][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 24) | (team['number_player'] >= 19) & (team['group'].isin(['d', 'h', 'b']))], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name')

association.merge(team[(team['group'] != 'g') & (team['group'] != 'c') | (team['group'].isin(['g', 'b', 'a', 'e']))][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['h'])) | (team['number_player'] > 22)], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'e') & (team['national_name'] != 't') | (team['number_player'] >= 20)][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['number_player'] == 19) & (team['group'] == 'c')][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').groupby(by=['number_player']).agg('max', numeric_only=True)

coach.merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'e') & (team['number_player'] <= 22) & (team['group'] != 'd')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['group'].isin(['b', 'e', 'h', 'g', 'c', 'f'])) & (team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['national_name'] == 't') & (team['national_name'].str.startswith('t'))][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['national_name', 'number_player', 'group']).agg('max', numeric_only=True)

coach[(coach['name'].str.startswith('c')) & (coach['national_name'].str.startswith('t')) & (coach['role'] != 'head coach')][['national_name']].merge(team[(team['number_player'] > 21) | (team['group'] != 'b') & (team['number_player'] >= 23)][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['number_player'] > 18)][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name')

association[(association['founded_year'] != 1959) | (association['president'] == 'p') | (association['president'] != 'p') & (association['president'].str.startswith('p'))].merge(team, left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

association[(association['national_name'] == 't') & (association['national_name'].str.startswith('t')) & (association['founded_year'] <= 1947)].merge(team[(team['group'].isin(['f', 'a'])) | (team['group'] == 'f') & (team['number_player'] >= 22)][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) | (team['national_name'] != 't') & (team['number_player'] > 20)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 18) & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'd') | (team['group'].isin(['f', 'h', 'b', 'e', 'c', 'd']))], left_on='national_name', right_on='national_name')

association[['association_name', 'president', 'national_name', 'founded_year']].merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 18) & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'a') | (team['national_name'].str.startswith('t')) & (team['group'] == 'e')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['number_player']).agg('sum', numeric_only=True)

coach[(coach['coach_id'] <= 32) | (coach['role'].isin(['goalkeeper coach', 'head coach', 'fitness coach', 'assistant coach'])) | (coach['name'] == 'c')].merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['c', 'h'])) & (team['number_player'] >= 18) | (team['number_player'] >= 22)], left_on='national_name', right_on='national_name')

association[(association['association_name'] != 'f')].merge(team[(team['national_name'].str.startswith('t')) & (team['number_player'] < 23) & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['group'].isin(['e', 'f', 'h', 'a', 'b', 'g', 'd', 'c']))][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 25) & (team['group'].isin(['f', 'c', 'g', 'b', 'e', 'a']))], left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['national_name', 'group']).agg('sum', numeric_only=True)

coach.merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['a'])) | (team['number_player'] != 18) & (team['number_player'] < 19)][['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 25) & (team['group'] == 'g') | (team['number_player'] != 21)][['number_player', 'national_name']], left_on='national_name', right_on='national_name')

coach[(coach['role'] == 'goalkeeper coach') & (coach['coach_id'] != 44) & (coach['experience_years'] != 2) | (coach['role'] != 'goalkeeper coach') | (coach['name'] == 'c')].merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['national_name'] != 't')][['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'b') & (team['group'] == 'g') | (team['number_player'] > 21)], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'd')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 19) & (team['group'] == 'f') | (team['group'] != 'a')], left_on='national_name', right_on='national_name')

match[['score_team2', 'match_id', 'score_team1', 'match_time', 'round', 'team1_id', 'team2_id', 'stadium_id', 'attendance', 'duration_minutes']].merge(stadium[(stadium['city'] != 'l') & (stadium['city'] != 'd') | (stadium['capacity'] <= 63343) | (stadium['capacity'] == 81961)][['year_built', 'stadium_id', 'name', 'city', 'capacity', 'location']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['location'] != 'e') & (stadium['location'].str.startswith('n')) & (stadium['capacity'] == 55075)], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['location'] == 's') & (stadium['year_built'] != 1977) | (stadium['capacity'] < 41813) | (stadium['year_built'] > 1952)][['location', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id')

association.merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 25) | (team['national_name'] == 't') & (team['national_name'] != 't')][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'a') | (team['national_name'].str.startswith('t'))][['number_player', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['number_player']).agg('mean', numeric_only=True)

coach.merge(team[(team['group'] != 'c') | (team['national_name'].str.startswith('t')) & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['number_player'] <= 23)][['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'g') | (team['national_name'].str.startswith('t')) | (team['number_player'] <= 20)][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 21)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 23)], left_on='national_name', right_on='national_name')

coach[(coach['name'].str.startswith('c'))].merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['d'])) | (team['national_name'] == 't')][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').groupby(by=['number_player', 'national_name']).agg('mean', numeric_only=True)

coach[(coach['role'] != 'fitness coach')].merge(team[(team['number_player'] > 18) & (team['national_name'] != 't') | (team['national_name'].str.startswith('t'))][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['number_player'] < 19) | (team['number_player'] >= 24)][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 25) & (team['national_name'].str.startswith('t')) | (team['group'].isin(['e']))], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['national_name'] == 't')][['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name')

association.merge(team, left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['group'] != 'f') & (team['group'] != 'g')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 19)], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name')

association[(association['president'].str.startswith('p')) | (association['president'] == 'p') & (association['president'] != 'p') | (association['national_name'] == 't')].merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 22) & (team['group'] == 'e')][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['h', 'g', 'f', 'a'])) | (team['number_player'] != 21)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 24) | (team['national_name'] == 't')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['group', 'number_player', 'national_name']).agg('min', numeric_only=True)

association[['national_name', 'president']].merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'group']).agg('sum', numeric_only=True)

coach.merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'f')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['number_player'] == 20) | (team['group'] == 'd')], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['c', 'h', 'b', 'f'])) & (team['group'] != 'c') & (team['national_name'].str.startswith('t'))][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name')

coach.merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 18) & (team['group'] == 'b')], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 22) | (team['group'].isin(['h', 'e', 'a', 'c', 'b', 'g', 'd', 'f'])) | (team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['number_player'] < 18)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 20)], left_on='national_name', right_on='national_name').groupby(by=['group']).agg('min', numeric_only=True)

coach[(coach['role'] == 'goalkeeper coach') & (coach['name'].str.startswith('c'))].merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 25) & (team['group'] == 'c') | (team['group'] != 'd')][['national_name', 'number_player']], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'number_player']).agg('mean', numeric_only=True)

coach[(coach['role'].isin(['head coach', 'fitness coach', 'goalkeeper coach', 'assistant coach'])) & (coach['experience_years'] == 33)][['coach_id', 'national_name', 'role', 'name']].merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 24) & (team['national_name'].str.startswith('t')) & (team['group'] == 'b')][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

match.merge(stadium[(stadium['location'] != 'c') & (stadium['stadium_id'] >= 9) & (stadium['city'].str.startswith('l')) & (stadium['location'] != 'n')][['stadium_id', 'name']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['stadium_id'] <= 1) | (stadium['name'] != 's')][['city', 'location', 'name', 'capacity', 'year_built', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['year_built'] >= 1973) & (stadium['year_built'] > 2012) & (stadium['city'] == 'a')], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['city'].str.startswith('a')) | (stadium['city'].str.startswith('l'))], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['location'] == 'w') | (stadium['city'] == 'a') & (stadium['stadium_id'] == 9) & (stadium['location'] != 'w') & (stadium['capacity'] >= 65495)], left_on='stadium_id', right_on='stadium_id')

match[(match['team1_id'].str.startswith('t')) & (match['stadium_id'] == 4) & (match['team2_id'] == 't') | (match['score_team2'] <= 4) | (match['match_time'] == '1')][['score_team1', 'match_time', 'stadium_id', 'team1_id']].merge(stadium[(stadium['city'] != 'd') & (stadium['name'] != 's') & (stadium['city'].str.startswith('d'))][['stadium_id', 'name']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['year_built'] >= 2020) & (stadium['stadium_id'] <= 5) & (stadium['year_built'] != 2012) & (stadium['name'].str.startswith('s')) | (stadium['name'] == 's') & (stadium['location'] == 's')][['stadium_id', 'name', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['city'] == 'a') | (stadium['stadium_id'] >= 1) | (stadium['city'] == 'r')][['stadium_id', 'capacity', 'name']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id')

association.merge(team[(team['group'] == 'b') | (team['group'] != 'e') & (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 18) & (team['group'] != 'a') & (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'e') & (team['group'] != 'g')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('count')

coach.merge(team[(team['group'].isin(['f', 'd', 'g', 'a', 'c'])) & (team['group'] != 'c')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['number_player'] >= 23)][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['e', 'g', 'f', 'c']))][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['national_name'] == 't')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name')

coach[(coach['coach_id'] <= 77) & (coach['national_name'] == 't') | (coach['coach_id'] == 86) | (coach['experience_years'] > 26)].merge(team[(team['number_player'] >= 18)], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['number_player'] == 19)], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['g', 'b', 'd', 'a', 'f']))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['f', 'a', 'e', 'h', 'g', 'd', 'c']))], left_on='national_name', right_on='national_name')

coach[(coach['name'] == 'c') | (coach['national_name'] == 't') & (coach['coach_id'] == 1) | (coach['name'] != 'c')][['experience_years', 'coach_id', 'national_name']].merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 18) | (team['number_player'] <= 20) & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 19) & (team['group'].isin(['d', 'h'])) | (team['group'] == 'g')][['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name')

coach[(coach['national_name'].str.startswith('t')) | (coach['coach_id'] != 14) | (coach['experience_years'] == 20)].merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['group'].isin(['d', 'f', 'g', 'b'])) & (team['group'].isin(['b', 'h', 'e', 'a']))][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['number_player', 'group', 'national_name']).agg('min', numeric_only=True)

match[(match['round'].isin(['round of 16', 'final'])) | (match['match_id'] == 45) & (match['team1_id'] == 't') | (match['match_id'] >= 55) & (match['duration_minutes'] > 140) & (match['team2_id'].str.startswith('t')) | (match['match_id'] < 43) & (match['match_time'] == '2') & (match['round'] == 'final') & (match['round'] != 'final')].merge(stadium[['location', 'name', 'year_built', 'stadium_id', 'city', 'capacity']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['city'].str.startswith('l')) | (stadium['location'].str.startswith('w'))][['stadium_id', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['city'] == 'l') | (stadium['stadium_id'] >= 7) & (stadium['stadium_id'] != 6)], left_on='stadium_id', right_on='stadium_id').merge(stadium[['location', 'name', 'year_built', 'stadium_id', 'city', 'capacity']], left_on='stadium_id', right_on='stadium_id')

association.merge(team[(team['number_player'] >= 20)][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 23) & (team['national_name'] != 't')][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'b')], left_on='national_name', right_on='national_name').groupby(by=['number_player']).agg('max', numeric_only=True)

association[(association['founded_year'] == 1942)].merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 21) & (team['number_player'] < 18) & (team['national_name'] != 't')][['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'b')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['number_player', 'national_name']).agg('sum', numeric_only=True)

coach[(coach['name'] != 'c') | (coach['coach_id'] == 58) & (coach['national_name'].str.startswith('t')) & (coach['experience_years'] <= 31)].merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['c', 'e']))][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) | (team['national_name'].str.startswith('t')) & (team['number_player'] < 21)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 25) | (team['number_player'] == 23)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 25)], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name')

coach[['role', 'coach_id', 'experience_years', 'name', 'national_name']].merge(team[(team['group'] == 'c')][['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 24) | (team['group'] != 'g')][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 20)], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'd')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

coach.merge(team[(team['national_name'] != 't') & (team['number_player'] > 21)], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['national_name'] == 't') & (team['national_name'] == 't')][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'd') & (team['number_player'] <= 20) | (team['national_name'] == 't')][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 18) | (team['number_player'] >= 25)], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'g') | (team['number_player'] < 20) & (team['national_name'] != 't')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('max', numeric_only=True)

match[(match['score_team1'] <= 2) | (match['match_date'] <= '2022-12-18') & (match['score_team1'] >= 4) & (match['score_team1'] < 2) | (match['score_team1'] >= 6) | (match['score_team2'] > 2) & (match['duration_minutes'] >= 143)].merge(stadium[['stadium_id', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['stadium_id', 'capacity']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['name'].str.startswith('s')) | (stadium['name'] != 's') & (stadium['name'] != 's') & (stadium['stadium_id'] <= 7) | (stadium['location'] == 'n')], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['location'] != 'e') & (stadium['name'] == 's') & (stadium['name'] != 's') | (stadium['location'] == 'n') | (stadium['city'].str.startswith('a'))][['capacity', 'location', 'year_built', 'stadium_id', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['city'].str.startswith('r')) & (stadium['stadium_id'] >= 4) & (stadium['year_built'] < 1986) & (stadium['capacity'] < 44865)], left_on='stadium_id', right_on='stadium_id')

match[(match['stadium_id'] <= 11) & (match['match_time'].str.startswith('1')) | (match['team1_id'] != 't') | (match['team1_id'] == 't') | (match['match_id'] < 31) | (match['attendance'] == 89132) & (match['team1_id'] == 't') & (match['team1_id'] == 't') & (match['score_team1'] <= 4) | (match['score_team1'] <= 3)][['team1_id', 'stadium_id', 'team2_id', 'match_time', 'match_id', 'score_team2']].merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[['capacity', 'stadium_id', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['name'] != 's')][['stadium_id', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['location', 'capacity', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').groupby(by=['location', 'stadium_id']).agg('sum', numeric_only=True)

association[(association['association_name'] != 'f') & (association['national_name'].str.startswith('t')) | (association['president'].str.startswith('p')) & (association['president'] == 'p')].merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['national_name'].str.startswith('t')) | (team['national_name'].str.startswith('t'))][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 23) & (team['national_name'].str.startswith('t')) | (team['group'] != 'd')][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name')

association[(association['association_name'] != 'f') | (association['national_name'].str.startswith('t')) | (association['national_name'] == 't') & (association['president'].str.startswith('p'))].merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'b') | (team['number_player'] < 20)], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 21)][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').groupby(by=['group', 'national_name']).agg('max', numeric_only=True)

association[(association['founded_year'] <= 1915)].merge(team[(team['national_name'] == 't')][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'g')][['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

association[['president', 'founded_year', 'association_name', 'national_name']].merge(team[(team['national_name'].str.startswith('t'))][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 21)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['national_name'] == 't') & (team['group'] != 'a')][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 20)], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'number_player']).agg('max', numeric_only=True)

coach.merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['number_player'] != 19)][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 25) | (team['national_name'] == 't') & (team['number_player'] < 23)][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['group', 'national_name']).agg('max', numeric_only=True)

coach.merge(team[(team['group'] != 'c')][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['group'].isin(['g', 'e', 'a', 'c', 'b', 'h', 'f', 'd'])) & (team['group'] != 'c')][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'a') | (team['national_name'] == 't') | (team['group'] == 'b')][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'h')][['group', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'group']).agg('max', numeric_only=True)

coach[(coach['experience_years'] > 26) | (coach['national_name'] == 't')][['national_name', 'coach_id']].merge(team[(team['number_player'] < 22) & (team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['national_name'] == 't') | (team['number_player'] > 25)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 18) | (team['group'] != 'h')][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['group'] != 'a')], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['group']).agg('mean', numeric_only=True)

coach[['role', 'coach_id', 'experience_years', 'name', 'national_name']].merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'e') & (team['number_player'] < 19)][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['number_player'] >= 24) | (team['number_player'] == 23)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

match.merge(stadium[(stadium['city'] == 'r') & (stadium['name'] != 's') & (stadium['name'] == 's') & (stadium['stadium_id'] != 9) | (stadium['city'] != 'd')][['stadium_id', 'location', 'capacity']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] == 45640) & (stadium['year_built'] == 2012)][['stadium_id', 'name', 'year_built', 'location', 'capacity']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[['stadium_id', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['city'] == 'r') & (stadium['year_built'] > 1984) | (stadium['year_built'] <= 1969)][['location', 'stadium_id', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['year_built'] <= 1977)][['stadium_id', 'name']], left_on='stadium_id', right_on='stadium_id')

match.merge(stadium[['location', 'name', 'city', 'year_built', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] > 76011) & (stadium['year_built'] < 1974) | (stadium['year_built'] <= 1971) & (stadium['city'] != 'd') & (stadium['capacity'] > 87349)], left_on='stadium_id', right_on='stadium_id').merge(stadium[['capacity', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['capacity', 'year_built', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['name', 'stadium_id', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['year_built'] <= 2009)], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').groupby(by=['name', 'location', 'capacity']).agg('count')

match[(match['match_time'].str.startswith('2')) | (match['round'] != 'semi-final') & (match['attendance'] != 75269) & (match['match_time'] == '1')].merge(stadium[(stadium['year_built'] != 1958) & (stadium['location'] == 'e')][['name', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] != 46707) & (stadium['capacity'] == 70869) & (stadium['capacity'] > 85669) | (stadium['city'] != 'r') & (stadium['capacity'] > 71848)][['location', 'stadium_id', 'capacity']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] < 41256)], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['name'].str.startswith('s')) | (stadium['stadium_id'] != 7) & (stadium['location'].str.startswith('e')) | (stadium['capacity'] >= 51250)][['location', 'year_built', 'capacity', 'name', 'stadium_id', 'city']], left_on='stadium_id', right_on='stadium_id').groupby(by=['stadium_id', 'name', 'year_built', 'city']).agg('min', numeric_only=True)

association[(association['association_name'] != 'f') | (association['national_name'].str.startswith('t')) | (association['president'] == 'p')][['national_name', 'founded_year']].merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 19) & (team['national_name'] != 't') | (team['group'] == 'h')][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['group'] == 'e') & (team['number_player'] < 21)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 24) | (team['number_player'] != 21) & (team['number_player'] >= 20)][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'group']).agg('sum', numeric_only=True)

coach.merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) | (team['group'].isin(['f', 'b', 'h', 'e', 'a'])) | (team['group'] != 'h')][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['national_name'] != 't')][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 21) & (team['group'] != 'g')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['number_player', 'group']).agg('min', numeric_only=True)

coach.merge(team[(team['number_player'] < 19)][['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['number_player'] >= 19)][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['national_name'].str.startswith('t'))][['national_name', 'group']], left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('sum', numeric_only=True)

association.merge(team[(team['group'] != 'h') & (team['group'] == 'c')][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'g')], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'a')][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['national_name'] == 't') | (team['national_name'] == 't')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 21)], left_on='national_name', right_on='national_name').groupby(by=['group', 'national_name']).agg('count')

association.merge(team[(team['number_player'] != 23) | (team['group'] != 'g') | (team['national_name'] != 't')][['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 22)], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name')

association[(association['association_name'] == 'f') & (association['association_name'] == 'f') | (association['national_name'] != 't') | (association['national_name'] == 't')][['national_name', 'president', 'founded_year']].merge(team[(team['national_name'].str.startswith('t')) | (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['h', 'c', 'b', 'd', 'e'])) & (team['group'] != 'h') & (team['number_player'] == 25)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 22) & (team['group'] == 'a') & (team['group'].isin(['g']))], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'group', 'number_player']).agg('sum', numeric_only=True)

association[(association['association_name'].str.startswith('f')) & (association['founded_year'] <= 1910) | (association['association_name'] != 'f')].merge(team[(team['number_player'] <= 21) & (team['group'].isin(['a', 'e', 'd'])) | (team['number_player'] < 25)], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'g') & (team['number_player'] != 23) | (team['number_player'] == 22)][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['e', 'a', 'h', 'd', 'g', 'c']))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'c') & (team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['number_player'] > 25) & (team['number_player'] == 23)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

association[(association['founded_year'] != 1927) & (association['national_name'] == 't') & (association['association_name'] != 'f') | (association['president'].str.startswith('p'))].merge(team[(team['group'].isin(['a', 'b', 'e'])) & (team['number_player'] >= 24)], left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 23) & (team['national_name'].str.startswith('t')) | (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['number_player'] == 25) & (team['number_player'] >= 18)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

association[(association['national_name'] == 't') & (association['national_name'] == 't')].merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 18)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 22)][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 22)][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['national_name'] != 't') | (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['group', 'number_player']).agg('mean', numeric_only=True)

association[(association['president'] == 'p')].merge(team[(team['national_name'] == 't') & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['national_name'] != 't') & (team['group'].isin(['f', 'g', 'c']))][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 18) | (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').groupby(by=['number_player', 'national_name']).agg('max', numeric_only=True)

association[['association_name', 'founded_year', 'national_name', 'president']].merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 23) | (team['number_player'] == 23)], left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

match[(match['attendance'] >= 74964) & (match['score_team2'] == 0) & (match['match_time'] == '2') & (match['score_team1'] <= 1) | (match['match_time'] == '1') & (match['stadium_id'] != 9)].merge(stadium[(stadium['city'] == 'd') & (stadium['location'] != 'c') | (stadium['year_built'] == 1981) | (stadium['city'] != 'a') & (stadium['location'].str.startswith('e')) & (stadium['city'].str.startswith('a'))][['stadium_id', 'capacity', 'name']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['stadium_id', 'capacity', 'location', 'name']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['city'] == 'l')], left_on='stadium_id', right_on='stadium_id').merge(stadium[['stadium_id', 'capacity', 'city', 'year_built']], left_on='stadium_id', right_on='stadium_id').groupby(by=['stadium_id', 'capacity', 'city']).agg('count')

association.merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'b') | (team['group'].isin(['f', 'c', 'd', 'g', 'a', 'b'])) | (team['number_player'] > 25)][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name')

association.merge(team[(team['group'] != 'f') & (team['national_name'].str.startswith('t'))][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 24)][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 22) & (team['number_player'] > 23)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

association[['association_name', 'founded_year', 'national_name', 'president']].merge(team[(team['number_player'] == 20) & (team['national_name'] != 't')][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) | (team['number_player'] >= 20)][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'h') & (team['group'] != 'd') & (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

association[['national_name', 'founded_year', 'president', 'association_name']].merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['number_player'] == 23)][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'e')][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['number_player']).agg('max', numeric_only=True)

coach[(coach['name'].str.startswith('c')) & (coach['coach_id'] >= 19) & (coach['role'].isin(['goalkeeper coach', 'head coach', 'assistant coach'])) | (coach['national_name'].str.startswith('t')) & (coach['coach_id'] == 9)].merge(team[(team['national_name'] == 't') | (team['number_player'] >= 24) | (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'b') | (team['national_name'].str.startswith('t'))][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 25) & (team['national_name'].str.startswith('t')) | (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'h') | (team['group'] == 'a') | (team['number_player'] != 18)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['group'].isin(['d', 'f', 'h']))][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name')

match[(match['match_id'] == 9) & (match['match_id'] != 49) | (match['duration_minutes'] >= 95) | (match['round'] != 'round of 16')][['round', 'attendance', 'match_id', 'score_team2', 'match_date', 'score_team1', 'stadium_id', 'duration_minutes', 'team2_id']].merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['name'].str.startswith('s')) | (stadium['name'] == 's') | (stadium['capacity'] <= 85985) & (stadium['stadium_id'] != 7)][['year_built', 'name', 'location', 'stadium_id', 'city', 'capacity']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['year_built'] == 1955) | (stadium['capacity'] == 52379) & (stadium['capacity'] >= 53282) | (stadium['capacity'] <= 64934) | (stadium['city'] == 'r')][['stadium_id', 'name', 'location']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id')

association[['association_name', 'national_name', 'president', 'founded_year']].merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) | (team['national_name'] != 't') | (team['group'].isin(['c', 'e']))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))][['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').groupby(by=['number_player', 'group', 'national_name']).agg('sum', numeric_only=True)

coach[(coach['national_name'].str.startswith('t')) & (coach['national_name'] != 't') & (coach['coach_id'] >= 59) | (coach['national_name'] == 't') & (coach['coach_id'] >= 25)][['experience_years', 'national_name', 'name', 'coach_id']].merge(team[(team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['group'] != 'f')][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name')

coach[(coach['role'] == 'assistant coach') | (coach['role'] != 'assistant coach') | (coach['national_name'] == 't') | (coach['name'] == 'c') | (coach['name'] != 'c')].merge(team, left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['number_player'] >= 22) & (team['group'].isin(['b', 'e', 'a', 'f', 'h', 'c']))], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 20)], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

coach[(coach['role'] == 'fitness coach')][['national_name']].merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'e') | (team['number_player'] >= 22) | (team['group'].isin(['g', 'h', 'f', 'd', 'c', 'a']))], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['group'].isin(['f'])) & (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'b') | (team['national_name'] == 't')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 19)], left_on='national_name', right_on='national_name')

match[['stadium_id', 'team2_id', 'score_team2', 'score_team1']].merge(stadium[(stadium['name'].str.startswith('s'))][['city', 'stadium_id', 'year_built']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[['name', 'stadium_id', 'year_built']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['name'].str.startswith('s')) | (stadium['year_built'] <= 2021) | (stadium['year_built'] < 2014) | (stadium['location'] == 'c')][['city', 'stadium_id', 'name', 'capacity']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['stadium_id', 'city', 'location', 'year_built']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['stadium_id'] == 10) | (stadium['location'].str.startswith('n')) & (stadium['stadium_id'] <= 6)], left_on='stadium_id', right_on='stadium_id').groupby(by=['name', 'location']).agg('mean', numeric_only=True)

association.merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'a') | (team['national_name'].str.startswith('t'))][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 21) & (team['national_name'] != 't')][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 25) & (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name')

association[['national_name', 'association_name']].merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['number_player'] <= 24) & (team['group'].isin(['d', 'b']))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'a') | (team['number_player'] == 21) | (team['national_name'].str.startswith('t'))][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['c', 'b', 'a', 'h', 'e'])) | (team['national_name'] != 't') & (team['number_player'] >= 25)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 21)][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name')

coach[(coach['coach_id'] < 38) & (coach['coach_id'] == 7) | (coach['role'].isin(['assistant coach', 'fitness coach', 'goalkeeper coach'])) & (coach['role'] == 'head coach')].merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['group'] != 'c') | (team['number_player'] > 25)], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'b')][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'c')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 21) & (team['number_player'] >= 24)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 23)][['national_name', 'number_player']], left_on='national_name', right_on='national_name')

coach[(coach['national_name'] != 't') & (coach['experience_years'] <= 38) & (coach['coach_id'] == 26) & (coach['role'] != 'assistant coach')][['national_name']].merge(team[(team['group'] != 'e')][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['group'] == 'c')][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['c', 'e', 'b', 'h']))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

match.merge(stadium[['capacity', 'name', 'location', 'city', 'stadium_id', 'year_built']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['name'].str.startswith('s'))], left_on='stadium_id', right_on='stadium_id').merge(stadium[['city', 'name', 'capacity', 'stadium_id', 'year_built']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['location', 'capacity', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['city', 'name', 'location', 'capacity', 'stadium_id', 'year_built']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['capacity', 'name', 'location', 'city', 'stadium_id', 'year_built']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id')

association.merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 21)], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['c', 'h', 'f', 'e', 'd', 'g', 'b'])) & (team['number_player'] >= 22) | (team['number_player'] == 19)][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 23) | (team['national_name'] == 't') & (team['group'] != 'a')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 18) & (team['number_player'] < 19) | (team['group'] == 'h')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['group'] == 'c')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 20)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['group', 'national_name']).agg('max', numeric_only=True)

association.merge(team[(team['national_name'] == 't')][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 21)][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 22) | (team['number_player'] <= 25) & (team['national_name'].str.startswith('t'))][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'c') | (team['number_player'] <= 25)][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'number_player', 'group']).agg('max', numeric_only=True)

association.merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 18) | (team['national_name'].str.startswith('t'))][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'g') | (team['group'].isin(['c', 'e', 'a', 'd', 'g', 'b', 'h']))][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['a', 'c', 'd', 'e', 'b', 'h', 'g', 'f'])) & (team['number_player'] < 22) & (team['number_player'] != 20)][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['number_player']).agg('min', numeric_only=True)

association[(association['association_name'] == 'f') & (association['national_name'].str.startswith('t'))].merge(team[(team['group'] != 'c') | (team['number_player'] >= 25)], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 24) & (team['number_player'] == 22) & (team['national_name'] == 't')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['national_name'] == 't') & (team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 25) & (team['number_player'] == 24) & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name')

association[(association['association_name'].str.startswith('f'))][['national_name', 'founded_year', 'president', 'association_name']].merge(team[(team['national_name'] != 't') & (team['national_name'] != 't') & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['number_player'] >= 25)][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 22) | (team['national_name'].str.startswith('t')) & (team['group'] == 'h')], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name')

association[['association_name', 'national_name', 'president', 'founded_year']].merge(team[(team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['f', 'h', 'e', 'g', 'd'])) | (team['number_player'] > 21) | (team['group'].isin(['c', 'd', 'f']))][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'a') | (team['national_name'].str.startswith('t')) | (team['group'] == 'c')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['number_player', 'national_name']).agg('mean', numeric_only=True)

coach[(coach['experience_years'] > 17) | (coach['coach_id'] >= 39)].merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['number_player'] <= 25)][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 22) | (team['group'] != 'h') & (team['national_name'] == 't')], left_on='national_name', right_on='national_name').groupby(by=['group', 'national_name']).agg('count')

coach[['role', 'name', 'coach_id', 'experience_years', 'national_name']].merge(team[(team['number_player'] < 24) | (team['national_name'] != 't') & (team['group'] == 'd')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 23)], left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 24) | (team['number_player'] <= 18) & (team['national_name'].str.startswith('t'))][['number_player', 'national_name']], left_on='national_name', right_on='national_name')

association[['association_name', 'national_name', 'president', 'founded_year']].merge(team[(team['number_player'] != 19) & (team['number_player'] > 25) | (team['number_player'] > 19)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'b') | (team['group'].isin(['c', 'f', 'd', 'e', 'g'])) & (team['number_player'] == 23)][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 18) | (team['number_player'] == 24) | (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 18) | (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['national_name', 'group', 'number_player']).agg('max', numeric_only=True)

coach[(coach['name'] != 'c')].merge(team[(team['number_player'] < 19) & (team['number_player'] == 19) & (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['number_player'] > 21) | (team['number_player'] > 20)], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'f')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'number_player']).agg('sum', numeric_only=True)

association.merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 20)][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 24) | (team['group'] == 'h') | (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 23) & (team['number_player'] > 23) | (team['number_player'] >= 22)][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 25)][['number_player', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['number_player']).agg('count')

association[(association['president'].str.startswith('p')) & (association['association_name'].str.startswith('f'))].merge(team[(team['national_name'] == 't') | (team['number_player'] != 22)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 21)], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 23)][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['b', 'a', 'g', 'f', 'e']))][['group', 'national_name']], left_on='national_name', right_on='national_name')

coach.merge(team[(team['group'] != 'h')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 24) & (team['number_player'] > 21)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 25) | (team['number_player'] == 21)][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['number_player'] == 22) & (team['group'] == 'b')][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name')

coach.merge(team[(team['number_player'] > 21) | (team['number_player'] == 23)], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['number_player'] < 20)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 21) | (team['number_player'] < 24) & (team['group'].isin(['b', 'g', 'a', 'h', 'c', 'e', 'f']))], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 19) | (team['number_player'] > 18)], left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['h', 'e', 'c', 'f', 'b'])) | (team['number_player'] >= 24)][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['group']).agg('count')

coach[(coach['name'] != 'c') | (coach['role'] == 'goalkeeper coach')].merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 19) | (team['group'] == 'c')][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 25) & (team['number_player'] > 22)], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['a', 'g', 'e', 'd', 'c', 'f', 'b', 'h'])) | (team['number_player'] != 20)], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['group'] == 'g')], left_on='national_name', right_on='national_name')

coach[['national_name']].merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'h')][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['c'])) & (team['group'].isin(['h', 'a']))][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 19) | (team['number_player'] == 18)], left_on='national_name', right_on='national_name')

match[(match['score_team1'] == 0) | (match['team2_id'] == 't') | (match['score_team1'] < 5) & (match['team1_id'] == 't') | (match['score_team2'] != 0)].merge(stadium[(stadium['year_built'] > 1993) | (stadium['name'].str.startswith('s')) | (stadium['name'] == 's') | (stadium['city'] != 'r') & (stadium['stadium_id'] == 6) | (stadium['stadium_id'] == 3)], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['city'] == 'd') & (stadium['stadium_id'] == 5)][['capacity', 'stadium_id', 'year_built', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['stadium_id'] <= 7) | (stadium['city'].str.startswith('r')) & (stadium['name'] != 's')][['stadium_id', 'year_built', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] > 66832) & (stadium['name'].str.startswith('s')) & (stadium['stadium_id'] <= 9) | (stadium['location'] == 'n')][['capacity', 'stadium_id', 'location', 'year_built', 'city']], left_on='stadium_id', right_on='stadium_id').groupby(by=['city', 'capacity', 'year_built', 'location']).agg('min', numeric_only=True)

association.merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 25)], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'g')][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 22) & (team['group'] != 'a')][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 23) & (team['national_name'] == 't') & (team['group'] == 'f')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 20)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('min', numeric_only=True)

coach[(coach['coach_id'] != 67) & (coach['role'] == 'goalkeeper coach') & (coach['national_name'] == 't') | (coach['coach_id'] > 50)].merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'g')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 25)], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'c')][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 22) & (team['group'] != 'e') | (team['number_player'] != 20)], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['number_player'] <= 19)], left_on='national_name', right_on='national_name')

association.merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 25) & (team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'e') | (team['number_player'] <= 23) & (team['number_player'] == 24)][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 24) | (team['number_player'] != 24) | (team['group'] != 'f')], left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('sum', numeric_only=True)

association[(association['president'].str.startswith('p'))][['national_name', 'association_name', 'president', 'founded_year']].merge(team[(team['number_player'] == 21) | (team['group'] == 'c') & (team['number_player'] == 20)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 25)][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['group'] == 'd')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'number_player']).agg('max', numeric_only=True)

coach[(coach['name'] != 'c') & (coach['national_name'] == 't') | (coach['role'] == 'assistant coach') | (coach['name'].str.startswith('c'))].merge(team[(team['national_name'] != 't')][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['number_player'] != 19) | (team['number_player'] != 21)], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'g') & (team['number_player'] > 25) & (team['number_player'] > 23)][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['number_player'] < 23)][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 18) & (team['group'] != 'b')][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'group']).agg('mean', numeric_only=True)

coach[(coach['name'].str.startswith('c')) & (coach['experience_years'] == 5)].merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'g')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'f')][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 21) | (team['number_player'] < 25) | (team['national_name'] == 't')][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

match[(match['score_team1'] >= 5) | (match['stadium_id'] > 6) | (match['round'] == 'final') | (match['match_id'] > 60) | (match['score_team1'] >= 0)][['score_team2', 'score_team1', 'stadium_id', 'round', 'attendance']].merge(stadium[['year_built', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['year_built', 'stadium_id', 'name', 'city', 'capacity', 'location']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] > 53103) | (stadium['stadium_id'] < 3)], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['city'] != 'l') & (stadium['name'].str.startswith('s')) & (stadium['capacity'] < 47107)], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['name'].str.startswith('s'))][['year_built', 'capacity', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').groupby(by=['stadium_id', 'year_built', 'capacity']).agg('min', numeric_only=True)

association[['association_name', 'founded_year', 'national_name']].merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 22) | (team['national_name'] == 't') & (team['national_name'] == 't')][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'b') & (team['number_player'] < 20)], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'h') & (team['number_player'] > 23)], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'f')][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')], left_on='national_name', right_on='national_name')

coach[(coach['name'] != 'c') | (coach['name'] == 'c') & (coach['coach_id'] != 85) & (coach['national_name'] == 't') & (coach['role'].isin(['head coach', 'goalkeeper coach']))][['name', 'national_name', 'coach_id', 'experience_years']].merge(team[(team['number_player'] < 25)], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'a')][['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['h', 'e', 'd', 'a', 'g', 'f']))], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['national_name'] != 't') | (team['number_player'] == 20)], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['national_name'] != 't')][['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

coach[(coach['role'] == 'assistant coach') & (coach['experience_years'] != 11) | (coach['coach_id'] <= 29) | (coach['experience_years'] >= 4) & (coach['coach_id'] < 90)].merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['g', 'a'])) & (team['national_name'].str.startswith('t')) & (team['group'] != 'b')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'c')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 20) & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['e', 'h'])) | (team['group'] == 'c')], left_on='national_name', right_on='national_name')

association.merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['number_player'] <= 19) & (team['number_player'] != 19)], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 24) & (team['national_name'] != 't')][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 24)][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 21) & (team['number_player'] >= 19) & (team['number_player'] > 19)], left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['number_player', 'group', 'national_name']).agg('max', numeric_only=True)

association[(association['association_name'] == 'f') & (association['president'].str.startswith('p')) | (association['president'].str.startswith('p')) & (association['president'].str.startswith('p'))].merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 24) | (team['national_name'] != 't') | (team['number_player'] > 18)], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['g', 'd', 'a', 'e', 'h', 'b', 'c', 'f']))][['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'c')], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'f') & (team['group'] == 'e')], left_on='national_name', right_on='national_name')

coach[(coach['role'].isin(['assistant coach', 'fitness coach'])) & (coach['name'] == 'c') | (coach['name'] == 'c') & (coach['name'] == 'c')].merge(team[(team['national_name'].str.startswith('t'))][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'a')], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'b') | (team['number_player'] <= 24) | (team['national_name'] == 't')][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'c') & (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name')

coach.merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) | (team['national_name'] == 't') & (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'h') & (team['group'].isin(['f', 'h', 'd', 'e']))], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 19) | (team['group'] != 'a')], left_on='national_name', right_on='national_name').groupby(by=['number_player', 'group', 'national_name']).agg('mean', numeric_only=True)

coach[(coach['name'].str.startswith('c'))][['national_name', 'role']].merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'e') & (team['group'] == 'f')][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['e', 'g', 'h', 'f', 'a'])) | (team['national_name'] != 't') & (team['number_player'] > 22)][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 21) & (team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

match.merge(stadium[(stadium['year_built'] != 1951) | (stadium['name'] != 's') | (stadium['location'] == 'c') | (stadium['capacity'] < 76723) & (stadium['name'].str.startswith('s'))], left_on='stadium_id', right_on='stadium_id').merge(stadium[['capacity', 'stadium_id', 'year_built', 'location', 'name', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['location'] != 'c') | (stadium['capacity'] < 48323)][['capacity', 'stadium_id', 'year_built', 'name']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[['capacity', 'stadium_id', 'location']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[['capacity', 'stadium_id', 'year_built']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['name'] == 's')][['stadium_id', 'location']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').groupby(by=['year_built']).agg('max', numeric_only=True)

association[['association_name', 'national_name', 'president', 'founded_year']].merge(team[(team['group'] == 'd') | (team['number_player'] > 25)], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 18) | (team['national_name'] != 't') | (team['national_name'] == 't')][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 24) | (team['group'].isin(['g', 'b']))], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['e', 'f']))], left_on='national_name', right_on='national_name')

coach[(coach['name'] == 'c') | (coach['name'] == 'c') | (coach['coach_id'] > 68)].merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 22)], left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 24) & (team['number_player'] != 22) & (team['national_name'] == 't')][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name')

match[(match['team2_id'] != 't') & (match['match_time'].str.startswith('1')) & (match['match_time'].str.startswith('2')) & (match['match_time'] != '1') & (match['duration_minutes'] <= 113) | (match['match_time'] != '2') & (match['match_time'] != '2')][['score_team2', 'match_id', 'score_team1', 'stadium_id', 'match_time', 'team1_id', 'team2_id', 'duration_minutes']].merge(stadium[(stadium['stadium_id'] > 3) | (stadium['city'].str.startswith('r')) | (stadium['name'] != 's')][['stadium_id', 'name']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['location'].str.startswith('w')) | (stadium['capacity'] <= 75573) & (stadium['city'] == 'l')], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['location'] == 'w') | (stadium['city'].str.startswith('a')) & (stadium['stadium_id'] != 9) | (stadium['city'] != 'a') | (stadium['city'].str.startswith('l')) & (stadium['year_built'] > 1996)], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['year_built'] == 1982)], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['name'] == 's') & (stadium['stadium_id'] > 5) | (stadium['capacity'] <= 52358)], left_on='stadium_id', right_on='stadium_id')

association[(association['national_name'] != 't') & (association['president'] == 'p')].merge(team[(team['national_name'] == 't') | (team['group'] != 'e') & (team['national_name'] != 't')][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'a') & (team['national_name'].str.startswith('t'))][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 19)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 20) & (team['group'] == 'c')][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 23) | (team['number_player'] == 21)], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'number_player', 'group']).agg('count')

association[(association['president'] != 'p') | (association['president'].str.startswith('p')) | (association['president'] == 'p') | (association['association_name'] == 'f')][['president', 'national_name', 'association_name']].merge(team[(team['number_player'] >= 25)][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'd') & (team['number_player'] != 25) & (team['national_name'].str.startswith('t'))][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'f') & (team['number_player'] == 22)][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'e') | (team['group'] != 'f')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 23)][['number_player', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('max', numeric_only=True)

association[(association['president'] == 'p') & (association['national_name'] == 't') | (association['association_name'] != 'f')].merge(team[(team['number_player'] != 20)][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 24)], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['g', 'a', 'd', 'b', 'f']))], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 18) | (team['number_player'] < 24)], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'group', 'number_player']).agg('mean', numeric_only=True)

coach[(coach['name'] == 'c')][['name', 'national_name']].merge(team[(team['national_name'] != 't') & (team['number_player'] <= 19) & (team['group'] == 'f')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['number_player'] == 25)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').groupby(by=['number_player']).agg('max', numeric_only=True)

coach[(coach['national_name'] != 't') & (coach['role'].isin(['head coach', 'assistant coach', 'goalkeeper coach'])) & (coach['experience_years'] >= 26)][['role', 'experience_years', 'name', 'coach_id', 'national_name']].merge(team[(team['number_player'] >= 20) | (team['national_name'] == 't') | (team['group'].isin(['g', 'c', 'h', 'b', 'd', 'a']))][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) | (team['number_player'] <= 22)], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 21)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['h', 'c', 'a']))][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name')

association[['national_name', 'founded_year', 'president']].merge(team[(team['group'].isin(['h'])) & (team['national_name'].str.startswith('t')) | (team['number_player'] >= 22)][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['group'] != 'a')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'f') & (team['national_name'] != 't') & (team['number_player'] > 18)][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 22)], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('sum', numeric_only=True)

coach.merge(team[(team['group'] == 'e')][['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 22) | (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 24) & (team['number_player'] < 19) | (team['number_player'] != 25)][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'b') | (team['group'] != 'c') & (team['number_player'] != 19)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['g', 'a', 'b', 'f'])) & (team['number_player'] <= 21)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'c')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')], left_on='national_name', right_on='national_name').groupby(by=['number_player', 'group']).agg('count')

coach.merge(team[(team['number_player'] > 19) & (team['number_player'] != 21) | (team['group'].isin(['f', 'd', 'b', 'h', 'e', 'g']))][['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['h', 'e', 'a', 'c'])) & (team['group'] == 'f')][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['f', 'a', 'e', 'c', 'd']))], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 19) | (team['national_name'] != 't')], left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('mean', numeric_only=True)

association[(association['founded_year'] == 1976) | (association['president'] != 'p')][['founded_year', 'national_name', 'president', 'association_name']].merge(team[(team['national_name'].str.startswith('t'))][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 24)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'f')][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['number_player'] > 23) | (team['number_player'] > 25)], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').groupby(by=['number_player']).agg('min', numeric_only=True)

coach[['coach_id', 'experience_years', 'national_name']].merge(team[(team['number_player'] > 22) & (team['group'].isin(['f']))][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 22)][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['number_player'] <= 23) & (team['national_name'] != 't')][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['group'] == 'e')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['number_player'] == 20) & (team['number_player'] != 21)][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))][['group', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['group']).agg('count')

association.merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'g')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['group'].isin(['d', 'h', 'g', 'f', 'a', 'b', 'e']))][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 18)][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['national_name'] == 't') | (team['group'].isin(['b', 'd', 'a', 'f', 'h']))][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 24) & (team['group'] == 'b')][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name')

association[(association['association_name'].str.startswith('f')) | (association['national_name'] == 't')][['national_name', 'founded_year', 'president', 'association_name']].merge(team[(team['national_name'] == 't') | (team['number_player'] < 18) & (team['national_name'] != 't')][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'f') | (team['number_player'] >= 22) | (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 22) & (team['number_player'] < 19) & (team['national_name'] == 't')][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'd') | (team['group'].isin(['e', 'd']))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'f')][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name')

match.merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['name'] != 's') | (stadium['name'] != 's') & (stadium['stadium_id'] >= 3) | (stadium['name'] == 's')], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['year_built'] == 1986) & (stadium['capacity'] >= 82492) | (stadium['year_built'] == 1964)], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['name'].str.startswith('s')) & (stadium['capacity'] == 48597) & (stadium['location'] != 'n') | (stadium['capacity'] > 65767) | (stadium['year_built'] <= 1970)][['stadium_id', 'location']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['stadium_id'] < 5) | (stadium['capacity'] != 80002) & (stadium['stadium_id'] <= 7)][['stadium_id', 'year_built']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['name', 'stadium_id', 'capacity', 'location', 'city', 'year_built']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').groupby(by=['capacity', 'name', 'year_built', 'stadium_id']).agg('sum', numeric_only=True)

match[(match['round'].isin(['quarter-final'])) | (match['team1_id'] != 't') & (match['match_id'] < 38) | (match['score_team1'] >= 2) & (match['match_id'] != 38) | (match['match_id'] > 28)].merge(stadium[(stadium['capacity'] < 85321) & (stadium['city'] == 'd') | (stadium['year_built'] == 1991) & (stadium['year_built'] != 1967)], left_on='stadium_id', right_on='stadium_id').merge(stadium[['name', 'stadium_id', 'capacity', 'location', 'city', 'year_built']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['name', 'stadium_id', 'capacity', 'city', 'year_built']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['stadium_id'] >= 2) & (stadium['capacity'] >= 81339)], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['name'] == 's') | (stadium['stadium_id'] >= 7) | (stadium['year_built'] != 1989) & (stadium['stadium_id'] <= 5) & (stadium['name'].str.startswith('s')) | (stadium['location'] != 'w')], left_on='stadium_id', right_on='stadium_id').groupby(by=['stadium_id', 'city', 'location', 'year_built']).agg('sum', numeric_only=True)

coach[['experience_years', 'coach_id', 'name', 'national_name', 'role']].merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 21)][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['group'].isin(['h', 'f', 'a', 'c', 'g', 'b'])) & (team['number_player'] < 19)][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['f', 'a', 'h', 'e', 'd', 'b'])) & (team['number_player'] > 24) | (team['number_player'] != 25)][['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 23) & (team['national_name'] != 't')][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('max', numeric_only=True)

coach.merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['number_player'] >= 21) | (team['group'].isin(['c', 'b']))][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'h') | (team['group'] != 'f') | (team['group'] == 'f')], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['group'].isin(['e', 'h', 'g', 'b'])) & (team['group'] == 'd')][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'h') & (team['number_player'] != 22)], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 21) & (team['national_name'].str.startswith('t')) & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').groupby(by=['number_player', 'national_name']).agg('min', numeric_only=True)

match[['score_team1', 'score_team2', 'team1_id', 'stadium_id', 'match_date', 'match_id', 'attendance', 'team2_id', 'duration_minutes', 'round']].merge(stadium[['name', 'capacity', 'year_built', 'stadium_id', 'city', 'location']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] <= 69935)][['stadium_id', 'location', 'year_built']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['stadium_id', 'capacity']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['capacity', 'location', 'year_built', 'stadium_id', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['location'] == 'w') & (stadium['stadium_id'] != 2) & (stadium['name'] != 's') & (stadium['capacity'] != 41213) | (stadium['name'].str.startswith('s')) | (stadium['name'] == 's')][['stadium_id', 'capacity', 'location', 'year_built']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] <= 49090) & (stadium['name'] == 's') | (stadium['capacity'] != 71745) | (stadium['stadium_id'] == 6)], left_on='stadium_id', right_on='stadium_id').groupby(by=['city', 'stadium_id', 'capacity']).agg('max', numeric_only=True)

association.merge(team[(team['number_player'] <= 24)][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'd') | (team['number_player'] <= 20) & (team['group'].isin(['c', 'h', 'a']))][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'f') | (team['national_name'] != 't') | (team['group'].isin(['f', 'd', 'b', 'e', 'a', 'g', 'h']))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['number_player'] >= 22)][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('sum', numeric_only=True)

association[(association['national_name'] == 't') | (association['association_name'] == 'f') | (association['founded_year'] != 1975)][['national_name']].merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'e')][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['h', 'e', 'g', 'f', 'a', 'b', 'd', 'c']))][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['f', 'c']))], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'f') & (team['national_name'] != 't') | (team['national_name'] != 't')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['national_name'] == 't')], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'group']).agg('min', numeric_only=True)

coach.merge(team[(team['national_name'] == 't') & (team['national_name'].str.startswith('t')) & (team['group'] == 'e')][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) | (team['number_player'] <= 23) | (team['group'].isin(['f']))][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 18) & (team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 22)][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 25)][['group', 'national_name']], left_on='national_name', right_on='national_name')

coach[(coach['role'] != 'goalkeeper coach') | (coach['coach_id'] <= 67) & (coach['name'] != 'c') & (coach['experience_years'] > 3) & (coach['experience_years'] < 16)][['name', 'experience_years', 'national_name', 'coach_id']].merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['number_player'] != 18) | (team['number_player'] == 18)][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'f')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') & (team['national_name'] != 't')][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['number_player', 'group']).agg('min', numeric_only=True)

association[(association['association_name'] != 'f') | (association['national_name'].str.startswith('t'))].merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'a') | (team['number_player'] >= 19)][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 25) | (team['group'] != 'd') | (team['group'].isin(['b']))][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['group'] == 'g') & (team['national_name'] == 't')][['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'group']).agg('sum', numeric_only=True)

association[['national_name']].merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['g', 'd', 'h'])) | (team['number_player'] >= 22)][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['g', 'a', 'e', 'f'])) | (team['group'] != 'e') & (team['national_name'] != 't')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['national_name'].str.startswith('t')) & (team['group'] == 'e')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) | (team['group'] != 'd')], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'a') | (team['national_name'] == 't') & (team['number_player'] >= 25)][['group', 'number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 25) & (team['number_player'] != 20) | (team['number_player'] <= 22)], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('count')

match.merge(stadium[['name', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['city', 'stadium_id', 'capacity']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['capacity', 'stadium_id', 'year_built']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['name', 'city', 'stadium_id', 'year_built']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] > 86384) & (stadium['year_built'] <= 1969) & (stadium['year_built'] <= 1989)], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['location'] != 'e') & (stadium['stadium_id'] > 5) | (stadium['name'] == 's') | (stadium['capacity'] > 73577)][['name', 'location', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['name', 'city', 'stadium_id', 'capacity', 'location', 'year_built']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['year_built'] > 2017)], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['stadium_id'] == 7)], left_on='stadium_id', right_on='stadium_id').groupby(by=['location', 'stadium_id', 'city', 'capacity', 'year_built']).agg('mean', numeric_only=True)

match[(match['match_date'] < '2022-11-20')].merge(stadium[['name', 'capacity', 'location', 'year_built', 'stadium_id', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] > 46746) & (stadium['stadium_id'] >= 6) & (stadium['name'] != 's') | (stadium['stadium_id'] == 9)][['stadium_id', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] > 41539) | (stadium['city'].str.startswith('l')) & (stadium['year_built'] >= 2004) & (stadium['name'].str.startswith('s'))][['name', 'capacity', 'location', 'year_built', 'stadium_id', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['stadium_id'] <= 1) | (stadium['year_built'] <= 1987) & (stadium['year_built'] >= 1975)], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['stadium_id'] != 9) & (stadium['stadium_id'] >= 11) & (stadium['capacity'] >= 75370)], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] <= 60593)][['capacity', 'location', 'year_built', 'stadium_id', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['city'].str.startswith('d')) | (stadium['city'].str.startswith('a')) | (stadium['name'] != 's') | (stadium['name'] != 's') | (stadium['capacity'] < 44860)], left_on='stadium_id', right_on='stadium_id')

association[(association['national_name'].str.startswith('t'))][['national_name']].merge(team[(team['group'] == 'c')][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'b')][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) | (team['number_player'] != 18)], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['group'] == 'g')][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').groupby(by=['national_name', 'group', 'number_player']).agg('min', numeric_only=True)

match[(match['attendance'] < 30335) | (match['attendance'] == 85165) & (match['score_team1'] == 1) & (match['team2_id'].str.startswith('t'))].merge(stadium[['location', 'name', 'city', 'capacity', 'year_built', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['year_built'] <= 1950) & (stadium['stadium_id'] <= 2) | (stadium['name'] == 's') | (stadium['stadium_id'] > 2) & (stadium['city'] == 'd')], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['year_built'] > 1956) & (stadium['year_built'] > 1996) & (stadium['city'] != 'd') & (stadium['location'].str.startswith('e'))][['name', 'city', 'capacity', 'year_built', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['stadium_id'] <= 7) & (stadium['location'].str.startswith('e')) & (stadium['location'].str.startswith('c'))], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] <= 70643) | (stadium['name'].str.startswith('s')) | (stadium['stadium_id'] > 3)], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['city'].str.startswith('l')) | (stadium['stadium_id'] == 5)][['location', 'name', 'city', 'year_built', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] >= 40632) & (stadium['capacity'] >= 52207) & (stadium['city'] == 'r') | (stadium['city'] == 'r') & (stadium['location'] != 's')], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id')

association.merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 22) & (team['group'].isin(['h', 'b', 'a', 'd', 'g', 'f', 'c', 'e'])) & (team['group'] != 'b')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) | (team['national_name'] == 't') | (team['group'] == 'd')][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 24) | (team['national_name'] == 't') | (team['group'] == 'a')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'a') | (team['national_name'] != 't')][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['group'] != 'd') & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 18) & (team['number_player'] >= 23) & (team['group'].isin(['a', 'f', 'h', 'e', 'c', 'g', 'd']))][['number_player', 'national_name']], left_on='national_name', right_on='national_name')

association[(association['national_name'].str.startswith('t')) | (association['founded_year'] >= 1935) | (association['founded_year'] < 1920)].merge(team[(team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'c')][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 24) & (team['group'].isin(['g', 'e', 'd'])) & (team['number_player'] != 18)][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 21) & (team['national_name'] == 't')][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['number_player'] >= 25)], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'e') | (team['group'] != 'e') | (team['group'] != 'g')][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 24) & (team['national_name'] == 't') & (team['group'] == 'd')], left_on='national_name', right_on='national_name').groupby(by=['group', 'number_player', 'national_name']).agg('mean', numeric_only=True)

coach[(coach['name'].str.startswith('c'))][['national_name', 'name', 'experience_years', 'role', 'coach_id']].merge(team[(team['national_name'] != 't') & (team['group'] == 'd') | (team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 23)], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 19) | (team['national_name'].str.startswith('t'))][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['f', 'b', 'e']))], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 18) & (team['number_player'] > 25)][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['c', 'e', 'b', 'h', 'd', 'f', 'a', 'g']))], left_on='national_name', right_on='national_name').groupby(by=['group', 'national_name']).agg('sum', numeric_only=True)

coach[(coach['national_name'].str.startswith('t'))][['national_name', 'role', 'name', 'experience_years']].merge(team[(team['number_player'] >= 18) | (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'b')][['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['h', 'b', 'c', 'f', 'g', 'd']))][['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 18) & (team['group'] != 'b')], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['a', 'g', 'h', 'b', 'c', 'e', 'd', 'f']))][['national_name', 'group', 'number_player']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').groupby(by=['group']).agg('mean', numeric_only=True)

coach[(coach['role'].isin(['head coach', 'fitness coach']))][['national_name', 'coach_id']].merge(team[(team['number_player'] < 21)], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'a') & (team['group'].isin(['h', 'c', 'd', 'a', 'f']))], left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 18) | (team['number_player'] < 23)][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'd') & (team['national_name'] == 't') & (team['number_player'] > 18)][['number_player', 'group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['a', 'h', 'c', 'b', 'f'])) & (team['number_player'] <= 23)], left_on='national_name', right_on='national_name').groupby(by=['group', 'number_player', 'national_name']).agg('count')

association[['association_name', 'national_name', 'founded_year', 'president']].merge(team[(team['number_player'] < 25) | (team['national_name'] != 't')][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'c') | (team['group'].isin(['h', 'c', 'e', 'f', 'g', 'd', 'b', 'a']))][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 21)], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t'))], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 23) | (team['national_name'] != 't') | (team['group'] != 'c')][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'h') & (team['number_player'] == 21) & (team['group'] == 'e')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 19) | (team['number_player'] <= 22) | (team['group'].isin(['a', 'd']))], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['e', 'f', 'c', 'h', 'b', 'g', 'd', 'a'])) | (team['national_name'] != 't') | (team['number_player'] > 24)], left_on='national_name', right_on='national_name').groupby(by=['group']).agg('count')

association[(association['president'] == 'p')][['national_name']].merge(team[(team['group'].isin(['d'])) | (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'a') & (team['group'].isin(['a', 'b', 'g', 'h', 'd', 'e', 'c']))], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['group'] != 'd') & (team['number_player'] != 23)], left_on='national_name', right_on='national_name').merge(team, left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 20) | (team['group'].isin(['d', 'a', 'g', 'c', 'h', 'e'])) & (team['group'] == 'd')][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'h') & (team['number_player'] < 23) | (team['national_name'] == 't')][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 21) & (team['national_name'].str.startswith('t'))][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').groupby(by=['number_player', 'group']).agg('sum', numeric_only=True)

match.merge(stadium[(stadium['capacity'] > 57425) & (stadium['city'].str.startswith('d')) | (stadium['location'] == 'e') | (stadium['name'] != 's') | (stadium['name'] == 's')][['stadium_id', 'name', 'city', 'year_built', 'location', 'capacity']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['stadium_id'] < 1) & (stadium['stadium_id'] > 2)], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['stadium_id'] != 9) & (stadium['location'].str.startswith('w')) | (stadium['location'].str.startswith('n')) | (stadium['name'].str.startswith('s')) & (stadium['stadium_id'] <= 2) & (stadium['stadium_id'] != 1)], left_on='stadium_id', right_on='stadium_id').merge(stadium[['stadium_id', 'name', 'city', 'year_built', 'location', 'capacity']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['name'] == 's') & (stadium['capacity'] >= 64730) | (stadium['city'] == 'a') | (stadium['location'].str.startswith('n')) | (stadium['year_built'] < 1966) & (stadium['stadium_id'] == 2)][['stadium_id', 'capacity', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['name'] != 's') & (stadium['capacity'] == 89945) & (stadium['capacity'] <= 46973) & (stadium['city'] != 'r') | (stadium['city'].str.startswith('l')) & (stadium['city'] == 'r')], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id')

association.merge(team[(team['national_name'] != 't') | (team['group'].isin(['e', 'f', 'h', 'c', 'b']))][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 20) | (team['group'] == 'd')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 23)][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 19) | (team['national_name'] != 't') | (team['number_player'] > 25)][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['national_name'] == 't') & (team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 23) & (team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 20) & (team['number_player'] <= 24)][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['number_player'] < 24) | (team['group'].isin(['b', 'e', 'a', 'c', 'f']))][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name')

association[(association['president'] == 'p') & (association['association_name'].str.startswith('f')) | (association['founded_year'] < 1947) & (association['founded_year'] <= 1989)].merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 21) & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 20)][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't')], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 18) & (team['number_player'] < 21)][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 19) | (team['number_player'] >= 21) | (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't') | (team['number_player'] == 21) | (team['number_player'] > 25)], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 22) & (team['group'] != 'a') | (team['national_name'].str.startswith('t'))][['national_name', 'number_player']], left_on='national_name', right_on='national_name')

association[(association['national_name'].str.startswith('t')) | (association['founded_year'] != 1903) & (association['association_name'].str.startswith('f'))][['association_name', 'national_name']].merge(team[(team['number_player'] != 21) | (team['group'].isin(['d', 'c', 'h', 'e']))], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['national_name'] == 't') | (team['group'].isin(['g', 'f', 'e', 'h']))], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] > 21) & (team['group'] != 'c')][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['g', 'h', 'f', 'b']))][['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['f', 'c'])) & (team['number_player'] == 21)], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 19) | (team['group'] != 'a') & (team['number_player'] <= 24)], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 21)][['group', 'national_name']], left_on='national_name', right_on='national_name')

match[(match['match_id'] <= 21) & (match['attendance'] <= 41573) | (match['round'].isin(['quarter-final', 'round of 16', 'final', 'group stage'])) & (match['score_team1'] == 6) & (match['match_id'] == 60) & (match['team2_id'] == 't') | (match['team1_id'] != 't') & (match['match_date'] != '2022-11-20') & (match['team1_id'].str.startswith('t')) & (match['round'].isin(['final', 'semi-final', 'quarter-final', 'group stage']))].merge(stadium[['name', 'capacity', 'year_built', 'stadium_id', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['stadium_id'] == 9) | (stadium['city'] != 'l') | (stadium['name'] != 's') | (stadium['year_built'] < 1990) & (stadium['year_built'] != 1957)][['name', 'year_built', 'stadium_id', 'city', 'location']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['year_built'] >= 2006) & (stadium['stadium_id'] >= 9) & (stadium['year_built'] <= 1954)], left_on='stadium_id', right_on='stadium_id').merge(stadium[['stadium_id', 'name']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['name', 'capacity', 'year_built', 'stadium_id', 'city', 'location']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['year_built'] >= 1997) | (stadium['year_built'] <= 1970) & (stadium['capacity'] > 59617)], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['stadium_id'] <= 7)][['stadium_id', 'capacity', 'location', 'year_built']], left_on='stadium_id', right_on='stadium_id')

coach[['experience_years', 'national_name', 'name', 'role', 'coach_id']].merge(team[(team['number_player'] == 25) | (team['national_name'] != 't') | (team['national_name'].str.startswith('t'))][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 25)], left_on='national_name', right_on='national_name').merge(team[(team['group'] != 'a') | (team['group'] == 'f') | (team['number_player'] != 23)][['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] >= 22) & (team['national_name'].str.startswith('t'))][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] == 18)][['group', 'national_name']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[['number_player', 'national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 22) & (team['number_player'] == 25)][['number_player', 'national_name']], left_on='national_name', right_on='national_name').merge(team[['group', 'national_name', 'number_player']], left_on='national_name', right_on='national_name').groupby(by=['group']).agg('max', numeric_only=True)

association[(association['national_name'] == 't') & (association['president'].str.startswith('p'))].merge(team, left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'] == 'd') & (team['number_player'] == 20)][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') & (team['national_name'] == 't') & (team['number_player'] != 22)], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['group'].isin(['c', 'd', 'g', 'e', 'b', 'a', 'f'])) | (team['group'] == 'g') | (team['national_name'].str.startswith('t'))][['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] == 't') | (team['group'].isin(['g', 'a', 'b', 'c', 'h', 'f', 'e', 'd'])) | (team['number_player'] > 18)][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'] != 't')][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['national_name'].str.startswith('t')) & (team['group'].isin(['g', 'h', 'b', 'a', 'f', 'e'])) & (team['national_name'] == 't')][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name')

coach[['role', 'national_name', 'experience_years']].merge(team[(team['number_player'] == 25)][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] != 21) & (team['national_name'] != 't')], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] <= 19) | (team['number_player'] < 22) | (team['number_player'] >= 23)][['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 22) & (team['group'].isin(['d', 'a', 'b', 'c', 'h', 'g', 'f']))], left_on='national_name', right_on='national_name').merge(team[(team['number_player'] < 22) & (team['national_name'].str.startswith('t'))][['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'group']], left_on='national_name', right_on='national_name').merge(team[['national_name', 'number_player', 'group']], left_on='national_name', right_on='national_name').groupby(by=['national_name']).agg('count')

match.merge(stadium[(stadium['location'] == 's')], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] != 56958) | (stadium['name'] == 's') & (stadium['name'].str.startswith('s')) & (stadium['name'].str.startswith('s')) & (stadium['year_built'] < 1987) | (stadium['name'].str.startswith('s'))][['stadium_id', 'name', 'city', 'capacity', 'location']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[['location', 'name', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['year_built', 'stadium_id', 'name', 'city', 'capacity', 'location']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['year_built', 'stadium_id', 'name', 'capacity', 'location']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['location'] != 'e') | (stadium['stadium_id'] > 10) & (stadium['year_built'] == 1969)][['year_built', 'stadium_id', 'name', 'city', 'capacity', 'location']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['name'] == 's') & (stadium['capacity'] <= 74695) & (stadium['location'].str.startswith('e')) & (stadium['year_built'] != 2021)], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['location'] != 'c') & (stadium['name'].str.startswith('s')) & (stadium['name'] == 's') | (stadium['name'].str.startswith('s')) & (stadium['city'] == 'a')][['year_built', 'location', 'city', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').groupby(by=['year_built', 'location']).agg('min', numeric_only=True)

match[['team1_id', 'score_team1', 'round', 'team2_id', 'match_time', 'stadium_id', 'match_id', 'match_date', 'attendance', 'duration_minutes']].merge(stadium[(stadium['name'] == 's')], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] <= 68027) & (stadium['stadium_id'] == 6) & (stadium['city'] == 'l') & (stadium['capacity'] < 74710) | (stadium['stadium_id'] < 5) | (stadium['year_built'] < 1987)], left_on='stadium_id', right_on='stadium_id').merge(stadium[['stadium_id', 'capacity', 'year_built', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['location'] == 'e') | (stadium['stadium_id'] < 3) & (stadium['capacity'] > 58448) | (stadium['name'].str.startswith('s')) & (stadium['capacity'] != 44404) & (stadium['stadium_id'] > 4)], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['year_built'] != 1963) & (stadium['location'] != 'n')], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] < 58572) | (stadium['year_built'] <= 1989) & (stadium['capacity'] >= 87689) & (stadium['city'] != 'd') & (stadium['name'] == 's') & (stadium['capacity'] == 41732)][['name', 'stadium_id', 'location', 'city', 'year_built']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['stadium_id', 'capacity', 'location', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[['stadium_id', 'location', 'capacity']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').groupby(by=['stadium_id', 'capacity', 'name', 'city']).agg('count')

match.merge(stadium[(stadium['year_built'] > 1966) & (stadium['stadium_id'] <= 2)], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['stadium_id'] != 11) & (stadium['year_built'] > 2019) & (stadium['name'].str.startswith('s')) | (stadium['capacity'] > 64562) | (stadium['location'] == 'n')][['year_built', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['stadium_id', 'name', 'city', 'capacity', 'location']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['stadium_id', 'name', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['name'] == 's') | (stadium['location'].str.startswith('c')) | (stadium['city'] == 'l') & (stadium['capacity'] > 53869) | (stadium['location'].str.startswith('s')) & (stadium['capacity'] > 40422)][['stadium_id', 'name', 'city', 'capacity', 'location']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['year_built'] != 1979) & (stadium['name'] == 's') | (stadium['city'] != 'l') | (stadium['name'] == 's') | (stadium['year_built'] == 1997) & (stadium['year_built'] >= 1982)][['year_built', 'stadium_id', 'name', 'city', 'capacity', 'location']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] <= 82246) | (stadium['stadium_id'] == 3) | (stadium['city'] == 'a')], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['year_built'] != 1973) & (stadium['location'].str.startswith('e')) | (stadium['location'] == 'e')][['capacity', 'location', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['stadium_id'] < 9) | (stadium['name'] == 's') | (stadium['year_built'] < 2006) | (stadium['location'] == 'w')], left_on='stadium_id', right_on='stadium_id').groupby(by=['capacity', 'location', 'name', 'stadium_id', 'city']).agg('mean', numeric_only=True)

match[(match['round'] != 'semi-final') | (match['score_team1'] >= 5) | (match['attendance'] <= 41483) & (match['team1_id'] != 't') & (match['score_team1'] > 1)][['stadium_id', 'score_team2', 'match_id', 'attendance', 'match_time', 'duration_minutes']].merge(stadium[(stadium['capacity'] == 71924) & (stadium['name'] == 's') & (stadium['stadium_id'] < 9)][['name', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] == 41780) | (stadium['year_built'] <= 1996) | (stadium['year_built'] <= 2018) & (stadium['location'] != 'e')][['stadium_id', 'capacity']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['name'].str.startswith('s')) & (stadium['capacity'] < 56154)][['name', 'stadium_id', 'capacity', 'location', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] >= 72634) & (stadium['location'] == 'e') & (stadium['stadium_id'] > 9) | (stadium['year_built'] <= 1970)][['name', 'stadium_id', 'capacity', 'location', 'city', 'year_built']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['capacity'] != 87192) & (stadium['city'] != 'r') & (stadium['name'].str.startswith('s')) | (stadium['location'].str.startswith('n'))][['stadium_id', 'capacity', 'city']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['year_built'] != 1966) | (stadium['location'] != 'n') & (stadium['capacity'] == 84183)], left_on='stadium_id', right_on='stadium_id').merge(stadium[['name', 'stadium_id', 'capacity', 'location', 'city', 'year_built']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').groupby(by=['name', 'capacity', 'city']).agg('min', numeric_only=True)

match[(match['match_date'] >= '2022-12-18') & (match['team1_id'] != 't') | (match['score_team1'] < 3) | (match['round'].isin(['final', 'semi-final', 'group stage'])) & (match['score_team1'] >= 6) & (match['match_id'] != 60)][['score_team2', 'match_id', 'score_team1', 'match_time', 'round', 'team1_id', 'match_date', 'stadium_id', 'team2_id', 'duration_minutes']].merge(stadium[(stadium['capacity'] == 51452) & (stadium['name'] == 's') & (stadium['city'] != 'r') & (stadium['name'] != 's')][['year_built', 'location', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['name'].str.startswith('s')) | (stadium['name'].str.startswith('s')) & (stadium['city'] == 'l') & (stadium['location'] != 'n')][['stadium_id', 'name', 'city', 'capacity', 'location']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['name'] != 's') | (stadium['city'] == 'l') | (stadium['city'].str.startswith('a'))][['year_built', 'stadium_id', 'name', 'capacity', 'location']], left_on='stadium_id', right_on='stadium_id').merge(stadium, left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['year_built'] != 1958) & (stadium['name'] != 's')], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['city'].str.startswith('d')) & (stadium['stadium_id'] <= 9)][['year_built', 'capacity', 'stadium_id']], left_on='stadium_id', right_on='stadium_id').merge(stadium[(stadium['location'].str.startswith('c')) | (stadium['city'] != 'l')][['year_built', 'stadium_id', 'name', 'city', 'location']], left_on='stadium_id', right_on='stadium_id').merge(stadium[['year_built', 'stadium_id', 'name', 'city', 'capacity', 'location']], left_on='stadium_id', right_on='stadium_id').groupby(by=['capacity', 'year_built', 'stadium_id']).agg('count')