association

coach

match

stadium

team

association[['A_ASSOCKEY']]

association[['A_FOUNDEDYEAR']]

association[['A_PRESIDENT']]

coach[['C_TEAMKEY']]

match[['M_ROUND']]

match[['M_SCORE1']]

stadium[(stadium['S_CITY'] == 'l')]

stadium[(stadium['S_LOCATION'] == 'c')]

stadium[(stadium['S_NAME'] != 's')]

stadium[(stadium['S_YEARBUILT'] == 1993)]

stadium[['S_CAPACITY']]

stadium[['S_STADIUMKEY']]

stadium[['S_YEARBUILT']]

team[(team['T_GROUP'] == 'g')]

team[(team['T_GROUP'] == 'h')]

team[(team['T_GROUP'].isin(['h', 'd', 'b']))]

team[(team['T_PLAYERCOUNT'] != 23)]

team[(team['T_PLAYERCOUNT'] < 18)]

team[(team['T_PLAYERCOUNT'] <= 20)]

team[(team['T_PLAYERCOUNT'] == 19)]

team[(team['T_PLAYERCOUNT'] >= 21)]

team[(team['T_TEAMKEY'].str.startswith('t'))]

team[['T_GROUP']]

team[['T_PLAYERCOUNT']]

team[['T_TEAMKEY']]

association.groupby(by=['A_PRESIDENT']).agg('min', numeric_only=True)

association.merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_FOUNDEDYEAR'] < 1973) & (association['A_TEAMKEY'] == 't')]

association[(association['A_FOUNDEDYEAR'] > 1920) | (association['A_PRESIDENT'] != 'p')]

association[['A_ASSOCKEY', 'A_FOUNDEDYEAR']]

association[['A_ASSOCKEY', 'A_PRESIDENT']]

coach.groupby(by=['C_COACHKEY']).agg('count')

coach.merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_ROLE', 'C_COACHKEY']]

match.merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match.merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match.merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[['M_ATTENDANCE', 'M_TIME']]

match[['M_DURATION', 'M_TIME']]

stadium.groupby(by=['S_CITY']).agg('count')

stadium.groupby(by=['S_LOCATION']).agg('max', numeric_only=True)

stadium.groupby(by=['S_NAME']).agg('max', numeric_only=True)

stadium.groupby(by=['S_STADIUMKEY']).agg('count')

stadium.groupby(by=['S_YEARBUILT']).agg('count')

stadium[(stadium['S_CAPACITY'] != 78909) | (stadium['S_LOCATION'].str.startswith('s'))]

stadium[(stadium['S_LOCATION'] != 'w') & (stadium['S_YEARBUILT'] >= 1952)]

stadium[(stadium['S_NAME'] != 's') | (stadium['S_CITY'] != 'l')]

stadium[(stadium['S_STADIUMKEY'] >= 11) & (stadium['S_LOCATION'] != 's')]

stadium[['S_CAPACITY', 'S_CITY']]

stadium[['S_LOCATION', 'S_CAPACITY']]

stadium[['S_NAME', 'S_CAPACITY']]

team.groupby(by=['T_GROUP']).agg('count')

team.groupby(by=['T_GROUP']).agg('max', numeric_only=True)

team.groupby(by=['T_GROUP']).agg('mean', numeric_only=True)

team.groupby(by=['T_PLAYERCOUNT']).agg('sum', numeric_only=True)

team.groupby(by=['T_TEAMKEY']).agg('count')

team.groupby(by=['T_TEAMKEY']).agg('mean', numeric_only=True)

team.groupby(by=['T_TEAMKEY']).agg('sum', numeric_only=True)

team[(team['T_GROUP'] != 'c') & (team['T_TEAMKEY'].str.startswith('t'))]

team[(team['T_GROUP'] != 'd') & (team['T_TEAMKEY'] != 't')]

team[(team['T_GROUP'] != 'h') | (team['T_TEAMKEY'] != 't')]

team[(team['T_GROUP'] == 'b') | (team['T_GROUP'].isin(['f', 'a', 'h', 'e', 'b', 'd', 'g', 'c']))]

team[(team['T_GROUP'] == 'b') | (team['T_PLAYERCOUNT'] == 25)]

team[(team['T_GROUP'] == 'e') & (team['T_GROUP'].isin(['e', 'h']))]

team[(team['T_GROUP'] == 'f') & (team['T_TEAMKEY'] == 't')]

team[(team['T_PLAYERCOUNT'] < 25) | (team['T_TEAMKEY'].str.startswith('t'))]

team[(team['T_TEAMKEY'].str.startswith('t')) | (team['T_TEAMKEY'] == 't')]

team[['T_GROUP', 'T_PLAYERCOUNT']]

team[['T_PLAYERCOUNT', 'T_GROUP']]

team[['T_TEAMKEY', 'T_GROUP']]

team[['T_TEAMKEY', 'T_PLAYERCOUNT']]

association.groupby(by=['A_FOUNDEDYEAR', 'A_PRESIDENT']).agg('max', numeric_only=True)

association[['A_ASSOCKEY', 'A_FOUNDEDYEAR', 'A_PRESIDENT']]

coach[(coach['C_EXPYEARS'] < 30) | (coach['C_COACHKEY'] <= 60) | (coach['C_TEAMKEY'] != 't')]

coach[['C_COACHKEY', 'C_EXPYEARS', 'C_ROLE']]

coach[['C_EXPYEARS', 'C_COACHKEY', 'C_ROLE']]

coach[['C_NAME', 'C_COACHKEY', 'C_EXPYEARS']]

match[(match['M_ROUND'] != 'group stage') & (match['M_TEAM2KEY'].str.startswith('t')) & (match['M_ATTENDANCE'] <= 80793)]

match[['M_DURATION', 'M_TIME', 'M_SCORE2']]

match[['M_ROUND', 'M_MATCHKEY', 'M_SCORE2']]

stadium.groupby(by=['S_CAPACITY', 'S_NAME']).agg('count')

stadium.groupby(by=['S_CITY', 'S_LOCATION']).agg('min', numeric_only=True)

stadium.groupby(by=['S_CITY', 'S_YEARBUILT']).agg('sum', numeric_only=True)

stadium.groupby(by=['S_LOCATION', 'S_YEARBUILT']).agg('min', numeric_only=True)

stadium.groupby(by=['S_YEARBUILT', 'S_CITY']).agg('min', numeric_only=True)

stadium[(stadium['S_CAPACITY'] >= 82125) | (stadium['S_YEARBUILT'] != 1990) & (stadium['S_NAME'] == 's')]

stadium[(stadium['S_CITY'] != 'd') | (stadium['S_YEARBUILT'] != 1965) | (stadium['S_CAPACITY'] != 83559)]

stadium[(stadium['S_CITY'] != 'l') | (stadium['S_YEARBUILT'] >= 1969) & (stadium['S_CITY'] != 'l')]

stadium[(stadium['S_CITY'] != 'r') | (stadium['S_CITY'] != 'l') | (stadium['S_CAPACITY'] >= 60027)]

stadium[['S_CITY', 'S_LOCATION', 'S_STADIUMKEY']]

stadium[['S_LOCATION', 'S_YEARBUILT', 'S_CITY']]

stadium[['S_NAME', 'S_LOCATION', 'S_CAPACITY']]

stadium[['S_YEARBUILT', 'S_CITY', 'S_STADIUMKEY']]

team.groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('mean', numeric_only=True)

team.groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('min', numeric_only=True)

team.groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

team.groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('mean', numeric_only=True)

team.groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('min', numeric_only=True)

team.groupby(by=['T_PLAYERCOUNT', 'T_GROUP']).agg('mean', numeric_only=True)

team.groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY']).agg('max', numeric_only=True)

team.groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY']).agg('min', numeric_only=True)

team.groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('count')

team.groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

team[(team['T_GROUP'] != 'd') | (team['T_TEAMKEY'] != 't') | (team['T_PLAYERCOUNT'] >= 20)]

team[(team['T_PLAYERCOUNT'] == 22) & (team['T_GROUP'] == 'b') & (team['T_TEAMKEY'].str.startswith('t'))]

team[(team['T_PLAYERCOUNT'] == 24) & (team['T_GROUP'].isin(['b'])) & (team['T_TEAMKEY'] != 't')]

team[(team['T_TEAMKEY'] == 't') & (team['T_TEAMKEY'].str.startswith('t')) & (team['T_TEAMKEY'] == 't')]

team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_GROUP'].isin(['c'])) | (team['T_PLAYERCOUNT'] < 19)]

team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']]

team[['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']]

team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']]

team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']]

association.merge(team[(team['T_PLAYERCOUNT'] >= 22)], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_ASSOCKEY'] == 'f')][['A_FOUNDEDYEAR']]

association[(association['A_TEAMKEY'] == 't')][['A_FOUNDEDYEAR']]

coach.merge(team[(team['T_GROUP'] == 'b')], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[(team['T_PLAYERCOUNT'] >= 18)], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'] != 'c') | (coach['C_NAME'].str.startswith('c')) & (coach['C_TEAMKEY'] == 't') | (coach['C_ROLE'].isin(['goalkeeper coach', 'head coach', 'fitness coach', 'assistant coach']))]

coach[['C_ROLE', 'C_NAME', 'C_COACHKEY', 'C_EXPYEARS']]

match.groupby(by=['M_DURATION', 'M_MATCHKEY', 'M_SCORE2']).agg('sum', numeric_only=True)

stadium.groupby(by=['S_CAPACITY', 'S_NAME', 'S_CITY']).agg('count')

stadium.groupby(by=['S_LOCATION', 'S_STADIUMKEY', 'S_CAPACITY']).agg('sum', numeric_only=True)

stadium.groupby(by=['S_NAME', 'S_STADIUMKEY', 'S_CITY']).agg('count')

stadium.groupby(by=['S_YEARBUILT', 'S_STADIUMKEY', 'S_NAME']).agg('sum', numeric_only=True)

stadium[(stadium['S_CAPACITY'] < 49819) | (stadium['S_YEARBUILT'] != 1986) & (stadium['S_CAPACITY'] != 86243) | (stadium['S_CITY'] != 'a')]

stadium[(stadium['S_CAPACITY'] > 86192) & (stadium['S_NAME'] != 's') | (stadium['S_LOCATION'] == 'w') | (stadium['S_CITY'] == 'l')]

stadium[(stadium['S_CITY'] == 'r') | (stadium['S_STADIUMKEY'] != 8) & (stadium['S_NAME'] != 's') & (stadium['S_STADIUMKEY'] >= 3)]

stadium[(stadium['S_LOCATION'] == 'w') & (stadium['S_YEARBUILT'] == 1990) & (stadium['S_STADIUMKEY'] < 6) | (stadium['S_CITY'] != 'r')]

stadium[(stadium['S_STADIUMKEY'] < 7) & (stadium['S_NAME'] == 's') & (stadium['S_NAME'] != 's') & (stadium['S_CITY'].str.startswith('l'))]

stadium[(stadium['S_YEARBUILT'] <= 1992) | (stadium['S_NAME'] == 's') & (stadium['S_CAPACITY'] != 47242) | (stadium['S_STADIUMKEY'] <= 3)]

stadium[['S_CAPACITY', 'S_LOCATION', 'S_NAME', 'S_YEARBUILT']]

stadium[['S_CAPACITY', 'S_LOCATION', 'S_YEARBUILT', 'S_STADIUMKEY']]

stadium[['S_LOCATION', 'S_CITY', 'S_STADIUMKEY', 'S_NAME']]

team.groupby(by=['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']).agg('max', numeric_only=True)

team.groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('count')

team.groupby(by=['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

team.groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']).agg('min', numeric_only=True)

team.groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']).agg('sum', numeric_only=True)

team[(team['T_GROUP'].isin(['a', 'c', 'e', 'h']))][['T_GROUP']]

team[(team['T_TEAMKEY'] == 't')][['T_TEAMKEY']]

association.groupby(by=['A_ASSOCKEY', 'A_PRESIDENT', 'A_FOUNDEDYEAR', 'A_TEAMKEY']).agg('min', numeric_only=True)

association.groupby(by=['A_PRESIDENT', 'A_ASSOCKEY', 'A_TEAMKEY', 'A_FOUNDEDYEAR']).agg('max', numeric_only=True)

association.merge(team[(team['T_PLAYERCOUNT'] != 22) & (team['T_GROUP'] != 'c')], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association.merge(team[(team['T_PLAYERCOUNT'] < 21) & (team['T_GROUP'] != 'c')], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association.merge(team[(team['T_PLAYERCOUNT'] < 22) & (team['T_GROUP'] == 'a')], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association.merge(team[(team['T_PLAYERCOUNT'] > 23) & (team['T_TEAMKEY'] == 't')], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_ASSOCKEY'] == 'f') & (association['A_PRESIDENT'].str.startswith('p'))][['A_FOUNDEDYEAR']]

association[(association['A_FOUNDEDYEAR'] < 1995)].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_FOUNDEDYEAR'] <= 1947) | (association['A_ASSOCKEY'] != 'f')][['A_FOUNDEDYEAR']]

association[(association['A_TEAMKEY'] != 't') | (association['A_ASSOCKEY'].str.startswith('f'))][['A_FOUNDEDYEAR']]

association[(association['A_TEAMKEY'] == 't') | (association['A_ASSOCKEY'] != 'f')][['A_FOUNDEDYEAR']]

association[['A_ASSOCKEY']].groupby(by=['A_ASSOCKEY']).agg('count')

association[['A_PRESIDENT']].groupby(by=['A_PRESIDENT']).agg('max', numeric_only=True)

association[['A_TEAMKEY']].groupby(by=['A_TEAMKEY']).agg('max', numeric_only=True)

coach.merge(team[(team['T_PLAYERCOUNT'] == 24) | (team['T_GROUP'] != 'e')], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'] != 'c') & (coach['C_TEAMKEY'].str.startswith('t'))][['C_ROLE']]

coach[(coach['C_NAME'].str.startswith('c'))].groupby(by=['C_NAME']).agg('sum', numeric_only=True)

coach[(coach['C_ROLE'] == 'goalkeeper coach') & (coach['C_NAME'].str.startswith('c')) | (coach['C_EXPYEARS'] >= 21) & (coach['C_TEAMKEY'].str.startswith('t')) | (coach['C_ROLE'] == 'head coach')]

coach[['C_EXPYEARS']].groupby(by=['C_EXPYEARS']).agg('mean', numeric_only=True)

coach[['C_EXPYEARS']].groupby(by=['C_EXPYEARS']).agg('sum', numeric_only=True)

coach[['C_ROLE']].groupby(by=['C_ROLE']).agg('max', numeric_only=True)

coach[['C_ROLE']].groupby(by=['C_ROLE']).agg('min', numeric_only=True)

match.groupby(by=['M_DATE', 'M_SCORE1', 'M_MATCHKEY', 'M_TEAM1KEY']).agg('max', numeric_only=True)

match.merge(team[(team['T_PLAYERCOUNT'] < 25) & (team['T_PLAYERCOUNT'] >= 23)], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match.merge(team[['T_GROUP', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[(match['M_ROUND'] == 'quarter-final')].merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[(match['M_TEAM2KEY'].str.startswith('t')) | (match['M_SCORE2'] <= 0)][['M_SCORE2']]

match[['M_ATTENDANCE']].groupby(by=['M_ATTENDANCE']).agg('min', numeric_only=True)

match[['M_ROUND']].groupby(by=['M_ROUND']).agg('sum', numeric_only=True)

match[['M_SCORE2']].groupby(by=['M_SCORE2']).agg('sum', numeric_only=True)

match[['M_TIME']].groupby(by=['M_TIME']).agg('sum', numeric_only=True)

stadium.groupby(by=['S_CAPACITY', 'S_CITY', 'S_NAME', 'S_STADIUMKEY']).agg('mean', numeric_only=True)

stadium.groupby(by=['S_CAPACITY', 'S_CITY', 'S_STADIUMKEY', 'S_NAME']).agg('mean', numeric_only=True)

stadium.groupby(by=['S_CAPACITY', 'S_NAME', 'S_LOCATION', 'S_CITY']).agg('max', numeric_only=True)

stadium.groupby(by=['S_CITY', 'S_LOCATION', 'S_CAPACITY', 'S_NAME']).agg('sum', numeric_only=True)

stadium.groupby(by=['S_LOCATION', 'S_STADIUMKEY', 'S_NAME', 'S_YEARBUILT']).agg('count')

stadium.groupby(by=['S_LOCATION', 'S_YEARBUILT', 'S_CAPACITY', 'S_STADIUMKEY']).agg('max', numeric_only=True)

stadium.groupby(by=['S_LOCATION', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_CITY']).agg('count')

stadium.groupby(by=['S_YEARBUILT', 'S_NAME', 'S_CITY', 'S_STADIUMKEY']).agg('mean', numeric_only=True)

stadium.groupby(by=['S_YEARBUILT', 'S_NAME', 'S_LOCATION', 'S_CITY']).agg('max', numeric_only=True)

stadium[(stadium['S_CAPACITY'] < 66708)][['S_STADIUMKEY', 'S_YEARBUILT']]

stadium[(stadium['S_CAPACITY'] == 83986) & (stadium['S_CAPACITY'] > 47087) | (stadium['S_NAME'] != 's') | (stadium['S_NAME'].str.startswith('s')) | (stadium['S_YEARBUILT'] <= 1964)]

stadium[(stadium['S_NAME'] == 's') & (stadium['S_NAME'] != 's') & (stadium['S_STADIUMKEY'] < 6) | (stadium['S_CITY'] == 'l') | (stadium['S_LOCATION'] != 'e')]

stadium[(stadium['S_YEARBUILT'] > 1976)].groupby(by=['S_YEARBUILT']).agg('count')

stadium[['S_CAPACITY', 'S_CITY', 'S_LOCATION', 'S_STADIUMKEY', 'S_NAME']]

stadium[['S_CAPACITY', 'S_CITY', 'S_STADIUMKEY', 'S_LOCATION', 'S_NAME']]

stadium[['S_CAPACITY', 'S_LOCATION', 'S_CITY', 'S_STADIUMKEY', 'S_NAME']]

stadium[['S_LOCATION', 'S_STADIUMKEY', 'S_YEARBUILT', 'S_CITY', 'S_NAME']]

stadium[['S_NAME']].groupby(by=['S_NAME']).agg('count')

stadium[['S_STADIUMKEY', 'S_YEARBUILT', 'S_NAME', 'S_CAPACITY', 'S_CITY']]

stadium[['S_STADIUMKEY']].groupby(by=['S_STADIUMKEY']).agg('count')

team[(team['T_GROUP'] != 'c')].groupby(by=['T_GROUP']).agg('sum', numeric_only=True)

team[(team['T_GROUP'].isin(['c', 'f', 'a', 'd', 'g', 'e', 'h']))][['T_GROUP', 'T_TEAMKEY']]

team[(team['T_PLAYERCOUNT'] != 18)][['T_GROUP', 'T_PLAYERCOUNT']]

team[(team['T_PLAYERCOUNT'] != 23)].groupby(by=['T_TEAMKEY']).agg('count')

team[(team['T_PLAYERCOUNT'] > 22)][['T_TEAMKEY', 'T_GROUP']]

team[(team['T_TEAMKEY'] != 't') | (team['T_TEAMKEY'] == 't')][['T_TEAMKEY']]

team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_GROUP'].isin(['f', 'g']))][['T_TEAMKEY']]

team[['T_GROUP']].groupby(by=['T_GROUP']).agg('mean', numeric_only=True)

team[['T_GROUP']].groupby(by=['T_GROUP']).agg('min', numeric_only=True)

team[['T_GROUP']].groupby(by=['T_GROUP']).agg('sum', numeric_only=True)

team[['T_PLAYERCOUNT']].groupby(by=['T_PLAYERCOUNT']).agg('mean', numeric_only=True)

team[['T_TEAMKEY']].groupby(by=['T_TEAMKEY']).agg('count')

team[['T_TEAMKEY']].groupby(by=['T_TEAMKEY']).agg('max', numeric_only=True)

team[['T_TEAMKEY']].groupby(by=['T_TEAMKEY']).agg('sum', numeric_only=True)

association.merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association.merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association.merge(team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association.merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_ASSOCKEY', 'A_PRESIDENT']].groupby(by=['A_ASSOCKEY']).agg('sum', numeric_only=True)

association[['A_FOUNDEDYEAR', 'A_PRESIDENT']].groupby(by=['A_FOUNDEDYEAR']).agg('max', numeric_only=True)

coach.groupby(by=['C_NAME', 'C_TEAMKEY', 'C_COACHKEY', 'C_EXPYEARS', 'C_ROLE']).agg('sum', numeric_only=True)

coach.groupby(by=['C_TEAMKEY', 'C_COACHKEY', 'C_NAME', 'C_ROLE', 'C_EXPYEARS']).agg('min', numeric_only=True)

coach.merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('sum', numeric_only=True)

coach.merge(team[(team['T_GROUP'] == 'f') | (team['T_GROUP'] != 'd') & (team['T_PLAYERCOUNT'] <= 19)], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[(team['T_PLAYERCOUNT'] < 22) | (team['T_TEAMKEY'].str.startswith('t')) | (team['T_PLAYERCOUNT'] == 20)], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_COACHKEY'] < 46) & (coach['C_ROLE'] != 'head coach')].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_COACHKEY'] < 75) & (coach['C_EXPYEARS'] != 38)].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_COACHKEY'] == 65) & (coach['C_ROLE'] != 'fitness coach')][['C_EXPYEARS', 'C_NAME']]

coach[(coach['C_COACHKEY'] > 9)][['C_EXPYEARS', 'C_COACHKEY', 'C_ROLE']]

coach[(coach['C_NAME'].str.startswith('c')) | (coach['C_EXPYEARS'] < 17)].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_NAME', 'C_TEAMKEY']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

match.merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_CITY']).agg('count')

match.merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[(match['M_ROUND'] != 'group stage') | (match['M_ROUND'] == 'round of 16')].merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_SCORE1'] == 3) & (match['M_STADIUMKEY'] >= 2)].merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_TEAM2KEY'] != 't') | (match['M_ATTENDANCE'] < 78817) & (match['M_MATCHKEY'] > 12) & (match['M_MATCHKEY'] > 24) & (match['M_ROUND'] != 'semi-final') | (match['M_TIME'] == '2')]

match[['M_MATCHKEY', 'M_ATTENDANCE']].groupby(by=['M_ATTENDANCE']).agg('sum', numeric_only=True)

stadium.groupby(by=['S_CITY', 'S_STADIUMKEY', 'S_YEARBUILT', 'S_LOCATION', 'S_NAME']).agg('min', numeric_only=True)

stadium.groupby(by=['S_CITY', 'S_YEARBUILT', 'S_LOCATION', 'S_STADIUMKEY', 'S_CAPACITY']).agg('max', numeric_only=True)

stadium.groupby(by=['S_LOCATION', 'S_CITY', 'S_YEARBUILT', 'S_CAPACITY', 'S_STADIUMKEY']).agg('mean', numeric_only=True)

stadium.groupby(by=['S_LOCATION', 'S_STADIUMKEY', 'S_YEARBUILT', 'S_CITY', 'S_CAPACITY']).agg('count')

stadium.groupby(by=['S_LOCATION', 'S_YEARBUILT', 'S_NAME', 'S_CAPACITY', 'S_STADIUMKEY']).agg('mean', numeric_only=True)

stadium.groupby(by=['S_NAME', 'S_CAPACITY', 'S_CITY', 'S_YEARBUILT', 'S_LOCATION']).agg('count')

stadium.groupby(by=['S_NAME', 'S_LOCATION', 'S_CAPACITY', 'S_CITY', 'S_YEARBUILT']).agg('sum', numeric_only=True)

stadium[(stadium['S_CAPACITY'] > 68820) | (stadium['S_STADIUMKEY'] > 8) | (stadium['S_LOCATION'].str.startswith('n')) & (stadium['S_YEARBUILT'] <= 1965) | (stadium['S_CITY'] != 'r') | (stadium['S_YEARBUILT'] > 1962)]

stadium[(stadium['S_NAME'] != 's') | (stadium['S_CAPACITY'] != 65770) & (stadium['S_CITY'] == 'l') | (stadium['S_LOCATION'] != 'n') & (stadium['S_NAME'] != 's') & (stadium['S_NAME'] == 's')]

stadium[(stadium['S_NAME'].str.startswith('s'))][['S_YEARBUILT', 'S_CITY', 'S_LOCATION']]

stadium[(stadium['S_STADIUMKEY'] < 10)].groupby(by=['S_YEARBUILT', 'S_NAME']).agg('max', numeric_only=True)

stadium[(stadium['S_YEARBUILT'] == 1954)].groupby(by=['S_STADIUMKEY', 'S_LOCATION']).agg('mean', numeric_only=True)

stadium[['S_CAPACITY', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_LOCATION', 'S_NAME', 'S_CITY']]

stadium[['S_LOCATION', 'S_CAPACITY', 'S_YEARBUILT', 'S_CITY', 'S_STADIUMKEY', 'S_NAME']]

stadium[['S_LOCATION', 'S_CITY', 'S_STADIUMKEY', 'S_CAPACITY', 'S_YEARBUILT', 'S_NAME']]

stadium[['S_LOCATION', 'S_YEARBUILT']].groupby(by=['S_YEARBUILT']).agg('min', numeric_only=True)

stadium[['S_NAME', 'S_CITY']].groupby(by=['S_CITY']).agg('min', numeric_only=True)

stadium[['S_STADIUMKEY', 'S_CAPACITY', 'S_LOCATION', 'S_CITY', 'S_YEARBUILT', 'S_NAME']]

stadium[['S_STADIUMKEY', 'S_LOCATION', 'S_CITY', 'S_YEARBUILT', 'S_NAME', 'S_CAPACITY']]

stadium[['S_YEARBUILT', 'S_STADIUMKEY']].groupby(by=['S_YEARBUILT']).agg('mean', numeric_only=True)

team[(team['T_GROUP'] != 'b') & (team['T_PLAYERCOUNT'] > 21)].groupby(by=['T_PLAYERCOUNT']).agg('min', numeric_only=True)

team[(team['T_GROUP'] != 'c') | (team['T_GROUP'] != 'e') | (team['T_PLAYERCOUNT'] != 25)][['T_TEAMKEY']]

team[(team['T_GROUP'] == 'a') & (team['T_GROUP'].isin(['c', 'd', 'h'])) & (team['T_PLAYERCOUNT'] > 24)][['T_TEAMKEY']]

team[(team['T_GROUP'] == 'b') | (team['T_PLAYERCOUNT'] > 21) & (team['T_GROUP'] != 'c')][['T_PLAYERCOUNT']]

team[(team['T_PLAYERCOUNT'] >= 25) & (team['T_PLAYERCOUNT'] != 18) & (team['T_GROUP'] != 'c')][['T_GROUP']]

team[(team['T_TEAMKEY'] != 't') & (team['T_GROUP'] != 'c')].groupby(by=['T_TEAMKEY']).agg('min', numeric_only=True)

team[(team['T_TEAMKEY'] != 't')].groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY']).agg('sum', numeric_only=True)

team[['T_GROUP', 'T_PLAYERCOUNT']].groupby(by=['T_GROUP']).agg('mean', numeric_only=True)

team[['T_GROUP', 'T_TEAMKEY']].groupby(by=['T_TEAMKEY']).agg('min', numeric_only=True)

team[['T_PLAYERCOUNT', 'T_GROUP']].groupby(by=['T_PLAYERCOUNT']).agg('sum', numeric_only=True)

association.merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

association.merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

association.merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('count')

association.merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP']).agg('min', numeric_only=True)

association.merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('max', numeric_only=True)

association.merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('mean', numeric_only=True)

association[(association['A_ASSOCKEY'] == 'f') & (association['A_PRESIDENT'] != 'p') & (association['A_PRESIDENT'] == 'p')].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_FOUNDEDYEAR'] == 1977) | (association['A_PRESIDENT'] != 'p') | (association['A_PRESIDENT'].str.startswith('p'))].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_PRESIDENT'] != 'p') | (association['A_TEAMKEY'].str.startswith('t')) | (association['A_ASSOCKEY'] == 'f')].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_PRESIDENT'] == 'p') & (association['A_FOUNDEDYEAR'] < 1906)][['A_ASSOCKEY', 'A_FOUNDEDYEAR', 'A_PRESIDENT']]

association[(association['A_TEAMKEY'] == 't') & (association['A_PRESIDENT'] != 'p') & (association['A_ASSOCKEY'] == 'f')].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_TEAMKEY'] == 't') | (association['A_PRESIDENT'] == 'p')][['A_FOUNDEDYEAR', 'A_TEAMKEY', 'A_PRESIDENT']]

association[['A_ASSOCKEY', 'A_FOUNDEDYEAR', 'A_PRESIDENT']].groupby(by=['A_ASSOCKEY']).agg('sum', numeric_only=True)

association[['A_FOUNDEDYEAR', 'A_PRESIDENT']].groupby(by=['A_FOUNDEDYEAR', 'A_PRESIDENT']).agg('sum', numeric_only=True)

association[['A_FOUNDEDYEAR', 'A_PRESIDENT']].groupby(by=['A_PRESIDENT', 'A_FOUNDEDYEAR']).agg('count')

association[['A_TEAMKEY', 'A_FOUNDEDYEAR', 'A_ASSOCKEY']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] > 25)], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP']).agg('mean', numeric_only=True)

coach.merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP']).agg('min', numeric_only=True)

coach.merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY']).agg('mean', numeric_only=True)

coach.merge(team[(team['T_PLAYERCOUNT'] < 23)][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_EXPYEARS'] <= 16) | (coach['C_NAME'] != 'c') | (coach['C_COACHKEY'] > 43)].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_EXPYEARS'] <= 24) & (coach['C_NAME'] == 'c') & (coach['C_COACHKEY'] <= 99) & (coach['C_NAME'].str.startswith('c'))][['C_NAME']]

coach[(coach['C_NAME'] != 'c') | (coach['C_ROLE'].isin(['goalkeeper coach'])) | (coach['C_TEAMKEY'].str.startswith('t')) | (coach['C_ROLE'].isin(['goalkeeper coach']))][['C_EXPYEARS']]

coach[(coach['C_ROLE'] != 'head coach') & (coach['C_COACHKEY'] == 58) | (coach['C_ROLE'] != 'head coach') | (coach['C_NAME'] != 'c')][['C_NAME']]

coach[(coach['C_ROLE'] == 'goalkeeper coach')].merge(team[(team['T_GROUP'].isin(['h', 'a', 'c', 'f', 'g', 'd']))], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_TEAMKEY'].str.startswith('t')) & (coach['C_ROLE'] != 'assistant coach') | (coach['C_COACHKEY'] < 33) & (coach['C_TEAMKEY'] != 't')][['C_EXPYEARS']]

coach[['C_ROLE', 'C_COACHKEY', 'C_TEAMKEY']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

match.merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('count')

match.merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP']).agg('mean', numeric_only=True)

match.merge(team[(team['T_TEAMKEY'] != 't')][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match.merge(team[(team['T_TEAMKEY'] == 't')][['T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[(match['M_DURATION'] < 127) & (match['M_DURATION'] >= 103) | (match['M_SCORE2'] <= 1)][['M_ROUND', 'M_SCORE1']]

match[['M_STADIUMKEY', 'M_ATTENDANCE', 'M_MATCHKEY']].merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

stadium[(stadium['S_CAPACITY'] == 56575) & (stadium['S_LOCATION'] != 'e') | (stadium['S_NAME'] != 's')].groupby(by=['S_LOCATION']).agg('min', numeric_only=True)

stadium[(stadium['S_CITY'] == 'r') | (stadium['S_YEARBUILT'] < 1978)].groupby(by=['S_NAME', 'S_CAPACITY']).agg('count')

stadium[(stadium['S_LOCATION'] == 'e') | (stadium['S_NAME'] != 's') | (stadium['S_NAME'] == 's')][['S_CAPACITY', 'S_YEARBUILT']]

stadium[(stadium['S_LOCATION'].str.startswith('e')) & (stadium['S_NAME'].str.startswith('s')) & (stadium['S_YEARBUILT'] == 1985)][['S_LOCATION', 'S_YEARBUILT']]

stadium[(stadium['S_LOCATION'].str.startswith('w')) & (stadium['S_CAPACITY'] > 54902)][['S_YEARBUILT', 'S_STADIUMKEY', 'S_CAPACITY']]

stadium[(stadium['S_NAME'].str.startswith('s'))][['S_CAPACITY', 'S_NAME', 'S_YEARBUILT', 'S_STADIUMKEY']]

stadium[(stadium['S_STADIUMKEY'] != 8) | (stadium['S_YEARBUILT'] == 1954) | (stadium['S_STADIUMKEY'] < 2) | (stadium['S_CITY'] != 'd')][['S_CITY']]

stadium[(stadium['S_YEARBUILT'] != 1961) & (stadium['S_YEARBUILT'] > 1964)].groupby(by=['S_STADIUMKEY', 'S_NAME']).agg('min', numeric_only=True)

stadium[(stadium['S_YEARBUILT'] >= 1970) & (stadium['S_NAME'] == 's') | (stadium['S_NAME'] != 's')][['S_YEARBUILT', 'S_STADIUMKEY']]

stadium[['S_CITY', 'S_STADIUMKEY', 'S_CAPACITY']].groupby(by=['S_CITY']).agg('max', numeric_only=True)

stadium[['S_STADIUMKEY', 'S_CAPACITY']].groupby(by=['S_CAPACITY', 'S_STADIUMKEY']).agg('min', numeric_only=True)

team[(team['T_GROUP'] != 'b') & (team['T_TEAMKEY'].str.startswith('t'))][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']]

team[(team['T_GROUP'] == 'g') | (team['T_TEAMKEY'] == 't')].groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

team[(team['T_GROUP'].isin(['b', 'e', 'h', 'd', 'f']))].groupby(by=['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']).agg('mean', numeric_only=True)

team[(team['T_GROUP'].isin(['d', 'h', 'c'])) & (team['T_TEAMKEY'] == 't')].groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('max', numeric_only=True)

team[(team['T_GROUP'].isin(['e', 'c'])) & (team['T_TEAMKEY'].str.startswith('t'))].groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

team[(team['T_GROUP'].isin(['e', 'f', 'c', 'h', 'b', 'd', 'a', 'g'])) & (team['T_GROUP'] != 'b') | (team['T_GROUP'].isin(['h', 'c', 'f', 'g', 'a']))].groupby(by=['T_PLAYERCOUNT']).agg('max', numeric_only=True)

team[(team['T_GROUP'].isin(['e', 'f', 'h', 'c'])) | (team['T_GROUP'].isin(['b', 'g'])) & (team['T_PLAYERCOUNT'] >= 20)][['T_PLAYERCOUNT', 'T_GROUP']]

team[(team['T_GROUP'].isin(['g', 'c', 'f', 'b', 'h', 'd']))].groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('sum', numeric_only=True)

team[(team['T_GROUP'].isin(['h', 'b', 'e', 'd', 'f', 'g', 'a'])) & (team['T_TEAMKEY'] != 't')].groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('min', numeric_only=True)

team[(team['T_PLAYERCOUNT'] < 21)].groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('mean', numeric_only=True)

team[(team['T_PLAYERCOUNT'] < 22) | (team['T_GROUP'] != 'b') | (team['T_GROUP'].isin(['d', 'g']))].groupby(by=['T_GROUP']).agg('sum', numeric_only=True)

team[(team['T_PLAYERCOUNT'] == 21) | (team['T_TEAMKEY'].str.startswith('t'))].groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('mean', numeric_only=True)

team[(team['T_PLAYERCOUNT'] > 23) & (team['T_GROUP'].isin(['d', 'e', 'g', 'b', 'a', 'c', 'f'])) & (team['T_GROUP'] == 'f')].groupby(by=['T_TEAMKEY']).agg('min', numeric_only=True)

team[(team['T_TEAMKEY'] != 't') | (team['T_GROUP'].isin(['b', 'a'])) | (team['T_TEAMKEY'] == 't')].groupby(by=['T_TEAMKEY']).agg('min', numeric_only=True)

team[(team['T_TEAMKEY'] != 't') | (team['T_GROUP'].isin(['d']))].groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('max', numeric_only=True)

team[(team['T_TEAMKEY'] != 't')].groupby(by=['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']).agg('count')

team[(team['T_TEAMKEY'] == 't') | (team['T_TEAMKEY'].str.startswith('t')) | (team['T_GROUP'] != 'b')].groupby(by=['T_PLAYERCOUNT']).agg('min', numeric_only=True)

team[(team['T_TEAMKEY'].str.startswith('t')) | (team['T_TEAMKEY'] != 't')].groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY']).agg('max', numeric_only=True)

team[(team['T_TEAMKEY'].str.startswith('t'))].groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']).agg('min', numeric_only=True)

team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']].groupby(by=['T_GROUP']).agg('count')

team[['T_GROUP', 'T_TEAMKEY']].groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('count')

team[['T_PLAYERCOUNT', 'T_GROUP']].groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('count')

team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']].groupby(by=['T_TEAMKEY']).agg('count')

team[['T_PLAYERCOUNT', 'T_TEAMKEY']].groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('min', numeric_only=True)

team[['T_TEAMKEY', 'T_GROUP']].groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('sum', numeric_only=True)

team[['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']].groupby(by=['T_TEAMKEY']).agg('max', numeric_only=True)

team[['T_TEAMKEY', 'T_PLAYERCOUNT']].groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('mean', numeric_only=True)

team[['T_TEAMKEY', 'T_PLAYERCOUNT']].groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

association.merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('max', numeric_only=True)

association.merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

association.merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']).agg('min', numeric_only=True)

association.merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']).agg('mean', numeric_only=True)

association.merge(team[(team['T_GROUP'].isin(['g', 'c', 'f', 'd', 'a', 'b', 'h', 'e']))][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association.merge(team[(team['T_PLAYERCOUNT'] < 19)], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT']).agg('count')

association.merge(team[(team['T_PLAYERCOUNT'] <= 19) & (team['T_TEAMKEY'] == 't')][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_ASSOCKEY'].str.startswith('f')) | (association['A_FOUNDEDYEAR'] >= 1993) | (association['A_ASSOCKEY'] != 'f')][['A_PRESIDENT', 'A_ASSOCKEY', 'A_FOUNDEDYEAR']]

association[(association['A_FOUNDEDYEAR'] <= 1933)].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_FOUNDEDYEAR'] == 1905) & (association['A_ASSOCKEY'].str.startswith('f')) | (association['A_PRESIDENT'].str.startswith('p'))][['A_TEAMKEY', 'A_PRESIDENT', 'A_FOUNDEDYEAR']]

association[(association['A_FOUNDEDYEAR'] == 1910)][['A_PRESIDENT']].groupby(by=['A_PRESIDENT']).agg('min', numeric_only=True)

association[(association['A_FOUNDEDYEAR'] > 1946)][['A_FOUNDEDYEAR']].groupby(by=['A_FOUNDEDYEAR']).agg('sum', numeric_only=True)

association[(association['A_TEAMKEY'] != 't')][['A_PRESIDENT']].groupby(by=['A_PRESIDENT']).agg('max', numeric_only=True)

association[(association['A_TEAMKEY'] == 't') & (association['A_TEAMKEY'].str.startswith('t')) | (association['A_FOUNDEDYEAR'] == 1996) | (association['A_PRESIDENT'].str.startswith('p'))].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_TEAMKEY'] == 't') | (association['A_ASSOCKEY'] != 'f') & (association['A_ASSOCKEY'].str.startswith('f')) | (association['A_TEAMKEY'] == 't')].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_TEAMKEY'].str.startswith('t'))].merge(team[(team['T_TEAMKEY'] != 't') & (team['T_TEAMKEY'] == 't')], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_PRESIDENT', 'A_ASSOCKEY', 'A_FOUNDEDYEAR', 'A_TEAMKEY']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_PRESIDENT', 'A_ASSOCKEY', 'A_FOUNDEDYEAR']].groupby(by=['A_FOUNDEDYEAR', 'A_PRESIDENT']).agg('mean', numeric_only=True)

association[['A_TEAMKEY', 'A_PRESIDENT', 'A_ASSOCKEY', 'A_FOUNDEDYEAR']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('min', numeric_only=True)

coach.merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']).agg('sum', numeric_only=True)

coach.merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']).agg('min', numeric_only=True)

coach.merge(team[(team['T_GROUP'] != 'd')][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[(team['T_GROUP'] == 'h')][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_EXPYEARS'] < 3) & (coach['C_ROLE'].isin(['assistant coach', 'head coach', 'fitness coach', 'goalkeeper coach'])) & (coach['C_EXPYEARS'] == 8) & (coach['C_ROLE'] != 'head coach')].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'] == 'c')].merge(team[(team['T_TEAMKEY'] == 't') | (team['T_GROUP'].isin(['a', 'f', 'd', 'b', 'c', 'e']))], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'] == 'c')].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'].str.startswith('c')) & (coach['C_COACHKEY'] == 31) & (coach['C_EXPYEARS'] <= 5) | (coach['C_ROLE'] != 'goalkeeper coach')].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_TEAMKEY'] != 't')][['C_ROLE']].groupby(by=['C_ROLE']).agg('max', numeric_only=True)

coach[(coach['C_TEAMKEY'] == 't')][['C_COACHKEY']].groupby(by=['C_COACHKEY']).agg('min', numeric_only=True)

coach[(coach['C_TEAMKEY'] == 't')][['C_TEAMKEY']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_COACHKEY', 'C_TEAMKEY']].merge(team[(team['T_GROUP'] != 'e')], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

match.merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_STADIUMKEY', 'S_YEARBUILT', 'S_NAME']).agg('min', numeric_only=True)

match.merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_YEARBUILT', 'S_LOCATION', 'S_STADIUMKEY']).agg('min', numeric_only=True)

match.merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('max', numeric_only=True)

match.merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

match.merge(team[(team['T_TEAMKEY'].str.startswith('t'))], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('count')

match[(match['M_ATTENDANCE'] != 78714) & (match['M_TEAM2KEY'] == 't') | (match['M_MATCHKEY'] > 7) & (match['M_SCORE2'] < 0) | (match['M_SCORE1'] >= 2) | (match['M_TEAM1KEY'] == 't') | (match['M_DURATION'] >= 120) | (match['M_SCORE1'] == 0)]

match[(match['M_ROUND'] == 'semi-final') & (match['M_DATE'] != '2022-11-20') | (match['M_ATTENDANCE'] < 45752) & (match['M_ATTENDANCE'] > 51648) | (match['M_TEAM2KEY'].str.startswith('t')) & (match['M_MATCHKEY'] <= 31) & (match['M_TIME'] != '2') & (match['M_ROUND'] != 'semi-final')]

match[(match['M_ROUND'].isin(['final'])) | (match['M_DURATION'] > 97) & (match['M_TEAM1KEY'].str.startswith('t')) & (match['M_TIME'] == '2')][['M_SCORE2', 'M_ROUND']]

stadium[(stadium['S_CAPACITY'] != 66156) | (stadium['S_CITY'].str.startswith('a')) & (stadium['S_LOCATION'] == 'c')].groupby(by=['S_LOCATION', 'S_CITY']).agg('min', numeric_only=True)

stadium[(stadium['S_LOCATION'] != 'w')].groupby(by=['S_CITY', 'S_NAME', 'S_LOCATION', 'S_STADIUMKEY']).agg('min', numeric_only=True)

stadium[(stadium['S_LOCATION'].str.startswith('n'))][['S_CAPACITY']].groupby(by=['S_CAPACITY']).agg('max', numeric_only=True)

stadium[(stadium['S_NAME'].str.startswith('s'))][['S_YEARBUILT']].groupby(by=['S_YEARBUILT']).agg('min', numeric_only=True)

stadium[(stadium['S_YEARBUILT'] > 1956) & (stadium['S_STADIUMKEY'] != 9) | (stadium['S_CAPACITY'] > 64215) | (stadium['S_CAPACITY'] > 85919)].groupby(by=['S_CITY']).agg('sum', numeric_only=True)

stadium[(stadium['S_YEARBUILT'] > 1980) | (stadium['S_STADIUMKEY'] < 9) | (stadium['S_CAPACITY'] == 80757) | (stadium['S_LOCATION'] == 'w') & (stadium['S_CITY'].str.startswith('d'))][['S_LOCATION']]

stadium[['S_CAPACITY', 'S_LOCATION', 'S_NAME']].groupby(by=['S_NAME', 'S_LOCATION']).agg('sum', numeric_only=True)

stadium[['S_CAPACITY', 'S_STADIUMKEY', 'S_NAME']].groupby(by=['S_NAME', 'S_STADIUMKEY']).agg('min', numeric_only=True)

stadium[['S_LOCATION', 'S_CAPACITY', 'S_YEARBUILT', 'S_NAME']].groupby(by=['S_CAPACITY']).agg('count')

stadium[['S_LOCATION', 'S_CITY', 'S_NAME', 'S_STADIUMKEY']].groupby(by=['S_NAME']).agg('count')

stadium[['S_LOCATION', 'S_CITY', 'S_NAME']].groupby(by=['S_CITY', 'S_LOCATION']).agg('min', numeric_only=True)

stadium[['S_LOCATION', 'S_YEARBUILT', 'S_CAPACITY']].groupby(by=['S_LOCATION', 'S_YEARBUILT']).agg('mean', numeric_only=True)

stadium[['S_NAME', 'S_CAPACITY', 'S_YEARBUILT']].groupby(by=['S_YEARBUILT', 'S_NAME']).agg('mean', numeric_only=True)

team[(team['T_GROUP'] != 'a') | (team['T_TEAMKEY'] != 't') & (team['T_TEAMKEY'] == 't')].groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('count')

team[(team['T_GROUP'] != 'b') | (team['T_GROUP'] == 'f') | (team['T_PLAYERCOUNT'] > 22)][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']]

team[(team['T_GROUP'] != 'h') | (team['T_GROUP'].isin(['f', 'b']))].groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']).agg('count')

team[(team['T_GROUP'] != 'h')][['T_GROUP']].groupby(by=['T_GROUP']).agg('max', numeric_only=True)

team[(team['T_GROUP'].isin(['d', 'f', 'e', 'a'])) | (team['T_GROUP'] != 'c') | (team['T_GROUP'].isin(['a', 'b', 'd', 'h', 'e']))][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']]

team[(team['T_GROUP'].isin(['d', 'g', 'c', 'h', 'f', 'e', 'b', 'a'])) & (team['T_TEAMKEY'] != 't') & (team['T_GROUP'] == 'a')][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']]

team[(team['T_PLAYERCOUNT'] <= 20) & (team['T_GROUP'].isin(['f', 'd', 'a', 'e', 'h', 'g']))].groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('count')

team[(team['T_TEAMKEY'] != 't') | (team['T_PLAYERCOUNT'] == 22) | (team['T_GROUP'] != 'h')][['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']]

team[(team['T_TEAMKEY'] == 't') & (team['T_PLAYERCOUNT'] <= 21) | (team['T_TEAMKEY'].str.startswith('t'))].groupby(by=['T_PLAYERCOUNT', 'T_GROUP']).agg('max', numeric_only=True)

team[(team['T_TEAMKEY'] == 't') | (team['T_PLAYERCOUNT'] == 21)].groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']).agg('min', numeric_only=True)

team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_GROUP'] == 'd')].groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('min', numeric_only=True)

team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_TEAMKEY'] == 't')].groupby(by=['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']).agg('count')

team[(team['T_TEAMKEY'].str.startswith('t')) | (team['T_PLAYERCOUNT'] > 24) & (team['T_GROUP'] == 'd')].groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('count')

team[['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']].groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY']).agg('sum', numeric_only=True)

team[['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']].groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('sum', numeric_only=True)

association.merge(team[(team['T_GROUP'] == 'a')], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

association.merge(team[(team['T_PLAYERCOUNT'] <= 19) & (team['T_PLAYERCOUNT'] >= 22)][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association.merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP']).agg('min', numeric_only=True)

association[(association['A_ASSOCKEY'] == 'f')].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_FOUNDEDYEAR'] > 1918) & (association['A_PRESIDENT'] == 'p')][['A_PRESIDENT']].groupby(by=['A_PRESIDENT']).agg('count')

association[(association['A_TEAMKEY'] == 't') & (association['A_ASSOCKEY'] == 'f')][['A_FOUNDEDYEAR']].groupby(by=['A_FOUNDEDYEAR']).agg('count')

association[(association['A_TEAMKEY'].str.startswith('t')) & (association['A_TEAMKEY'] == 't')].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[(team['T_PLAYERCOUNT'] < 21) | (team['T_TEAMKEY'] == 't')][['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[(team['T_TEAMKEY'] != 't') & (team['T_GROUP'].isin(['g', 'h', 'c', 'd', 'b', 'e', 'a']))][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('max', numeric_only=True)

coach[(coach['C_EXPYEARS'] > 33) | (coach['C_COACHKEY'] > 87) | (coach['C_NAME'] == 'c') & (coach['C_EXPYEARS'] <= 5) & (coach['C_ROLE'] != 'goalkeeper coach')].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'] == 'c') | (coach['C_ROLE'] != 'head coach')][['C_ROLE']].groupby(by=['C_ROLE']).agg('sum', numeric_only=True)

coach[(coach['C_ROLE'] != 'fitness coach') & (coach['C_EXPYEARS'] <= 23)].merge(team[['T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_ROLE'].isin(['head coach', 'fitness coach']))].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_TEAMKEY'] == 't') & (coach['C_EXPYEARS'] <= 10) | (coach['C_COACHKEY'] >= 71) | (coach['C_TEAMKEY'] == 't')][['C_NAME', 'C_TEAMKEY', 'C_EXPYEARS']]

coach[['C_NAME', 'C_ROLE', 'C_EXPYEARS', 'C_COACHKEY', 'C_TEAMKEY']].groupby(by=['C_ROLE']).agg('count')

coach[['C_NAME', 'C_TEAMKEY', 'C_ROLE', 'C_COACHKEY', 'C_EXPYEARS']].groupby(by=['C_EXPYEARS']).agg('count')

coach[['C_NAME', 'C_TEAMKEY', 'C_ROLE', 'C_EXPYEARS', 'C_COACHKEY']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_ROLE', 'C_NAME', 'C_COACHKEY']].groupby(by=['C_ROLE', 'C_COACHKEY', 'C_NAME']).agg('mean', numeric_only=True)

coach[['C_TEAMKEY', 'C_NAME', 'C_COACHKEY', 'C_ROLE', 'C_EXPYEARS']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_TEAMKEY']].merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

match.merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_NAME', 'S_LOCATION', 'S_CAPACITY', 'S_CITY']).agg('mean', numeric_only=True)

match.merge(stadium[(stadium['S_NAME'] != 's') | (stadium['S_STADIUMKEY'] != 2) | (stadium['S_STADIUMKEY'] <= 11) & (stadium['S_NAME'].str.startswith('s')) | (stadium['S_YEARBUILT'] < 1970) & (stadium['S_CAPACITY'] != 76267)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match.merge(stadium[(stadium['S_YEARBUILT'] < 1978)][['S_CAPACITY', 'S_CITY', 'S_LOCATION', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match.merge(stadium[['S_NAME', 'S_CITY', 'S_STADIUMKEY', 'S_YEARBUILT', 'S_LOCATION', 'S_CAPACITY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match.merge(team[(team['T_TEAMKEY'] == 't') & (team['T_GROUP'] == 'd')][['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match.merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('mean', numeric_only=True)

match[(match['M_MATCHKEY'] == 1) & (match['M_TIME'] != '1')].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[(match['M_TEAM2KEY'].str.startswith('t')) | (match['M_DURATION'] > 135)].merge(team[(team['T_PLAYERCOUNT'] <= 21) & (team['T_TEAMKEY'].str.startswith('t'))], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[['M_ATTENDANCE', 'M_ROUND', 'M_MATCHKEY']].groupby(by=['M_ROUND', 'M_MATCHKEY', 'M_ATTENDANCE']).agg('min', numeric_only=True)

match[['M_SCORE1', 'M_ROUND', 'M_DURATION', 'M_MATCHKEY']].groupby(by=['M_DURATION', 'M_MATCHKEY']).agg('mean', numeric_only=True)

match[['M_SCORE2', 'M_DATE', 'M_ROUND', 'M_DURATION']].groupby(by=['M_SCORE2', 'M_DURATION']).agg('mean', numeric_only=True)

stadium[(stadium['S_CITY'] != 'a') | (stadium['S_YEARBUILT'] < 2013)].groupby(by=['S_STADIUMKEY', 'S_YEARBUILT', 'S_CITY', 'S_NAME']).agg('min', numeric_only=True)

stadium[(stadium['S_LOCATION'] != 'c') & (stadium['S_YEARBUILT'] != 1990)][['S_NAME']].groupby(by=['S_NAME']).agg('sum', numeric_only=True)

stadium[(stadium['S_LOCATION'].str.startswith('e')) & (stadium['S_LOCATION'] == 'w')].groupby(by=['S_NAME', 'S_LOCATION', 'S_CITY', 'S_CAPACITY']).agg('max', numeric_only=True)

stadium[(stadium['S_LOCATION'].str.startswith('n')) & (stadium['S_STADIUMKEY'] == 4) & (stadium['S_LOCATION'] != 'n') & (stadium['S_NAME'] != 's') | (stadium['S_STADIUMKEY'] <= 11)].groupby(by=['S_STADIUMKEY']).agg('count')

stadium[(stadium['S_NAME'].str.startswith('s')) | (stadium['S_LOCATION'].str.startswith('w')) & (stadium['S_CAPACITY'] != 44273) | (stadium['S_YEARBUILT'] >= 2007) & (stadium['S_CAPACITY'] != 59711) | (stadium['S_YEARBUILT'] > 1969)][['S_NAME']]

stadium[(stadium['S_STADIUMKEY'] <= 2) | (stadium['S_STADIUMKEY'] == 6) & (stadium['S_CAPACITY'] <= 71232) | (stadium['S_STADIUMKEY'] >= 4) | (stadium['S_CAPACITY'] > 46149) | (stadium['S_NAME'] == 's')][['S_STADIUMKEY']]

stadium[(stadium['S_STADIUMKEY'] > 7) & (stadium['S_STADIUMKEY'] < 4)][['S_STADIUMKEY']].groupby(by=['S_STADIUMKEY']).agg('sum', numeric_only=True)

stadium[(stadium['S_YEARBUILT'] != 1953) | (stadium['S_NAME'] == 's') & (stadium['S_YEARBUILT'] < 2013) | (stadium['S_STADIUMKEY'] != 5)][['S_CAPACITY', 'S_CITY', 'S_YEARBUILT']]

stadium[(stadium['S_YEARBUILT'] != 2002) & (stadium['S_CITY'] != 'a')].groupby(by=['S_LOCATION', 'S_CITY', 'S_YEARBUILT', 'S_NAME']).agg('count')

stadium[(stadium['S_YEARBUILT'] <= 1959) | (stadium['S_NAME'] != 's')].groupby(by=['S_YEARBUILT', 'S_CAPACITY', 'S_NAME', 'S_CITY']).agg('count')

stadium[(stadium['S_YEARBUILT'] <= 2017) & (stadium['S_STADIUMKEY'] != 9)][['S_NAME']].groupby(by=['S_NAME']).agg('min', numeric_only=True)

stadium[(stadium['S_YEARBUILT'] > 1973) & (stadium['S_LOCATION'] != 'n') & (stadium['S_STADIUMKEY'] == 9) & (stadium['S_NAME'] == 's') & (stadium['S_CAPACITY'] < 47031) & (stadium['S_YEARBUILT'] == 1960)][['S_NAME']]

stadium[(stadium['S_YEARBUILT'] >= 1967) | (stadium['S_YEARBUILT'] <= 1994) | (stadium['S_STADIUMKEY'] != 2) | (stadium['S_YEARBUILT'] >= 1987) | (stadium['S_YEARBUILT'] <= 1964) & (stadium['S_CITY'] == 'r')][['S_STADIUMKEY']]

stadium[['S_NAME', 'S_STADIUMKEY', 'S_CITY']].groupby(by=['S_NAME', 'S_CITY', 'S_STADIUMKEY']).agg('max', numeric_only=True)

stadium[['S_NAME', 'S_YEARBUILT', 'S_STADIUMKEY']].groupby(by=['S_STADIUMKEY', 'S_YEARBUILT', 'S_NAME']).agg('count')

stadium[['S_YEARBUILT', 'S_LOCATION', 'S_STADIUMKEY', 'S_NAME']].groupby(by=['S_LOCATION', 'S_STADIUMKEY']).agg('sum', numeric_only=True)

team[(team['T_GROUP'] != 'a') & (team['T_PLAYERCOUNT'] != 18) | (team['T_GROUP'] == 'h')].groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('min', numeric_only=True)

team[(team['T_GROUP'] == 'a') | (team['T_GROUP'].isin(['g', 'b', 'a', 'h', 'f', 'e', 'd', 'c']))][['T_GROUP']].groupby(by=['T_GROUP']).agg('count')

team[(team['T_GROUP'] == 'c') | (team['T_GROUP'] == 'e')][['T_GROUP']].groupby(by=['T_GROUP']).agg('mean', numeric_only=True)

team[(team['T_GROUP'].isin(['d', 'a', 'b', 'c', 'g', 'e', 'h'])) & (team['T_GROUP'] != 'f') | (team['T_TEAMKEY'] != 't')].groupby(by=['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']).agg('count')

team[(team['T_PLAYERCOUNT'] != 22)][['T_PLAYERCOUNT', 'T_GROUP']].groupby(by=['T_PLAYERCOUNT']).agg('max', numeric_only=True)

team[(team['T_PLAYERCOUNT'] <= 22) & (team['T_TEAMKEY'] != 't')][['T_PLAYERCOUNT']].groupby(by=['T_PLAYERCOUNT']).agg('count')

team[(team['T_PLAYERCOUNT'] == 18) | (team['T_PLAYERCOUNT'] != 18) & (team['T_PLAYERCOUNT'] > 25)].groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('count')

team[(team['T_PLAYERCOUNT'] == 19) | (team['T_GROUP'] != 'e')][['T_PLAYERCOUNT']].groupby(by=['T_PLAYERCOUNT']).agg('mean', numeric_only=True)

team[(team['T_TEAMKEY'] != 't') & (team['T_TEAMKEY'] == 't') | (team['T_GROUP'] != 'f')].groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

team[(team['T_TEAMKEY'] == 't') | (team['T_PLAYERCOUNT'] < 20) & (team['T_PLAYERCOUNT'] != 19)].groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']).agg('count')

team[(team['T_TEAMKEY'].str.startswith('t')) | (team['T_TEAMKEY'] == 't')][['T_TEAMKEY']].groupby(by=['T_TEAMKEY']).agg('min', numeric_only=True)

team[(team['T_TEAMKEY'].str.startswith('t'))][['T_PLAYERCOUNT', 'T_TEAMKEY']].groupby(by=['T_PLAYERCOUNT']).agg('count')

team[['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']].groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']].groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('mean', numeric_only=True)

team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']].groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('min', numeric_only=True)

team[['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']].groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('min', numeric_only=True)

association.merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

association[(association['A_ASSOCKEY'] != 'f') | (association['A_PRESIDENT'] != 'p')].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('min', numeric_only=True)

association[(association['A_ASSOCKEY'] == 'f') & (association['A_PRESIDENT'] != 'p')].merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_ASSOCKEY'] == 'f') & (association['A_PRESIDENT'].str.startswith('p')) & (association['A_ASSOCKEY'] != 'f')][['A_ASSOCKEY']].groupby(by=['A_ASSOCKEY']).agg('min', numeric_only=True)

association[(association['A_ASSOCKEY'].str.startswith('f')) | (association['A_TEAMKEY'].str.startswith('t'))].merge(team[(team['T_GROUP'].isin(['h', 'g', 'f', 'e', 'b', 'd'])) | (team['T_PLAYERCOUNT'] >= 20) & (team['T_GROUP'].isin(['d', 'g', 'c', 'e', 'a', 'f']))], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_FOUNDEDYEAR'] < 1929) | (association['A_TEAMKEY'] != 't')].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('count')

association[(association['A_FOUNDEDYEAR'] > 1940)][['A_ASSOCKEY', 'A_FOUNDEDYEAR']].groupby(by=['A_FOUNDEDYEAR', 'A_ASSOCKEY']).agg('mean', numeric_only=True)

association[(association['A_PRESIDENT'] != 'p') & (association['A_TEAMKEY'] == 't') & (association['A_PRESIDENT'] == 'p')][['A_ASSOCKEY']].groupby(by=['A_ASSOCKEY']).agg('sum', numeric_only=True)

association[(association['A_TEAMKEY'] != 't') & (association['A_FOUNDEDYEAR'] <= 1962) | (association['A_FOUNDEDYEAR'] > 1936)].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_TEAMKEY'] != 't') | (association['A_PRESIDENT'] != 'p')].merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_TEAMKEY'] == 't') & (association['A_PRESIDENT'] != 'p') & (association['A_TEAMKEY'] != 't')][['A_ASSOCKEY']].groupby(by=['A_ASSOCKEY']).agg('max', numeric_only=True)

association[['A_PRESIDENT', 'A_TEAMKEY', 'A_FOUNDEDYEAR']].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_TEAMKEY', 'A_ASSOCKEY', 'A_FOUNDEDYEAR']].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[(team['T_PLAYERCOUNT'] == 18) & (team['T_PLAYERCOUNT'] > 21) | (team['T_PLAYERCOUNT'] < 21)], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('count')

coach.merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('min', numeric_only=True)

coach.merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('sum', numeric_only=True)

coach[(coach['C_COACHKEY'] < 43)][['C_ROLE', 'C_EXPYEARS', 'C_NAME']].groupby(by=['C_EXPYEARS']).agg('max', numeric_only=True)

coach[(coach['C_ROLE'] == 'goalkeeper coach')][['C_ROLE', 'C_EXPYEARS']].groupby(by=['C_EXPYEARS', 'C_ROLE']).agg('max', numeric_only=True)

coach[['C_TEAMKEY']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP']).agg('sum', numeric_only=True)

match.merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('min', numeric_only=True)

match[(match['M_ATTENDANCE'] == 78883) & (match['M_STADIUMKEY'] < 7) & (match['M_ATTENDANCE'] != 79145) | (match['M_TEAM2KEY'] == 't')].merge(stadium[(stadium['S_LOCATION'] != 's')], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_DURATION'] <= 102) | (match['M_STADIUMKEY'] == 8)].merge(team[(team['T_PLAYERCOUNT'] <= 25) & (team['T_PLAYERCOUNT'] >= 18) | (team['T_TEAMKEY'] == 't')], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[(match['M_SCORE1'] != 1) & (match['M_TEAM1KEY'] != 't') & (match['M_SCORE2'] >= 3) & (match['M_TEAM2KEY'] == 't') & (match['M_ROUND'] == 'group stage') & (match['M_DURATION'] == 134)][['M_ROUND', 'M_MATCHKEY']]

match[(match['M_TIME'].str.startswith('1')) & (match['M_SCORE2'] > 2)].merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[['M_DATE', 'M_ROUND', 'M_STADIUMKEY', 'M_MATCHKEY']].merge(stadium[(stadium['S_CITY'] == 'a')], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[['M_SCORE2', 'M_ATTENDANCE', 'M_DURATION', 'M_TIME', 'M_SCORE1', 'M_ROUND', 'M_STADIUMKEY', 'M_DATE', 'M_TEAM2KEY', 'M_TEAM1KEY']]

stadium[(stadium['S_CAPACITY'] > 71599) | (stadium['S_CITY'].str.startswith('d')) & (stadium['S_NAME'] == 's')][['S_STADIUMKEY']].groupby(by=['S_STADIUMKEY']).agg('min', numeric_only=True)

stadium[(stadium['S_CAPACITY'] >= 82623) & (stadium['S_CAPACITY'] > 70706) & (stadium['S_NAME'] != 's')].groupby(by=['S_YEARBUILT', 'S_CAPACITY', 'S_LOCATION', 'S_NAME']).agg('count')

stadium[(stadium['S_CITY'] != 'a') & (stadium['S_CAPACITY'] > 47594)].groupby(by=['S_STADIUMKEY', 'S_NAME', 'S_LOCATION', 'S_YEARBUILT', 'S_CAPACITY']).agg('count')

stadium[(stadium['S_CITY'] == 'a') & (stadium['S_CITY'] == 'r') & (stadium['S_CITY'] == 'a')][['S_LOCATION']].groupby(by=['S_LOCATION']).agg('count')

stadium[(stadium['S_LOCATION'] != 's')][['S_NAME', 'S_CITY']].groupby(by=['S_NAME', 'S_CITY']).agg('min', numeric_only=True)

stadium[(stadium['S_LOCATION'] == 'n') | (stadium['S_CAPACITY'] < 68156) & (stadium['S_CAPACITY'] < 49677) & (stadium['S_NAME'] == 's') | (stadium['S_YEARBUILT'] != 1999) | (stadium['S_NAME'].str.startswith('s'))][['S_CAPACITY', 'S_YEARBUILT']]

stadium[(stadium['S_NAME'] != 's') | (stadium['S_YEARBUILT'] >= 1976)].groupby(by=['S_NAME', 'S_YEARBUILT', 'S_CITY', 'S_STADIUMKEY', 'S_LOCATION']).agg('sum', numeric_only=True)

stadium[(stadium['S_NAME'] == 's') & (stadium['S_NAME'] != 's')][['S_CAPACITY', 'S_CITY', 'S_LOCATION', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_NAME']]

stadium[(stadium['S_NAME'].str.startswith('s')) & (stadium['S_STADIUMKEY'] != 7) & (stadium['S_STADIUMKEY'] == 6) | (stadium['S_NAME'] != 's') | (stadium['S_CAPACITY'] >= 65558) | (stadium['S_CAPACITY'] == 72828)][['S_LOCATION', 'S_YEARBUILT']]

stadium[(stadium['S_STADIUMKEY'] < 2) | (stadium['S_CAPACITY'] != 50475)][['S_CAPACITY', 'S_LOCATION', 'S_CITY', 'S_STADIUMKEY', 'S_NAME', 'S_YEARBUILT']]

stadium[(stadium['S_YEARBUILT'] != 2003) & (stadium['S_STADIUMKEY'] == 5) & (stadium['S_LOCATION'].str.startswith('w')) & (stadium['S_CITY'].str.startswith('d')) & (stadium['S_STADIUMKEY'] != 3)].groupby(by=['S_YEARBUILT', 'S_LOCATION']).agg('sum', numeric_only=True)

stadium[['S_CAPACITY', 'S_LOCATION', 'S_CITY', 'S_STADIUMKEY', 'S_NAME', 'S_YEARBUILT']].groupby(by=['S_STADIUMKEY']).agg('sum', numeric_only=True)

stadium[['S_CAPACITY', 'S_LOCATION', 'S_STADIUMKEY', 'S_YEARBUILT']].groupby(by=['S_YEARBUILT', 'S_CAPACITY', 'S_STADIUMKEY']).agg('max', numeric_only=True)

stadium[['S_CAPACITY', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_LOCATION', 'S_NAME', 'S_CITY']].groupby(by=['S_CITY']).agg('max', numeric_only=True)

team[(team['T_GROUP'] == 'a') & (team['T_GROUP'] != 'e')][['T_GROUP', 'T_TEAMKEY']].groupby(by=['T_GROUP']).agg('max', numeric_only=True)

team[(team['T_GROUP'] == 'f') & (team['T_PLAYERCOUNT'] <= 22) | (team['T_TEAMKEY'] == 't')][['T_TEAMKEY']].groupby(by=['T_TEAMKEY']).agg('min', numeric_only=True)

team[(team['T_PLAYERCOUNT'] > 19) | (team['T_PLAYERCOUNT'] == 19)][['T_GROUP', 'T_PLAYERCOUNT']].groupby(by=['T_PLAYERCOUNT']).agg('count')

team[(team['T_PLAYERCOUNT'] > 23) | (team['T_PLAYERCOUNT'] < 24)][['T_TEAMKEY', 'T_GROUP']].groupby(by=['T_TEAMKEY']).agg('sum', numeric_only=True)

team[(team['T_PLAYERCOUNT'] > 25) & (team['T_TEAMKEY'].str.startswith('t')) & (team['T_GROUP'].isin(['e', 'd', 'b', 'f', 'g', 'a']))][['T_GROUP']].groupby(by=['T_GROUP']).agg('min', numeric_only=True)

team[(team['T_TEAMKEY'] != 't') | (team['T_TEAMKEY'] == 't') | (team['T_PLAYERCOUNT'] > 20)][['T_TEAMKEY']].groupby(by=['T_TEAMKEY']).agg('count')

team[(team['T_TEAMKEY'] != 't')][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']].groupby(by=['T_PLAYERCOUNT']).agg('count')

team[(team['T_TEAMKEY'] == 't') | (team['T_PLAYERCOUNT'] <= 20) & (team['T_GROUP'].isin(['e', 'b', 'g', 'c', 'a', 'f', 'h']))][['T_PLAYERCOUNT']].groupby(by=['T_PLAYERCOUNT']).agg('sum', numeric_only=True)

association.merge(team[(team['T_PLAYERCOUNT'] > 22) & (team['T_GROUP'].isin(['a', 'f', 'h', 'd', 'c', 'e', 'b'])) & (team['T_GROUP'].isin(['b', 'g', 'e', 'c', 'd', 'h', 'a']))], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY']).agg('count')

association.merge(team[(team['T_TEAMKEY'] == 't')][['T_GROUP', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('count')

association.merge(team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_GROUP'].isin(['b', 'h', 'c', 'a', 'f', 'g', 'e']))], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']).agg('mean', numeric_only=True)

association.merge(team[(team['T_TEAMKEY'].str.startswith('t')) | (team['T_PLAYERCOUNT'] >= 22)], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('count')

association.merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP']).agg('min', numeric_only=True)

association[(association['A_ASSOCKEY'] != 'f') & (association['A_TEAMKEY'] != 't') & (association['A_PRESIDENT'] == 'p')].merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_ASSOCKEY'] != 'f') | (association['A_PRESIDENT'].str.startswith('p')) & (association['A_ASSOCKEY'] == 'f') | (association['A_PRESIDENT'].str.startswith('p'))].merge(team[(team['T_PLAYERCOUNT'] == 22) & (team['T_TEAMKEY'] == 't')], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_FOUNDEDYEAR'] > 1906) & (association['A_PRESIDENT'] == 'p') | (association['A_TEAMKEY'].str.startswith('t')) | (association['A_PRESIDENT'] == 'p')].merge(team[['T_GROUP', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_FOUNDEDYEAR'] >= 1999) & (association['A_ASSOCKEY'] == 'f')][['A_TEAMKEY', 'A_PRESIDENT']].groupby(by=['A_TEAMKEY', 'A_PRESIDENT']).agg('min', numeric_only=True)

association[(association['A_PRESIDENT'].str.startswith('p')) & (association['A_TEAMKEY'] != 't') | (association['A_ASSOCKEY'].str.startswith('f'))][['A_ASSOCKEY', 'A_PRESIDENT']].groupby(by=['A_ASSOCKEY']).agg('min', numeric_only=True)

association[(association['A_PRESIDENT'].str.startswith('p')) | (association['A_FOUNDEDYEAR'] != 1972) & (association['A_FOUNDEDYEAR'] != 1985)].merge(team[(team['T_PLAYERCOUNT'] < 23) | (team['T_GROUP'] != 'a') & (team['T_TEAMKEY'] == 't')], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_TEAMKEY', 'A_ASSOCKEY']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP']).agg('mean', numeric_only=True)

association[['A_TEAMKEY']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']).agg('mean', numeric_only=True)

coach.merge(team[(team['T_PLAYERCOUNT'] >= 21) | (team['T_GROUP'].isin(['b', 'e', 'g']))], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('max', numeric_only=True)

coach[(coach['C_COACHKEY'] <= 84)].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('count')

coach[(coach['C_EXPYEARS'] <= 9)].merge(team[(team['T_PLAYERCOUNT'] < 25) & (team['T_PLAYERCOUNT'] > 24)][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_EXPYEARS'] >= 9)].merge(team[(team['T_PLAYERCOUNT'] >= 23)][['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'].str.startswith('c')) & (coach['C_NAME'] == 'c')][['C_ROLE', 'C_NAME']].groupby(by=['C_ROLE', 'C_NAME']).agg('min', numeric_only=True)

coach[(coach['C_TEAMKEY'] == 't') | (coach['C_EXPYEARS'] != 5) | (coach['C_ROLE'] != 'goalkeeper coach') | (coach['C_COACHKEY'] >= 8)].merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_TEAMKEY'].str.startswith('t')) | (coach['C_ROLE'].isin(['assistant coach'])) & (coach['C_EXPYEARS'] != 28)][['C_EXPYEARS', 'C_COACHKEY']].groupby(by=['C_COACHKEY']).agg('count')

coach[['C_COACHKEY', 'C_EXPYEARS', 'C_TEAMKEY']].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_ROLE', 'C_TEAMKEY', 'C_COACHKEY']].merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_TEAMKEY', 'C_EXPYEARS', 'C_COACHKEY', 'C_ROLE']].groupby(by=['C_ROLE', 'C_COACHKEY', 'C_TEAMKEY', 'C_EXPYEARS']).agg('count')

match.merge(team[(team['T_GROUP'] != 'a') | (team['T_GROUP'].isin(['h', 'b', 'd', 'a', 'e', 'f', 'g'])) & (team['T_TEAMKEY'] == 't')], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('mean', numeric_only=True)

match.merge(team[(team['T_PLAYERCOUNT'] != 25) & (team['T_TEAMKEY'].str.startswith('t'))], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']).agg('count')

match.merge(team[(team['T_PLAYERCOUNT'] < 19)][['T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP']).agg('count')

match.merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP']).agg('min', numeric_only=True)

match.merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('max', numeric_only=True)

match[(match['M_DURATION'] == 93) | (match['M_ATTENDANCE'] == 73683)].merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('min', numeric_only=True)

match[['M_SCORE1', 'M_TEAM2KEY', 'M_DURATION', 'M_MATCHKEY']].merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

stadium[(stadium['S_CAPACITY'] != 43825) | (stadium['S_CAPACITY'] != 59122)][['S_STADIUMKEY', 'S_NAME']].groupby(by=['S_NAME', 'S_STADIUMKEY']).agg('max', numeric_only=True)

stadium[(stadium['S_CITY'] != 'r') | (stadium['S_LOCATION'] == 'c') & (stadium['S_STADIUMKEY'] == 4) & (stadium['S_CITY'] == 'd') | (stadium['S_LOCATION'] != 'e')].groupby(by=['S_LOCATION', 'S_CAPACITY', 'S_NAME']).agg('max', numeric_only=True)

stadium[(stadium['S_CITY'] == 'r') & (stadium['S_NAME'] == 's') | (stadium['S_NAME'].str.startswith('s'))].groupby(by=['S_CAPACITY', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_CITY', 'S_LOCATION']).agg('min', numeric_only=True)

stadium[(stadium['S_LOCATION'].str.startswith('c'))][['S_YEARBUILT', 'S_STADIUMKEY', 'S_CITY', 'S_NAME']].groupby(by=['S_STADIUMKEY']).agg('sum', numeric_only=True)

stadium[(stadium['S_NAME'] != 's') & (stadium['S_NAME'] != 's') | (stadium['S_LOCATION'] != 'e') & (stadium['S_CITY'].str.startswith('a')) & (stadium['S_YEARBUILT'] > 1977) | (stadium['S_LOCATION'] != 's')].groupby(by=['S_STADIUMKEY', 'S_YEARBUILT']).agg('max', numeric_only=True)

stadium[(stadium['S_NAME'] != 's') | (stadium['S_CAPACITY'] < 47669) & (stadium['S_STADIUMKEY'] != 7) | (stadium['S_CAPACITY'] >= 75153)][['S_CAPACITY', 'S_YEARBUILT', 'S_CITY', 'S_LOCATION', 'S_NAME']]

stadium[(stadium['S_NAME'] != 's') | (stadium['S_STADIUMKEY'] != 6) & (stadium['S_LOCATION'] != 'w') & (stadium['S_NAME'] == 's') | (stadium['S_CITY'] != 'a')].groupby(by=['S_STADIUMKEY', 'S_LOCATION', 'S_CAPACITY']).agg('mean', numeric_only=True)

stadium[(stadium['S_NAME'] == 's') | (stadium['S_CITY'] == 'l') & (stadium['S_STADIUMKEY'] > 9)][['S_CAPACITY', 'S_CITY', 'S_LOCATION', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_NAME']]

stadium[(stadium['S_NAME'].str.startswith('s')) | (stadium['S_CITY'] == 'l') & (stadium['S_YEARBUILT'] == 2019) & (stadium['S_NAME'] == 's')][['S_LOCATION', 'S_CAPACITY', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_NAME']]

stadium[(stadium['S_STADIUMKEY'] < 6) | (stadium['S_YEARBUILT'] != 1987) | (stadium['S_CITY'] != 'a') & (stadium['S_NAME'] != 's') & (stadium['S_YEARBUILT'] >= 1979) | (stadium['S_NAME'] != 's')].groupby(by=['S_YEARBUILT', 'S_STADIUMKEY']).agg('min', numeric_only=True)

stadium[(stadium['S_YEARBUILT'] < 1992) | (stadium['S_LOCATION'] != 's') | (stadium['S_CAPACITY'] <= 83098) & (stadium['S_CITY'].str.startswith('r'))].groupby(by=['S_STADIUMKEY', 'S_LOCATION', 'S_NAME', 'S_CITY']).agg('sum', numeric_only=True)

stadium[(stadium['S_YEARBUILT'] <= 2002) & (stadium['S_YEARBUILT'] > 1973) | (stadium['S_NAME'].str.startswith('s'))].groupby(by=['S_CITY', 'S_NAME', 'S_STADIUMKEY', 'S_CAPACITY', 'S_YEARBUILT']).agg('max', numeric_only=True)

stadium[['S_STADIUMKEY', 'S_CITY', 'S_YEARBUILT', 'S_CAPACITY']].groupby(by=['S_CITY', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_CAPACITY']).agg('min', numeric_only=True)

stadium[['S_YEARBUILT', 'S_LOCATION', 'S_STADIUMKEY', 'S_CAPACITY']].groupby(by=['S_CAPACITY', 'S_STADIUMKEY', 'S_YEARBUILT', 'S_LOCATION']).agg('sum', numeric_only=True)

team[(team['T_GROUP'] != 'b') & (team['T_GROUP'].isin(['g', 'f', 'b', 'a', 'e']))][['T_GROUP', 'T_TEAMKEY']].groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('max', numeric_only=True)

team[(team['T_GROUP'] != 'g') & (team['T_GROUP'].isin(['b', 'h', 'g', 'a', 'd', 'e', 'c', 'f']))][['T_PLAYERCOUNT', 'T_GROUP']].groupby(by=['T_PLAYERCOUNT', 'T_GROUP']).agg('sum', numeric_only=True)

team[(team['T_GROUP'] == 'd') | (team['T_GROUP'].isin(['a', 'e', 'h', 'g', 'f', 'b', 'c', 'd']))][['T_GROUP', 'T_TEAMKEY']].groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('sum', numeric_only=True)

team[(team['T_PLAYERCOUNT'] <= 18) | (team['T_TEAMKEY'] != 't')][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']].groupby(by=['T_TEAMKEY']).agg('sum', numeric_only=True)

team[(team['T_PLAYERCOUNT'] > 22) & (team['T_PLAYERCOUNT'] < 22)][['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']].groupby(by=['T_GROUP']).agg('sum', numeric_only=True)

team[(team['T_PLAYERCOUNT'] >= 20) & (team['T_TEAMKEY'] == 't')][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']].groupby(by=['T_TEAMKEY']).agg('sum', numeric_only=True)

association.merge(team[(team['T_GROUP'] != 'h') | (team['T_PLAYERCOUNT'] != 19)][['T_GROUP', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('count')

association.merge(team[(team['T_GROUP'].isin(['g'])) | (team['T_PLAYERCOUNT'] == 19) | (team['T_PLAYERCOUNT'] == 22)], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']).agg('max', numeric_only=True)

association.merge(team[(team['T_PLAYERCOUNT'] >= 21) & (team['T_PLAYERCOUNT'] <= 22) | (team['T_PLAYERCOUNT'] >= 25)], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('min', numeric_only=True)

association.merge(team[(team['T_TEAMKEY'] != 't') & (team['T_TEAMKEY'] != 't') & (team['T_PLAYERCOUNT'] >= 24)], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('max', numeric_only=True)

association.merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('sum', numeric_only=True)

association[(association['A_FOUNDEDYEAR'] == 1929) | (association['A_FOUNDEDYEAR'] >= 1930)].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']).agg('sum', numeric_only=True)

association[['A_ASSOCKEY', 'A_TEAMKEY', 'A_FOUNDEDYEAR']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('sum', numeric_only=True)

association[['A_FOUNDEDYEAR', 'A_TEAMKEY', 'A_ASSOCKEY', 'A_PRESIDENT']].merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_TEAMKEY', 'A_PRESIDENT']].merge(team[(team['T_TEAMKEY'] == 't')][['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_TEAMKEY']].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT']).agg('mean', numeric_only=True)

association[['A_TEAMKEY']].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('sum', numeric_only=True)

coach.merge(team[(team['T_TEAMKEY'] != 't') | (team['T_PLAYERCOUNT'] <= 20)][['T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('sum', numeric_only=True)

coach.merge(team[(team['T_TEAMKEY'] == 't') | (team['T_TEAMKEY'] != 't')][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT']).agg('sum', numeric_only=True)

coach.merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('min', numeric_only=True)

coach.merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

coach[(coach['C_NAME'].str.startswith('c')) & (coach['C_TEAMKEY'] == 't') & (coach['C_EXPYEARS'] == 13) & (coach['C_EXPYEARS'] > 37)].groupby(by=['C_NAME', 'C_EXPYEARS', 'C_ROLE', 'C_TEAMKEY', 'C_COACHKEY']).agg('min', numeric_only=True)

coach[(coach['C_ROLE'].isin(['goalkeeper coach', 'head coach', 'fitness coach', 'assistant coach']))][['C_COACHKEY', 'C_NAME', 'C_EXPYEARS']].groupby(by=['C_COACHKEY', 'C_NAME', 'C_EXPYEARS']).agg('min', numeric_only=True)

coach[(coach['C_TEAMKEY'] != 't') | (coach['C_COACHKEY'] <= 12) & (coach['C_NAME'] == 'c') | (coach['C_EXPYEARS'] != 30) & (coach['C_COACHKEY'] > 28)].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_COACHKEY', 'C_TEAMKEY', 'C_ROLE']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('count')

coach[['C_NAME', 'C_TEAMKEY']].merge(team[(team['T_TEAMKEY'] == 't')], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT']).agg('sum', numeric_only=True)

coach[['C_TEAMKEY']].merge(team[(team['T_GROUP'].isin(['b', 'd', 'c'])) & (team['T_PLAYERCOUNT'] >= 20) & (team['T_GROUP'].isin(['g', 'd', 'f', 'e', 'h', 'a', 'b']))][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

match.merge(stadium[['S_CAPACITY', 'S_CITY', 'S_LOCATION', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_LOCATION', 'S_STADIUMKEY']).agg('max', numeric_only=True)

match.merge(team[(team['T_GROUP'].isin(['e', 'g', 'd', 'c', 'h', 'b'])) & (team['T_GROUP'].isin(['h'])) | (team['T_PLAYERCOUNT'] == 24)], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('sum', numeric_only=True)

match.merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']).agg('min', numeric_only=True)

match[(match['M_MATCHKEY'] > 46) & (match['M_SCORE1'] > 5)].merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']).agg('min', numeric_only=True)

match[(match['M_TEAM2KEY'] == 't') | (match['M_ROUND'] == 'round of 16') & (match['M_DATE'] < '2022-11-20') | (match['M_ATTENDANCE'] <= 33197) | (match['M_ATTENDANCE'] <= 72544) & (match['M_SCORE1'] <= 1) | (match['M_DURATION'] < 143) | (match['M_MATCHKEY'] >= 61)].merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_TIME'].str.startswith('2'))].merge(team[(team['T_TEAMKEY'] == 't')], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('sum', numeric_only=True)

match[['M_MATCHKEY', 'M_ATTENDANCE', 'M_SCORE1', 'M_TEAM1KEY', 'M_STADIUMKEY', 'M_ROUND', 'M_TEAM2KEY']].groupby(by=['M_MATCHKEY', 'M_SCORE1']).agg('min', numeric_only=True)

match[['M_STADIUMKEY', 'M_TEAM2KEY', 'M_TIME', 'M_ROUND', 'M_DURATION']].groupby(by=['M_TIME', 'M_TEAM2KEY', 'M_ROUND', 'M_STADIUMKEY']).agg('max', numeric_only=True)

match[['M_TEAM1KEY', 'M_DURATION', 'M_TIME']].merge(team[(team['T_GROUP'] == 'd')][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

stadium[(stadium['S_CITY'] != 'r') | (stadium['S_YEARBUILT'] >= 1973) | (stadium['S_STADIUMKEY'] == 1) & (stadium['S_CITY'] != 'a') & (stadium['S_LOCATION'].str.startswith('s'))][['S_LOCATION', 'S_STADIUMKEY', 'S_YEARBUILT', 'S_CITY', 'S_NAME']]

stadium[(stadium['S_CITY'].str.startswith('d')) | (stadium['S_CITY'].str.startswith('r')) | (stadium['S_LOCATION'] != 'c') | (stadium['S_CAPACITY'] > 83018) & (stadium['S_YEARBUILT'] >= 1982)][['S_CITY', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_LOCATION', 'S_CAPACITY']]

stadium[(stadium['S_STADIUMKEY'] > 11) | (stadium['S_STADIUMKEY'] != 6) & (stadium['S_LOCATION'] != 'n') | (stadium['S_NAME'] != 's') & (stadium['S_CITY'].str.startswith('l'))].groupby(by=['S_CITY', 'S_YEARBUILT', 'S_NAME', 'S_STADIUMKEY']).agg('sum', numeric_only=True)

stadium[(stadium['S_STADIUMKEY'] > 2) | (stadium['S_NAME'] == 's') | (stadium['S_YEARBUILT'] < 2016) | (stadium['S_YEARBUILT'] == 1998)][['S_YEARBUILT', 'S_STADIUMKEY', 'S_NAME', 'S_CITY', 'S_LOCATION', 'S_CAPACITY']]

stadium[(stadium['S_YEARBUILT'] <= 1969) | (stadium['S_CITY'] == 'a') | (stadium['S_STADIUMKEY'] < 3) | (stadium['S_LOCATION'] != 'w')].groupby(by=['S_STADIUMKEY', 'S_YEARBUILT', 'S_CITY', 'S_CAPACITY', 'S_LOCATION']).agg('max', numeric_only=True)

stadium[['S_CITY', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_LOCATION', 'S_NAME', 'S_CAPACITY']].groupby(by=['S_LOCATION', 'S_NAME', 'S_STADIUMKEY']).agg('max', numeric_only=True)

stadium[['S_YEARBUILT', 'S_STADIUMKEY', 'S_NAME', 'S_CITY', 'S_LOCATION', 'S_CAPACITY']].groupby(by=['S_LOCATION', 'S_NAME', 'S_YEARBUILT']).agg('min', numeric_only=True)

team[(team['T_GROUP'] != 'd')][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']].groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('min', numeric_only=True)

team[(team['T_GROUP'] == 'c') | (team['T_TEAMKEY'] != 't') & (team['T_PLAYERCOUNT'] == 19)][['T_TEAMKEY', 'T_PLAYERCOUNT']].groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY']).agg('max', numeric_only=True)

team[(team['T_GROUP'] == 'g') | (team['T_PLAYERCOUNT'] <= 22)][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']].groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('mean', numeric_only=True)

team[(team['T_TEAMKEY'] == 't')][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']].groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('sum', numeric_only=True)

association.merge(team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_GROUP'].isin(['e', 'b', 'f', 'd'])) & (team['T_PLAYERCOUNT'] == 21)][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('mean', numeric_only=True)

association[(association['A_ASSOCKEY'] != 'f') | (association['A_FOUNDEDYEAR'] == 1928) & (association['A_ASSOCKEY'].str.startswith('f'))][['A_TEAMKEY', 'A_FOUNDEDYEAR']].merge(team[(team['T_PLAYERCOUNT'] == 23)], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_FOUNDEDYEAR'] != 1984) | (association['A_FOUNDEDYEAR'] < 1995) | (association['A_TEAMKEY'].str.startswith('t'))][['A_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] <= 23) | (team['T_GROUP'] != 'g')], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_FOUNDEDYEAR'] < 1970) | (association['A_PRESIDENT'] != 'p')].merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('min', numeric_only=True)

association[(association['A_FOUNDEDYEAR'] == 1968) | (association['A_ASSOCKEY'] == 'f') & (association['A_FOUNDEDYEAR'] < 1930) & (association['A_PRESIDENT'] != 'p')][['A_ASSOCKEY', 'A_TEAMKEY', 'A_PRESIDENT']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_PRESIDENT'] == 'p') | (association['A_ASSOCKEY'] != 'f') | (association['A_PRESIDENT'].str.startswith('p'))][['A_PRESIDENT', 'A_ASSOCKEY', 'A_FOUNDEDYEAR', 'A_TEAMKEY']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_PRESIDENT'].str.startswith('p')) | (association['A_FOUNDEDYEAR'] != 1920)].merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP']).agg('max', numeric_only=True)

association[(association['A_PRESIDENT'].str.startswith('p')) | (association['A_TEAMKEY'] == 't') | (association['A_TEAMKEY'] != 't') | (association['A_TEAMKEY'] != 't')][['A_ASSOCKEY', 'A_FOUNDEDYEAR']].groupby(by=['A_ASSOCKEY', 'A_FOUNDEDYEAR']).agg('min', numeric_only=True)

association[(association['A_TEAMKEY'].str.startswith('t')) & (association['A_ASSOCKEY'] != 'f') | (association['A_PRESIDENT'] == 'p')][['A_PRESIDENT', 'A_ASSOCKEY', 'A_FOUNDEDYEAR', 'A_TEAMKEY']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_TEAMKEY'].str.startswith('t')) & (association['A_TEAMKEY'] == 't') | (association['A_ASSOCKEY'] != 'f') | (association['A_PRESIDENT'] == 'p')].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('mean', numeric_only=True)

association[['A_PRESIDENT', 'A_TEAMKEY', 'A_FOUNDEDYEAR', 'A_ASSOCKEY']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

association[['A_TEAMKEY', 'A_FOUNDEDYEAR', 'A_ASSOCKEY']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']).agg('sum', numeric_only=True)

association[['A_TEAMKEY', 'A_PRESIDENT', 'A_ASSOCKEY', 'A_FOUNDEDYEAR']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('count')

association[['A_TEAMKEY', 'A_PRESIDENT', 'A_FOUNDEDYEAR']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']).agg('count')

association[['A_TEAMKEY']].merge(team[(team['T_GROUP'].isin(['g', 'c', 'b', 'a', 'd', 'h', 'e'])) & (team['T_PLAYERCOUNT'] != 25) | (team['T_PLAYERCOUNT'] >= 20)][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] == 18) | (team['T_TEAMKEY'] == 't') | (team['T_PLAYERCOUNT'] > 20)][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[(team['T_GROUP'] != 'b') | (team['T_PLAYERCOUNT'] < 25)][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('min', numeric_only=True)

coach.merge(team[(team['T_GROUP'] == 'b') & (team['T_PLAYERCOUNT'] != 23) | (team['T_GROUP'] != 'a')][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('max', numeric_only=True)

coach.merge(team[(team['T_GROUP'].isin(['d'])) | (team['T_PLAYERCOUNT'] >= 22) | (team['T_GROUP'] != 'b')][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('max', numeric_only=True)

coach[(coach['C_COACHKEY'] == 5) & (coach['C_TEAMKEY'] == 't') | (coach['C_COACHKEY'] <= 6) & (coach['C_ROLE'] == 'head coach') & (coach['C_NAME'].str.startswith('c'))].merge(team[['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_COACHKEY'] > 85) & (coach['C_ROLE'] == 'head coach') | (coach['C_NAME'].str.startswith('c')) & (coach['C_TEAMKEY'] == 't') & (coach['C_TEAMKEY'] != 't')].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('count')

coach[(coach['C_EXPYEARS'] <= 1) & (coach['C_EXPYEARS'] == 17) & (coach['C_EXPYEARS'] > 33) & (coach['C_ROLE'] == 'goalkeeper coach') | (coach['C_EXPYEARS'] < 29)].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP']).agg('min', numeric_only=True)

coach[(coach['C_ROLE'] != 'head coach') & (coach['C_TEAMKEY'] == 't') & (coach['C_EXPYEARS'] > 20) | (coach['C_ROLE'].isin(['assistant coach', 'goalkeeper coach'])) | (coach['C_TEAMKEY'].str.startswith('t'))].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_TEAMKEY'] == 't') & (coach['C_NAME'] != 'c') | (coach['C_NAME'].str.startswith('c')) | (coach['C_COACHKEY'] > 86)].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('mean', numeric_only=True)

coach[(coach['C_TEAMKEY'].str.startswith('t')) & (coach['C_ROLE'] == 'head coach') | (coach['C_ROLE'] == 'fitness coach') | (coach['C_ROLE'] != 'fitness coach') & (coach['C_TEAMKEY'] == 't')].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP']).agg('mean', numeric_only=True)

coach[['C_EXPYEARS', 'C_COACHKEY', 'C_ROLE', 'C_NAME', 'C_TEAMKEY']].groupby(by=['C_ROLE', 'C_NAME', 'C_COACHKEY', 'C_TEAMKEY', 'C_EXPYEARS']).agg('count')

coach[['C_NAME', 'C_TEAMKEY']].merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('max', numeric_only=True)

coach[['C_NAME', 'C_TEAMKEY']].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT']).agg('mean', numeric_only=True)

match.merge(team[(team['T_GROUP'] != 'h')][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

match[(match['M_ATTENDANCE'] < 82852) | (match['M_STADIUMKEY'] == 3) & (match['M_SCORE1'] == 4)][['M_TEAM1KEY']].merge(team[(team['T_GROUP'].isin(['e'])) | (team['T_PLAYERCOUNT'] <= 23)], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[(match['M_ATTENDANCE'] == 75667) | (match['M_ROUND'] != 'final') | (match['M_ROUND'] == 'final') & (match['M_MATCHKEY'] <= 13) & (match['M_SCORE2'] < 4) & (match['M_TEAM2KEY'] == 't') & (match['M_TIME'] == '1') & (match['M_SCORE1'] == 5) & (match['M_TEAM2KEY'] != 't')].merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_DATE'] >= '2022-12-18') & (match['M_ROUND'] != 'group stage') | (match['M_SCORE2'] < 1) | (match['M_TIME'].str.startswith('2')) & (match['M_STADIUMKEY'] == 7)].merge(stadium[(stadium['S_CITY'] == 'r') | (stadium['S_NAME'] == 's') & (stadium['S_STADIUMKEY'] < 3)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_MATCHKEY'] == 54) | (match['M_TEAM1KEY'] == 't') | (match['M_STADIUMKEY'] != 7) & (match['M_ATTENDANCE'] > 70176) | (match['M_DURATION'] != 141) | (match['M_DURATION'] == 112) & (match['M_TEAM2KEY'].str.startswith('t')) & (match['M_TEAM2KEY'] == 't') & (match['M_TEAM1KEY'] == 't')].merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_ROUND'] != 'round of 16') & (match['M_TEAM2KEY'].str.startswith('t')) & (match['M_ROUND'] == 'semi-final') & (match['M_STADIUMKEY'] == 1) & (match['M_TEAM1KEY'].str.startswith('t')) & (match['M_SCORE2'] > 0)].merge(team[(team['T_TEAMKEY'] == 't') | (team['T_TEAMKEY'] != 't')], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[(match['M_SCORE1'] >= 0) & (match['M_ROUND'] == 'quarter-final') | (match['M_TEAM2KEY'] == 't') & (match['M_DATE'] == '2022-12-18') & (match['M_DURATION'] >= 102)].merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP']).agg('count')

match[(match['M_STADIUMKEY'] < 8) & (match['M_ATTENDANCE'] >= 50614) | (match['M_DURATION'] >= 100)].merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('max', numeric_only=True)

match[(match['M_TIME'] == '2') & (match['M_DURATION'] < 140) & (match['M_ROUND'] != 'round of 16') & (match['M_SCORE1'] == 3) | (match['M_STADIUMKEY'] == 2) & (match['M_STADIUMKEY'] >= 5) & (match['M_SCORE2'] < 1)].groupby(by=['M_SCORE2', 'M_ROUND', 'M_TEAM2KEY']).agg('sum', numeric_only=True)

match[['M_ATTENDANCE', 'M_TIME', 'M_SCORE1', 'M_STADIUMKEY', 'M_ROUND', 'M_MATCHKEY', 'M_DATE', 'M_DURATION', 'M_TEAM1KEY']].merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[['M_SCORE2', 'M_ATTENDANCE', 'M_SCORE1', 'M_TEAM1KEY', 'M_STADIUMKEY']].merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

stadium[(stadium['S_CITY'] == 'r') | (stadium['S_CITY'] != 'l') & (stadium['S_CITY'] != 'l') & (stadium['S_CAPACITY'] <= 76825) | (stadium['S_LOCATION'] != 'c')][['S_CAPACITY', 'S_CITY', 'S_LOCATION', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_NAME']]

stadium[['S_CAPACITY', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_LOCATION', 'S_NAME', 'S_CITY']].groupby(by=['S_LOCATION', 'S_CITY', 'S_YEARBUILT', 'S_STADIUMKEY']).agg('sum', numeric_only=True)

stadium[['S_STADIUMKEY', 'S_CAPACITY', 'S_LOCATION', 'S_CITY', 'S_YEARBUILT', 'S_NAME']].groupby(by=['S_YEARBUILT', 'S_CAPACITY', 'S_STADIUMKEY', 'S_NAME']).agg('min', numeric_only=True)

team[(team['T_PLAYERCOUNT'] <= 24) & (team['T_PLAYERCOUNT'] > 18)][['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']].groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']).agg('mean', numeric_only=True)

team[(team['T_PLAYERCOUNT'] == 21) | (team['T_GROUP'].isin(['f', 'b', 'e']))][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']].groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']).agg('mean', numeric_only=True)

team[(team['T_PLAYERCOUNT'] == 24) | (team['T_GROUP'] == 'd')][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']].groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('count')

team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_GROUP'] != 'b') & (team['T_TEAMKEY'] != 't')][['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']].groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('count')

association.merge(team[(team['T_PLAYERCOUNT'] != 18) & (team['T_PLAYERCOUNT'] >= 19) | (team['T_TEAMKEY'] != 't')][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('mean', numeric_only=True)

association.merge(team[(team['T_TEAMKEY'].str.startswith('t')) | (team['T_GROUP'].isin(['h', 'g', 'f', 'a', 'e', 'b', 'c', 'd'])) & (team['T_TEAMKEY'] == 't')][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('count')

association[(association['A_ASSOCKEY'].str.startswith('f'))].merge(team[(team['T_GROUP'] != 'h') & (team['T_TEAMKEY'].str.startswith('t')) & (team['T_TEAMKEY'] == 't')], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('mean', numeric_only=True)

association[(association['A_FOUNDEDYEAR'] > 1913) & (association['A_TEAMKEY'].str.startswith('t')) | (association['A_TEAMKEY'] != 't')].merge(team[(team['T_TEAMKEY'] != 't') & (team['T_TEAMKEY'] != 't')][['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_FOUNDEDYEAR'] > 1958) | (association['A_ASSOCKEY'] != 'f')].merge(team[['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP']).agg('sum', numeric_only=True)

association[(association['A_PRESIDENT'] != 'p') | (association['A_FOUNDEDYEAR'] < 1938) & (association['A_ASSOCKEY'].str.startswith('f')) & (association['A_PRESIDENT'] == 'p')].merge(team[(team['T_PLAYERCOUNT'] != 22)], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('count')

association[(association['A_PRESIDENT'] == 'p') | (association['A_TEAMKEY'] == 't') & (association['A_FOUNDEDYEAR'] != 1912)].merge(team[(team['T_GROUP'] == 'd') & (team['T_PLAYERCOUNT'] != 23)][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_TEAMKEY'] == 't') & (association['A_TEAMKEY'].str.startswith('t')) | (association['A_ASSOCKEY'] == 'f') & (association['A_FOUNDEDYEAR'] <= 1961)].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']).agg('count')

association[['A_ASSOCKEY', 'A_FOUNDEDYEAR', 'A_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] <= 21) & (team['T_PLAYERCOUNT'] == 21) | (team['T_PLAYERCOUNT'] == 25)][['T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_TEAMKEY', 'A_ASSOCKEY', 'A_FOUNDEDYEAR']].merge(team[(team['T_TEAMKEY'] != 't')], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('count')

coach.merge(team[(team['T_GROUP'].isin(['h', 'e', 'b', 'd', 'g'])) | (team['T_PLAYERCOUNT'] >= 23) & (team['T_TEAMKEY'] == 't')][['T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('min', numeric_only=True)

coach.merge(team[(team['T_PLAYERCOUNT'] < 20)][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('min', numeric_only=True)

coach[(coach['C_COACHKEY'] >= 51) | (coach['C_TEAMKEY'].str.startswith('t')) & (coach['C_COACHKEY'] < 60) | (coach['C_ROLE'].isin(['head coach', 'assistant coach', 'fitness coach']))].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('min', numeric_only=True)

coach[(coach['C_NAME'] != 'c') & (coach['C_COACHKEY'] > 7)].merge(team[(team['T_PLAYERCOUNT'] >= 18) | (team['T_GROUP'].isin(['d', 'a', 'g'])) | (team['T_PLAYERCOUNT'] >= 22)][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_TEAMKEY'] == 't')].merge(team[(team['T_TEAMKEY'] == 't')][['T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP']).agg('min', numeric_only=True)

coach[['C_COACHKEY', 'C_EXPYEARS', 'C_TEAMKEY', 'C_NAME']].merge(team[(team['T_PLAYERCOUNT'] == 25) | (team['T_PLAYERCOUNT'] <= 24)][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_COACHKEY', 'C_NAME', 'C_TEAMKEY', 'C_EXPYEARS']].merge(team[(team['T_TEAMKEY'] != 't')], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('count')

coach[['C_TEAMKEY', 'C_COACHKEY', 'C_ROLE']].merge(team[(team['T_GROUP'] == 'h') | (team['T_GROUP'].isin(['f'])) | (team['T_GROUP'] == 'c')][['T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_TEAMKEY', 'C_EXPYEARS']].merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('count')

match.merge(stadium[(stadium['S_CAPACITY'] < 76923) | (stadium['S_CAPACITY'] >= 54690) & (stadium['S_LOCATION'] == 'c') | (stadium['S_CITY'] == 'a')][['S_LOCATION', 'S_CITY', 'S_STADIUMKEY', 'S_CAPACITY', 'S_NAME', 'S_YEARBUILT']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match.merge(stadium[(stadium['S_STADIUMKEY'] <= 1) | (stadium['S_CITY'] != 'a') | (stadium['S_CAPACITY'] >= 75860)][['S_STADIUMKEY', 'S_NAME']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_STADIUMKEY', 'S_NAME']).agg('min', numeric_only=True)

match.merge(team[(team['T_PLAYERCOUNT'] > 25) | (team['T_TEAMKEY'].str.startswith('t'))][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP']).agg('mean', numeric_only=True)

match[(match['M_DATE'] != '2022-11-20') | (match['M_TEAM2KEY'] == 't') & (match['M_TEAM2KEY'] != 't') | (match['M_MATCHKEY'] > 8) | (match['M_DATE'] < '2022-12-18') | (match['M_SCORE1'] > 0) | (match['M_ROUND'] != 'group stage')][['M_DATE']].groupby(by=['M_DATE']).agg('max', numeric_only=True)

match[(match['M_DATE'] <= '2022-12-18') & (match['M_MATCHKEY'] <= 8) & (match['M_ROUND'] == 'quarter-final') | (match['M_STADIUMKEY'] < 11) & (match['M_ROUND'] == 'semi-final')].merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('mean', numeric_only=True)

match[(match['M_DURATION'] >= 96) & (match['M_DURATION'] >= 135)].merge(team[(team['T_TEAMKEY'] == 't')], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']).agg('min', numeric_only=True)

match[(match['M_TEAM1KEY'] == 't') & (match['M_TIME'].str.startswith('1')) & (match['M_SCORE2'] <= 3) & (match['M_DATE'] == '2022-12-18') | (match['M_MATCHKEY'] < 47) & (match['M_ROUND'] != 'group stage')].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[['M_ATTENDANCE', 'M_DURATION', 'M_ROUND', 'M_TEAM2KEY', 'M_DATE', 'M_TEAM1KEY', 'M_SCORE1', 'M_STADIUMKEY', 'M_SCORE2', 'M_TIME']].merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[['M_DATE', 'M_TEAM1KEY', 'M_ATTENDANCE', 'M_ROUND', 'M_MATCHKEY']].merge(team[(team['T_TEAMKEY'] != 't')][['T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[['M_DATE', 'M_TEAM1KEY', 'M_STADIUMKEY', 'M_TEAM2KEY', 'M_ATTENDANCE', 'M_MATCHKEY', 'M_ROUND', 'M_SCORE1']].merge(stadium[(stadium['S_LOCATION'].str.startswith('n'))], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[['M_SCORE2', 'M_ROUND', 'M_STADIUMKEY', 'M_TEAM2KEY', 'M_MATCHKEY', 'M_TEAM1KEY']].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[['M_TIME', 'M_ATTENDANCE', 'M_ROUND', 'M_DATE', 'M_SCORE1', 'M_TEAM2KEY']].merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('mean', numeric_only=True)

stadium[(stadium['S_LOCATION'].str.startswith('n')) | (stadium['S_STADIUMKEY'] <= 1) & (stadium['S_LOCATION'] == 'w') & (stadium['S_CITY'] == 'r') | (stadium['S_NAME'] == 's') & (stadium['S_LOCATION'].str.startswith('w'))][['S_CITY', 'S_NAME']].groupby(by=['S_CITY']).agg('min', numeric_only=True)

stadium[(stadium['S_YEARBUILT'] != 2010) | (stadium['S_YEARBUILT'] >= 2006) | (stadium['S_CITY'] != 'd') & (stadium['S_YEARBUILT'] < 2007) & (stadium['S_CAPACITY'] > 81082)][['S_LOCATION', 'S_YEARBUILT']].groupby(by=['S_YEARBUILT', 'S_LOCATION']).agg('count')

team[(team['T_GROUP'].isin(['f', 'b', 'g', 'd', 'e', 'h'])) & (team['T_GROUP'] != 'g') & (team['T_PLAYERCOUNT'] != 22)][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']].groupby(by=['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']).agg('mean', numeric_only=True)

association.merge(team[(team['T_TEAMKEY'] != 't') & (team['T_GROUP'].isin(['g', 'd', 'c', 'b', 'f', 'a', 'h'])) | (team['T_PLAYERCOUNT'] < 25)][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP']).agg('min', numeric_only=True)

association[(association['A_ASSOCKEY'].str.startswith('f')) & (association['A_TEAMKEY'] != 't') | (association['A_TEAMKEY'] == 't')].merge(team[['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT']).agg('max', numeric_only=True)

association[(association['A_ASSOCKEY'].str.startswith('f'))][['A_TEAMKEY', 'A_PRESIDENT', 'A_ASSOCKEY', 'A_FOUNDEDYEAR']].merge(team[['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_FOUNDEDYEAR'] == 1962) | (association['A_ASSOCKEY'] == 'f') & (association['A_ASSOCKEY'].str.startswith('f')) & (association['A_PRESIDENT'] == 'p')][['A_ASSOCKEY', 'A_PRESIDENT', 'A_TEAMKEY']].merge(team[(team['T_TEAMKEY'] == 't')], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_PRESIDENT'] == 'p') & (association['A_ASSOCKEY'] == 'f') | (association['A_FOUNDEDYEAR'] >= 1937) | (association['A_TEAMKEY'] == 't')][['A_FOUNDEDYEAR', 'A_ASSOCKEY', 'A_PRESIDENT']].groupby(by=['A_ASSOCKEY', 'A_PRESIDENT', 'A_FOUNDEDYEAR']).agg('min', numeric_only=True)

association[(association['A_PRESIDENT'].str.startswith('p'))].merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('count')

association[(association['A_TEAMKEY'] != 't') | (association['A_TEAMKEY'].str.startswith('t')) & (association['A_FOUNDEDYEAR'] == 1906) | (association['A_ASSOCKEY'].str.startswith('f'))].merge(team[(team['T_PLAYERCOUNT'] > 22) | (team['T_TEAMKEY'].str.startswith('t'))], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP']).agg('min', numeric_only=True)

association[(association['A_TEAMKEY'] == 't') & (association['A_ASSOCKEY'] == 'f') & (association['A_FOUNDEDYEAR'] >= 1919)].merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('max', numeric_only=True)

association[(association['A_TEAMKEY'] == 't') & (association['A_PRESIDENT'].str.startswith('p')) | (association['A_FOUNDEDYEAR'] == 1997)].merge(team[(team['T_TEAMKEY'] == 't')], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']).agg('max', numeric_only=True)

association[(association['A_TEAMKEY'].str.startswith('t')) | (association['A_TEAMKEY'].str.startswith('t')) | (association['A_FOUNDEDYEAR'] <= 1926)].merge(team[(team['T_TEAMKEY'] == 't')], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']).agg('max', numeric_only=True)

association[(association['A_TEAMKEY'].str.startswith('t'))].merge(team[(team['T_GROUP'].isin(['d', 'h', 'e', 'g']))][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('count')

association[['A_PRESIDENT', 'A_ASSOCKEY', 'A_FOUNDEDYEAR', 'A_TEAMKEY']].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('sum', numeric_only=True)

association[['A_PRESIDENT', 'A_TEAMKEY', 'A_ASSOCKEY', 'A_FOUNDEDYEAR']].merge(team[(team['T_PLAYERCOUNT'] > 21) & (team['T_GROUP'] == 'f')], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('count')

coach[(coach['C_COACHKEY'] >= 24) & (coach['C_EXPYEARS'] > 4) & (coach['C_TEAMKEY'] == 't')][['C_NAME', 'C_EXPYEARS', 'C_COACHKEY', 'C_ROLE', 'C_TEAMKEY']].groupby(by=['C_ROLE', 'C_TEAMKEY']).agg('sum', numeric_only=True)

coach[(coach['C_COACHKEY'] >= 43) | (coach['C_TEAMKEY'] != 't')].merge(team[(team['T_PLAYERCOUNT'] != 20)][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT']).agg('mean', numeric_only=True)

coach[(coach['C_EXPYEARS'] < 37)][['C_TEAMKEY']].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('sum', numeric_only=True)

coach[(coach['C_NAME'] == 'c') & (coach['C_ROLE'].isin(['fitness coach', 'goalkeeper coach', 'assistant coach'])) | (coach['C_COACHKEY'] > 22) & (coach['C_NAME'] == 'c') & (coach['C_NAME'] != 'c')][['C_NAME', 'C_COACHKEY', 'C_TEAMKEY', 'C_ROLE']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_ROLE'].isin(['head coach', 'goalkeeper coach', 'assistant coach', 'fitness coach'])) | (coach['C_ROLE'] != 'fitness coach') & (coach['C_ROLE'] == 'head coach') & (coach['C_COACHKEY'] != 27) | (coach['C_COACHKEY'] == 32)].merge(team[(team['T_TEAMKEY'] != 't')][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_NAME', 'C_COACHKEY', 'C_TEAMKEY', 'C_ROLE']].merge(team[(team['T_TEAMKEY'] != 't') & (team['T_TEAMKEY'] == 't') & (team['T_TEAMKEY'] == 't')][['T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

match[(match['M_DURATION'] < 113) & (match['M_ROUND'].isin(['final', 'round of 16'])) | (match['M_ATTENDANCE'] == 47405) & (match['M_ATTENDANCE'] >= 59424) | (match['M_ATTENDANCE'] < 66482)].merge(team[(team['T_PLAYERCOUNT'] >= 22)][['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[(match['M_DURATION'] == 140) & (match['M_DATE'] < '2022-11-20') & (match['M_SCORE2'] < 3)].merge(team[['T_GROUP', 'T_TEAMKEY']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('count')

match[(match['M_ROUND'] != 'group stage')][['M_ROUND', 'M_TEAM1KEY', 'M_ATTENDANCE', 'M_STADIUMKEY', 'M_TEAM2KEY']].merge(team[(team['T_TEAMKEY'] == 't') & (team['T_GROUP'].isin(['a', 'b', 'g']))], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[(match['M_SCORE1'] == 4) | (match['M_ATTENDANCE'] < 40040) & (match['M_MATCHKEY'] <= 31) | (match['M_DURATION'] <= 125) & (match['M_SCORE1'] <= 0) & (match['M_DURATION'] != 142)][['M_DATE', 'M_ATTENDANCE', 'M_SCORE1']].groupby(by=['M_SCORE1']).agg('min', numeric_only=True)

match[(match['M_TEAM1KEY'] != 't') & (match['M_STADIUMKEY'] != 3) & (match['M_SCORE1'] <= 0)].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('mean', numeric_only=True)

match[(match['M_TIME'].str.startswith('1')) | (match['M_TIME'] != '2') & (match['M_ATTENDANCE'] <= 30719) | (match['M_SCORE2'] != 5) | (match['M_ROUND'].isin(['final', 'quarter-final', 'round of 16', 'group stage', 'semi-final'])) & (match['M_MATCHKEY'] >= 19) | (match['M_DATE'] == '2022-12-18') & (match['M_ROUND'].isin(['round of 16', 'final', 'quarter-final', 'semi-final', 'group stage']))].merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[['M_ATTENDANCE', 'M_TEAM1KEY', 'M_STADIUMKEY']].merge(stadium[(stadium['S_CAPACITY'] == 40601)][['S_CAPACITY', 'S_CITY', 'S_LOCATION', 'S_YEARBUILT', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[['M_DATE', 'M_SCORE2', 'M_STADIUMKEY', 'M_DURATION', 'M_ATTENDANCE']].merge(stadium[['S_CAPACITY', 'S_STADIUMKEY', 'S_LOCATION', 'S_NAME', 'S_CITY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[['M_TEAM1KEY']].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('min', numeric_only=True)

match[['M_TEAM2KEY', 'M_ROUND', 'M_ATTENDANCE']].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('min', numeric_only=True)

stadium[(stadium['S_CAPACITY'] <= 66937) | (stadium['S_LOCATION'].str.startswith('c'))][['S_CAPACITY', 'S_CITY', 'S_NAME', 'S_STADIUMKEY']].groupby(by=['S_CAPACITY', 'S_NAME', 'S_CITY', 'S_STADIUMKEY']).agg('sum', numeric_only=True)

stadium[(stadium['S_LOCATION'] == 'w') | (stadium['S_YEARBUILT'] > 1984) & (stadium['S_STADIUMKEY'] <= 2) | (stadium['S_NAME'] == 's') & (stadium['S_CITY'].str.startswith('d')) & (stadium['S_CITY'] != 'a')][['S_STADIUMKEY', 'S_LOCATION', 'S_NAME']].groupby(by=['S_LOCATION']).agg('sum', numeric_only=True)

stadium[(stadium['S_STADIUMKEY'] > 10) & (stadium['S_CITY'] == 'l') & (stadium['S_YEARBUILT'] >= 1950) | (stadium['S_CITY'] == 'd') | (stadium['S_STADIUMKEY'] >= 3) | (stadium['S_NAME'] != 's')][['S_CAPACITY', 'S_YEARBUILT', 'S_LOCATION']].groupby(by=['S_LOCATION']).agg('mean', numeric_only=True)

association[(association['A_ASSOCKEY'] == 'f')].merge(team[(team['T_GROUP'].isin(['h', 'd', 'e', 'c', 'a'])) | (team['T_GROUP'] == 'e') | (team['T_GROUP'] != 'd')][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('max', numeric_only=True)

association[(association['A_FOUNDEDYEAR'] <= 1958)][['A_FOUNDEDYEAR', 'A_TEAMKEY', 'A_PRESIDENT']].merge(team[(team['T_PLAYERCOUNT'] != 19)][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_FOUNDEDYEAR'] <= 1960) | (association['A_PRESIDENT'].str.startswith('p'))][['A_FOUNDEDYEAR', 'A_ASSOCKEY', 'A_PRESIDENT', 'A_TEAMKEY']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('count')

association[(association['A_FOUNDEDYEAR'] == 1914) | (association['A_FOUNDEDYEAR'] < 1971) & (association['A_ASSOCKEY'] == 'f') | (association['A_FOUNDEDYEAR'] != 1954)].merge(team[(team['T_GROUP'] != 'd') & (team['T_TEAMKEY'] == 't') & (team['T_TEAMKEY'] == 't')][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_FOUNDEDYEAR'] == 1936) | (association['A_TEAMKEY'] == 't') | (association['A_FOUNDEDYEAR'] <= 1903) | (association['A_FOUNDEDYEAR'] < 1900)].merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT']).agg('count')

association[(association['A_PRESIDENT'] != 'p') | (association['A_PRESIDENT'] == 'p') | (association['A_ASSOCKEY'] != 'f') & (association['A_PRESIDENT'].str.startswith('p'))].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY']).agg('max', numeric_only=True)

association[(association['A_PRESIDENT'] == 'p') & (association['A_TEAMKEY'] != 't') | (association['A_FOUNDEDYEAR'] > 1918) & (association['A_ASSOCKEY'].str.startswith('f'))].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('count')

association[(association['A_TEAMKEY'].str.startswith('t'))].merge(team[(team['T_GROUP'] == 'h') & (team['T_TEAMKEY'].str.startswith('t'))][['T_GROUP', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('count')

association[['A_TEAMKEY', 'A_ASSOCKEY']].merge(team[(team['T_PLAYERCOUNT'] >= 25)][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

association[['A_TEAMKEY', 'A_PRESIDENT', 'A_ASSOCKEY', 'A_FOUNDEDYEAR']].merge(team[['T_GROUP', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('mean', numeric_only=True)

association[['A_TEAMKEY', 'A_PRESIDENT', 'A_ASSOCKEY']].merge(team[(team['T_GROUP'].isin(['c', 'g']))][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT']).agg('sum', numeric_only=True)

coach[(coach['C_EXPYEARS'] != 36) & (coach['C_NAME'] == 'c') & (coach['C_ROLE'] == 'assistant coach') | (coach['C_ROLE'] == 'head coach')].merge(team[(team['T_TEAMKEY'] != 't') & (team['T_GROUP'] == 'h') | (team['T_PLAYERCOUNT'] <= 25)][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_ROLE'] != 'head coach')].merge(team[(team['T_GROUP'].isin(['d', 'f', 'g'])) & (team['T_GROUP'].isin(['g', 'c', 'd', 'b', 'a']))][['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT']).agg('count')

coach[(coach['C_ROLE'].isin(['goalkeeper coach'])) | (coach['C_NAME'].str.startswith('c'))][['C_NAME', 'C_TEAMKEY', 'C_ROLE', 'C_EXPYEARS', 'C_COACHKEY']].merge(team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_PLAYERCOUNT'] > 19)], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_NAME', 'C_TEAMKEY', 'C_ROLE', 'C_EXPYEARS', 'C_COACHKEY']].merge(team[(team['T_TEAMKEY'] != 't') & (team['T_GROUP'] == 'f') | (team['T_PLAYERCOUNT'] <= 25)][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_NAME', 'C_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] >= 18) | (team['T_TEAMKEY'] != 't') | (team['T_GROUP'] == 'd')], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('max', numeric_only=True)

match.merge(stadium[(stadium['S_LOCATION'] == 'e') & (stadium['S_CITY'].str.startswith('d')) & (stadium['S_CITY'] != 'l') & (stadium['S_CAPACITY'] >= 40862) | (stadium['S_STADIUMKEY'] != 9) | (stadium['S_NAME'] == 's')][['S_LOCATION', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_LOCATION']).agg('mean', numeric_only=True)

match.merge(stadium[['S_CAPACITY', 'S_CITY', 'S_LOCATION', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_NAME']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_CAPACITY', 'S_NAME', 'S_CITY', 'S_STADIUMKEY']).agg('count')

match.merge(stadium[['S_CAPACITY', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_LOCATION', 'S_NAME']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_YEARBUILT', 'S_CAPACITY', 'S_NAME', 'S_LOCATION', 'S_STADIUMKEY']).agg('mean', numeric_only=True)

match.merge(team[(team['T_TEAMKEY'] != 't') | (team['T_PLAYERCOUNT'] >= 19) | (team['T_PLAYERCOUNT'] == 20)][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

match[(match['M_DATE'] != '2022-11-20') | (match['M_SCORE1'] < 2) & (match['M_STADIUMKEY'] <= 2) | (match['M_MATCHKEY'] != 46) | (match['M_TEAM1KEY'].str.startswith('t')) | (match['M_TIME'].str.startswith('2')) | (match['M_TEAM2KEY'] == 't')].merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY']).agg('min', numeric_only=True)

match[(match['M_ROUND'] != 'quarter-final') | (match['M_SCORE2'] == 0) | (match['M_STADIUMKEY'] == 1) & (match['M_ROUND'] == 'round of 16') & (match['M_TEAM2KEY'].str.startswith('t')) & (match['M_DURATION'] < 115) & (match['M_DATE'] == '2022-12-18') & (match['M_DATE'] <= '2022-12-18')][['M_SCORE1', 'M_STADIUMKEY']].groupby(by=['M_STADIUMKEY']).agg('sum', numeric_only=True)

match[(match['M_SCORE1'] != 0) | (match['M_ATTENDANCE'] >= 89588)][['M_DATE', 'M_STADIUMKEY', 'M_SCORE1', 'M_TIME', 'M_MATCHKEY', 'M_SCORE2']].merge(stadium[(stadium['S_NAME'].str.startswith('s'))], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_SCORE1'] != 1) | (match['M_TIME'] != '2') | (match['M_STADIUMKEY'] != 2) & (match['M_TIME'] != '1') & (match['M_DURATION'] <= 118) | (match['M_DURATION'] != 107) & (match['M_STADIUMKEY'] >= 4)].merge(team[(team['T_TEAMKEY'].str.startswith('t'))][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[(match['M_SCORE2'] > 3) | (match['M_DATE'] < '2022-12-18') & (match['M_ATTENDANCE'] != 55081) | (match['M_TIME'] == '2') | (match['M_STADIUMKEY'] >= 8) & (match['M_DATE'] > '2022-12-18') & (match['M_STADIUMKEY'] == 4) | (match['M_TEAM2KEY'] != 't') | (match['M_SCORE1'] == 4) & (match['M_TEAM1KEY'] == 't')].merge(stadium[(stadium['S_CAPACITY'] == 66010)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_SCORE2'] >= 5) & (match['M_DATE'] == '2022-12-18') & (match['M_SCORE1'] < 0) | (match['M_TEAM1KEY'].str.startswith('t')) & (match['M_TEAM1KEY'] != 't') & (match['M_TEAM2KEY'].str.startswith('t')) & (match['M_SCORE2'] == 3) | (match['M_TEAM1KEY'] == 't') & (match['M_STADIUMKEY'] != 7) | (match['M_MATCHKEY'] == 50)].merge(team[(team['T_GROUP'].isin(['e', 'g', 'h', 'a', 'b', 'd', 'c']))], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[(match['M_STADIUMKEY'] >= 11) | (match['M_STADIUMKEY'] < 10) & (match['M_SCORE2'] == 2) | (match['M_STADIUMKEY'] != 5) & (match['M_TEAM1KEY'] == 't') & (match['M_DURATION'] == 101) | (match['M_SCORE1'] < 6)].merge(team[(team['T_PLAYERCOUNT'] != 22)][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[(match['M_TEAM2KEY'] == 't') & (match['M_TEAM2KEY'] == 't') | (match['M_SCORE2'] != 0) & (match['M_STADIUMKEY'] != 2) | (match['M_TEAM1KEY'] != 't') & (match['M_DATE'] != '2022-11-20') | (match['M_TEAM2KEY'] == 't')].merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('mean', numeric_only=True)

match[(match['M_TIME'].str.startswith('2')) | (match['M_STADIUMKEY'] != 4) | (match['M_ROUND'] == 'round of 16')].merge(team[(team['T_PLAYERCOUNT'] != 23) | (team['T_TEAMKEY'] != 't') & (team['T_PLAYERCOUNT'] >= 21)], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP']).agg('max', numeric_only=True)

match[['M_DURATION', 'M_TEAM1KEY', 'M_SCORE1', 'M_ROUND', 'M_TEAM2KEY', 'M_MATCHKEY']].merge(team[(team['T_GROUP'].isin(['e', 'd', 'h', 'b', 'g', 'a', 'f', 'c']))], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP']).agg('sum', numeric_only=True)

match[['M_ROUND', 'M_TEAM2KEY', 'M_DATE', 'M_MATCHKEY', 'M_SCORE1', 'M_ATTENDANCE', 'M_SCORE2', 'M_TIME', 'M_DURATION']].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[['M_SCORE2', 'M_TEAM1KEY']].merge(team[(team['T_TEAMKEY'] == 't')][['T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('max', numeric_only=True)

match[['M_TEAM2KEY']].merge(team[(team['T_TEAMKEY'] != 't') | (team['T_GROUP'].isin(['f']))][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT']).agg('max', numeric_only=True)

association[(association['A_ASSOCKEY'] == 'f') & (association['A_ASSOCKEY'].str.startswith('f')) | (association['A_TEAMKEY'].str.startswith('t'))][['A_FOUNDEDYEAR', 'A_ASSOCKEY', 'A_TEAMKEY', 'A_PRESIDENT']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP']).agg('max', numeric_only=True)

association[(association['A_PRESIDENT'].str.startswith('p'))][['A_ASSOCKEY', 'A_TEAMKEY', 'A_PRESIDENT']].merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP']).agg('count')

association[(association['A_TEAMKEY'] == 't') | (association['A_ASSOCKEY'].str.startswith('f')) & (association['A_FOUNDEDYEAR'] > 1962)].merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('min', numeric_only=True)

association[['A_ASSOCKEY', 'A_TEAMKEY', 'A_FOUNDEDYEAR', 'A_PRESIDENT']].merge(team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_GROUP'] != 'a')], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('count')

coach[(coach['C_COACHKEY'] != 11) & (coach['C_TEAMKEY'] != 't') | (coach['C_EXPYEARS'] <= 3)][['C_NAME', 'C_ROLE', 'C_EXPYEARS', 'C_TEAMKEY', 'C_COACHKEY']].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_COACHKEY'] < 48) | (coach['C_COACHKEY'] >= 70) & (coach['C_NAME'].str.startswith('c'))][['C_NAME', 'C_EXPYEARS', 'C_COACHKEY', 'C_TEAMKEY']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT']).agg('min', numeric_only=True)

coach[(coach['C_EXPYEARS'] >= 11)][['C_EXPYEARS', 'C_TEAMKEY', 'C_COACHKEY']].merge(team[(team['T_TEAMKEY'] == 't') & (team['T_TEAMKEY'] != 't')][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'] == 'c') & (coach['C_TEAMKEY'] == 't') & (coach['C_TEAMKEY'] != 't') & (coach['C_ROLE'].isin(['fitness coach', 'assistant coach']))][['C_COACHKEY', 'C_TEAMKEY', 'C_EXPYEARS']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP']).agg('count')

coach[(coach['C_NAME'].str.startswith('c')) | (coach['C_ROLE'] != 'assistant coach') | (coach['C_NAME'] != 'c') & (coach['C_NAME'].str.startswith('c')) & (coach['C_EXPYEARS'] == 24)][['C_ROLE', 'C_TEAMKEY']].merge(team[(team['T_GROUP'].isin(['c', 'f', 'e', 'a', 'h', 'g'])) | (team['T_PLAYERCOUNT'] != 18) & (team['T_GROUP'].isin(['d', 'g', 'f', 'b']))], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_ROLE'] == 'assistant coach')][['C_TEAMKEY', 'C_NAME', 'C_EXPYEARS']].merge(team[['T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('mean', numeric_only=True)

coach[(coach['C_ROLE'].isin(['assistant coach', 'head coach', 'fitness coach'])) & (coach['C_NAME'] != 'c') & (coach['C_EXPYEARS'] <= 26) | (coach['C_NAME'] != 'c')].merge(team[(team['T_GROUP'].isin(['b', 'e', 'c']))][['T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('sum', numeric_only=True)

coach[(coach['C_TEAMKEY'] == 't') & (coach['C_NAME'].str.startswith('c')) | (coach['C_EXPYEARS'] <= 24)][['C_ROLE', 'C_TEAMKEY']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']).agg('min', numeric_only=True)

coach[(coach['C_TEAMKEY'].str.startswith('t')) | (coach['C_COACHKEY'] >= 36) & (coach['C_ROLE'] != 'assistant coach') & (coach['C_TEAMKEY'].str.startswith('t')) | (coach['C_TEAMKEY'] != 't')].merge(team[(team['T_PLAYERCOUNT'] != 21) | (team['T_TEAMKEY'] == 't') & (team['T_GROUP'] == 'g')][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_NAME', 'C_EXPYEARS', 'C_TEAMKEY']].merge(team[(team['T_GROUP'].isin(['b', 'd', 'g', 'h', 'e', 'f', 'c', 'a'])) | (team['T_PLAYERCOUNT'] <= 25) | (team['T_TEAMKEY'] == 't')], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

coach[['C_NAME', 'C_ROLE', 'C_EXPYEARS', 'C_TEAMKEY', 'C_COACHKEY']].merge(team[['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT']).agg('max', numeric_only=True)

match.merge(stadium[(stadium['S_STADIUMKEY'] < 5) | (stadium['S_CITY'].str.startswith('d')) & (stadium['S_CAPACITY'] <= 53153) | (stadium['S_LOCATION'].str.startswith('n')) | (stadium['S_STADIUMKEY'] != 2) | (stadium['S_CITY'] == 'a')][['S_STADIUMKEY', 'S_CITY', 'S_NAME']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_NAME']).agg('min', numeric_only=True)

match[(match['M_DATE'] != '2022-11-20')].merge(stadium[(stadium['S_STADIUMKEY'] != 6) | (stadium['S_STADIUMKEY'] < 11)][['S_YEARBUILT', 'S_CITY', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_STADIUMKEY', 'S_YEARBUILT']).agg('max', numeric_only=True)

match[(match['M_ROUND'] == 'quarter-final') & (match['M_TEAM1KEY'] == 't')].merge(stadium[['S_LOCATION', 'S_CAPACITY', 'S_STADIUMKEY', 'S_NAME']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_CAPACITY', 'S_STADIUMKEY', 'S_NAME']).agg('max', numeric_only=True)

match[(match['M_ROUND'].isin(['group stage', 'round of 16', 'quarter-final']))][['M_SCORE2', 'M_ATTENDANCE', 'M_ROUND', 'M_TEAM1KEY', 'M_DATE', 'M_TEAM2KEY']].merge(team[(team['T_TEAMKEY'] != 't') | (team['T_TEAMKEY'].str.startswith('t')) & (team['T_PLAYERCOUNT'] > 23)], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[(match['M_TEAM2KEY'].str.startswith('t')) & (match['M_STADIUMKEY'] != 6) & (match['M_ATTENDANCE'] < 87129) | (match['M_STADIUMKEY'] == 9) | (match['M_STADIUMKEY'] >= 11) | (match['M_TIME'] == '2') | (match['M_DURATION'] < 144) & (match['M_ROUND'] != 'final')].merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY']).agg('count')

match[(match['M_TIME'] != '2') & (match['M_DURATION'] > 134) & (match['M_DURATION'] >= 123) | (match['M_DURATION'] <= 107)].merge(team[(team['T_PLAYERCOUNT'] == 23)][['T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('mean', numeric_only=True)

match[['M_SCORE2', 'M_ROUND', 'M_DURATION', 'M_TEAM2KEY', 'M_TEAM1KEY', 'M_STADIUMKEY', 'M_TIME', 'M_MATCHKEY', 'M_ATTENDANCE']].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[['M_TIME', 'M_MATCHKEY', 'M_SCORE1', 'M_TEAM1KEY', 'M_STADIUMKEY']].merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_CITY', 'S_YEARBUILT', 'S_CAPACITY', 'S_STADIUMKEY', 'S_LOCATION']).agg('max', numeric_only=True)

match[['M_TIME', 'M_SCORE2', 'M_STADIUMKEY', 'M_SCORE1', 'M_MATCHKEY', 'M_ATTENDANCE']].merge(stadium[['S_STADIUMKEY', 'S_CITY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_STADIUMKEY']).agg('max', numeric_only=True)

stadium[(stadium['S_CITY'] == 'r') | (stadium['S_YEARBUILT'] > 1964) & (stadium['S_NAME'] != 's')][['S_NAME', 'S_CITY', 'S_STADIUMKEY', 'S_YEARBUILT', 'S_LOCATION', 'S_CAPACITY']].groupby(by=['S_STADIUMKEY', 'S_CITY', 'S_YEARBUILT']).agg('count')

stadium[(stadium['S_NAME'] == 's') | (stadium['S_CAPACITY'] < 53076) & (stadium['S_LOCATION'] != 'n') & (stadium['S_NAME'].str.startswith('s'))][['S_CITY', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_LOCATION', 'S_NAME']].groupby(by=['S_LOCATION', 'S_CITY', 'S_YEARBUILT']).agg('mean', numeric_only=True)

association[(association['A_ASSOCKEY'] == 'f') | (association['A_FOUNDEDYEAR'] == 1930)][['A_TEAMKEY', 'A_PRESIDENT', 'A_FOUNDEDYEAR']].merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('max', numeric_only=True)

association[(association['A_ASSOCKEY'].str.startswith('f')) & (association['A_FOUNDEDYEAR'] == 1986)].merge(team[(team['T_GROUP'] != 'a') & (team['T_GROUP'] != 'e') | (team['T_PLAYERCOUNT'] <= 20)][['T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('count')

association[(association['A_FOUNDEDYEAR'] > 1999) | (association['A_PRESIDENT'] != 'p')].merge(team[(team['T_PLAYERCOUNT'] >= 22) | (team['T_PLAYERCOUNT'] >= 20) & (team['T_PLAYERCOUNT'] < 23)][['T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('mean', numeric_only=True)

association[(association['A_FOUNDEDYEAR'] >= 1996)][['A_TEAMKEY', 'A_FOUNDEDYEAR', 'A_ASSOCKEY']].merge(team[(team['T_TEAMKEY'] != 't') | (team['T_GROUP'].isin(['b', 'd', 'a', 'e', 'h', 'f', 'g', 'c']))], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('sum', numeric_only=True)

association[(association['A_PRESIDENT'] != 'p') | (association['A_PRESIDENT'] == 'p') | (association['A_TEAMKEY'] != 't') & (association['A_FOUNDEDYEAR'] < 1919)].merge(team[(team['T_GROUP'] != 'd')][['T_GROUP', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('sum', numeric_only=True)

coach[(coach['C_EXPYEARS'] < 14)][['C_ROLE', 'C_EXPYEARS', 'C_TEAMKEY']].merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('min', numeric_only=True)

coach[(coach['C_ROLE'].isin(['assistant coach', 'head coach', 'fitness coach'])) & (coach['C_COACHKEY'] > 41) | (coach['C_NAME'] == 'c') & (coach['C_EXPYEARS'] > 5)][['C_NAME', 'C_TEAMKEY', 'C_ROLE', 'C_COACHKEY', 'C_EXPYEARS']].merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_TEAMKEY'] != 't')][['C_NAME', 'C_TEAMKEY', 'C_ROLE', 'C_COACHKEY', 'C_EXPYEARS']].merge(team[(team['T_TEAMKEY'] != 't')][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_COACHKEY', 'C_NAME', 'C_TEAMKEY']].merge(team[(team['T_TEAMKEY'] == 't') & (team['T_TEAMKEY'].str.startswith('t'))][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP']).agg('min', numeric_only=True)

coach[['C_NAME', 'C_TEAMKEY', 'C_EXPYEARS', 'C_ROLE']].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

coach[['C_TEAMKEY', 'C_NAME', 'C_EXPYEARS', 'C_ROLE']].merge(team[(team['T_TEAMKEY'] == 't') | (team['T_PLAYERCOUNT'] <= 21) & (team['T_TEAMKEY'].str.startswith('t'))], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('max', numeric_only=True)

match.merge(stadium[(stadium['S_STADIUMKEY'] <= 6) & (stadium['S_CITY'] != 'a')][['S_CAPACITY', 'S_CITY', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_NAME']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_NAME', 'S_CITY', 'S_CAPACITY', 'S_STADIUMKEY']).agg('max', numeric_only=True)

match[(match['M_DATE'] <= '2022-12-18') & (match['M_TIME'] != '2') | (match['M_ROUND'] != 'semi-final') & (match['M_TIME'] != '2') | (match['M_TIME'].str.startswith('2')) & (match['M_TEAM2KEY'].str.startswith('t')) | (match['M_ROUND'].isin(['round of 16', 'quarter-final']))].merge(team[(team['T_TEAMKEY'] == 't') & (team['T_TEAMKEY'] == 't') & (team['T_TEAMKEY'] == 't')][['T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[(match['M_ROUND'].isin(['semi-final', 'round of 16', 'final'])) & (match['M_MATCHKEY'] < 54)][['M_SCORE2', 'M_SCORE1', 'M_TEAM1KEY', 'M_STADIUMKEY']].merge(stadium[(stadium['S_CAPACITY'] >= 52037)][['S_CAPACITY', 'S_YEARBUILT', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_SCORE2'] < 2) & (match['M_ATTENDANCE'] != 46599)].merge(team[(team['T_PLAYERCOUNT'] > 24)][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']).agg('max', numeric_only=True)

match[(match['M_SCORE2'] > 3) & (match['M_TIME'].str.startswith('1'))].merge(team[(team['T_GROUP'].isin(['h', 'd', 'a', 'b', 'c', 'f', 'g', 'e'])) | (team['T_TEAMKEY'] != 't') & (team['T_PLAYERCOUNT'] != 25)][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY']).agg('max', numeric_only=True)

match[['M_DATE', 'M_STADIUMKEY']].merge(stadium[(stadium['S_NAME'].str.startswith('s')) | (stadium['S_CITY'] == 'r') | (stadium['S_CAPACITY'] <= 43037) | (stadium['S_STADIUMKEY'] > 10)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_CITY', 'S_LOCATION', 'S_CAPACITY', 'S_YEARBUILT']).agg('count')

match[['M_DURATION', 'M_ATTENDANCE', 'M_STADIUMKEY', 'M_SCORE1', 'M_MATCHKEY', 'M_ROUND', 'M_TEAM1KEY', 'M_TIME', 'M_SCORE2']].merge(stadium[(stadium['S_YEARBUILT'] != 2009) & (stadium['S_LOCATION'] == 'e') | (stadium['S_NAME'] == 's') & (stadium['S_CITY'] == 'a')], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[['M_DURATION', 'M_SCORE1', 'M_MATCHKEY', 'M_ATTENDANCE', 'M_TIME', 'M_TEAM2KEY', 'M_DATE']].merge(team[(team['T_TEAMKEY'] != 't')], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY']).agg('count')

match[['M_MATCHKEY', 'M_STADIUMKEY', 'M_SCORE1', 'M_DATE', 'M_TIME', 'M_DURATION', 'M_SCORE2']].merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_YEARBUILT', 'S_STADIUMKEY', 'S_CAPACITY', 'S_LOCATION']).agg('min', numeric_only=True)

match[['M_STADIUMKEY', 'M_TEAM2KEY', 'M_MATCHKEY', 'M_ATTENDANCE', 'M_SCORE2', 'M_ROUND', 'M_DURATION', 'M_DATE', 'M_TIME', 'M_TEAM1KEY']].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

stadium[(stadium['S_CAPACITY'] < 68702) | (stadium['S_NAME'].str.startswith('s')) | (stadium['S_CAPACITY'] > 70315) & (stadium['S_YEARBUILT'] != 1957) | (stadium['S_CAPACITY'] >= 61831)][['S_STADIUMKEY', 'S_YEARBUILT', 'S_NAME', 'S_LOCATION', 'S_CAPACITY', 'S_CITY']].groupby(by=['S_STADIUMKEY', 'S_NAME']).agg('sum', numeric_only=True)

stadium[(stadium['S_CAPACITY'] == 71534) | (stadium['S_STADIUMKEY'] < 3) & (stadium['S_LOCATION'].str.startswith('w')) | (stadium['S_CITY'] == 'd') & (stadium['S_CAPACITY'] != 56379)][['S_LOCATION', 'S_NAME', 'S_CITY', 'S_STADIUMKEY']].groupby(by=['S_LOCATION', 'S_CITY', 'S_STADIUMKEY', 'S_NAME']).agg('count')

stadium[(stadium['S_CAPACITY'] > 74979) | (stadium['S_STADIUMKEY'] >= 9) | (stadium['S_YEARBUILT'] <= 1991) | (stadium['S_CAPACITY'] > 58072)][['S_LOCATION', 'S_STADIUMKEY', 'S_CAPACITY', 'S_YEARBUILT', 'S_CITY', 'S_NAME']].groupby(by=['S_LOCATION', 'S_NAME', 'S_YEARBUILT']).agg('count')

stadium[(stadium['S_YEARBUILT'] < 2007) & (stadium['S_LOCATION'].str.startswith('c')) & (stadium['S_STADIUMKEY'] == 2)][['S_CAPACITY', 'S_CITY', 'S_LOCATION', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_NAME']].groupby(by=['S_STADIUMKEY', 'S_NAME', 'S_YEARBUILT', 'S_CITY']).agg('mean', numeric_only=True)

association[(association['A_FOUNDEDYEAR'] == 1965) & (association['A_PRESIDENT'] == 'p') & (association['A_FOUNDEDYEAR'] <= 1915)][['A_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] > 24) & (team['T_GROUP'].isin(['e', 'a', 'c', 'h', 'g'])) | (team['T_TEAMKEY'] != 't')], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('min', numeric_only=True)

association[(association['A_FOUNDEDYEAR'] > 1995) & (association['A_TEAMKEY'] == 't') | (association['A_TEAMKEY'].str.startswith('t')) & (association['A_TEAMKEY'] == 't')][['A_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] > 21) | (team['T_PLAYERCOUNT'] >= 20)], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('mean', numeric_only=True)

coach[(coach['C_EXPYEARS'] == 8) & (coach['C_EXPYEARS'] == 34) | (coach['C_EXPYEARS'] < 11) & (coach['C_NAME'] == 'c')][['C_NAME', 'C_EXPYEARS', 'C_ROLE', 'C_COACHKEY', 'C_TEAMKEY']].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

match[(match['M_ATTENDANCE'] < 38100) & (match['M_STADIUMKEY'] <= 9) | (match['M_TIME'] == '1') & (match['M_SCORE2'] > 0) | (match['M_DURATION'] <= 147) | (match['M_TIME'].str.startswith('2')) | (match['M_SCORE1'] >= 4) & (match['M_SCORE1'] <= 3) & (match['M_STADIUMKEY'] == 3)].merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('count')

match[(match['M_DATE'] == '2022-11-20') | (match['M_ATTENDANCE'] == 35830)].merge(stadium[['S_STADIUMKEY', 'S_YEARBUILT', 'S_NAME', 'S_LOCATION', 'S_CAPACITY', 'S_CITY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_LOCATION', 'S_CITY', 'S_STADIUMKEY']).agg('max', numeric_only=True)

match[(match['M_MATCHKEY'] <= 6) & (match['M_MATCHKEY'] < 23) & (match['M_TEAM2KEY'] == 't') & (match['M_DATE'] == '2022-11-20') | (match['M_SCORE1'] < 6) & (match['M_TIME'].str.startswith('2')) | (match['M_STADIUMKEY'] != 5) & (match['M_STADIUMKEY'] > 5) & (match['M_SCORE1'] <= 6)][['M_TEAM2KEY', 'M_ROUND']].merge(team[(team['T_PLAYERCOUNT'] != 19)], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[(match['M_MATCHKEY'] > 37) | (match['M_ATTENDANCE'] == 63234) | (match['M_ATTENDANCE'] >= 68413) | (match['M_DURATION'] < 129) & (match['M_ATTENDANCE'] != 79882)][['M_SCORE1', 'M_ATTENDANCE', 'M_STADIUMKEY']].merge(stadium[['S_YEARBUILT', 'S_STADIUMKEY', 'S_CITY', 'S_NAME']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_ROUND'].isin(['quarter-final', 'final'])) | (match['M_SCORE2'] != 5) | (match['M_TEAM1KEY'] == 't') & (match['M_ROUND'] != 'final') | (match['M_TEAM2KEY'].str.startswith('t')) | (match['M_MATCHKEY'] > 36) | (match['M_TIME'].str.startswith('1')) | (match['M_TIME'] == '1') | (match['M_ROUND'] == 'quarter-final') & (match['M_TEAM2KEY'] != 't')].merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP']).agg('count')

match[(match['M_TEAM2KEY'] == 't') | (match['M_TEAM2KEY'].str.startswith('t')) | (match['M_DURATION'] <= 138) & (match['M_STADIUMKEY'] > 6) & (match['M_TEAM1KEY'].str.startswith('t'))][['M_STADIUMKEY', 'M_ROUND', 'M_SCORE1', 'M_TEAM1KEY', 'M_MATCHKEY']].merge(stadium[(stadium['S_STADIUMKEY'] == 9) & (stadium['S_CITY'].str.startswith('d'))], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_TEAM2KEY'].str.startswith('t')) & (match['M_DURATION'] < 109) & (match['M_DURATION'] < 133) | (match['M_TEAM2KEY'] == 't') | (match['M_MATCHKEY'] != 30) | (match['M_TEAM2KEY'].str.startswith('t'))].merge(team[(team['T_GROUP'] == 'f') | (team['T_TEAMKEY'] != 't')], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']).agg('count')

match[['M_SCORE2', 'M_ATTENDANCE', 'M_MATCHKEY', 'M_TIME', 'M_DURATION', 'M_TEAM1KEY', 'M_ROUND']].merge(team[(team['T_GROUP'] != 'a') & (team['T_PLAYERCOUNT'] != 19) | (team['T_PLAYERCOUNT'] >= 21)][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[['M_STADIUMKEY', 'M_ROUND', 'M_TEAM2KEY', 'M_DATE', 'M_SCORE1', 'M_SCORE2', 'M_TIME', 'M_DURATION', 'M_TEAM1KEY']].merge(stadium[(stadium['S_LOCATION'] != 's')][['S_LOCATION', 'S_STADIUMKEY', 'S_CAPACITY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[['M_TEAM1KEY', 'M_ROUND', 'M_SCORE1', 'M_STADIUMKEY', 'M_DATE', 'M_SCORE2', 'M_DURATION', 'M_TEAM2KEY']].merge(team[(team['T_GROUP'] != 'd') & (team['T_PLAYERCOUNT'] == 21)], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP']).agg('min', numeric_only=True)

match[['M_TEAM2KEY', 'M_MATCHKEY', 'M_DURATION', 'M_DATE', 'M_SCORE1', 'M_TEAM1KEY', 'M_STADIUMKEY']].merge(team[(team['T_GROUP'].isin(['f', 'h', 'a'])) & (team['T_PLAYERCOUNT'] >= 25)], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('count')

association[(association['A_FOUNDEDYEAR'] <= 1951) | (association['A_TEAMKEY'] == 't') | (association['A_TEAMKEY'] != 't')][['A_FOUNDEDYEAR', 'A_ASSOCKEY', 'A_TEAMKEY', 'A_PRESIDENT']].merge(team[(team['T_TEAMKEY'] == 't') | (team['T_PLAYERCOUNT'] < 21)][['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_TEAMKEY'] != 't')][['A_TEAMKEY', 'A_ASSOCKEY', 'A_PRESIDENT']].merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']).agg('max', numeric_only=True)

association[['A_ASSOCKEY', 'A_TEAMKEY', 'A_FOUNDEDYEAR', 'A_PRESIDENT']].merge(team[(team['T_TEAMKEY'] == 't') | (team['T_TEAMKEY'] != 't') & (team['T_GROUP'] != 'f')][['T_GROUP', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('min', numeric_only=True)

coach[(coach['C_ROLE'] == 'fitness coach') & (coach['C_COACHKEY'] > 5) | (coach['C_ROLE'].isin(['goalkeeper coach', 'head coach', 'assistant coach', 'fitness coach']))][['C_ROLE', 'C_NAME', 'C_TEAMKEY', 'C_EXPYEARS', 'C_COACHKEY']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('sum', numeric_only=True)

coach[['C_NAME', 'C_COACHKEY', 'C_TEAMKEY']].merge(team[(team['T_TEAMKEY'] == 't') | (team['T_TEAMKEY'] != 't') | (team['T_PLAYERCOUNT'] >= 22)][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY']).agg('count')

match[(match['M_SCORE1'] > 1) | (match['M_TEAM1KEY'] == 't') & (match['M_MATCHKEY'] <= 57) & (match['M_MATCHKEY'] > 13) & (match['M_TEAM2KEY'] != 't') & (match['M_TEAM1KEY'].str.startswith('t'))][['M_TIME', 'M_STADIUMKEY', 'M_MATCHKEY', 'M_DURATION', 'M_ATTENDANCE', 'M_TEAM1KEY']].groupby(by=['M_TEAM1KEY', 'M_MATCHKEY', 'M_STADIUMKEY']).agg('min', numeric_only=True)

match[(match['M_STADIUMKEY'] == 7) | (match['M_TEAM2KEY'] == 't') & (match['M_SCORE1'] != 0) | (match['M_SCORE1'] <= 6) | (match['M_ROUND'] != 'group stage') & (match['M_SCORE2'] != 5) & (match['M_TEAM1KEY'].str.startswith('t')) & (match['M_MATCHKEY'] >= 50) & (match['M_ATTENDANCE'] >= 66196) & (match['M_DATE'] != '2022-11-20')][['M_TEAM1KEY', 'M_ROUND', 'M_TIME', 'M_ATTENDANCE', 'M_SCORE1', 'M_STADIUMKEY', 'M_DATE', 'M_TEAM2KEY']]

match[(match['M_TEAM1KEY'] == 't')][['M_SCORE2', 'M_MATCHKEY', 'M_DATE', 'M_SCORE1', 'M_STADIUMKEY', 'M_ROUND', 'M_TEAM2KEY']].merge(team[(team['T_PLAYERCOUNT'] <= 20)][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[(match['M_TEAM2KEY'] == 't') | (match['M_SCORE1'] >= 2) | (match['M_STADIUMKEY'] == 10) | (match['M_MATCHKEY'] == 10) | (match['M_DURATION'] != 137)].merge(team[(team['T_GROUP'] == 'b') | (team['T_TEAMKEY'].str.startswith('t'))][['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('count')

match[(match['M_TIME'] == '1') & (match['M_ROUND'] != 'round of 16')][['M_SCORE2', 'M_ROUND', 'M_STADIUMKEY', 'M_MATCHKEY', 'M_TEAM1KEY', 'M_ATTENDANCE']].merge(team[(team['T_PLAYERCOUNT'] >= 25) | (team['T_PLAYERCOUNT'] > 25)][['T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[['M_DATE', 'M_TEAM2KEY', 'M_TIME', 'M_TEAM1KEY']].merge(team[(team['T_PLAYERCOUNT'] < 21)][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('max', numeric_only=True)

match[['M_SCORE2', 'M_DURATION', 'M_STADIUMKEY', 'M_DATE', 'M_TEAM1KEY', 'M_SCORE1', 'M_MATCHKEY', 'M_ATTENDANCE', 'M_TIME']].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('max', numeric_only=True)

match[['M_STADIUMKEY', 'M_TEAM2KEY', 'M_ATTENDANCE', 'M_SCORE2', 'M_DURATION', 'M_DATE', 'M_TIME', 'M_TEAM1KEY']].merge(team[(team['T_TEAMKEY'] == 't') & (team['T_TEAMKEY'] != 't') & (team['T_PLAYERCOUNT'] != 20)][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

stadium[(stadium['S_CITY'] != 'r') & (stadium['S_YEARBUILT'] > 1954) & (stadium['S_CAPACITY'] <= 57131) & (stadium['S_NAME'] != 's') & (stadium['S_NAME'].str.startswith('s'))][['S_STADIUMKEY', 'S_LOCATION', 'S_CITY', 'S_YEARBUILT', 'S_NAME', 'S_CAPACITY']].groupby(by=['S_STADIUMKEY', 'S_YEARBUILT', 'S_CITY', 'S_CAPACITY']).agg('mean', numeric_only=True)

stadium[(stadium['S_LOCATION'] != 'w') & (stadium['S_LOCATION'] != 'c') & (stadium['S_YEARBUILT'] == 1954) | (stadium['S_CAPACITY'] <= 51245) | (stadium['S_STADIUMKEY'] <= 2)][['S_CAPACITY', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_NAME', 'S_CITY']].groupby(by=['S_CITY', 'S_YEARBUILT', 'S_CAPACITY', 'S_STADIUMKEY', 'S_NAME']).agg('mean', numeric_only=True)

association[(association['A_ASSOCKEY'].str.startswith('f')) | (association['A_ASSOCKEY'] != 'f') | (association['A_FOUNDEDYEAR'] <= 1940) | (association['A_ASSOCKEY'] != 'f')][['A_TEAMKEY', 'A_PRESIDENT']].merge(team[(team['T_TEAMKEY'] != 't') & (team['T_PLAYERCOUNT'] != 23) | (team['T_PLAYERCOUNT'] < 18)], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

association[(association['A_FOUNDEDYEAR'] > 1974) & (association['A_FOUNDEDYEAR'] >= 1947) | (association['A_TEAMKEY'] != 't')][['A_PRESIDENT', 'A_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] == 20)][['T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('mean', numeric_only=True)

association[(association['A_PRESIDENT'] != 'p') & (association['A_TEAMKEY'] == 't') & (association['A_FOUNDEDYEAR'] != 1922)][['A_ASSOCKEY', 'A_TEAMKEY', 'A_FOUNDEDYEAR', 'A_PRESIDENT']].merge(team[(team['T_GROUP'] == 'e') | (team['T_GROUP'] != 'd')], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

association[['A_FOUNDEDYEAR', 'A_PRESIDENT', 'A_TEAMKEY', 'A_ASSOCKEY']].merge(team[(team['T_TEAMKEY'] != 't') & (team['T_PLAYERCOUNT'] <= 25)][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('sum', numeric_only=True)

coach[(coach['C_EXPYEARS'] < 37) & (coach['C_COACHKEY'] != 74) & (coach['C_NAME'] == 'c') & (coach['C_NAME'] != 'c')][['C_COACHKEY', 'C_ROLE', 'C_TEAMKEY', 'C_NAME']].merge(team[(team['T_GROUP'] != 'c') & (team['T_GROUP'] != 'd') & (team['T_TEAMKEY'] == 't')][['T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_TEAMKEY'] == 't') | (coach['C_TEAMKEY'].str.startswith('t')) | (coach['C_TEAMKEY'] == 't')][['C_COACHKEY', 'C_NAME', 'C_TEAMKEY', 'C_ROLE']].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('mean', numeric_only=True)

coach[['C_NAME', 'C_ROLE', 'C_COACHKEY', 'C_TEAMKEY']].merge(team[(team['T_GROUP'] == 'c') & (team['T_GROUP'].isin(['a', 'h', 'f', 'd', 'b'])) & (team['T_TEAMKEY'].str.startswith('t'))][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('min', numeric_only=True)

match[(match['M_ATTENDANCE'] != 89613) & (match['M_DATE'] >= '2022-11-20') | (match['M_ATTENDANCE'] == 80486) | (match['M_TEAM1KEY'] != 't') | (match['M_ROUND'] == 'quarter-final')][['M_SCORE2', 'M_ATTENDANCE', 'M_TIME', 'M_SCORE1', 'M_ROUND', 'M_STADIUMKEY', 'M_MATCHKEY', 'M_TEAM2KEY', 'M_DURATION', 'M_TEAM1KEY']].merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[(match['M_ATTENDANCE'] >= 73945) | (match['M_TEAM2KEY'] == 't') & (match['M_TEAM1KEY'] != 't') | (match['M_ROUND'] != 'final') | (match['M_DATE'] != '2022-11-20') & (match['M_STADIUMKEY'] == 2)][['M_TEAM1KEY', 'M_ROUND', 'M_SCORE2', 'M_ATTENDANCE']].merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('count')

match[(match['M_SCORE1'] > 6) | (match['M_MATCHKEY'] >= 48) | (match['M_DURATION'] < 90)][['M_TEAM2KEY', 'M_TIME', 'M_ATTENDANCE', 'M_STADIUMKEY']].merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_YEARBUILT', 'S_LOCATION', 'S_NAME', 'S_CAPACITY', 'S_CITY']).agg('sum', numeric_only=True)

match[(match['M_TEAM1KEY'] == 't') | (match['M_SCORE2'] >= 1)][['M_SCORE1', 'M_SCORE2', 'M_STADIUMKEY', 'M_TEAM2KEY', 'M_DATE', 'M_TIME', 'M_MATCHKEY']].merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('count')

association[(association['A_FOUNDEDYEAR'] <= 1915) & (association['A_ASSOCKEY'] == 'f') | (association['A_ASSOCKEY'] == 'f')][['A_PRESIDENT', 'A_TEAMKEY', 'A_ASSOCKEY']].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']).agg('mean', numeric_only=True)

association[(association['A_TEAMKEY'] == 't')][['A_ASSOCKEY', 'A_PRESIDENT', 'A_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] <= 18) & (team['T_TEAMKEY'] == 't') & (team['T_PLAYERCOUNT'] > 20)][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('count')

match[(match['M_ATTENDANCE'] > 54659) | (match['M_DATE'] >= '2022-12-18') & (match['M_DURATION'] == 109)][['M_DURATION', 'M_ATTENDANCE', 'M_STADIUMKEY', 'M_SCORE1', 'M_TEAM2KEY', 'M_MATCHKEY', 'M_ROUND', 'M_TEAM1KEY', 'M_TIME', 'M_SCORE2']].merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[(match['M_ROUND'].isin(['quarter-final', 'group stage', 'semi-final', 'final'])) | (match['M_STADIUMKEY'] > 9) & (match['M_TEAM2KEY'].str.startswith('t')) | (match['M_DATE'] >= '2022-11-20')].merge(stadium[(stadium['S_LOCATION'] == 'e')][['S_CITY', 'S_STADIUMKEY', 'S_YEARBUILT', 'S_LOCATION', 'S_CAPACITY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_CITY', 'S_STADIUMKEY', 'S_LOCATION']).agg('sum', numeric_only=True)

match[(match['M_STADIUMKEY'] > 10) & (match['M_STADIUMKEY'] > 10) & (match['M_ATTENDANCE'] < 33048) | (match['M_TEAM1KEY'].str.startswith('t')) & (match['M_SCORE1'] < 0) | (match['M_TIME'] != '1')][['M_DATE', 'M_TEAM2KEY', 'M_STADIUMKEY', 'M_TEAM1KEY', 'M_SCORE2', 'M_TIME', 'M_MATCHKEY', 'M_ATTENDANCE', 'M_ROUND']].groupby(by=['M_STADIUMKEY', 'M_DATE']).agg('min', numeric_only=True)

match[(match['M_STADIUMKEY'] > 4) & (match['M_ATTENDANCE'] > 54735) | (match['M_TIME'] == '1') & (match['M_DATE'] <= '2022-12-18') & (match['M_TEAM2KEY'] == 't') & (match['M_TEAM2KEY'] == 't') | (match['M_ROUND'] == 'round of 16')][['M_SCORE1', 'M_DURATION', 'M_TEAM2KEY', 'M_TIME', 'M_TEAM1KEY', 'M_MATCHKEY']].merge(team[['T_GROUP', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[(match['M_TEAM1KEY'].str.startswith('t')) & (match['M_DURATION'] == 136) | (match['M_SCORE1'] <= 5) | (match['M_MATCHKEY'] >= 48) | (match['M_TEAM2KEY'].str.startswith('t')) | (match['M_MATCHKEY'] > 2)][['M_SCORE2', 'M_ROUND', 'M_STADIUMKEY', 'M_TEAM2KEY', 'M_TIME']].merge(stadium[(stadium['S_LOCATION'] == 'e')][['S_CITY', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_TEAM2KEY'] == 't') & (match['M_DURATION'] >= 118) | (match['M_STADIUMKEY'] != 5) & (match['M_DATE'] != '2022-11-20')][['M_ATTENDANCE', 'M_DURATION', 'M_TIME', 'M_SCORE1', 'M_ROUND', 'M_STADIUMKEY', 'M_DATE', 'M_TEAM2KEY', 'M_TEAM1KEY']].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[['M_ATTENDANCE', 'M_ROUND', 'M_TEAM2KEY', 'M_TEAM1KEY', 'M_DATE', 'M_TIME', 'M_MATCHKEY', 'M_DURATION']].merge(team[(team['T_GROUP'].isin(['d', 'g']))][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

match[['M_DURATION', 'M_ATTENDANCE', 'M_SCORE1', 'M_STADIUMKEY', 'M_TEAM2KEY', 'M_MATCHKEY', 'M_DATE', 'M_TEAM1KEY', 'M_ROUND', 'M_TIME']].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

match[['M_SCORE2', 'M_MATCHKEY', 'M_TEAM2KEY', 'M_TEAM1KEY', 'M_DURATION']].merge(team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_PLAYERCOUNT'] == 21) | (team['T_PLAYERCOUNT'] == 18)][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('min', numeric_only=True)

match[['M_SCORE2', 'M_TIME', 'M_MATCHKEY', 'M_ATTENDANCE', 'M_DATE', 'M_TEAM1KEY']].merge(team[(team['T_GROUP'] == 'g') | (team['T_TEAMKEY'] != 't') | (team['T_TEAMKEY'] != 't')][['T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('min', numeric_only=True)

match[['M_STADIUMKEY', 'M_TEAM2KEY', 'M_ATTENDANCE', 'M_MATCHKEY', 'M_SCORE1', 'M_SCORE2', 'M_ROUND', 'M_DURATION', 'M_DATE']].merge(stadium[['S_LOCATION', 'S_CITY', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_STADIUMKEY', 'S_LOCATION']).agg('count')

match[['M_TIME', 'M_STADIUMKEY', 'M_ROUND', 'M_SCORE1', 'M_MATCHKEY', 'M_ATTENDANCE', 'M_TEAM1KEY']].merge(team[(team['T_TEAMKEY'] == 't') | (team['T_TEAMKEY'].str.startswith('t')) & (team['T_GROUP'] != 'd')][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT']).agg('max', numeric_only=True)

coach[(coach['C_EXPYEARS'] == 1) & (coach['C_NAME'] != 'c') | (coach['C_TEAMKEY'] != 't')][['C_ROLE', 'C_NAME', 'C_TEAMKEY', 'C_EXPYEARS']].merge(team[(team['T_PLAYERCOUNT'] != 18)][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT']).agg('mean', numeric_only=True)

coach[(coach['C_TEAMKEY'] == 't') | (coach['C_ROLE'] != 'assistant coach') | (coach['C_NAME'] != 'c')][['C_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] < 22) & (team['T_TEAMKEY'].str.startswith('t'))][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('mean', numeric_only=True)

match[(match['M_DURATION'] >= 103) & (match['M_STADIUMKEY'] > 11) | (match['M_ATTENDANCE'] > 36793) & (match['M_SCORE1'] > 2)][['M_DURATION', 'M_ATTENDANCE', 'M_STADIUMKEY', 'M_SCORE1', 'M_MATCHKEY', 'M_DATE', 'M_ROUND', 'M_TIME', 'M_SCORE2']].merge(stadium[['S_STADIUMKEY', 'S_LOCATION', 'S_CITY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_ROUND'] == 'quarter-final') | (match['M_TEAM1KEY'] != 't') & (match['M_MATCHKEY'] <= 62) | (match['M_MATCHKEY'] < 46) & (match['M_TEAM1KEY'] == 't') & (match['M_ATTENDANCE'] == 56714) | (match['M_MATCHKEY'] < 56) & (match['M_TIME'] != '1') | (match['M_ROUND'] != 'semi-final')][['M_TEAM1KEY', 'M_ROUND', 'M_TEAM2KEY', 'M_SCORE2', 'M_DURATION', 'M_SCORE1', 'M_MATCHKEY']].groupby(by=['M_SCORE1', 'M_SCORE2']).agg('sum', numeric_only=True)

match[(match['M_TIME'].str.startswith('2')) & (match['M_TEAM2KEY'].str.startswith('t')) & (match['M_DATE'] != '2022-12-18') & (match['M_ROUND'].isin(['semi-final', 'group stage']))][['M_TEAM1KEY', 'M_ROUND', 'M_DURATION', 'M_SCORE2', 'M_TIME', 'M_SCORE1']].merge(team[(team['T_TEAMKEY'].str.startswith('t')) | (team['T_TEAMKEY'] != 't') & (team['T_GROUP'] != 'h')][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[['M_DURATION', 'M_SCORE1', 'M_STADIUMKEY', 'M_MATCHKEY', 'M_DATE', 'M_ROUND', 'M_TEAM1KEY', 'M_TEAM2KEY', 'M_TIME', 'M_SCORE2']].merge(stadium[['S_STADIUMKEY', 'S_NAME', 'S_CAPACITY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_NAME', 'S_STADIUMKEY']).agg('max', numeric_only=True)

coach[(coach['C_NAME'].str.startswith('c')) | (coach['C_TEAMKEY'] != 't')][['C_NAME', 'C_ROLE', 'C_EXPYEARS', 'C_TEAMKEY', 'C_COACHKEY']].merge(team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_TEAMKEY'].str.startswith('t')) | (team['T_TEAMKEY'].str.startswith('t'))][['T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('count')

coach[(coach['C_TEAMKEY'].str.startswith('t'))][['C_ROLE', 'C_EXPYEARS', 'C_COACHKEY', 'C_NAME', 'C_TEAMKEY']].merge(team[(team['T_TEAMKEY'] != 't') | (team['T_GROUP'] != 'h') & (team['T_TEAMKEY'].str.startswith('t'))][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('count')

match[(match['M_DURATION'] != 143)][['M_SCORE2', 'M_ATTENDANCE', 'M_ROUND', 'M_SCORE1', 'M_TEAM2KEY']].merge(team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_PLAYERCOUNT'] >= 21) | (team['T_GROUP'] == 'a')][['T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('mean', numeric_only=True)

match[['M_DURATION', 'M_ATTENDANCE', 'M_SCORE1', 'M_STADIUMKEY', 'M_TEAM2KEY', 'M_MATCHKEY', 'M_ROUND', 'M_TEAM1KEY', 'M_TIME', 'M_SCORE2']].merge(team[(team['T_GROUP'] == 'c') | (team['T_PLAYERCOUNT'] >= 18) | (team['T_TEAMKEY'] == 't')], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('max', numeric_only=True)

association[(association['A_FOUNDEDYEAR'] != 1967) & (association['A_PRESIDENT'] != 'p') | (association['A_ASSOCKEY'].str.startswith('f')) | (association['A_PRESIDENT'] != 'p')][['A_ASSOCKEY', 'A_PRESIDENT', 'A_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] < 25) | (team['T_PLAYERCOUNT'] > 22) | (team['T_PLAYERCOUNT'] >= 21)][['T_GROUP', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('sum', numeric_only=True)

coach[(coach['C_EXPYEARS'] < 14)][['C_EXPYEARS', 'C_COACHKEY', 'C_ROLE', 'C_NAME', 'C_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] == 22) | (team['T_PLAYERCOUNT'] != 25)][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

coach[(coach['C_NAME'].str.startswith('c')) | (coach['C_COACHKEY'] <= 83)][['C_NAME', 'C_COACHKEY', 'C_TEAMKEY', 'C_ROLE']].merge(team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_PLAYERCOUNT'] != 22) | (team['T_TEAMKEY'] != 't')][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY']).agg('sum', numeric_only=True)

match[(match['M_SCORE2'] != 3)][['M_ATTENDANCE', 'M_SCORE2', 'M_ROUND', 'M_TEAM2KEY', 'M_SCORE1', 'M_DATE', 'M_STADIUMKEY', 'M_MATCHKEY', 'M_DURATION']].merge(team[(team['T_PLAYERCOUNT'] <= 22) | (team['T_PLAYERCOUNT'] < 20)], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

match[(match['M_TEAM1KEY'].str.startswith('t')) | (match['M_DURATION'] >= 92) & (match['M_ATTENDANCE'] <= 84836) & (match['M_TEAM2KEY'] != 't') & (match['M_SCORE1'] == 2) & (match['M_TIME'] != '2') | (match['M_TEAM2KEY'] == 't') & (match['M_SCORE2'] < 4)][['M_DATE', 'M_TEAM2KEY', 'M_TIME', 'M_SCORE2', 'M_TEAM1KEY', 'M_STADIUMKEY', 'M_ROUND']].merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('count')

match[(match['M_ATTENDANCE'] == 80469) & (match['M_DATE'] >= '2022-12-18') | (match['M_TEAM1KEY'].str.startswith('t')) & (match['M_DATE'] != '2022-11-20') | (match['M_TEAM2KEY'] == 't') | (match['M_STADIUMKEY'] <= 5) & (match['M_SCORE1'] == 3)].merge(stadium[(stadium['S_STADIUMKEY'] <= 7) | (stadium['S_YEARBUILT'] == 1993) & (stadium['S_NAME'] != 's') | (stadium['S_CITY'] == 'd') | (stadium['S_LOCATION'].str.startswith('s')) & (stadium['S_CAPACITY'] != 71271)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_CAPACITY', 'S_STADIUMKEY', 'S_NAME', 'S_YEARBUILT', 'S_LOCATION']).agg('min', numeric_only=True)

match[(match['M_ATTENDANCE'] > 68995) | (match['M_MATCHKEY'] != 21) | (match['M_DATE'] == '2022-11-20') & (match['M_DURATION'] < 103) | (match['M_DATE'] < '2022-11-20') & (match['M_DATE'] > '2022-12-18')][['M_SCORE2', 'M_MATCHKEY', 'M_DATE', 'M_TIME', 'M_TEAM2KEY', 'M_TEAM1KEY']].merge(team[(team['T_PLAYERCOUNT'] >= 21) & (team['T_PLAYERCOUNT'] < 22) | (team['T_TEAMKEY'].str.startswith('t'))], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('min', numeric_only=True)

match[(match['M_DURATION'] != 111) & (match['M_TEAM1KEY'] == 't') | (match['M_TIME'] != '2') & (match['M_SCORE1'] != 5) & (match['M_STADIUMKEY'] <= 1) | (match['M_ROUND'] == 'semi-final') | (match['M_DURATION'] >= 115) | (match['M_ATTENDANCE'] != 64511)].merge(stadium[(stadium['S_NAME'] == 's') | (stadium['S_YEARBUILT'] > 1980) | (stadium['S_LOCATION'] != 's')][['S_YEARBUILT', 'S_CITY', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_YEARBUILT', 'S_STADIUMKEY', 'S_CITY']).agg('mean', numeric_only=True)

match[(match['M_TIME'].str.startswith('1')) | (match['M_STADIUMKEY'] <= 5) | (match['M_TIME'].str.startswith('2')) | (match['M_MATCHKEY'] <= 4) | (match['M_TIME'] == '2') | (match['M_TIME'] == '2') | (match['M_SCORE1'] > 2) | (match['M_TEAM1KEY'] == 't') | (match['M_DATE'] >= '2022-12-18') | (match['M_TEAM2KEY'] != 't')].merge(stadium[(stadium['S_LOCATION'].str.startswith('e')) | (stadium['S_STADIUMKEY'] <= 2) & (stadium['S_STADIUMKEY'] > 1)][['S_NAME', 'S_STADIUMKEY', 'S_CAPACITY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_NAME']).agg('count')

match[['M_SCORE2', 'M_ROUND', 'M_TEAM1KEY', 'M_SCORE1', 'M_DATE', 'M_STADIUMKEY', 'M_MATCHKEY', 'M_ATTENDANCE']].merge(stadium[['S_LOCATION', 'S_CITY', 'S_STADIUMKEY', 'S_CAPACITY', 'S_YEARBUILT', 'S_NAME']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_CITY', 'S_NAME', 'S_STADIUMKEY', 'S_CAPACITY']).agg('mean', numeric_only=True)

association[(association['A_TEAMKEY'] != 't') & (association['A_TEAMKEY'] == 't') & (association['A_PRESIDENT'] == 'p') | (association['A_PRESIDENT'].str.startswith('p'))][['A_PRESIDENT', 'A_TEAMKEY', 'A_FOUNDEDYEAR', 'A_ASSOCKEY']].merge(team[(team['T_PLAYERCOUNT'] != 20) | (team['T_PLAYERCOUNT'] < 25)][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('sum', numeric_only=True)

match[(match['M_DATE'] != '2022-12-18') | (match['M_SCORE2'] != 0) | (match['M_TIME'] == '1')][['M_SCORE2', 'M_ATTENDANCE', 'M_TEAM2KEY', 'M_TEAM1KEY', 'M_DURATION']].merge(team[(team['T_GROUP'] != 'f') | (team['T_GROUP'] != 'g')][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']).agg('count')

match[(match['M_DURATION'] > 112) & (match['M_STADIUMKEY'] > 4) | (match['M_TEAM2KEY'].str.startswith('t')) & (match['M_DURATION'] <= 116) | (match['M_TEAM1KEY'] == 't') & (match['M_SCORE2'] == 1) | (match['M_MATCHKEY'] < 36) | (match['M_DURATION'] <= 146) & (match['M_TEAM1KEY'].str.startswith('t')) & (match['M_DURATION'] >= 108)][['M_DATE', 'M_TEAM2KEY', 'M_ROUND', 'M_ATTENDANCE', 'M_TIME', 'M_SCORE1']].merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('count')

match[(match['M_STADIUMKEY'] == 11) | (match['M_DURATION'] >= 91) | (match['M_STADIUMKEY'] != 10) | (match['M_TEAM2KEY'] == 't') & (match['M_TEAM1KEY'] == 't') | (match['M_DURATION'] == 116) & (match['M_TIME'] == '2')][['M_TEAM1KEY', 'M_SCORE2', 'M_TEAM2KEY', 'M_ATTENDANCE']].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('mean', numeric_only=True)

match[(match['M_TIME'].str.startswith('2')) | (match['M_TIME'].str.startswith('2')) & (match['M_TIME'].str.startswith('2')) & (match['M_STADIUMKEY'] != 7) & (match['M_TEAM2KEY'].str.startswith('t')) & (match['M_TEAM2KEY'] == 't') | (match['M_TIME'] == '2') & (match['M_TIME'].str.startswith('1')) | (match['M_ATTENDANCE'] == 66680) | (match['M_TIME'] == '1')][['M_TEAM1KEY', 'M_TIME', 'M_ROUND']].merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('count')

match[['M_TEAM1KEY', 'M_TIME', 'M_ATTENDANCE', 'M_SCORE1', 'M_STADIUMKEY', 'M_DATE', 'M_SCORE2', 'M_MATCHKEY', 'M_DURATION']].merge(stadium[['S_CAPACITY', 'S_LOCATION', 'S_CITY', 'S_STADIUMKEY', 'S_NAME', 'S_YEARBUILT']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_STADIUMKEY', 'S_NAME', 'S_LOCATION', 'S_CAPACITY']).agg('min', numeric_only=True)

coach[(coach['C_NAME'] == 'c') | (coach['C_TEAMKEY'] != 't') & (coach['C_TEAMKEY'] == 't') & (coach['C_COACHKEY'] <= 16) | (coach['C_COACHKEY'] < 9)][['C_NAME', 'C_TEAMKEY', 'C_ROLE', 'C_EXPYEARS', 'C_COACHKEY']].merge(team[(team['T_GROUP'] != 'f') & (team['T_TEAMKEY'] == 't') | (team['T_GROUP'] == 'a')][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('min', numeric_only=True)

match[(match['M_ROUND'] != 'quarter-final') & (match['M_SCORE1'] != 3) & (match['M_TEAM1KEY'].str.startswith('t'))][['M_STADIUMKEY', 'M_DURATION', 'M_MATCHKEY', 'M_ATTENDANCE']].merge(stadium[['S_CITY', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_LOCATION', 'S_NAME', 'S_CAPACITY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_CITY', 'S_STADIUMKEY', 'S_YEARBUILT', 'S_CAPACITY', 'S_LOCATION']).agg('min', numeric_only=True)

match[(match['M_SCORE2'] > 5) & (match['M_DATE'] <= '2022-11-20') & (match['M_DURATION'] > 106) & (match['M_SCORE1'] < 6) | (match['M_ATTENDANCE'] <= 75565) | (match['M_DATE'] >= '2022-12-18') | (match['M_DATE'] == '2022-11-20') & (match['M_STADIUMKEY'] >= 4)][['M_TEAM2KEY', 'M_TIME', 'M_DURATION', 'M_ROUND', 'M_SCORE1', 'M_MATCHKEY', 'M_ATTENDANCE', 'M_TEAM1KEY']].merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('mean', numeric_only=True)

coach[(coach['C_COACHKEY'] > 71) & (coach['C_NAME'] != 'c') | (coach['C_NAME'].str.startswith('c')) | (coach['C_TEAMKEY'] != 't')][['C_NAME', 'C_EXPYEARS', 'C_ROLE', 'C_COACHKEY', 'C_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] > 22) | (team['T_PLAYERCOUNT'] != 23) & (team['T_GROUP'].isin(['d', 'e', 'f', 'g']))][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

match[(match['M_DURATION'] >= 92) | (match['M_STADIUMKEY'] != 10) & (match['M_DURATION'] >= 92) | (match['M_DURATION'] <= 108) & (match['M_SCORE2'] != 3) & (match['M_TIME'].str.startswith('2'))][['M_STADIUMKEY', 'M_ATTENDANCE', 'M_ROUND', 'M_DATE']].merge(stadium[(stadium['S_CITY'] == 'r') & (stadium['S_CITY'] != 'l') & (stadium['S_CITY'] == 'a') & (stadium['S_CITY'].str.startswith('l'))], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_YEARBUILT', 'S_LOCATION', 'S_CITY', 'S_NAME', 'S_STADIUMKEY']).agg('min', numeric_only=True)

match[(match['M_TEAM1KEY'].str.startswith('t')) & (match['M_SCORE1'] >= 3) | (match['M_DATE'] > '2022-12-18') & (match['M_ATTENDANCE'] != 44712) | (match['M_SCORE1'] == 2)][['M_ATTENDANCE', 'M_SCORE2', 'M_ROUND', 'M_TEAM2KEY', 'M_SCORE1', 'M_DATE', 'M_STADIUMKEY', 'M_TIME', 'M_MATCHKEY', 'M_DURATION']].merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('min', numeric_only=True)

match[['M_DURATION', 'M_ATTENDANCE', 'M_STADIUMKEY', 'M_SCORE1', 'M_TEAM2KEY', 'M_MATCHKEY', 'M_TEAM1KEY', 'M_ROUND', 'M_TIME', 'M_SCORE2']].merge(stadium[['S_CITY', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_LOCATION', 'S_NAME', 'S_CAPACITY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_YEARBUILT', 'S_CITY', 'S_LOCATION', 'S_NAME', 'S_CAPACITY']).agg('mean', numeric_only=True)

match[(match['M_DATE'] <= '2022-11-20') & (match['M_ATTENDANCE'] < 79196) & (match['M_ATTENDANCE'] <= 49884) | (match['M_TEAM2KEY'] == 't') & (match['M_MATCHKEY'] <= 4) | (match['M_ATTENDANCE'] != 73695) | (match['M_TEAM2KEY'].str.startswith('t')) & (match['M_TIME'] == '1') | (match['M_DATE'] > '2022-11-20') | (match['M_ATTENDANCE'] > 69341)].merge(stadium[(stadium['S_CITY'] != 'l') & (stadium['S_LOCATION'].str.startswith('w')) & (stadium['S_CITY'] != 'd')][['S_NAME', 'S_CITY', 'S_STADIUMKEY', 'S_CAPACITY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_STADIUMKEY', 'S_CAPACITY', 'S_NAME', 'S_CITY']).agg('sum', numeric_only=True)

match[(match['M_SCORE1'] >= 3) & (match['M_TEAM2KEY'] == 't') & (match['M_ATTENDANCE'] <= 86305) & (match['M_MATCHKEY'] > 32) | (match['M_DATE'] <= '2022-11-20') | (match['M_TEAM2KEY'] != 't') | (match['M_TEAM2KEY'] != 't') | (match['M_SCORE1'] >= 5) | (match['M_STADIUMKEY'] != 10)][['M_STADIUMKEY', 'M_ROUND', 'M_DURATION', 'M_TIME']].merge(stadium[(stadium['S_YEARBUILT'] != 1954) & (stadium['S_CITY'] == 'r')][['S_STADIUMKEY', 'S_CITY', 'S_CAPACITY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_CITY', 'S_STADIUMKEY']).agg('count')

match[(match['M_MATCHKEY'] >= 55) | (match['M_SCORE1'] <= 5) & (match['M_DATE'] == '2022-12-18') & (match['M_MATCHKEY'] < 11) | (match['M_TEAM2KEY'].str.startswith('t')) & (match['M_DATE'] >= '2022-11-20') & (match['M_ATTENDANCE'] <= 65411) & (match['M_MATCHKEY'] > 62) & (match['M_TEAM2KEY'] == 't') | (match['M_TIME'] != '2')][['M_DATE', 'M_TEAM2KEY', 'M_TEAM1KEY', 'M_STADIUMKEY', 'M_SCORE2', 'M_TIME', 'M_MATCHKEY', 'M_ATTENDANCE', 'M_DURATION', 'M_SCORE1']].merge(team[(team['T_TEAMKEY'] != 't')][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[(match['M_STADIUMKEY'] <= 8) | (match['M_SCORE1'] < 3) | (match['M_TEAM2KEY'] == 't') & (match['M_DURATION'] <= 102) | (match['M_MATCHKEY'] < 47) | (match['M_STADIUMKEY'] <= 11) & (match['M_SCORE1'] != 5) & (match['M_TEAM1KEY'].str.startswith('t')) & (match['M_MATCHKEY'] < 11) & (match['M_ATTENDANCE'] == 56601)][['M_STADIUMKEY', 'M_ATTENDANCE', 'M_DURATION', 'M_MATCHKEY', 'M_SCORE1']].merge(stadium[['S_NAME', 'S_CITY', 'S_LOCATION', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_CITY', 'S_NAME', 'S_STADIUMKEY', 'S_LOCATION']).agg('min', numeric_only=True)

match[(match['M_TEAM2KEY'] == 't') | (match['M_DATE'] >= '2022-11-20') & (match['M_TEAM1KEY'].str.startswith('t')) | (match['M_DATE'] < '2022-11-20') | (match['M_STADIUMKEY'] != 7) | (match['M_TEAM2KEY'] != 't') & (match['M_DURATION'] > 94) | (match['M_STADIUMKEY'] <= 9) & (match['M_SCORE2'] == 4)][['M_ATTENDANCE', 'M_SCORE2', 'M_TEAM2KEY', 'M_TEAM1KEY', 'M_SCORE1', 'M_STADIUMKEY', 'M_TIME', 'M_MATCHKEY', 'M_DURATION']].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']).agg('count')