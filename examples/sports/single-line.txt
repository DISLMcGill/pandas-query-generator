coach

coach

coach

match

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

stadium

team

team

team

team

team

team

team

team

team

team

team

team

team

team

team

team

team

team

team

team

team

team

association[['A_ASSOCKEY']]

association[['A_FOUNDEDYEAR']]

association[['A_FOUNDEDYEAR']]

association[['A_PRESIDENT']]

coach[['C_COACHKEY']]

coach[['C_EXPYEARS']]

coach[['C_EXPYEARS']]

coach[['C_ROLE']]

coach[['C_ROLE']]

match[['M_ATTENDANCE']]

match[['M_MATCHKEY']]

match[['M_TIME']]

stadium[(stadium['S_CAPACITY'] > 84001)]

stadium[(stadium['S_CITY'] != 'r')]

stadium[(stadium['S_CITY'] == 'd')]

stadium[(stadium['S_LOCATION'] == 'w')]

stadium[(stadium['S_STADIUMKEY'] <= 1)]

stadium[(stadium['S_STADIUMKEY'] > 9)]

stadium[['S_YEARBUILT']]

team[(team['T_GROUP'].isin(['c', 'f']))]

team[(team['T_GROUP'].isin(['f', 'b', 'h', 'a', 'g', 'c']))]

team[(team['T_PLAYERCOUNT'] < 18)]

team[(team['T_PLAYERCOUNT'] == 23)]

team[(team['T_PLAYERCOUNT'] >= 22)]

team[(team['T_TEAMKEY'] == 't')]

team[(team['T_TEAMKEY'] == 't')]

team[(team['T_TEAMKEY'] == 't')]

team[(team['T_TEAMKEY'] == 't')]

team[(team['T_TEAMKEY'].str.startswith('t'))]

team[['T_GROUP']]

team[['T_PLAYERCOUNT']]

team[['T_PLAYERCOUNT']]

team[['T_PLAYERCOUNT']]

team[['T_PLAYERCOUNT']]

team[['T_TEAMKEY']]

team[['T_TEAMKEY']]

association.merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association.merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association.merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association.merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association.merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_ASSOCKEY'] == 'f') | (association['A_FOUNDEDYEAR'] == 1983)]

association[['A_ASSOCKEY', 'A_PRESIDENT']]

association[['A_PRESIDENT', 'A_FOUNDEDYEAR']]

association[['A_PRESIDENT', 'A_FOUNDEDYEAR']]

coach.merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_EXPYEARS', 'C_NAME']]

coach[['C_ROLE', 'C_EXPYEARS']]

match[['M_ROUND', 'M_TEAM1KEY']]

stadium.groupby(by=['S_CITY']).agg('count')

stadium.groupby(by=['S_LOCATION']).agg('mean', numeric_only=True)

stadium.groupby(by=['S_LOCATION']).agg('min', numeric_only=True)

stadium.groupby(by=['S_LOCATION']).agg('sum', numeric_only=True)

stadium.groupby(by=['S_NAME']).agg('mean', numeric_only=True)

stadium.groupby(by=['S_STADIUMKEY']).agg('count')

stadium.groupby(by=['S_YEARBUILT']).agg('max', numeric_only=True)

stadium.groupby(by=['S_YEARBUILT']).agg('sum', numeric_only=True)

stadium.groupby(by=['S_YEARBUILT']).agg('sum', numeric_only=True)

stadium[(stadium['S_LOCATION'].str.startswith('w')) | (stadium['S_CAPACITY'] <= 50909)]

stadium[(stadium['S_STADIUMKEY'] >= 11) | (stadium['S_CITY'].str.startswith('l'))]

stadium[['S_CAPACITY', 'S_LOCATION']]

stadium[['S_LOCATION', 'S_NAME']]

stadium[['S_NAME', 'S_STADIUMKEY']]

stadium[['S_YEARBUILT', 'S_NAME']]

stadium[['S_YEARBUILT', 'S_STADIUMKEY']]

team.groupby(by=['T_GROUP']).agg('count')

team.groupby(by=['T_GROUP']).agg('max', numeric_only=True)

team.groupby(by=['T_PLAYERCOUNT']).agg('max', numeric_only=True)

team.groupby(by=['T_PLAYERCOUNT']).agg('mean', numeric_only=True)

team.groupby(by=['T_TEAMKEY']).agg('max', numeric_only=True)

team.groupby(by=['T_TEAMKEY']).agg('max', numeric_only=True)

team.groupby(by=['T_TEAMKEY']).agg('min', numeric_only=True)

team.groupby(by=['T_TEAMKEY']).agg('min', numeric_only=True)

team.groupby(by=['T_TEAMKEY']).agg('sum', numeric_only=True)

team.groupby(by=['T_TEAMKEY']).agg('sum', numeric_only=True)

team[(team['T_GROUP'].isin(['g', 'c', 'a', 'd', 'h'])) | (team['T_PLAYERCOUNT'] == 25)]

team[(team['T_PLAYERCOUNT'] < 25) | (team['T_TEAMKEY'] != 't')]

team[(team['T_PLAYERCOUNT'] > 20) & (team['T_PLAYERCOUNT'] < 18)]

team[(team['T_TEAMKEY'] != 't') & (team['T_PLAYERCOUNT'] != 24)]

team[(team['T_TEAMKEY'] == 't') | (team['T_GROUP'].isin(['a', 'g']))]

team[(team['T_TEAMKEY'] == 't') | (team['T_PLAYERCOUNT'] >= 24)]

team[['T_GROUP', 'T_PLAYERCOUNT']]

team[['T_GROUP', 'T_PLAYERCOUNT']]

team[['T_GROUP', 'T_TEAMKEY']]

team[['T_GROUP', 'T_TEAMKEY']]

team[['T_GROUP', 'T_TEAMKEY']]

team[['T_PLAYERCOUNT', 'T_GROUP']]

team[['T_PLAYERCOUNT', 'T_GROUP']]

team[['T_PLAYERCOUNT', 'T_GROUP']]

team[['T_TEAMKEY', 'T_GROUP']]

team[['T_TEAMKEY', 'T_GROUP']]

team[['T_TEAMKEY', 'T_PLAYERCOUNT']]

association[['A_ASSOCKEY', 'A_PRESIDENT', 'A_FOUNDEDYEAR']]

match[['M_DURATION', 'M_MATCHKEY', 'M_SCORE2']]

match[['M_MATCHKEY', 'M_SCORE1', 'M_DURATION']]

match[['M_MATCHKEY', 'M_SCORE1', 'M_SCORE2']]

match[['M_SCORE2', 'M_SCORE1', 'M_TIME']]

stadium.groupby(by=['S_CAPACITY', 'S_NAME']).agg('max', numeric_only=True)

stadium.groupby(by=['S_CITY', 'S_LOCATION']).agg('min', numeric_only=True)

stadium.groupby(by=['S_CITY', 'S_LOCATION']).agg('sum', numeric_only=True)

stadium.groupby(by=['S_NAME', 'S_CAPACITY']).agg('max', numeric_only=True)

stadium.groupby(by=['S_NAME', 'S_STADIUMKEY']).agg('sum', numeric_only=True)

stadium.groupby(by=['S_YEARBUILT', 'S_CAPACITY']).agg('count')

stadium[(stadium['S_CITY'] == 'l') & (stadium['S_CAPACITY'] <= 87495) | (stadium['S_YEARBUILT'] < 1968)]

stadium[(stadium['S_NAME'] == 's') | (stadium['S_CAPACITY'] <= 44903) | (stadium['S_CITY'].str.startswith('d'))]

stadium[(stadium['S_NAME'].str.startswith('s')) & (stadium['S_CITY'] != 'l') | (stadium['S_LOCATION'].str.startswith('c'))]

stadium[(stadium['S_STADIUMKEY'] < 2) & (stadium['S_YEARBUILT'] > 2013) & (stadium['S_STADIUMKEY'] != 2)]

stadium[(stadium['S_STADIUMKEY'] >= 6) & (stadium['S_STADIUMKEY'] > 2) & (stadium['S_NAME'].str.startswith('s'))]

stadium[['S_CAPACITY', 'S_YEARBUILT', 'S_LOCATION']]

stadium[['S_CITY', 'S_CAPACITY', 'S_LOCATION']]

stadium[['S_CITY', 'S_CAPACITY', 'S_NAME']]

stadium[['S_LOCATION', 'S_YEARBUILT', 'S_NAME']]

stadium[['S_NAME', 'S_CAPACITY', 'S_STADIUMKEY']]

stadium[['S_NAME', 'S_CITY', 'S_CAPACITY']]

team.groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('count')

team.groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

team.groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

team.groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('count')

team.groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('max', numeric_only=True)

team.groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('max', numeric_only=True)

team.groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY']).agg('mean', numeric_only=True)

team.groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY']).agg('min', numeric_only=True)

team.groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY']).agg('min', numeric_only=True)

team.groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('mean', numeric_only=True)

team.groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('mean', numeric_only=True)

team.groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

team.groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

team[(team['T_GROUP'] == 'h') & (team['T_GROUP'] != 'a') | (team['T_GROUP'] == 'f')]

team[(team['T_GROUP'] == 'h') | (team['T_TEAMKEY'] == 't') | (team['T_GROUP'].isin(['h', 'c', 'a', 'd', 'b', 'f', 'e', 'g']))]

team[(team['T_GROUP'].isin(['a', 'f'])) | (team['T_TEAMKEY'] != 't') | (team['T_PLAYERCOUNT'] != 20)]

team[(team['T_GROUP'].isin(['g', 'a', 'e', 'c', 'h', 'b', 'd', 'f'])) | (team['T_PLAYERCOUNT'] == 25) | (team['T_GROUP'] == 'e')]

team[(team['T_PLAYERCOUNT'] <= 21) & (team['T_TEAMKEY'] != 't') & (team['T_PLAYERCOUNT'] > 24)]

team[(team['T_TEAMKEY'] != 't') & (team['T_TEAMKEY'] == 't') & (team['T_PLAYERCOUNT'] <= 21)]

team[(team['T_TEAMKEY'] == 't') & (team['T_PLAYERCOUNT'] >= 18) & (team['T_PLAYERCOUNT'] > 23)]

team[(team['T_TEAMKEY'] == 't') | (team['T_PLAYERCOUNT'] != 18) & (team['T_GROUP'] != 'd')]

team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_TEAMKEY'].str.startswith('t')) | (team['T_PLAYERCOUNT'] != 21)]

team[['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']]

team[['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']]

team[['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']]

team[['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']]

team[['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']]

team[['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']]

team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']]

team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']]

team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']]

team[['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']]

association.merge(team[(team['T_GROUP'].isin(['d', 'h', 'g', 'b', 'e']))], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association.merge(team[(team['T_PLAYERCOUNT'] != 22)], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_ASSOCKEY'] == 'f') | (association['A_FOUNDEDYEAR'] > 1950) & (association['A_PRESIDENT'] == 'p') | (association['A_PRESIDENT'] == 'p')]

coach.merge(team[(team['T_GROUP'] != 'e')], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[(team['T_PLAYERCOUNT'] <= 24)], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[(team['T_PLAYERCOUNT'] > 24)], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[(team['T_TEAMKEY'].str.startswith('t'))], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_COACHKEY'] == 67) & (coach['C_NAME'] == 'c') & (coach['C_NAME'] != 'c') | (coach['C_NAME'] == 'c')]

coach[(coach['C_NAME'].str.startswith('c'))][['C_ROLE']]

coach[(coach['C_ROLE'] == 'goalkeeper coach')][['C_NAME']]

coach[['C_EXPYEARS', 'C_ROLE', 'C_COACHKEY', 'C_NAME']]

coach[['C_ROLE', 'C_EXPYEARS', 'C_COACHKEY', 'C_TEAMKEY']]

match[['M_ATTENDANCE', 'M_MATCHKEY', 'M_SCORE1', 'M_SCORE2']]

stadium.groupby(by=['S_LOCATION', 'S_CAPACITY', 'S_CITY']).agg('count')

stadium.groupby(by=['S_LOCATION', 'S_CITY', 'S_YEARBUILT']).agg('min', numeric_only=True)

stadium.groupby(by=['S_NAME', 'S_STADIUMKEY', 'S_LOCATION']).agg('min', numeric_only=True)

stadium.groupby(by=['S_STADIUMKEY', 'S_LOCATION', 'S_CAPACITY']).agg('max', numeric_only=True)

stadium.groupby(by=['S_YEARBUILT', 'S_CAPACITY', 'S_LOCATION']).agg('count')

stadium.groupby(by=['S_YEARBUILT', 'S_STADIUMKEY', 'S_CITY']).agg('count')

stadium[(stadium['S_CAPACITY'] < 66795) & (stadium['S_CITY'] != 'd') & (stadium['S_YEARBUILT'] == 2020) | (stadium['S_NAME'].str.startswith('s'))]

stadium[(stadium['S_CITY'] != 'd') | (stadium['S_NAME'].str.startswith('s')) & (stadium['S_YEARBUILT'] >= 1990) | (stadium['S_NAME'] != 's')]

stadium[(stadium['S_LOCATION'] != 's') & (stadium['S_CAPACITY'] != 83231) | (stadium['S_CITY'] != 'r') | (stadium['S_CITY'].str.startswith('a'))]

stadium[(stadium['S_NAME'] == 's') & (stadium['S_STADIUMKEY'] > 6) & (stadium['S_STADIUMKEY'] >= 10) | (stadium['S_NAME'].str.startswith('s'))]

stadium[(stadium['S_NAME'] == 's')][['S_LOCATION']]

stadium[(stadium['S_STADIUMKEY'] <= 3) | (stadium['S_CAPACITY'] > 47803) & (stadium['S_NAME'] == 's') & (stadium['S_LOCATION'].str.startswith('w'))]

stadium[(stadium['S_YEARBUILT'] < 2014) & (stadium['S_LOCATION'] != 's') | (stadium['S_CAPACITY'] != 46999) | (stadium['S_YEARBUILT'] >= 2004)]

stadium[(stadium['S_YEARBUILT'] <= 1981) | (stadium['S_NAME'].str.startswith('s')) | (stadium['S_CITY'] == 'r') & (stadium['S_CAPACITY'] != 68016)]

stadium[(stadium['S_YEARBUILT'] <= 1987) & (stadium['S_NAME'] == 's') | (stadium['S_CAPACITY'] > 56758) & (stadium['S_CAPACITY'] <= 76009)]

stadium[['S_CITY', 'S_NAME', 'S_CAPACITY', 'S_STADIUMKEY']]

stadium[['S_NAME', 'S_CAPACITY', 'S_STADIUMKEY', 'S_YEARBUILT']]

stadium[['S_NAME', 'S_LOCATION', 'S_CITY', 'S_STADIUMKEY']]

stadium[['S_NAME', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_CAPACITY']]

team.groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('count')

team.groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('min', numeric_only=True)

team.groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('sum', numeric_only=True)

team.groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('sum', numeric_only=True)

team.groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('count')

team.groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('count')

team.groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('max', numeric_only=True)

team.groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('sum', numeric_only=True)

team.groupby(by=['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

team.groupby(by=['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

team.groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']).agg('sum', numeric_only=True)

team[(team['T_GROUP'] != 'e')][['T_TEAMKEY']]

team[(team['T_PLAYERCOUNT'] < 23)][['T_GROUP']]

team[(team['T_PLAYERCOUNT'] <= 19)][['T_TEAMKEY']]

team[(team['T_PLAYERCOUNT'] > 21)][['T_TEAMKEY']]

team[(team['T_PLAYERCOUNT'] > 25)][['T_GROUP']]

team[(team['T_TEAMKEY'].str.startswith('t'))][['T_GROUP']]

association.merge(team[(team['T_TEAMKEY'] != 't') | (team['T_PLAYERCOUNT'] < 25)], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association.merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association.merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_ASSOCKEY'] == 'f')].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_ASSOCKEY'].str.startswith('f')) | (association['A_PRESIDENT'].str.startswith('p'))][['A_FOUNDEDYEAR']]

association[(association['A_FOUNDEDYEAR'] < 1991) | (association['A_FOUNDEDYEAR'] <= 1912)][['A_PRESIDENT']]

association[(association['A_PRESIDENT'] == 'p')][['A_ASSOCKEY', 'A_FOUNDEDYEAR']]

association[(association['A_TEAMKEY'] == 't') | (association['A_TEAMKEY'] == 't')][['A_PRESIDENT']]

association[(association['A_TEAMKEY'] == 't')].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_FOUNDEDYEAR']].groupby(by=['A_FOUNDEDYEAR']).agg('sum', numeric_only=True)

association[['A_FOUNDEDYEAR']].groupby(by=['A_FOUNDEDYEAR']).agg('sum', numeric_only=True)

coach.merge(team[(team['T_GROUP'] == 'e') | (team['T_PLAYERCOUNT'] < 25)], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'] != 'c')].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'] == 'c') | (coach['C_COACHKEY'] <= 24) | (coach['C_NAME'] != 'c') & (coach['C_ROLE'] == 'goalkeeper coach') | (coach['C_EXPYEARS'] <= 6)]

coach[(coach['C_NAME'] == 'c')][['C_ROLE', 'C_TEAMKEY']]

coach[(coach['C_TEAMKEY'] == 't')][['C_NAME', 'C_EXPYEARS']]

coach[['C_COACHKEY']].groupby(by=['C_COACHKEY']).agg('max', numeric_only=True)

coach[['C_EXPYEARS']].groupby(by=['C_EXPYEARS']).agg('mean', numeric_only=True)

coach[['C_ROLE']].groupby(by=['C_ROLE']).agg('min', numeric_only=True)

match[(match['M_TEAM1KEY'] != 't') | (match['M_ATTENDANCE'] != 73624) | (match['M_STADIUMKEY'] == 7) | (match['M_SCORE1'] < 3) & (match['M_DURATION'] <= 110)]

match[['M_MATCHKEY']].groupby(by=['M_MATCHKEY']).agg('mean', numeric_only=True)

stadium.groupby(by=['S_CAPACITY', 'S_CITY', 'S_STADIUMKEY', 'S_NAME']).agg('min', numeric_only=True)

stadium.groupby(by=['S_CAPACITY', 'S_STADIUMKEY', 'S_NAME', 'S_CITY']).agg('max', numeric_only=True)

stadium.groupby(by=['S_CAPACITY', 'S_YEARBUILT', 'S_NAME', 'S_CITY']).agg('mean', numeric_only=True)

stadium.groupby(by=['S_CITY', 'S_CAPACITY', 'S_NAME', 'S_YEARBUILT']).agg('min', numeric_only=True)

stadium.groupby(by=['S_LOCATION', 'S_STADIUMKEY', 'S_CITY', 'S_YEARBUILT']).agg('mean', numeric_only=True)

stadium.groupby(by=['S_NAME', 'S_STADIUMKEY', 'S_CITY', 'S_YEARBUILT']).agg('max', numeric_only=True)

stadium.groupby(by=['S_YEARBUILT', 'S_NAME', 'S_LOCATION', 'S_CAPACITY']).agg('count')

stadium[(stadium['S_CAPACITY'] > 74617) & (stadium['S_CAPACITY'] < 59333) | (stadium['S_CAPACITY'] > 76513) | (stadium['S_NAME'] == 's') | (stadium['S_LOCATION'] == 's')]

stadium[(stadium['S_NAME'] != 's') & (stadium['S_LOCATION'] != 'c') & (stadium['S_CAPACITY'] > 71463) & (stadium['S_CITY'] == 'a') | (stadium['S_LOCATION'] == 's')]

stadium[(stadium['S_NAME'].str.startswith('s'))].groupby(by=['S_CAPACITY']).agg('sum', numeric_only=True)

stadium[(stadium['S_YEARBUILT'] != 1964) | (stadium['S_CAPACITY'] < 81605)][['S_CITY']]

stadium[(stadium['S_YEARBUILT'] <= 1987)].groupby(by=['S_STADIUMKEY']).agg('sum', numeric_only=True)

stadium[(stadium['S_YEARBUILT'] > 1952)][['S_YEARBUILT', 'S_LOCATION']]

stadium[['S_CAPACITY', 'S_LOCATION', 'S_YEARBUILT', 'S_CITY', 'S_NAME']]

stadium[['S_CAPACITY', 'S_NAME', 'S_STADIUMKEY', 'S_YEARBUILT', 'S_LOCATION']]

stadium[['S_CITY', 'S_CAPACITY', 'S_LOCATION', 'S_NAME', 'S_YEARBUILT']]

stadium[['S_CITY']].groupby(by=['S_CITY']).agg('max', numeric_only=True)

stadium[['S_CITY']].groupby(by=['S_CITY']).agg('sum', numeric_only=True)

stadium[['S_LOCATION', 'S_YEARBUILT', 'S_CITY', 'S_NAME', 'S_STADIUMKEY']]

stadium[['S_NAME', 'S_CAPACITY', 'S_STADIUMKEY', 'S_CITY', 'S_LOCATION']]

stadium[['S_STADIUMKEY']].groupby(by=['S_STADIUMKEY']).agg('count')

stadium[['S_STADIUMKEY']].groupby(by=['S_STADIUMKEY']).agg('sum', numeric_only=True)

stadium[['S_YEARBUILT', 'S_CITY', 'S_NAME', 'S_LOCATION', 'S_CAPACITY']]

team[(team['T_PLAYERCOUNT'] != 24)][['T_PLAYERCOUNT', 'T_GROUP']]

team[(team['T_PLAYERCOUNT'] == 22)].groupby(by=['T_GROUP']).agg('sum', numeric_only=True)

team[(team['T_TEAMKEY'].str.startswith('t'))][['T_PLAYERCOUNT', 'T_TEAMKEY']]

team[(team['T_TEAMKEY'].str.startswith('t'))][['T_TEAMKEY', 'T_GROUP']]

team[['T_GROUP']].groupby(by=['T_GROUP']).agg('count')

team[['T_GROUP']].groupby(by=['T_GROUP']).agg('mean', numeric_only=True)

team[['T_GROUP']].groupby(by=['T_GROUP']).agg('min', numeric_only=True)

team[['T_PLAYERCOUNT']].groupby(by=['T_PLAYERCOUNT']).agg('max', numeric_only=True)

team[['T_PLAYERCOUNT']].groupby(by=['T_PLAYERCOUNT']).agg('mean', numeric_only=True)

team[['T_TEAMKEY']].groupby(by=['T_TEAMKEY']).agg('count')

team[['T_TEAMKEY']].groupby(by=['T_TEAMKEY']).agg('mean', numeric_only=True)

association.merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_PRESIDENT']).agg('count')

association.merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT']).agg('sum', numeric_only=True)

association.merge(team[(team['T_GROUP'].isin(['b', 'h', 'f', 'e', 'g', 'c'])) | (team['T_PLAYERCOUNT'] < 23) | (team['T_PLAYERCOUNT'] == 22)], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association.merge(team[(team['T_PLAYERCOUNT'] < 19) & (team['T_TEAMKEY'].str.startswith('t')) | (team['T_GROUP'] == 'h')], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association.merge(team[(team['T_PLAYERCOUNT'] >= 18) & (team['T_GROUP'].isin(['g', 'f', 'a', 'c', 'b'])) | (team['T_GROUP'].isin(['f', 'h', 'g', 'e', 'c']))], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association.merge(team[(team['T_TEAMKEY'].str.startswith('t')) | (team['T_TEAMKEY'] != 't') | (team['T_TEAMKEY'] != 't')], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_TEAMKEY'].str.startswith('t')) & (association['A_FOUNDEDYEAR'] != 1941)].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_TEAMKEY'].str.startswith('t')) | (association['A_FOUNDEDYEAR'] > 1923)][['A_ASSOCKEY', 'A_FOUNDEDYEAR']]

association[['A_PRESIDENT', 'A_FOUNDEDYEAR']].groupby(by=['A_PRESIDENT']).agg('count')

association[['A_TEAMKEY', 'A_FOUNDEDYEAR']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_TEAMKEY', 'A_FOUNDEDYEAR']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_COACHKEY']).agg('count')

coach.merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_EXPYEARS']).agg('mean', numeric_only=True)

coach.merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_NAME']).agg('max', numeric_only=True)

coach.merge(team[(team['T_GROUP'].isin(['e', 'f'])) & (team['T_PLAYERCOUNT'] <= 19) & (team['T_PLAYERCOUNT'] <= 22)], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[(team['T_PLAYERCOUNT'] <= 20) & (team['T_GROUP'] == 'a') & (team['T_GROUP'].isin(['e', 'b', 'a', 'h', 'f']))], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'].str.startswith('c'))][['C_EXPYEARS', 'C_COACHKEY', 'C_NAME']]

coach[(coach['C_ROLE'] != 'fitness coach') & (coach['C_COACHKEY'] > 23) & (coach['C_COACHKEY'] > 19)][['C_EXPYEARS']]

coach[['C_ROLE', 'C_NAME']].groupby(by=['C_ROLE']).agg('sum', numeric_only=True)

match.merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_TEAM2KEY'] != 't') & (match['M_DURATION'] >= 118) | (match['M_DATE'] <= '2022-11-20') | (match['M_STADIUMKEY'] >= 4) | (match['M_TIME'] != '2') & (match['M_DATE'] >= '2022-12-18')]

match[['M_ATTENDANCE', 'M_DATE']].groupby(by=['M_DATE']).agg('sum', numeric_only=True)

match[['M_DURATION', 'M_MATCHKEY', 'M_TEAM2KEY', 'M_SCORE2', 'M_SCORE1', 'M_ROUND']]

match[['M_SCORE1', 'M_MATCHKEY']].groupby(by=['M_SCORE1']).agg('mean', numeric_only=True)

stadium.groupby(by=['S_CAPACITY', 'S_NAME', 'S_YEARBUILT', 'S_CITY', 'S_LOCATION']).agg('max', numeric_only=True)

stadium.groupby(by=['S_CITY', 'S_LOCATION', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_NAME']).agg('max', numeric_only=True)

stadium.groupby(by=['S_CITY', 'S_NAME', 'S_LOCATION', 'S_YEARBUILT', 'S_CAPACITY']).agg('count')

stadium.groupby(by=['S_LOCATION', 'S_NAME', 'S_YEARBUILT', 'S_CITY', 'S_CAPACITY']).agg('sum', numeric_only=True)

stadium.groupby(by=['S_STADIUMKEY', 'S_CITY', 'S_LOCATION', 'S_CAPACITY', 'S_YEARBUILT']).agg('min', numeric_only=True)

stadium.groupby(by=['S_STADIUMKEY', 'S_NAME', 'S_CITY', 'S_YEARBUILT', 'S_CAPACITY']).agg('count')

stadium.groupby(by=['S_YEARBUILT', 'S_NAME', 'S_CITY', 'S_CAPACITY', 'S_STADIUMKEY']).agg('mean', numeric_only=True)

stadium[(stadium['S_CAPACITY'] > 67471) & (stadium['S_NAME'] != 's') & (stadium['S_STADIUMKEY'] != 7) & (stadium['S_STADIUMKEY'] > 4) | (stadium['S_NAME'] != 's') & (stadium['S_LOCATION'] == 'c')]

stadium[(stadium['S_CITY'].str.startswith('a')) | (stadium['S_CAPACITY'] <= 81964) | (stadium['S_STADIUMKEY'] != 1) | (stadium['S_NAME'] != 's') | (stadium['S_CAPACITY'] >= 77666) & (stadium['S_CITY'] != 'l')]

stadium[(stadium['S_LOCATION'].str.startswith('c')) & (stadium['S_CAPACITY'] <= 50297) | (stadium['S_STADIUMKEY'] == 9) | (stadium['S_CAPACITY'] > 43442) | (stadium['S_CAPACITY'] > 61512) | (stadium['S_LOCATION'] != 'c')]

stadium[(stadium['S_LOCATION'].str.startswith('e')) & (stadium['S_CAPACITY'] <= 81289) & (stadium['S_NAME'] != 's') & (stadium['S_LOCATION'].str.startswith('e')) | (stadium['S_YEARBUILT'] < 2018) & (stadium['S_LOCATION'] == 'w')]

stadium[(stadium['S_LOCATION'].str.startswith('w'))].groupby(by=['S_STADIUMKEY', 'S_CAPACITY']).agg('max', numeric_only=True)

stadium[(stadium['S_YEARBUILT'] != 1975)].groupby(by=['S_CITY', 'S_CAPACITY']).agg('min', numeric_only=True)

stadium[['S_CITY', 'S_CAPACITY', 'S_LOCATION', 'S_NAME', 'S_YEARBUILT', 'S_STADIUMKEY']]

stadium[['S_CITY', 'S_NAME', 'S_CAPACITY', 'S_STADIUMKEY', 'S_YEARBUILT', 'S_LOCATION']]

stadium[['S_CITY', 'S_NAME', 'S_CAPACITY', 'S_STADIUMKEY', 'S_YEARBUILT', 'S_LOCATION']]

stadium[['S_YEARBUILT', 'S_LOCATION', 'S_CAPACITY', 'S_NAME', 'S_CITY', 'S_STADIUMKEY']]

stadium[['S_YEARBUILT', 'S_LOCATION']].groupby(by=['S_LOCATION']).agg('sum', numeric_only=True)

team[(team['T_GROUP'] != 'd')].groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

team[(team['T_GROUP'] != 'e')][['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']]

team[(team['T_GROUP'] != 'f') & (team['T_GROUP'].isin(['f', 'g', 'd', 'c', 'h']))][['T_GROUP', 'T_TEAMKEY']]

team[(team['T_GROUP'] == 'a') | (team['T_PLAYERCOUNT'] > 23)].groupby(by=['T_PLAYERCOUNT']).agg('mean', numeric_only=True)

team[(team['T_GROUP'].isin(['c', 'h', 'a'])) & (team['T_TEAMKEY'].str.startswith('t'))].groupby(by=['T_TEAMKEY']).agg('max', numeric_only=True)

team[(team['T_GROUP'].isin(['f', 'h', 'c', 'g', 'b'])) | (team['T_TEAMKEY'] != 't')].groupby(by=['T_PLAYERCOUNT']).agg('count')

team[(team['T_PLAYERCOUNT'] != 21)].groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('min', numeric_only=True)

team[(team['T_PLAYERCOUNT'] != 22) | (team['T_TEAMKEY'] == 't') | (team['T_GROUP'].isin(['e', 'h']))][['T_TEAMKEY']]

team[(team['T_PLAYERCOUNT'] < 21) & (team['T_GROUP'] != 'e') | (team['T_GROUP'].isin(['h']))][['T_GROUP']]

team[(team['T_PLAYERCOUNT'] == 25)][['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']]

team[(team['T_PLAYERCOUNT'] > 19) & (team['T_TEAMKEY'].str.startswith('t'))].groupby(by=['T_GROUP']).agg('max', numeric_only=True)

team[(team['T_TEAMKEY'] != 't') & (team['T_PLAYERCOUNT'] > 18)].groupby(by=['T_GROUP']).agg('count')

team[(team['T_TEAMKEY'] != 't')].groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('min', numeric_only=True)

team[(team['T_TEAMKEY'].str.startswith('t'))][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']]

team[['T_GROUP', 'T_PLAYERCOUNT']].groupby(by=['T_GROUP']).agg('mean', numeric_only=True)

team[['T_GROUP', 'T_TEAMKEY']].groupby(by=['T_GROUP']).agg('sum', numeric_only=True)

team[['T_TEAMKEY', 'T_PLAYERCOUNT']].groupby(by=['T_PLAYERCOUNT']).agg('min', numeric_only=True)

association.merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'A_ASSOCKEY']).agg('mean', numeric_only=True)

association.merge(team[(team['T_GROUP'].isin(['f', 'a', 'h', 'g', 'c', 'b', 'e', 'd']))][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association.merge(team[(team['T_TEAMKEY'] != 't')][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_PRESIDENT'] == 'p')].merge(team[(team['T_TEAMKEY'].str.startswith('t'))], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_PRESIDENT'].str.startswith('p')) & (association['A_TEAMKEY'].str.startswith('t'))][['A_PRESIDENT', 'A_ASSOCKEY', 'A_FOUNDEDYEAR']]

association[['A_ASSOCKEY', 'A_TEAMKEY', 'A_FOUNDEDYEAR']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_FOUNDEDYEAR', 'A_ASSOCKEY']].groupby(by=['A_FOUNDEDYEAR', 'A_ASSOCKEY']).agg('sum', numeric_only=True)

association[['A_FOUNDEDYEAR', 'A_PRESIDENT']].groupby(by=['A_FOUNDEDYEAR', 'A_PRESIDENT']).agg('sum', numeric_only=True)

association[['A_PRESIDENT', 'A_ASSOCKEY', 'A_FOUNDEDYEAR']].groupby(by=['A_PRESIDENT']).agg('mean', numeric_only=True)

association[['A_PRESIDENT', 'A_ASSOCKEY', 'A_TEAMKEY']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_PRESIDENT', 'A_ASSOCKEY']].groupby(by=['A_PRESIDENT', 'A_ASSOCKEY']).agg('mean', numeric_only=True)

association[['A_PRESIDENT', 'A_FOUNDEDYEAR']].groupby(by=['A_PRESIDENT', 'A_FOUNDEDYEAR']).agg('min', numeric_only=True)

association[['A_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] > 25)], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] >= 19)], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_ROLE', 'T_PLAYERCOUNT']).agg('mean', numeric_only=True)

coach[(coach['C_EXPYEARS'] > 30) & (coach['C_NAME'].str.startswith('c')) | (coach['C_EXPYEARS'] > 36)].groupby(by=['C_COACHKEY']).agg('sum', numeric_only=True)

coach[(coach['C_NAME'] != 'c') | (coach['C_EXPYEARS'] < 19) | (coach['C_NAME'].str.startswith('c')) & (coach['C_TEAMKEY'] != 't')][['C_COACHKEY']]

coach[(coach['C_ROLE'] != 'fitness coach') & (coach['C_ROLE'] == 'head coach') & (coach['C_ROLE'] != 'assistant coach')][['C_ROLE', 'C_NAME']]

coach[(coach['C_ROLE'] != 'head coach') | (coach['C_NAME'].str.startswith('c')) & (coach['C_COACHKEY'] != 19)].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_ROLE', 'C_EXPYEARS']].groupby(by=['C_EXPYEARS', 'C_ROLE']).agg('mean', numeric_only=True)

match[(match['M_STADIUMKEY'] <= 9) & (match['M_SCORE2'] < 4) & (match['M_TEAM1KEY'] != 't')].merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[['M_SCORE2', 'M_TIME', 'M_ROUND']].groupby(by=['M_TIME']).agg('mean', numeric_only=True)

match[['M_TIME', 'M_SCORE1']].groupby(by=['M_TIME', 'M_SCORE1']).agg('count')

match[['M_TIME', 'M_TEAM2KEY', 'M_SCORE2']].merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

stadium[(stadium['S_YEARBUILT'] <= 2008) & (stadium['S_CAPACITY'] >= 40320) & (stadium['S_NAME'] == 's')][['S_LOCATION', 'S_CAPACITY']]

stadium[['S_CAPACITY', 'S_STADIUMKEY']].groupby(by=['S_CAPACITY', 'S_STADIUMKEY']).agg('min', numeric_only=True)

stadium[['S_CAPACITY', 'S_YEARBUILT', 'S_CITY']].groupby(by=['S_CITY']).agg('max', numeric_only=True)

team[(team['T_GROUP'] != 'a') | (team['T_TEAMKEY'].str.startswith('t'))].groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY']).agg('sum', numeric_only=True)

team[(team['T_GROUP'] != 'c') & (team['T_PLAYERCOUNT'] <= 25) & (team['T_TEAMKEY'] != 't')][['T_TEAMKEY', 'T_PLAYERCOUNT']]

team[(team['T_GROUP'].isin(['e'])) & (team['T_GROUP'] != 'e')][['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']]

team[(team['T_PLAYERCOUNT'] != 24) & (team['T_GROUP'].isin(['b']))].groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('max', numeric_only=True)

team[(team['T_PLAYERCOUNT'] < 21) & (team['T_PLAYERCOUNT'] <= 18)][['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']]

team[(team['T_TEAMKEY'] != 't') & (team['T_TEAMKEY'] != 't') & (team['T_GROUP'].isin(['g', 'd', 'a', 'b', 'e']))].groupby(by=['T_TEAMKEY']).agg('count')

team[(team['T_TEAMKEY'] != 't') | (team['T_GROUP'] != 'e') | (team['T_GROUP'] == 'a')][['T_GROUP', 'T_PLAYERCOUNT']]

team[(team['T_TEAMKEY'] != 't')].groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('count')

team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_GROUP'] == 'c') | (team['T_PLAYERCOUNT'] != 24)].groupby(by=['T_TEAMKEY']).agg('mean', numeric_only=True)

team[['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']].groupby(by=['T_GROUP']).agg('min', numeric_only=True)

team[['T_GROUP', 'T_PLAYERCOUNT']].groupby(by=['T_PLAYERCOUNT', 'T_GROUP']).agg('min', numeric_only=True)

team[['T_PLAYERCOUNT', 'T_TEAMKEY']].groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY']).agg('mean', numeric_only=True)

team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']].groupby(by=['T_TEAMKEY']).agg('min', numeric_only=True)

association[(association['A_ASSOCKEY'] != 'f') & (association['A_FOUNDEDYEAR'] >= 1925) | (association['A_TEAMKEY'].str.startswith('t')) | (association['A_PRESIDENT'].str.startswith('p'))].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_ASSOCKEY'] != 'f')][['A_TEAMKEY']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_ASSOCKEY'].str.startswith('f'))][['A_ASSOCKEY']].groupby(by=['A_ASSOCKEY']).agg('mean', numeric_only=True)

association[(association['A_TEAMKEY'] != 't') & (association['A_ASSOCKEY'] == 'f')].merge(team[(team['T_PLAYERCOUNT'] != 21)], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_TEAMKEY'].str.startswith('t')) & (association['A_TEAMKEY'].str.startswith('t'))].merge(team[(team['T_GROUP'].isin(['g', 'a', 'c', 'b']))], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_TEAMKEY'].str.startswith('t'))][['A_ASSOCKEY']].groupby(by=['A_ASSOCKEY']).agg('max', numeric_only=True)

association[['A_ASSOCKEY', 'A_TEAMKEY', 'A_PRESIDENT', 'A_FOUNDEDYEAR']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_TEAMKEY']].merge(team[['T_GROUP', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_TEAMKEY', 'C_ROLE', 'C_NAME']).agg('max', numeric_only=True)

coach.merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'C_TEAMKEY', 'C_ROLE']).agg('sum', numeric_only=True)

coach.merge(team[(team['T_TEAMKEY'] != 't') & (team['T_TEAMKEY'] != 't')][['T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[(team['T_TEAMKEY'] == 't')][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_COACHKEY'] != 64) | (coach['C_TEAMKEY'].str.startswith('t')) | (coach['C_NAME'] != 'c') | (coach['C_COACHKEY'] == 43)][['C_TEAMKEY', 'C_NAME']]

coach[(coach['C_COACHKEY'] <= 53) & (coach['C_NAME'] == 'c') & (coach['C_EXPYEARS'] < 10) & (coach['C_EXPYEARS'] > 29)].groupby(by=['C_ROLE']).agg('min', numeric_only=True)

coach[(coach['C_COACHKEY'] <= 86) & (coach['C_ROLE'] != 'fitness coach') & (coach['C_ROLE'] == 'fitness coach') & (coach['C_NAME'] != 'c')].groupby(by=['C_ROLE']).agg('max', numeric_only=True)

coach[(coach['C_EXPYEARS'] <= 18)][['C_COACHKEY']].groupby(by=['C_COACHKEY']).agg('mean', numeric_only=True)

coach[(coach['C_EXPYEARS'] == 37) & (coach['C_EXPYEARS'] != 4) | (coach['C_ROLE'].isin(['fitness coach', 'head coach'])) & (coach['C_ROLE'].isin(['goalkeeper coach']))][['C_EXPYEARS', 'C_COACHKEY']]

coach[(coach['C_NAME'] != 'c') & (coach['C_TEAMKEY'] != 't') & (coach['C_ROLE'].isin(['assistant coach', 'head coach']))][['C_EXPYEARS', 'C_NAME', 'C_COACHKEY']]

coach[(coach['C_NAME'] != 'c') | (coach['C_ROLE'] == 'head coach') & (coach['C_ROLE'] != 'fitness coach')][['C_EXPYEARS', 'C_COACHKEY', 'C_NAME']]

coach[(coach['C_ROLE'] != 'head coach')][['C_TEAMKEY']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_TEAMKEY'].str.startswith('t'))][['C_NAME', 'C_EXPYEARS', 'C_TEAMKEY', 'C_COACHKEY', 'C_ROLE']]

coach[['C_COACHKEY', 'C_NAME', 'C_EXPYEARS', 'C_ROLE']].groupby(by=['C_NAME']).agg('count')

coach[['C_EXPYEARS', 'C_NAME', 'C_TEAMKEY', 'C_ROLE']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

match.merge(team[(team['T_TEAMKEY'] != 't')], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match.merge(team[(team['T_TEAMKEY'] == 't')], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_DATE'] >= '2022-12-18') | (match['M_DATE'] != '2022-11-20') & (match['M_ROUND'] == 'final') & (match['M_DURATION'] < 90)][['M_DURATION', 'M_MATCHKEY']]

match[['M_ATTENDANCE', 'M_DATE', 'M_DURATION']].groupby(by=['M_DURATION', 'M_ATTENDANCE']).agg('count')

match[['M_TEAM1KEY', 'M_MATCHKEY', 'M_DURATION', 'M_DATE']].merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[['M_TIME', 'M_SCORE1', 'M_TEAM1KEY', 'M_ATTENDANCE', 'M_ROUND', 'M_STADIUMKEY', 'M_DURATION', 'M_DATE']]

stadium[(stadium['S_CAPACITY'] < 70797) & (stadium['S_NAME'] == 's') & (stadium['S_CAPACITY'] == 54626)][['S_YEARBUILT', 'S_CAPACITY', 'S_NAME']]

stadium[(stadium['S_CITY'] != 'd')][['S_NAME']].groupby(by=['S_NAME']).agg('mean', numeric_only=True)

stadium[(stadium['S_LOCATION'] != 'c') & (stadium['S_LOCATION'] == 'n') | (stadium['S_STADIUMKEY'] > 2) | (stadium['S_CITY'].str.startswith('l'))].groupby(by=['S_STADIUMKEY']).agg('sum', numeric_only=True)

stadium[(stadium['S_NAME'] != 's') & (stadium['S_CITY'] == 'l') | (stadium['S_CAPACITY'] < 47134) | (stadium['S_STADIUMKEY'] > 5) & (stadium['S_NAME'].str.startswith('s'))][['S_STADIUMKEY']]

stadium[(stadium['S_NAME'] != 's')][['S_LOCATION', 'S_YEARBUILT', 'S_NAME', 'S_CITY', 'S_STADIUMKEY']]

stadium[(stadium['S_STADIUMKEY'] <= 6) & (stadium['S_NAME'].str.startswith('s'))][['S_LOCATION', 'S_NAME', 'S_STADIUMKEY', 'S_CAPACITY']]

stadium[(stadium['S_STADIUMKEY'] == 3) & (stadium['S_YEARBUILT'] >= 2020)].groupby(by=['S_LOCATION', 'S_CAPACITY', 'S_YEARBUILT']).agg('count')

stadium[(stadium['S_YEARBUILT'] < 1996) | (stadium['S_NAME'] != 's') | (stadium['S_YEARBUILT'] > 1962) & (stadium['S_NAME'] != 's')].groupby(by=['S_LOCATION']).agg('sum', numeric_only=True)

stadium[(stadium['S_YEARBUILT'] > 1984)].groupby(by=['S_CITY', 'S_STADIUMKEY', 'S_CAPACITY', 'S_NAME']).agg('max', numeric_only=True)

stadium[['S_CAPACITY', 'S_YEARBUILT', 'S_LOCATION']].groupby(by=['S_LOCATION', 'S_YEARBUILT']).agg('max', numeric_only=True)

stadium[['S_CITY', 'S_CAPACITY', 'S_STADIUMKEY', 'S_LOCATION']].groupby(by=['S_CAPACITY']).agg('count')

team[(team['T_GROUP'] != 'e') | (team['T_GROUP'] == 'h') & (team['T_GROUP'] == 'f')][['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']]

team[(team['T_GROUP'] == 'e') & (team['T_TEAMKEY'] == 't') & (team['T_TEAMKEY'].str.startswith('t'))][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']]

team[(team['T_GROUP'] == 'e')][['T_PLAYERCOUNT']].groupby(by=['T_PLAYERCOUNT']).agg('count')

team[(team['T_GROUP'] == 'f') | (team['T_TEAMKEY'] == 't')].groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('mean', numeric_only=True)

team[(team['T_GROUP'] == 'g') | (team['T_GROUP'] == 'h') | (team['T_GROUP'] == 'g')].groupby(by=['T_PLAYERCOUNT', 'T_GROUP']).agg('sum', numeric_only=True)

team[(team['T_PLAYERCOUNT'] != 19) & (team['T_PLAYERCOUNT'] != 23)].groupby(by=['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']).agg('sum', numeric_only=True)

team[(team['T_PLAYERCOUNT'] < 21)][['T_PLAYERCOUNT']].groupby(by=['T_PLAYERCOUNT']).agg('min', numeric_only=True)

team[(team['T_PLAYERCOUNT'] <= 18) & (team['T_PLAYERCOUNT'] <= 18)].groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('min', numeric_only=True)

team[(team['T_PLAYERCOUNT'] <= 19) & (team['T_GROUP'] == 'b') & (team['T_PLAYERCOUNT'] >= 18)][['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']]

team[(team['T_PLAYERCOUNT'] > 21) & (team['T_TEAMKEY'] == 't') & (team['T_TEAMKEY'] == 't')][['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']]

team[(team['T_PLAYERCOUNT'] > 23)][['T_PLAYERCOUNT']].groupby(by=['T_PLAYERCOUNT']).agg('max', numeric_only=True)

team[(team['T_PLAYERCOUNT'] >= 18) & (team['T_TEAMKEY'] == 't')].groupby(by=['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

team[(team['T_TEAMKEY'] != 't') & (team['T_GROUP'] != 'c') & (team['T_PLAYERCOUNT'] <= 18)].groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY']).agg('max', numeric_only=True)

team[(team['T_TEAMKEY'] != 't') | (team['T_GROUP'] == 'd') | (team['T_GROUP'] == 'b')][['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']]

team[(team['T_TEAMKEY'] != 't') | (team['T_PLAYERCOUNT'] == 21)].groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('mean', numeric_only=True)

team[(team['T_TEAMKEY'] == 't') & (team['T_TEAMKEY'] == 't')].groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']).agg('max', numeric_only=True)

team[(team['T_TEAMKEY'] == 't') | (team['T_PLAYERCOUNT'] >= 23) & (team['T_GROUP'].isin(['d', 'b', 'e', 'a']))].groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_TEAMKEY'].str.startswith('t')) & (team['T_TEAMKEY'].str.startswith('t'))].groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('sum', numeric_only=True)

team[['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']].groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('count')

team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']].groupby(by=['T_PLAYERCOUNT', 'T_GROUP']).agg('min', numeric_only=True)

team[['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']].groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('mean', numeric_only=True)

team[['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']].groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

team[['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']].groupby(by=['T_PLAYERCOUNT', 'T_GROUP']).agg('mean', numeric_only=True)

association.merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'A_ASSOCKEY', 'T_TEAMKEY', 'A_TEAMKEY']).agg('count')

association.merge(team[(team['T_GROUP'].isin(['g', 'b'])) | (team['T_TEAMKEY'] == 't')][['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association.merge(team[(team['T_TEAMKEY'] != 't')], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'A_FOUNDEDYEAR']).agg('min', numeric_only=True)

association.merge(team[(team['T_TEAMKEY'] == 't') & (team['T_PLAYERCOUNT'] != 23)], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP']).agg('max', numeric_only=True)

association[(association['A_ASSOCKEY'] != 'f') | (association['A_ASSOCKEY'] != 'f') | (association['A_FOUNDEDYEAR'] <= 1955) & (association['A_ASSOCKEY'] != 'f')][['A_FOUNDEDYEAR', 'A_ASSOCKEY', 'A_PRESIDENT']]

association[(association['A_ASSOCKEY'].str.startswith('f'))].merge(team[(team['T_PLAYERCOUNT'] < 23) | (team['T_PLAYERCOUNT'] >= 22) | (team['T_TEAMKEY'] == 't')], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_FOUNDEDYEAR'] <= 1915) & (association['A_TEAMKEY'] == 't') | (association['A_ASSOCKEY'].str.startswith('f')) | (association['A_ASSOCKEY'].str.startswith('f'))][['A_ASSOCKEY', 'A_PRESIDENT', 'A_FOUNDEDYEAR']]

association[(association['A_FOUNDEDYEAR'] <= 1957) | (association['A_FOUNDEDYEAR'] == 1974) | (association['A_TEAMKEY'] != 't')].merge(team[(team['T_GROUP'] != 'e')], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_PRESIDENT'] == 'p')].merge(team[(team['T_TEAMKEY'] == 't') | (team['T_GROUP'].isin(['g', 'd', 'a', 'e', 'b', 'h', 'c'])) & (team['T_GROUP'] == 'a')], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_PRESIDENT'].str.startswith('p')) | (association['A_PRESIDENT'] == 'p')].merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_ASSOCKEY', 'A_PRESIDENT', 'A_FOUNDEDYEAR']].groupby(by=['A_FOUNDEDYEAR', 'A_ASSOCKEY', 'A_PRESIDENT']).agg('count')

association[['A_FOUNDEDYEAR', 'A_TEAMKEY']].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_ROLE', 'C_TEAMKEY', 'C_NAME', 'T_GROUP']).agg('sum', numeric_only=True)

coach.merge(team[(team['T_GROUP'] == 'h')], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_ROLE', 'T_TEAMKEY']).agg('min', numeric_only=True)

coach.merge(team[(team['T_GROUP'].isin(['h', 'e', 'g', 'a', 'c', 'b', 'f'])) & (team['T_PLAYERCOUNT'] >= 21)], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_EXPYEARS']).agg('max', numeric_only=True)

coach.merge(team[(team['T_PLAYERCOUNT'] == 21) | (team['T_TEAMKEY'] != 't') & (team['T_PLAYERCOUNT'] == 25)][['T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[(team['T_PLAYERCOUNT'] > 19) & (team['T_GROUP'].isin(['b', 'h', 'e', 'c', 'f']))][['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_COACHKEY'] != 40) & (coach['C_ROLE'] != 'goalkeeper coach') | (coach['C_TEAMKEY'] == 't') | (coach['C_COACHKEY'] > 58) & (coach['C_COACHKEY'] != 23)].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_COACHKEY'] != 64) | (coach['C_ROLE'] != 'goalkeeper coach') & (coach['C_COACHKEY'] == 76) | (coach['C_NAME'] == 'c') & (coach['C_NAME'].str.startswith('c'))].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_EXPYEARS'] < 34) & (coach['C_TEAMKEY'].str.startswith('t'))].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_EXPYEARS'] > 29) & (coach['C_ROLE'].isin(['fitness coach', 'goalkeeper coach'])) & (coach['C_EXPYEARS'] <= 33) | (coach['C_EXPYEARS'] > 39) & (coach['C_EXPYEARS'] <= 31)][['C_EXPYEARS', 'C_ROLE']]

coach[(coach['C_EXPYEARS'] > 4)].merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'] != 'c')].merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'] == 'c') | (coach['C_TEAMKEY'] != 't') | (coach['C_EXPYEARS'] < 30) & (coach['C_ROLE'].isin(['fitness coach']))][['C_COACHKEY', 'C_EXPYEARS', 'C_ROLE']]

coach[(coach['C_NAME'].str.startswith('c')) & (coach['C_EXPYEARS'] >= 11) | (coach['C_TEAMKEY'] != 't') & (coach['C_EXPYEARS'] < 34) & (coach['C_ROLE'] == 'assistant coach')][['C_EXPYEARS', 'C_NAME']]

coach[(coach['C_ROLE'].isin(['goalkeeper coach', 'assistant coach', 'fitness coach']))].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_ROLE']).agg('mean', numeric_only=True)

coach[(coach['C_TEAMKEY'] != 't')].merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_EXPYEARS', 'C_COACHKEY', 'C_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] <= 23)], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_TEAMKEY']].merge(team[(team['T_TEAMKEY'] != 't') | (team['T_PLAYERCOUNT'] >= 18) & (team['T_TEAMKEY'].str.startswith('t'))], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

match.merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match.merge(stadium[(stadium['S_NAME'] != 's') & (stadium['S_CAPACITY'] > 65379)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match.merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_LOCATION'].str.startswith('w')) | (stadium['S_NAME'].str.startswith('s'))], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match.merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_STADIUMKEY'] <= 10) | (stadium['S_NAME'].str.startswith('s'))], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match.merge(team[['T_GROUP', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP']).agg('mean', numeric_only=True)

match.merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_TEAM1KEY'] != 't') | (match['M_DURATION'] <= 91) & (match['M_DURATION'] >= 120)].groupby(by=['M_DURATION', 'M_ROUND', 'M_TIME']).agg('min', numeric_only=True)

match[['M_DURATION', 'M_DATE', 'M_SCORE1', 'M_SCORE2']].groupby(by=['M_SCORE2', 'M_DATE']).agg('count')

stadium[(stadium['S_CAPACITY'] != 51772) & (stadium['S_YEARBUILT'] <= 2005) | (stadium['S_NAME'] == 's') & (stadium['S_CAPACITY'] > 67474) & (stadium['S_YEARBUILT'] >= 2013)].groupby(by=['S_LOCATION']).agg('mean', numeric_only=True)

stadium[(stadium['S_CAPACITY'] <= 78390) | (stadium['S_STADIUMKEY'] <= 11) & (stadium['S_YEARBUILT'] != 2001) & (stadium['S_LOCATION'] == 'c')][['S_YEARBUILT', 'S_NAME', 'S_CAPACITY']]

stadium[(stadium['S_LOCATION'] == 's') | (stadium['S_STADIUMKEY'] > 5) | (stadium['S_CITY'] == 'a') | (stadium['S_LOCATION'] == 'c') & (stadium['S_LOCATION'] != 'c') | (stadium['S_YEARBUILT'] >= 2016)][['S_CAPACITY']]

stadium[(stadium['S_NAME'] == 's')][['S_CITY', 'S_NAME', 'S_CAPACITY', 'S_STADIUMKEY', 'S_YEARBUILT', 'S_LOCATION']]

stadium[(stadium['S_STADIUMKEY'] <= 11) | (stadium['S_NAME'] == 's') | (stadium['S_YEARBUILT'] > 1966)].groupby(by=['S_STADIUMKEY', 'S_CAPACITY', 'S_LOCATION']).agg('mean', numeric_only=True)

stadium[(stadium['S_STADIUMKEY'] == 8) | (stadium['S_LOCATION'] == 's') | (stadium['S_STADIUMKEY'] <= 8)].groupby(by=['S_NAME', 'S_CAPACITY', 'S_CITY']).agg('max', numeric_only=True)

stadium[(stadium['S_YEARBUILT'] == 1990) | (stadium['S_CITY'] != 'r') | (stadium['S_LOCATION'].str.startswith('c')) | (stadium['S_LOCATION'] != 'w')][['S_YEARBUILT', 'S_STADIUMKEY', 'S_CITY']]

team[(team['T_GROUP'].isin(['c', 'h', 'g', 'a', 'b', 'f', 'e'])) & (team['T_TEAMKEY'] == 't') & (team['T_GROUP'].isin(['c', 'e', 'f', 'g', 'h', 'a']))].groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']).agg('count')

team[(team['T_PLAYERCOUNT'] != 23)][['T_PLAYERCOUNT', 'T_GROUP']].groupby(by=['T_GROUP']).agg('mean', numeric_only=True)

team[(team['T_PLAYERCOUNT'] < 19) & (team['T_GROUP'] == 'b')][['T_PLAYERCOUNT']].groupby(by=['T_PLAYERCOUNT']).agg('count')

team[(team['T_PLAYERCOUNT'] <= 19) | (team['T_PLAYERCOUNT'] <= 18) & (team['T_TEAMKEY'].str.startswith('t'))].groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

team[(team['T_PLAYERCOUNT'] == 19) | (team['T_TEAMKEY'].str.startswith('t')) | (team['T_GROUP'].isin(['e', 'b', 'a']))].groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']).agg('count')

team[(team['T_PLAYERCOUNT'] >= 20)][['T_TEAMKEY', 'T_PLAYERCOUNT']].groupby(by=['T_TEAMKEY']).agg('count')

team[(team['T_TEAMKEY'] != 't') | (team['T_GROUP'].isin(['f', 'b', 'a', 'h', 'd']))][['T_PLAYERCOUNT']].groupby(by=['T_PLAYERCOUNT']).agg('max', numeric_only=True)

team[(team['T_TEAMKEY'] != 't') | (team['T_PLAYERCOUNT'] != 23)][['T_TEAMKEY']].groupby(by=['T_TEAMKEY']).agg('sum', numeric_only=True)

team[(team['T_TEAMKEY'] == 't') & (team['T_GROUP'] == 'b')][['T_TEAMKEY']].groupby(by=['T_TEAMKEY']).agg('mean', numeric_only=True)

team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']].groupby(by=['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']).agg('mean', numeric_only=True)

team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']].groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

association.merge(team[(team['T_GROUP'].isin(['g', 'f', 'c', 'a', 'b', 'e', 'd', 'h'])) | (team['T_GROUP'].isin(['e', 'b', 'c', 'h', 'd'])) | (team['T_GROUP'].isin(['h', 'd', 'c', 'g', 'f', 'b', 'a', 'e']))][['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association.merge(team[(team['T_TEAMKEY'] != 't') & (team['T_PLAYERCOUNT'] > 22) & (team['T_PLAYERCOUNT'] <= 18)][['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association.merge(team[(team['T_TEAMKEY'].str.startswith('t'))], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_TEAMKEY', 'T_TEAMKEY', 'A_FOUNDEDYEAR']).agg('sum', numeric_only=True)

association.merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('min', numeric_only=True)

association.merge(team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT']).agg('count')

association[(association['A_ASSOCKEY'] == 'f') & (association['A_FOUNDEDYEAR'] >= 1992) | (association['A_FOUNDEDYEAR'] != 1984)].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_ASSOCKEY'] == 'f') | (association['A_ASSOCKEY'] == 'f') & (association['A_PRESIDENT'] == 'p')][['A_FOUNDEDYEAR']].groupby(by=['A_FOUNDEDYEAR']).agg('max', numeric_only=True)

association[(association['A_ASSOCKEY'].str.startswith('f')) | (association['A_ASSOCKEY'].str.startswith('f'))][['A_PRESIDENT', 'A_ASSOCKEY']].groupby(by=['A_ASSOCKEY']).agg('max', numeric_only=True)

association[(association['A_FOUNDEDYEAR'] == 1959) & (association['A_ASSOCKEY'] != 'f') & (association['A_TEAMKEY'] == 't') & (association['A_ASSOCKEY'] != 'f')].merge(team[(team['T_TEAMKEY'] != 't')], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_ASSOCKEY', 'A_FOUNDEDYEAR', 'A_TEAMKEY', 'A_PRESIDENT']].groupby(by=['A_FOUNDEDYEAR', 'A_ASSOCKEY', 'A_TEAMKEY']).agg('count')

association[['A_TEAMKEY', 'A_PRESIDENT']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_TEAMKEY']).agg('sum', numeric_only=True)

coach.merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'C_NAME', 'C_EXPYEARS', 'T_TEAMKEY', 'C_ROLE']).agg('min', numeric_only=True)

coach.merge(team[(team['T_GROUP'] == 'e') & (team['T_PLAYERCOUNT'] != 21)], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'C_NAME']).agg('count')

coach.merge(team[(team['T_TEAMKEY'] != 't') | (team['T_TEAMKEY'] != 't') & (team['T_PLAYERCOUNT'] != 20)], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_EXPYEARS']).agg('max', numeric_only=True)

coach.merge(team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_GROUP'] != 'e') | (team['T_TEAMKEY'] != 't')][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_PLAYERCOUNT'] >= 19)], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('sum', numeric_only=True)

coach.merge(team[['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_NAME']).agg('sum', numeric_only=True)

coach[(coach['C_EXPYEARS'] < 15) | (coach['C_NAME'] != 'c')].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_NAME']).agg('mean', numeric_only=True)

coach[(coach['C_NAME'] != 'c') & (coach['C_NAME'].str.startswith('c')) | (coach['C_ROLE'].isin(['assistant coach', 'goalkeeper coach', 'fitness coach', 'head coach'])) | (coach['C_NAME'] != 'c')][['C_EXPYEARS', 'C_COACHKEY', 'C_TEAMKEY', 'C_NAME']]

coach[(coach['C_ROLE'].isin(['head coach', 'assistant coach'])) | (coach['C_TEAMKEY'] == 't') | (coach['C_TEAMKEY'].str.startswith('t')) & (coach['C_TEAMKEY'] != 't')].merge(team[(team['T_PLAYERCOUNT'] >= 18)], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_TEAMKEY'] == 't') & (coach['C_COACHKEY'] >= 3)].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_TEAMKEY']).agg('mean', numeric_only=True)

coach[['C_ROLE', 'C_TEAMKEY', 'C_COACHKEY']].merge(team[['T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_TEAMKEY', 'C_COACHKEY', 'C_EXPYEARS']].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_TEAMKEY', 'C_NAME', 'C_EXPYEARS', 'C_ROLE']].merge(team[(team['T_GROUP'] != 'f')], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_TEAMKEY', 'C_NAME']].merge(team[(team['T_PLAYERCOUNT'] >= 23) & (team['T_PLAYERCOUNT'] < 25) & (team['T_PLAYERCOUNT'] >= 24)], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_TEAMKEY', 'C_NAME']].merge(team[['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

match.merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_STADIUMKEY']).agg('mean', numeric_only=True)

match[(match['M_SCORE1'] != 1) | (match['M_SCORE1'] == 2) & (match['M_TIME'].str.startswith('2')) | (match['M_DURATION'] > 125) | (match['M_ATTENDANCE'] != 37387) & (match['M_TIME'] == '2') & (match['M_SCORE1'] >= 0)][['M_SCORE2']]

match[(match['M_STADIUMKEY'] < 3) & (match['M_SCORE1'] >= 2)][['M_ATTENDANCE', 'M_DURATION', 'M_DATE', 'M_ROUND', 'M_MATCHKEY', 'M_TIME']]

match[['M_DATE', 'M_TEAM2KEY', 'M_SCORE1', 'M_TIME', 'M_SCORE2', 'M_STADIUMKEY', 'M_MATCHKEY', 'M_ATTENDANCE', 'M_ROUND', 'M_DURATION']]

match[['M_SCORE1', 'M_ATTENDANCE', 'M_TEAM1KEY', 'M_DURATION', 'M_STADIUMKEY', 'M_TEAM2KEY', 'M_TIME', 'M_SCORE2', 'M_DATE', 'M_MATCHKEY']]

match[['M_SCORE1', 'M_TEAM2KEY', 'M_MATCHKEY']].merge(team[(team['T_PLAYERCOUNT'] <= 22) & (team['T_TEAMKEY'] == 't')], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

stadium[(stadium['S_CAPACITY'] < 78589) | (stadium['S_LOCATION'] == 'n') & (stadium['S_CITY'].str.startswith('a')) | (stadium['S_YEARBUILT'] < 1988) | (stadium['S_LOCATION'] == 'n')][['S_CAPACITY', 'S_YEARBUILT', 'S_STADIUMKEY']]

stadium[(stadium['S_CAPACITY'] >= 48809) & (stadium['S_CITY'].str.startswith('d')) & (stadium['S_CAPACITY'] <= 71554) & (stadium['S_STADIUMKEY'] == 11)][['S_CITY', 'S_NAME', 'S_STADIUMKEY', 'S_LOCATION']]

stadium[(stadium['S_CITY'] == 'd') | (stadium['S_YEARBUILT'] < 1998) & (stadium['S_STADIUMKEY'] > 10)][['S_CAPACITY']].groupby(by=['S_CAPACITY']).agg('count')

stadium[(stadium['S_CITY'] == 'r') & (stadium['S_CAPACITY'] <= 66058)].groupby(by=['S_CITY', 'S_NAME', 'S_STADIUMKEY', 'S_CAPACITY', 'S_LOCATION']).agg('count')

stadium[(stadium['S_CITY'].str.startswith('r')) & (stadium['S_STADIUMKEY'] == 7) | (stadium['S_STADIUMKEY'] != 10)][['S_LOCATION']].groupby(by=['S_LOCATION']).agg('max', numeric_only=True)

stadium[(stadium['S_LOCATION'].str.startswith('c')) | (stadium['S_YEARBUILT'] <= 1991) & (stadium['S_CITY'] != 'a')].groupby(by=['S_CAPACITY', 'S_NAME', 'S_STADIUMKEY', 'S_YEARBUILT']).agg('min', numeric_only=True)

stadium[(stadium['S_YEARBUILT'] < 1980) & (stadium['S_STADIUMKEY'] >= 4) | (stadium['S_CITY'] == 'l')][['S_CITY', 'S_CAPACITY', 'S_LOCATION', 'S_NAME', 'S_YEARBUILT']]

stadium[(stadium['S_YEARBUILT'] == 1968) & (stadium['S_CITY'] == 'r') & (stadium['S_CITY'] != 'a') | (stadium['S_STADIUMKEY'] != 7) | (stadium['S_CAPACITY'] >= 49025) & (stadium['S_YEARBUILT'] >= 1951)][['S_YEARBUILT', 'S_CAPACITY']]

team[(team['T_PLAYERCOUNT'] < 23) & (team['T_TEAMKEY'] != 't')][['T_GROUP', 'T_PLAYERCOUNT']].groupby(by=['T_GROUP']).agg('count')

team[(team['T_PLAYERCOUNT'] < 24)][['T_TEAMKEY', 'T_PLAYERCOUNT']].groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT']).agg('count')

team[(team['T_TEAMKEY'] != 't')][['T_GROUP', 'T_PLAYERCOUNT']].groupby(by=['T_GROUP', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

team[(team['T_TEAMKEY'] == 't') | (team['T_TEAMKEY'] == 't')][['T_TEAMKEY', 'T_PLAYERCOUNT']].groupby(by=['T_PLAYERCOUNT']).agg('max', numeric_only=True)

association.merge(team[(team['T_PLAYERCOUNT'] <= 18)][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_FOUNDEDYEAR']).agg('max', numeric_only=True)

association.merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_FOUNDEDYEAR', 'A_ASSOCKEY', 'A_TEAMKEY']).agg('min', numeric_only=True)

association[(association['A_ASSOCKEY'].str.startswith('f'))].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'A_TEAMKEY', 'T_TEAMKEY']).agg('max', numeric_only=True)

association[(association['A_FOUNDEDYEAR'] <= 1905)].merge(team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_PLAYERCOUNT'] >= 19)][['T_GROUP', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_FOUNDEDYEAR'] <= 1926) & (association['A_PRESIDENT'].str.startswith('p')) & (association['A_PRESIDENT'].str.startswith('p'))].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_FOUNDEDYEAR'] == 1930)].merge(team[(team['T_PLAYERCOUNT'] < 23) & (team['T_TEAMKEY'] == 't')][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_PRESIDENT'] == 'p') & (association['A_FOUNDEDYEAR'] > 1918) | (association['A_PRESIDENT'] == 'p') | (association['A_TEAMKEY'].str.startswith('t'))][['A_PRESIDENT']].groupby(by=['A_PRESIDENT']).agg('min', numeric_only=True)

association[(association['A_TEAMKEY'] != 't') | (association['A_TEAMKEY'] != 't') | (association['A_ASSOCKEY'] == 'f') | (association['A_ASSOCKEY'].str.startswith('f'))][['A_FOUNDEDYEAR']].groupby(by=['A_FOUNDEDYEAR']).agg('max', numeric_only=True)

association[(association['A_TEAMKEY'].str.startswith('t')) | (association['A_PRESIDENT'] == 'p') | (association['A_ASSOCKEY'].str.startswith('f')) | (association['A_ASSOCKEY'].str.startswith('f'))][['A_PRESIDENT']].groupby(by=['A_PRESIDENT']).agg('mean', numeric_only=True)

association[['A_ASSOCKEY', 'A_TEAMKEY', 'A_PRESIDENT', 'A_FOUNDEDYEAR']].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_PRESIDENT', 'A_ASSOCKEY', 'A_TEAMKEY', 'A_FOUNDEDYEAR']].merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_PRESIDENT', 'A_ASSOCKEY', 'A_TEAMKEY', 'A_FOUNDEDYEAR']].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_TEAMKEY', 'A_FOUNDEDYEAR', 'A_PRESIDENT']].merge(team[(team['T_PLAYERCOUNT'] > 22) | (team['T_GROUP'] == 'f') | (team['T_TEAMKEY'] == 't')], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_TEAMKEY', 'A_PRESIDENT', 'A_ASSOCKEY']].merge(team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_COACHKEY'] < 98) & (coach['C_NAME'] == 'c')].merge(team[(team['T_PLAYERCOUNT'] < 25)][['T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_EXPYEARS'] < 34) & (coach['C_TEAMKEY'].str.startswith('t')) & (coach['C_EXPYEARS'] < 20) & (coach['C_EXPYEARS'] < 29)][['C_ROLE']].groupby(by=['C_ROLE']).agg('min', numeric_only=True)

coach[(coach['C_EXPYEARS'] == 17) | (coach['C_COACHKEY'] < 89)][['C_TEAMKEY', 'C_COACHKEY', 'C_ROLE']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'].str.startswith('c')) & (coach['C_NAME'] != 'c') | (coach['C_TEAMKEY'] == 't') | (coach['C_NAME'] != 'c')].merge(team[(team['T_GROUP'].isin(['c', 'g', 'e', 'f', 'a'])) & (team['T_GROUP'].isin(['b', 'e']))], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_ROLE'].isin(['head coach', 'assistant coach', 'goalkeeper coach', 'fitness coach'])) & (coach['C_NAME'] == 'c')].merge(team[(team['T_GROUP'].isin(['g', 'f', 'b', 'd', 'c', 'e']))][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_TEAMKEY'] == 't')][['C_COACHKEY', 'C_TEAMKEY']].merge(team[(team['T_GROUP'] != 'g')], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_COACHKEY', 'C_TEAMKEY']].merge(team[(team['T_GROUP'] != 'b')][['T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

match[(match['M_STADIUMKEY'] <= 11) | (match['M_SCORE1'] > 0)][['M_DURATION', 'M_SCORE2', 'M_ATTENDANCE']].groupby(by=['M_DURATION']).agg('max', numeric_only=True)

stadium[(stadium['S_CAPACITY'] == 46972) & (stadium['S_CAPACITY'] < 40633) & (stadium['S_YEARBUILT'] >= 1991) | (stadium['S_YEARBUILT'] <= 1990)][['S_YEARBUILT']].groupby(by=['S_YEARBUILT']).agg('count')

stadium[(stadium['S_CAPACITY'] >= 46486) | (stadium['S_CITY'] == 'a') | (stadium['S_CITY'].str.startswith('a')) & (stadium['S_YEARBUILT'] < 1968) | (stadium['S_STADIUMKEY'] >= 4)][['S_LOCATION', 'S_YEARBUILT', 'S_NAME', 'S_CAPACITY']]

stadium[(stadium['S_CITY'].str.startswith('r'))][['S_STADIUMKEY', 'S_CAPACITY', 'S_NAME']].groupby(by=['S_NAME', 'S_CAPACITY']).agg('mean', numeric_only=True)

stadium[(stadium['S_LOCATION'] != 'c') | (stadium['S_STADIUMKEY'] < 10) | (stadium['S_CAPACITY'] > 74565) | (stadium['S_CITY'] == 'a') | (stadium['S_CAPACITY'] < 42177) & (stadium['S_CITY'] == 'r')].groupby(by=['S_NAME', 'S_CITY']).agg('sum', numeric_only=True)

stadium[(stadium['S_LOCATION'] != 'n') | (stadium['S_CITY'] == 'l') & (stadium['S_NAME'] == 's') & (stadium['S_CITY'] != 'r')][['S_CITY']].groupby(by=['S_CITY']).agg('count')

stadium[(stadium['S_LOCATION'] == 's') | (stadium['S_NAME'] == 's') & (stadium['S_CITY'].str.startswith('r')) | (stadium['S_LOCATION'] != 'n') | (stadium['S_LOCATION'] == 'n')].groupby(by=['S_CITY', 'S_STADIUMKEY', 'S_LOCATION']).agg('max', numeric_only=True)

stadium[(stadium['S_NAME'] != 's') | (stadium['S_CITY'] != 'r') | (stadium['S_LOCATION'].str.startswith('s')) & (stadium['S_CAPACITY'] >= 46869)][['S_NAME', 'S_CAPACITY', 'S_STADIUMKEY', 'S_LOCATION', 'S_YEARBUILT']]

stadium[(stadium['S_NAME'] == 's') & (stadium['S_NAME'].str.startswith('s')) & (stadium['S_CITY'] != 'l') | (stadium['S_CAPACITY'] != 81717) & (stadium['S_YEARBUILT'] == 1990)].groupby(by=['S_CAPACITY', 'S_STADIUMKEY', 'S_CITY']).agg('max', numeric_only=True)

stadium[(stadium['S_STADIUMKEY'] < 7) | (stadium['S_STADIUMKEY'] >= 3) | (stadium['S_CAPACITY'] <= 63569) | (stadium['S_CAPACITY'] >= 57520) & (stadium['S_STADIUMKEY'] <= 9) & (stadium['S_STADIUMKEY'] == 1)][['S_CAPACITY', 'S_YEARBUILT', 'S_STADIUMKEY']]

stadium[(stadium['S_STADIUMKEY'] > 2)][['S_STADIUMKEY', 'S_CAPACITY', 'S_LOCATION']].groupby(by=['S_LOCATION', 'S_STADIUMKEY']).agg('max', numeric_only=True)

stadium[(stadium['S_YEARBUILT'] <= 1953) | (stadium['S_CAPACITY'] <= 73312) | (stadium['S_CAPACITY'] <= 80070)].groupby(by=['S_YEARBUILT', 'S_LOCATION', 'S_CAPACITY', 'S_CITY', 'S_NAME']).agg('max', numeric_only=True)

stadium[['S_CAPACITY', 'S_NAME', 'S_STADIUMKEY', 'S_CITY', 'S_LOCATION', 'S_YEARBUILT']].groupby(by=['S_LOCATION', 'S_CAPACITY']).agg('count')

stadium[['S_CITY', 'S_CAPACITY', 'S_LOCATION', 'S_NAME', 'S_YEARBUILT', 'S_STADIUMKEY']].groupby(by=['S_CITY', 'S_YEARBUILT']).agg('min', numeric_only=True)

stadium[['S_CITY', 'S_NAME', 'S_CAPACITY', 'S_STADIUMKEY', 'S_YEARBUILT']].groupby(by=['S_YEARBUILT', 'S_NAME', 'S_CAPACITY']).agg('sum', numeric_only=True)

stadium[['S_NAME', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_LOCATION']].groupby(by=['S_NAME', 'S_YEARBUILT', 'S_LOCATION', 'S_STADIUMKEY']).agg('mean', numeric_only=True)

team[(team['T_GROUP'].isin(['b', 'd', 'e'])) & (team['T_GROUP'].isin(['a', 'b', 'e'])) | (team['T_GROUP'] == 'f')][['T_TEAMKEY', 'T_GROUP']].groupby(by=['T_GROUP']).agg('min', numeric_only=True)

team[(team['T_GROUP'].isin(['c'])) & (team['T_TEAMKEY'] != 't')][['T_PLAYERCOUNT', 'T_TEAMKEY']].groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY']).agg('sum', numeric_only=True)

team[(team['T_PLAYERCOUNT'] >= 23) | (team['T_GROUP'] == 'g')][['T_TEAMKEY', 'T_GROUP']].groupby(by=['T_TEAMKEY', 'T_GROUP']).agg('sum', numeric_only=True)

association.merge(team[(team['T_GROUP'].isin(['g', 'd', 'a']))][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_ASSOCKEY', 'T_PLAYERCOUNT']).agg('count')

association.merge(team[(team['T_PLAYERCOUNT'] <= 18) | (team['T_TEAMKEY'] == 't') | (team['T_TEAMKEY'].str.startswith('t'))], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_ASSOCKEY', 'T_TEAMKEY', 'A_TEAMKEY']).agg('count')

association.merge(team[(team['T_TEAMKEY'] == 't') & (team['T_GROUP'] == 'a') & (team['T_GROUP'].isin(['c', 'f', 'g', 'h']))], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'A_FOUNDEDYEAR']).agg('sum', numeric_only=True)

association[(association['A_PRESIDENT'].str.startswith('p')) & (association['A_PRESIDENT'] == 'p') | (association['A_TEAMKEY'] != 't') & (association['A_TEAMKEY'] != 't')].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_PRESIDENT']).agg('count')

association[(association['A_PRESIDENT'].str.startswith('p')) | (association['A_TEAMKEY'].str.startswith('t'))][['A_TEAMKEY']].merge(team[(team['T_TEAMKEY'] == 't') & (team['T_GROUP'] != 'f')], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_PRESIDENT', 'A_TEAMKEY']].merge(team[(team['T_GROUP'] == 'f')], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('count')

coach.merge(team[(team['T_GROUP'] == 'c') & (team['T_PLAYERCOUNT'] != 25)], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_ROLE', 'T_GROUP', 'T_PLAYERCOUNT', 'C_NAME']).agg('max', numeric_only=True)

coach.merge(team[['T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_ROLE', 'C_NAME', 'T_GROUP', 'C_EXPYEARS']).agg('mean', numeric_only=True)

coach.merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'C_EXPYEARS', 'C_COACHKEY']).agg('min', numeric_only=True)

coach[(coach['C_COACHKEY'] <= 21) | (coach['C_ROLE'] != 'assistant coach')].merge(team[(team['T_PLAYERCOUNT'] != 23) & (team['T_PLAYERCOUNT'] <= 24)][['T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_EXPYEARS'] < 1) | (coach['C_EXPYEARS'] > 27)].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'C_EXPYEARS', 'C_NAME']).agg('count')

coach[(coach['C_NAME'] != 'c') & (coach['C_COACHKEY'] > 9) | (coach['C_ROLE'] != 'goalkeeper coach') | (coach['C_NAME'].str.startswith('c'))].merge(team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'] != 'c')].merge(team[(team['T_GROUP'] != 'g') | (team['T_TEAMKEY'].str.startswith('t')) & (team['T_GROUP'] == 'd')][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'].str.startswith('c')) & (coach['C_ROLE'].isin(['head coach', 'fitness coach', 'goalkeeper coach'])) | (coach['C_NAME'].str.startswith('c'))].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'C_ROLE']).agg('min', numeric_only=True)

coach[(coach['C_NAME'].str.startswith('c')) | (coach['C_NAME'].str.startswith('c')) & (coach['C_ROLE'].isin(['goalkeeper coach', 'fitness coach']))][['C_NAME', 'C_ROLE']].groupby(by=['C_ROLE', 'C_NAME']).agg('max', numeric_only=True)

coach[(coach['C_ROLE'] != 'goalkeeper coach') | (coach['C_TEAMKEY'] == 't') | (coach['C_EXPYEARS'] <= 25) & (coach['C_TEAMKEY'] == 't') & (coach['C_EXPYEARS'] < 26)].merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_ROLE', 'C_TEAMKEY', 'C_NAME']].merge(team[(team['T_TEAMKEY'].str.startswith('t'))][['T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_TEAMKEY', 'C_EXPYEARS', 'C_ROLE', 'C_COACHKEY', 'C_NAME']].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_TEAMKEY', 'C_ROLE', 'C_NAME', 'C_COACHKEY']].merge(team[['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_TEAMKEY']].merge(team[(team['T_GROUP'] == 'f') & (team['T_TEAMKEY'] == 't')][['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

match.merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[['S_CITY', 'S_NAME', 'S_CAPACITY', 'S_STADIUMKEY', 'S_LOCATION']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match.merge(team[['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_CAPACITY'] != 49700)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match.merge(team[['T_GROUP', 'T_TEAMKEY']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_NAME'] == 's') | (stadium['S_STADIUMKEY'] >= 6)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_TEAM2KEY'].str.startswith('t')) | (match['M_DURATION'] <= 140) & (match['M_TEAM2KEY'].str.startswith('t')) & (match['M_TEAM2KEY'].str.startswith('t'))].merge(team[(team['T_GROUP'] != 'h') | (team['T_TEAMKEY'] != 't') | (team['T_TEAMKEY'].str.startswith('t'))], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[['M_TIME', 'M_MATCHKEY', 'M_TEAM1KEY', 'M_SCORE1']].merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['M_TEAM1KEY']).agg('mean', numeric_only=True)

stadium[(stadium['S_CAPACITY'] > 61004)][['S_CITY', 'S_YEARBUILT', 'S_STADIUMKEY']].groupby(by=['S_STADIUMKEY', 'S_YEARBUILT', 'S_CITY']).agg('max', numeric_only=True)

stadium[(stadium['S_CITY'] != 'd') | (stadium['S_YEARBUILT'] != 1953) & (stadium['S_NAME'] == 's') & (stadium['S_CITY'] != 'l') & (stadium['S_YEARBUILT'] == 2001) & (stadium['S_CAPACITY'] < 58042)][['S_LOCATION', 'S_STADIUMKEY', 'S_CITY', 'S_NAME']]

stadium[(stadium['S_NAME'] == 's') | (stadium['S_LOCATION'].str.startswith('w')) | (stadium['S_CAPACITY'] == 53158)][['S_STADIUMKEY', 'S_CAPACITY', 'S_YEARBUILT']].groupby(by=['S_STADIUMKEY']).agg('count')

stadium[(stadium['S_YEARBUILT'] != 1990) & (stadium['S_NAME'] != 's') | (stadium['S_YEARBUILT'] <= 2006) & (stadium['S_NAME'] == 's') & (stadium['S_NAME'] == 's')].groupby(by=['S_CITY', 'S_STADIUMKEY', 'S_YEARBUILT', 'S_NAME']).agg('mean', numeric_only=True)

team[(team['T_TEAMKEY'] == 't') & (team['T_PLAYERCOUNT'] <= 25) | (team['T_GROUP'].isin(['h']))][['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']].groupby(by=['T_TEAMKEY']).agg('min', numeric_only=True)

team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_GROUP'] == 'b') | (team['T_TEAMKEY'].str.startswith('t'))][['T_GROUP', 'T_PLAYERCOUNT']].groupby(by=['T_PLAYERCOUNT', 'T_GROUP']).agg('min', numeric_only=True)

team[(team['T_TEAMKEY'].str.startswith('t'))][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']].groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']).agg('mean', numeric_only=True)

association.merge(team[(team['T_GROUP'] == 'f') | (team['T_TEAMKEY'] == 't')][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_ASSOCKEY', 'A_PRESIDENT']).agg('count')

association.merge(team[(team['T_GROUP'].isin(['f', 'e'])) | (team['T_GROUP'] == 'e') & (team['T_PLAYERCOUNT'] < 18)][['T_GROUP', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('max', numeric_only=True)

association[(association['A_ASSOCKEY'] != 'f') | (association['A_ASSOCKEY'] == 'f') & (association['A_PRESIDENT'] == 'p')][['A_TEAMKEY']].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_FOUNDEDYEAR'] > 1902) & (association['A_TEAMKEY'].str.startswith('t')) & (association['A_TEAMKEY'] != 't') & (association['A_PRESIDENT'] != 'p')][['A_FOUNDEDYEAR', 'A_TEAMKEY', 'A_PRESIDENT']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_FOUNDEDYEAR'] >= 1913) | (association['A_ASSOCKEY'] == 'f')].merge(team[(team['T_PLAYERCOUNT'] == 22) | (team['T_PLAYERCOUNT'] <= 22)], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP']).agg('sum', numeric_only=True)

association[(association['A_PRESIDENT'] == 'p')].merge(team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_PLAYERCOUNT'] == 23) | (team['T_GROUP'] == 'f')][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_PRESIDENT'].str.startswith('p'))].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_PRESIDENT', 'A_FOUNDEDYEAR']).agg('max', numeric_only=True)

association[(association['A_TEAMKEY'].str.startswith('t')) & (association['A_ASSOCKEY'].str.startswith('f')) & (association['A_PRESIDENT'] != 'p') | (association['A_PRESIDENT'] != 'p')][['A_FOUNDEDYEAR', 'A_PRESIDENT', 'A_ASSOCKEY']].groupby(by=['A_ASSOCKEY']).agg('min', numeric_only=True)

association[(association['A_TEAMKEY'].str.startswith('t')) & (association['A_FOUNDEDYEAR'] > 1950) | (association['A_PRESIDENT'] == 'p') & (association['A_FOUNDEDYEAR'] >= 1984)].merge(team[(team['T_GROUP'] != 'a')][['T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_TEAMKEY'].str.startswith('t')) & (association['A_FOUNDEDYEAR'] >= 1987)].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP', 'A_FOUNDEDYEAR', 'A_TEAMKEY']).agg('count')

association[['A_FOUNDEDYEAR', 'A_PRESIDENT', 'A_TEAMKEY']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_FOUNDEDYEAR', 'A_PRESIDENT', 'T_PLAYERCOUNT']).agg('mean', numeric_only=True)

association[['A_FOUNDEDYEAR', 'A_TEAMKEY', 'A_ASSOCKEY']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'A_TEAMKEY']).agg('min', numeric_only=True)

association[['A_TEAMKEY']].merge(team[(team['T_TEAMKEY'] == 't') | (team['T_PLAYERCOUNT'] <= 22) | (team['T_GROUP'].isin(['d', 'e', 'c', 'a']))][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[(team['T_GROUP'] != 'd') & (team['T_TEAMKEY'] == 't') & (team['T_GROUP'] != 'g')][['T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_TEAMKEY']).agg('min', numeric_only=True)

coach.merge(team[(team['T_GROUP'] == 'b')][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_ROLE', 'C_EXPYEARS', 'C_COACHKEY']).agg('min', numeric_only=True)

coach.merge(team[(team['T_TEAMKEY'] != 't') | (team['T_GROUP'] != 'c') & (team['T_PLAYERCOUNT'] <= 20)], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_EXPYEARS', 'C_ROLE', 'T_GROUP', 'T_TEAMKEY']).agg('mean', numeric_only=True)

coach.merge(team[(team['T_TEAMKEY'] != 't')][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_TEAMKEY', 'C_NAME', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

coach.merge(team[(team['T_TEAMKEY'] == 't') & (team['T_PLAYERCOUNT'] <= 20) | (team['T_GROUP'] != 'b')], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'C_ROLE', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

coach.merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'C_TEAMKEY', 'C_EXPYEARS']).agg('count')

coach[(coach['C_COACHKEY'] != 61) & (coach['C_TEAMKEY'].str.startswith('t'))].merge(team[(team['T_TEAMKEY'] == 't') | (team['T_GROUP'].isin(['b', 'g'])) | (team['T_TEAMKEY'] != 't')][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_EXPYEARS'] != 7) | (coach['C_NAME'].str.startswith('c')) & (coach['C_TEAMKEY'].str.startswith('t')) & (coach['C_ROLE'] == 'head coach') & (coach['C_EXPYEARS'] >= 20)].merge(team[['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_EXPYEARS'] < 26) & (coach['C_EXPYEARS'] < 25) & (coach['C_COACHKEY'] != 64) & (coach['C_NAME'] != 'c')].merge(team[(team['T_PLAYERCOUNT'] >= 25)][['T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'].str.startswith('c')) | (coach['C_EXPYEARS'] != 26) | (coach['C_NAME'] == 'c')].merge(team[(team['T_TEAMKEY'].str.startswith('t')) | (team['T_PLAYERCOUNT'] < 22)][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_ROLE'] != 'assistant coach') & (coach['C_ROLE'].isin(['assistant coach', 'fitness coach', 'head coach'])) | (coach['C_NAME'] == 'c') & (coach['C_TEAMKEY'] == 't') | (coach['C_TEAMKEY'] == 't')].merge(team[(team['T_PLAYERCOUNT'] < 23) & (team['T_TEAMKEY'] != 't') & (team['T_PLAYERCOUNT'] != 20)], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_ROLE'] == 'goalkeeper coach') | (coach['C_TEAMKEY'] != 't') | (coach['C_COACHKEY'] != 28)][['C_ROLE', 'C_EXPYEARS', 'C_COACHKEY']].groupby(by=['C_EXPYEARS', 'C_ROLE']).agg('min', numeric_only=True)

coach[(coach['C_TEAMKEY'] != 't') & (coach['C_ROLE'] != 'head coach') & (coach['C_COACHKEY'] != 74) | (coach['C_TEAMKEY'] == 't') & (coach['C_NAME'].str.startswith('c'))][['C_COACHKEY', 'C_NAME']].groupby(by=['C_COACHKEY']).agg('count')

coach[(coach['C_TEAMKEY'] == 't') | (coach['C_EXPYEARS'] != 27) & (coach['C_EXPYEARS'] < 29)].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'C_COACHKEY', 'T_TEAMKEY']).agg('count')

coach[['C_NAME', 'C_TEAMKEY', 'C_EXPYEARS', 'C_ROLE', 'C_COACHKEY']].merge(team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_GROUP'] != 'f') & (team['T_PLAYERCOUNT'] == 24)], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

match.merge(team[(team['T_PLAYERCOUNT'] == 25) & (team['T_TEAMKEY'] != 't')][['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_MATCHKEY'] >= 17)].merge(team[['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['M_SCORE2']).agg('sum', numeric_only=True)

match[(match['M_ROUND'] != 'group stage') & (match['M_DATE'] != '2022-11-20') & (match['M_SCORE2'] > 0) | (match['M_ROUND'] == 'semi-final') & (match['M_SCORE1'] < 5)].merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_ROUND'] == 'semi-final') & (match['M_ROUND'] != 'quarter-final') | (match['M_DURATION'] > 128) | (match['M_ROUND'].isin(['group stage', 'round of 16'])) & (match['M_MATCHKEY'] <= 63)][['M_SCORE2', 'M_TIME']].groupby(by=['M_SCORE2']).agg('max', numeric_only=True)

match[(match['M_ROUND'].isin(['group stage', 'round of 16', 'semi-final', 'final', 'quarter-final'])) | (match['M_TEAM1KEY'] != 't') & (match['M_TEAM2KEY'] == 't') & (match['M_ROUND'].isin(['semi-final', 'group stage', 'quarter-final', 'round of 16', 'final'])) | (match['M_STADIUMKEY'] == 7) | (match['M_MATCHKEY'] < 57) & (match['M_TEAM2KEY'] != 't') | (match['M_MATCHKEY'] >= 44) & (match['M_TEAM2KEY'] == 't')][['M_DATE', 'M_ROUND']]

match[['M_TIME', 'M_ATTENDANCE', 'M_TEAM1KEY']].merge(team[(team['T_GROUP'] != 'e')], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['M_TIME']).agg('sum', numeric_only=True)

stadium[(stadium['S_CAPACITY'] <= 48830) & (stadium['S_CITY'] != 'r') & (stadium['S_YEARBUILT'] < 1987) & (stadium['S_LOCATION'].str.startswith('c')) & (stadium['S_LOCATION'].str.startswith('s')) & (stadium['S_NAME'] != 's')].groupby(by=['S_CAPACITY', 'S_CITY', 'S_NAME', 'S_LOCATION']).agg('sum', numeric_only=True)

stadium[(stadium['S_CITY'] != 'r') | (stadium['S_LOCATION'] != 'n') & (stadium['S_YEARBUILT'] > 2014) & (stadium['S_LOCATION'] == 'n') & (stadium['S_YEARBUILT'] > 2008) & (stadium['S_YEARBUILT'] <= 1968)].groupby(by=['S_CITY', 'S_STADIUMKEY', 'S_LOCATION', 'S_YEARBUILT']).agg('min', numeric_only=True)

stadium[(stadium['S_CITY'].str.startswith('a')) & (stadium['S_NAME'] == 's') | (stadium['S_LOCATION'].str.startswith('n')) & (stadium['S_LOCATION'] == 's')][['S_CAPACITY', 'S_YEARBUILT', 'S_LOCATION']].groupby(by=['S_YEARBUILT']).agg('sum', numeric_only=True)

stadium[(stadium['S_NAME'].str.startswith('s')) & (stadium['S_LOCATION'].str.startswith('n')) | (stadium['S_NAME'].str.startswith('s')) | (stadium['S_STADIUMKEY'] >= 3) & (stadium['S_CITY'].str.startswith('l')) | (stadium['S_CAPACITY'] != 86676)].groupby(by=['S_LOCATION', 'S_CAPACITY', 'S_CITY', 'S_YEARBUILT']).agg('mean', numeric_only=True)

stadium[(stadium['S_NAME'].str.startswith('s')) | (stadium['S_NAME'] != 's') & (stadium['S_CITY'] != 'l') & (stadium['S_CITY'] == 'l') & (stadium['S_LOCATION'] != 'n') | (stadium['S_CITY'] == 'r')][['S_YEARBUILT', 'S_NAME', 'S_LOCATION', 'S_STADIUMKEY', 'S_CAPACITY']]

stadium[(stadium['S_NAME'].str.startswith('s')) | (stadium['S_YEARBUILT'] < 1994) & (stadium['S_YEARBUILT'] <= 1952) & (stadium['S_NAME'] == 's') | (stadium['S_CITY'].str.startswith('d')) & (stadium['S_CITY'] != 'r')][['S_YEARBUILT', 'S_LOCATION', 'S_CAPACITY', 'S_NAME', 'S_CITY']]

stadium[(stadium['S_STADIUMKEY'] < 9) | (stadium['S_LOCATION'].str.startswith('e')) & (stadium['S_NAME'] != 's') | (stadium['S_YEARBUILT'] != 1959) | (stadium['S_STADIUMKEY'] <= 1)][['S_CITY', 'S_CAPACITY', 'S_LOCATION', 'S_NAME', 'S_YEARBUILT', 'S_STADIUMKEY']]

stadium[(stadium['S_STADIUMKEY'] > 11) & (stadium['S_NAME'] != 's') & (stadium['S_CAPACITY'] > 57023) | (stadium['S_CITY'] != 'a') & (stadium['S_YEARBUILT'] != 1988) | (stadium['S_CITY'] == 'l')].groupby(by=['S_LOCATION', 'S_YEARBUILT', 'S_CITY', 'S_NAME']).agg('min', numeric_only=True)

stadium[(stadium['S_YEARBUILT'] > 1981) | (stadium['S_CITY'].str.startswith('d'))][['S_NAME', 'S_STADIUMKEY', 'S_CITY', 'S_LOCATION']].groupby(by=['S_LOCATION', 'S_STADIUMKEY']).agg('max', numeric_only=True)

stadium[['S_CAPACITY', 'S_LOCATION', 'S_YEARBUILT', 'S_CITY', 'S_STADIUMKEY']].groupby(by=['S_CITY', 'S_YEARBUILT', 'S_LOCATION', 'S_CAPACITY', 'S_STADIUMKEY']).agg('max', numeric_only=True)

stadium[['S_CAPACITY', 'S_NAME', 'S_STADIUMKEY', 'S_CITY', 'S_LOCATION', 'S_YEARBUILT']].groupby(by=['S_NAME', 'S_CAPACITY', 'S_STADIUMKEY', 'S_CITY']).agg('max', numeric_only=True)

team[(team['T_GROUP'] != 'c') | (team['T_TEAMKEY'] != 't')][['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']].groupby(by=['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']).agg('max', numeric_only=True)

team[(team['T_GROUP'] != 'd') | (team['T_TEAMKEY'] == 't')][['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']].groupby(by=['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']).agg('mean', numeric_only=True)

team[(team['T_GROUP'] == 'e') | (team['T_GROUP'] == 'g')][['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']].groupby(by=['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']).agg('max', numeric_only=True)

association.merge(team[(team['T_GROUP'] != 'b') | (team['T_GROUP'].isin(['b', 'c']))][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_TEAMKEY', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

association.merge(team[(team['T_PLAYERCOUNT'] == 23) & (team['T_PLAYERCOUNT'] >= 20) & (team['T_GROUP'].isin(['g', 'e', 'h', 'a']))], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_PRESIDENT', 'T_TEAMKEY', 'A_TEAMKEY', 'T_GROUP', 'A_FOUNDEDYEAR']).agg('min', numeric_only=True)

association.merge(team[(team['T_PLAYERCOUNT'] >= 25) & (team['T_GROUP'] != 'd') & (team['T_TEAMKEY'] != 't')], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_PRESIDENT', 'T_PLAYERCOUNT', 'A_FOUNDEDYEAR', 'A_ASSOCKEY', 'A_TEAMKEY']).agg('sum', numeric_only=True)

association.merge(team[['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_TEAMKEY', 'T_PLAYERCOUNT', 'T_TEAMKEY', 'A_ASSOCKEY', 'A_FOUNDEDYEAR']).agg('sum', numeric_only=True)

association[(association['A_FOUNDEDYEAR'] > 1999) & (association['A_ASSOCKEY'] == 'f') | (association['A_ASSOCKEY'] == 'f') & (association['A_FOUNDEDYEAR'] > 1908)].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_TEAMKEY', 'A_FOUNDEDYEAR', 'T_PLAYERCOUNT']).agg('mean', numeric_only=True)

association[(association['A_PRESIDENT'] != 'p') | (association['A_PRESIDENT'] == 'p')][['A_FOUNDEDYEAR', 'A_TEAMKEY', 'A_PRESIDENT', 'A_ASSOCKEY']].merge(team[(team['T_PLAYERCOUNT'] == 21)], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_TEAMKEY'] == 't') | (association['A_FOUNDEDYEAR'] <= 1943) & (association['A_FOUNDEDYEAR'] <= 1914)].merge(team[(team['T_TEAMKEY'].str.startswith('t'))], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_FOUNDEDYEAR', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

association[(association['A_TEAMKEY'] == 't')][['A_ASSOCKEY', 'A_TEAMKEY', 'A_FOUNDEDYEAR', 'A_PRESIDENT']].groupby(by=['A_TEAMKEY', 'A_FOUNDEDYEAR', 'A_ASSOCKEY', 'A_PRESIDENT']).agg('count')

association[['A_TEAMKEY', 'A_FOUNDEDYEAR', 'A_ASSOCKEY', 'A_PRESIDENT']].merge(team[(team['T_GROUP'] != 'h')], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT']).agg('mean', numeric_only=True)

association[['A_TEAMKEY', 'A_FOUNDEDYEAR', 'A_ASSOCKEY']].merge(team[(team['T_GROUP'].isin(['g', 'e', 'h', 'd'])) & (team['T_PLAYERCOUNT'] > 20)][['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_TEAMKEY', 'C_NAME', 'T_PLAYERCOUNT', 'C_COACHKEY', 'C_ROLE']).agg('max', numeric_only=True)

coach.merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'C_NAME', 'C_ROLE', 'C_EXPYEARS', 'C_TEAMKEY']).agg('sum', numeric_only=True)

coach[(coach['C_COACHKEY'] < 2) & (coach['C_ROLE'] != 'head coach')].merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY']).agg('max', numeric_only=True)

coach[(coach['C_COACHKEY'] < 34) | (coach['C_EXPYEARS'] != 25) | (coach['C_TEAMKEY'] == 't')][['C_NAME', 'C_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] == 24) | (team['T_GROUP'].isin(['b', 'c', 'a']))], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_COACHKEY'] == 98) & (coach['C_TEAMKEY'] != 't') & (coach['C_EXPYEARS'] == 32)].merge(team[(team['T_TEAMKEY'].str.startswith('t')) | (team['T_GROUP'].isin(['e', 'f', 'c', 'g', 'h', 'b']))][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'] == 'c')][['C_TEAMKEY', 'C_EXPYEARS', 'C_ROLE', 'C_COACHKEY', 'C_NAME']].groupby(by=['C_EXPYEARS', 'C_NAME', 'C_COACHKEY']).agg('sum', numeric_only=True)

coach[(coach['C_ROLE'].isin(['head coach', 'fitness coach', 'goalkeeper coach']))][['C_EXPYEARS', 'C_ROLE', 'C_NAME', 'C_COACHKEY']].groupby(by=['C_COACHKEY', 'C_EXPYEARS', 'C_NAME', 'C_ROLE']).agg('sum', numeric_only=True)

coach[(coach['C_TEAMKEY'] != 't') & (coach['C_TEAMKEY'] == 't') | (coach['C_ROLE'].isin(['goalkeeper coach', 'assistant coach', 'head coach', 'fitness coach']))][['C_NAME', 'C_EXPYEARS', 'C_TEAMKEY', 'C_COACHKEY', 'C_ROLE']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_TEAMKEY'] == 't') | (coach['C_NAME'].str.startswith('c'))][['C_EXPYEARS', 'C_COACHKEY', 'C_NAME', 'C_ROLE', 'C_TEAMKEY']].groupby(by=['C_TEAMKEY', 'C_ROLE']).agg('mean', numeric_only=True)

coach[(coach['C_TEAMKEY'] == 't') | (coach['C_ROLE'] != 'fitness coach')].merge(team[(team['T_TEAMKEY'].str.startswith('t')) | (team['T_GROUP'] == 'e') | (team['T_PLAYERCOUNT'] != 23)][['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_EXPYEARS', 'C_NAME', 'C_COACHKEY', 'C_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] >= 24) | (team['T_TEAMKEY'] == 't')][['T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_EXPYEARS', 'C_TEAMKEY']].merge(team[(team['T_TEAMKEY'] != 't') | (team['T_TEAMKEY'].str.startswith('t')) & (team['T_GROUP'].isin(['g', 'a']))][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_NAME', 'C_TEAMKEY', 'C_EXPYEARS', 'C_ROLE', 'C_COACHKEY']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'C_EXPYEARS']).agg('sum', numeric_only=True)

coach[['C_ROLE', 'C_NAME', 'C_EXPYEARS', 'C_COACHKEY', 'C_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] > 21)][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

match.merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[(team['T_PLAYERCOUNT'] <= 21) | (team['T_GROUP'] != 'e')], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['S_LOCATION', 'M_DURATION']).agg('sum', numeric_only=True)

match.merge(stadium[(stadium['S_NAME'] != 's') | (stadium['S_CAPACITY'] != 63462) & (stadium['S_CITY'].str.startswith('d')) & (stadium['S_NAME'].str.startswith('s'))], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_STADIUMKEY', 'M_TEAM1KEY', 'S_STADIUMKEY', 'M_DURATION']).agg('count')

match[(match['M_DURATION'] >= 95) & (match['M_SCORE2'] != 6) | (match['M_TEAM2KEY'].str.startswith('t')) | (match['M_MATCHKEY'] > 20) & (match['M_ROUND'] == 'final') & (match['M_ROUND'] == 'semi-final') | (match['M_DURATION'] < 139) & (match['M_TEAM1KEY'] == 't') | (match['M_ATTENDANCE'] == 85430) | (match['M_SCORE1'] == 1)][['M_DATE', 'M_SCORE1']]

match[(match['M_SCORE2'] <= 1) & (match['M_TEAM1KEY'] != 't') | (match['M_DURATION'] > 149) & (match['M_TEAM2KEY'] != 't')].merge(team[(team['T_PLAYERCOUNT'] != 21)], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_STADIUMKEY'] == 4) | (match['M_MATCHKEY'] == 7) & (match['M_TIME'] == '1')].merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_CITY'] != 'r') | (stadium['S_STADIUMKEY'] >= 5)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_TIME'].str.startswith('1')) | (match['M_TIME'].str.startswith('1')) | (match['M_TEAM2KEY'].str.startswith('t')) & (match['M_ROUND'] == 'final')].merge(team[(team['T_PLAYERCOUNT'] == 22)][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[['M_MATCHKEY', 'M_STADIUMKEY']].merge(stadium[(stadium['S_CAPACITY'] > 82869) | (stadium['S_CAPACITY'] <= 78984)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_MATCHKEY', 'S_STADIUMKEY']).agg('sum', numeric_only=True)

match[['M_SCORE1', 'M_TEAM2KEY', 'M_DURATION', 'M_SCORE2', 'M_DATE', 'M_TEAM1KEY']].merge(team[['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

stadium[(stadium['S_LOCATION'] != 'e') | (stadium['S_NAME'] == 's') | (stadium['S_LOCATION'].str.startswith('w')) | (stadium['S_STADIUMKEY'] < 5) & (stadium['S_LOCATION'] != 'e') | (stadium['S_STADIUMKEY'] < 8)].groupby(by=['S_LOCATION', 'S_NAME', 'S_STADIUMKEY', 'S_YEARBUILT', 'S_CAPACITY']).agg('sum', numeric_only=True)

stadium[(stadium['S_LOCATION'] == 'c')][['S_YEARBUILT', 'S_LOCATION', 'S_CAPACITY', 'S_NAME', 'S_CITY', 'S_STADIUMKEY']].groupby(by=['S_YEARBUILT', 'S_LOCATION']).agg('sum', numeric_only=True)

stadium[(stadium['S_NAME'].str.startswith('s'))][['S_YEARBUILT', 'S_NAME', 'S_LOCATION', 'S_CITY']].groupby(by=['S_CITY', 'S_YEARBUILT', 'S_LOCATION', 'S_NAME']).agg('mean', numeric_only=True)

stadium[(stadium['S_YEARBUILT'] <= 1992) | (stadium['S_NAME'] != 's') | (stadium['S_YEARBUILT'] <= 1961)][['S_YEARBUILT', 'S_LOCATION', 'S_CAPACITY', 'S_NAME', 'S_CITY']].groupby(by=['S_LOCATION']).agg('sum', numeric_only=True)

association[(association['A_FOUNDEDYEAR'] == 1990) & (association['A_TEAMKEY'].str.startswith('t')) | (association['A_FOUNDEDYEAR'] == 1902) | (association['A_ASSOCKEY'].str.startswith('f'))][['A_TEAMKEY', 'A_FOUNDEDYEAR']].merge(team[['T_GROUP', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_PRESIDENT'] == 'p')][['A_FOUNDEDYEAR', 'A_PRESIDENT', 'A_TEAMKEY']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'A_FOUNDEDYEAR']).agg('sum', numeric_only=True)

association[(association['A_TEAMKEY'] == 't') & (association['A_PRESIDENT'] != 'p') | (association['A_PRESIDENT'] == 'p') & (association['A_PRESIDENT'].str.startswith('p'))].merge(team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_PLAYERCOUNT'] < 21) | (team['T_GROUP'].isin(['g']))][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_ASSOCKEY', 'A_PRESIDENT', 'A_TEAMKEY']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'A_PRESIDENT', 'T_TEAMKEY', 'A_TEAMKEY']).agg('sum', numeric_only=True)

coach.merge(team[(team['T_GROUP'] == 'e') | (team['T_TEAMKEY'].str.startswith('t')) | (team['T_PLAYERCOUNT'] != 23)][['T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP', 'C_COACHKEY']).agg('max', numeric_only=True)

coach[(coach['C_COACHKEY'] > 54) | (coach['C_COACHKEY'] < 74) | (coach['C_COACHKEY'] == 2) & (coach['C_TEAMKEY'] == 't')].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_ROLE', 'T_TEAMKEY', 'C_COACHKEY', 'T_PLAYERCOUNT']).agg('min', numeric_only=True)

coach[(coach['C_EXPYEARS'] < 12) | (coach['C_NAME'] != 'c')][['C_TEAMKEY', 'C_EXPYEARS', 'C_ROLE', 'C_COACHKEY']].merge(team[['T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_EXPYEARS'] < 36) & (coach['C_TEAMKEY'] == 't') | (coach['C_COACHKEY'] > 57) & (coach['C_ROLE'].isin(['goalkeeper coach', 'assistant coach', 'head coach', 'fitness coach']))].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('min', numeric_only=True)

coach[(coach['C_EXPYEARS'] <= 5)].merge(team[(team['T_GROUP'].isin(['f', 'g', 'b', 'e', 'h', 'c', 'a', 'd']))], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'C_EXPYEARS', 'C_TEAMKEY', 'T_PLAYERCOUNT', 'C_NAME']).agg('sum', numeric_only=True)

coach[(coach['C_EXPYEARS'] == 17) & (coach['C_TEAMKEY'].str.startswith('t')) | (coach['C_COACHKEY'] > 81) | (coach['C_ROLE'] != 'head coach')].merge(team[(team['T_PLAYERCOUNT'] < 24) & (team['T_GROUP'].isin(['g'])) & (team['T_GROUP'] != 'b')][['T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_EXPYEARS'] == 28) | (coach['C_TEAMKEY'] != 't') & (coach['C_TEAMKEY'] != 't') & (coach['C_EXPYEARS'] >= 21)][['C_TEAMKEY']].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_EXPYEARS'] == 4) & (coach['C_COACHKEY'] == 59) & (coach['C_COACHKEY'] <= 14) & (coach['C_COACHKEY'] == 77)].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_NAME', 'C_COACHKEY', 'C_ROLE', 'C_EXPYEARS']).agg('mean', numeric_only=True)

coach[(coach['C_NAME'] == 'c') | (coach['C_NAME'] == 'c') | (coach['C_NAME'] == 'c') | (coach['C_EXPYEARS'] != 30)][['C_TEAMKEY', 'C_EXPYEARS', 'C_ROLE']].merge(team[(team['T_TEAMKEY'].str.startswith('t'))], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'].str.startswith('c')) | (coach['C_TEAMKEY'].str.startswith('t')) | (coach['C_EXPYEARS'] < 2)].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_NAME', 'T_PLAYERCOUNT', 'T_GROUP', 'C_ROLE', 'T_TEAMKEY']).agg('max', numeric_only=True)

coach[(coach['C_TEAMKEY'] != 't') & (coach['C_EXPYEARS'] != 15) | (coach['C_TEAMKEY'] == 't') | (coach['C_TEAMKEY'].str.startswith('t'))].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_TEAMKEY', 'C_COACHKEY', 'C_EXPYEARS']).agg('mean', numeric_only=True)

coach[(coach['C_TEAMKEY'] != 't') & (coach['C_NAME'] == 'c') & (coach['C_EXPYEARS'] >= 26)].merge(team[['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP']).agg('count')

coach[['C_TEAMKEY', 'C_COACHKEY', 'C_EXPYEARS']].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_EXPYEARS', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

match.merge(stadium[(stadium['S_NAME'].str.startswith('s')) | (stadium['S_YEARBUILT'] == 1983) & (stadium['S_YEARBUILT'] >= 2016) & (stadium['S_CAPACITY'] != 84651) & (stadium['S_YEARBUILT'] > 1975)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[(team['T_PLAYERCOUNT'] > 20) | (team['T_PLAYERCOUNT'] == 21)], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match.merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[['S_STADIUMKEY', 'S_CAPACITY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['T_TEAMKEY', 'M_MATCHKEY', 'M_TEAM1KEY']).agg('max', numeric_only=True)

match[(match['M_MATCHKEY'] != 17)].merge(team[(team['T_TEAMKEY'] != 't')][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[['M_ATTENDANCE', 'M_TEAM1KEY', 'M_TIME']].merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY', 'M_ATTENDANCE', 'M_TEAM1KEY']).agg('min', numeric_only=True)

match[['M_ROUND', 'M_DATE', 'M_MATCHKEY', 'M_TEAM1KEY', 'M_STADIUMKEY', 'M_TIME', 'M_SCORE2', 'M_DURATION', 'M_SCORE1', 'M_TEAM2KEY']].groupby(by=['M_ROUND', 'M_MATCHKEY']).agg('count')

match[['M_ROUND', 'M_MATCHKEY', 'M_STADIUMKEY', 'M_SCORE2', 'M_DURATION', 'M_TIME', 'M_SCORE1']].merge(stadium[(stadium['S_CITY'] != 'r') | (stadium['S_YEARBUILT'] > 1992) | (stadium['S_LOCATION'].str.startswith('s'))], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[['M_STADIUMKEY', 'M_ATTENDANCE', 'M_SCORE1']].merge(stadium[(stadium['S_YEARBUILT'] != 2020) & (stadium['S_LOCATION'] != 'n')][['S_CITY', 'S_NAME', 'S_CAPACITY', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[['M_TEAM2KEY']].merge(team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'M_TEAM2KEY', 'T_GROUP']).agg('count')

stadium[(stadium['S_CITY'] != 'a')][['S_NAME', 'S_CAPACITY', 'S_STADIUMKEY', 'S_YEARBUILT', 'S_LOCATION']].groupby(by=['S_STADIUMKEY', 'S_YEARBUILT', 'S_CAPACITY', 'S_NAME']).agg('min', numeric_only=True)

stadium[(stadium['S_CITY'].str.startswith('a')) | (stadium['S_YEARBUILT'] != 1987) | (stadium['S_LOCATION'] == 's') | (stadium['S_NAME'] != 's') & (stadium['S_NAME'] == 's') & (stadium['S_LOCATION'].str.startswith('w'))][['S_YEARBUILT', 'S_STADIUMKEY']].groupby(by=['S_YEARBUILT', 'S_STADIUMKEY']).agg('max', numeric_only=True)

stadium[(stadium['S_LOCATION'].str.startswith('e')) & (stadium['S_YEARBUILT'] > 1966) | (stadium['S_NAME'] != 's') & (stadium['S_CAPACITY'] == 85932) & (stadium['S_YEARBUILT'] < 1996)][['S_CAPACITY', 'S_NAME', 'S_YEARBUILT', 'S_STADIUMKEY']].groupby(by=['S_NAME']).agg('mean', numeric_only=True)

stadium[(stadium['S_YEARBUILT'] >= 1950)][['S_YEARBUILT', 'S_CITY', 'S_NAME', 'S_LOCATION', 'S_STADIUMKEY']].groupby(by=['S_YEARBUILT', 'S_CITY', 'S_STADIUMKEY', 'S_LOCATION']).agg('max', numeric_only=True)

association[(association['A_ASSOCKEY'] != 'f') & (association['A_TEAMKEY'] != 't') | (association['A_PRESIDENT'].str.startswith('p')) | (association['A_PRESIDENT'] != 'p')].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_PRESIDENT', 'A_ASSOCKEY', 'T_GROUP', 'A_FOUNDEDYEAR', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

association[(association['A_ASSOCKEY'] != 'f') | (association['A_TEAMKEY'] != 't') & (association['A_TEAMKEY'] == 't') & (association['A_FOUNDEDYEAR'] == 1961)][['A_PRESIDENT', 'A_TEAMKEY', 'A_FOUNDEDYEAR']].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_ASSOCKEY'] != 'f')].merge(team[(team['T_TEAMKEY'].str.startswith('t')) | (team['T_PLAYERCOUNT'] != 21) & (team['T_TEAMKEY'] == 't')][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_PRESIDENT']).agg('sum', numeric_only=True)

association[(association['A_FOUNDEDYEAR'] < 1938) & (association['A_FOUNDEDYEAR'] > 1922) | (association['A_FOUNDEDYEAR'] < 1940) & (association['A_ASSOCKEY'] != 'f')].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_ASSOCKEY', 'A_FOUNDEDYEAR', 'A_PRESIDENT', 'T_GROUP', 'T_PLAYERCOUNT']).agg('mean', numeric_only=True)

association[(association['A_PRESIDENT'] != 'p') & (association['A_FOUNDEDYEAR'] >= 1992) | (association['A_FOUNDEDYEAR'] != 1946) & (association['A_PRESIDENT'] == 'p')][['A_ASSOCKEY', 'A_TEAMKEY', 'A_PRESIDENT', 'A_FOUNDEDYEAR']].groupby(by=['A_TEAMKEY', 'A_ASSOCKEY', 'A_PRESIDENT']).agg('mean', numeric_only=True)

association[(association['A_PRESIDENT'] != 'p') & (association['A_PRESIDENT'].str.startswith('p'))].merge(team[(team['T_TEAMKEY'] == 't')], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'A_TEAMKEY', 'T_TEAMKEY', 'A_FOUNDEDYEAR']).agg('mean', numeric_only=True)

association[(association['A_TEAMKEY'] != 't') | (association['A_PRESIDENT'] != 'p') & (association['A_ASSOCKEY'].str.startswith('f'))][['A_TEAMKEY']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP', 'A_TEAMKEY']).agg('sum', numeric_only=True)

association[(association['A_TEAMKEY'].str.startswith('t')) & (association['A_PRESIDENT'] != 'p') & (association['A_PRESIDENT'] == 'p') & (association['A_ASSOCKEY'] != 'f')].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_PRESIDENT', 'T_GROUP', 'A_FOUNDEDYEAR', 'T_TEAMKEY', 'A_ASSOCKEY']).agg('max', numeric_only=True)

association[['A_PRESIDENT', 'A_ASSOCKEY', 'A_TEAMKEY', 'A_FOUNDEDYEAR']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'A_ASSOCKEY', 'T_GROUP', 'A_PRESIDENT', 'A_FOUNDEDYEAR']).agg('min', numeric_only=True)

association[['A_TEAMKEY', 'A_ASSOCKEY', 'A_PRESIDENT', 'A_FOUNDEDYEAR']].merge(team[(team['T_GROUP'] != 'h') & (team['T_PLAYERCOUNT'] >= 20) | (team['T_TEAMKEY'] == 't')][['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

coach.merge(team[(team['T_GROUP'] != 'g') | (team['T_GROUP'] == 'e')][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_ROLE', 'C_NAME', 'C_EXPYEARS', 'C_COACHKEY', 'T_TEAMKEY']).agg('min', numeric_only=True)

coach.merge(team[(team['T_PLAYERCOUNT'] != 22) & (team['T_GROUP'].isin(['g', 'c', 'f', 'b', 'h', 'a'])) | (team['T_GROUP'] == 'f')][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_NAME', 'C_COACHKEY', 'C_EXPYEARS', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

coach[(coach['C_COACHKEY'] >= 51) & (coach['C_EXPYEARS'] <= 3) | (coach['C_ROLE'] != 'goalkeeper coach') | (coach['C_NAME'] != 'c')].merge(team[(team['T_PLAYERCOUNT'] < 22) & (team['T_TEAMKEY'].str.startswith('t')) & (team['T_PLAYERCOUNT'] >= 24)][['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_EXPYEARS'] < 3) & (coach['C_NAME'].str.startswith('c')) & (coach['C_TEAMKEY'] == 't') | (coach['C_NAME'] == 'c') | (coach['C_ROLE'].isin(['head coach', 'fitness coach', 'goalkeeper coach', 'assistant coach']))][['C_EXPYEARS', 'C_TEAMKEY', 'C_ROLE', 'C_NAME', 'C_COACHKEY']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_EXPYEARS'] == 19) & (coach['C_COACHKEY'] == 32) & (coach['C_TEAMKEY'] == 't') & (coach['C_NAME'] == 'c')].merge(team[(team['T_PLAYERCOUNT'] >= 20) | (team['T_PLAYERCOUNT'] != 21) | (team['T_GROUP'] != 'g')][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'] != 'c') & (coach['C_COACHKEY'] >= 16) | (coach['C_ROLE'] == 'assistant coach')].merge(team[(team['T_PLAYERCOUNT'] != 18) & (team['T_TEAMKEY'] == 't') & (team['T_TEAMKEY'] != 't')], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_COACHKEY', 'C_TEAMKEY']).agg('sum', numeric_only=True)

coach[(coach['C_NAME'] == 'c') & (coach['C_ROLE'].isin(['goalkeeper coach', 'fitness coach', 'assistant coach'])) & (coach['C_ROLE'] == 'fitness coach')].merge(team[(team['T_TEAMKEY'] != 't') & (team['T_PLAYERCOUNT'] < 19) & (team['T_GROUP'] != 'g')], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_NAME', 'T_TEAMKEY']).agg('min', numeric_only=True)

coach[(coach['C_NAME'] == 'c') | (coach['C_TEAMKEY'] != 't') & (coach['C_ROLE'].isin(['assistant coach', 'goalkeeper coach'])) | (coach['C_TEAMKEY'].str.startswith('t'))][['C_EXPYEARS', 'C_COACHKEY', 'C_ROLE', 'C_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] < 21)], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_TEAMKEY'] != 't') | (coach['C_EXPYEARS'] <= 5) & (coach['C_EXPYEARS'] <= 33) & (coach['C_EXPYEARS'] <= 31)].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_EXPYEARS', 'C_TEAMKEY', 'C_ROLE', 'C_COACHKEY', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

coach[(coach['C_TEAMKEY'].str.startswith('t')) | (coach['C_TEAMKEY'] != 't') & (coach['C_EXPYEARS'] <= 7) & (coach['C_EXPYEARS'] > 31) | (coach['C_COACHKEY'] != 46)].merge(team[(team['T_PLAYERCOUNT'] >= 25) | (team['T_PLAYERCOUNT'] > 23)][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[['C_TEAMKEY', 'C_COACHKEY', 'C_ROLE', 'C_EXPYEARS', 'C_NAME']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT', 'C_ROLE']).agg('max', numeric_only=True)

coach[['C_TEAMKEY', 'C_ROLE', 'C_COACHKEY', 'C_NAME']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_COACHKEY', 'T_TEAMKEY', 'C_NAME', 'T_PLAYERCOUNT', 'T_GROUP']).agg('max', numeric_only=True)

match.merge(team[(team['T_GROUP'] == 'd') & (team['T_GROUP'] != 'c')][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[['S_STADIUMKEY', 'S_YEARBUILT']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match.merge(team[['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_CAPACITY'] != 59861) | (stadium['S_LOCATION'] != 'e') & (stadium['S_LOCATION'] != 'c') & (stadium['S_CAPACITY'] == 50945) | (stadium['S_YEARBUILT'] < 1975)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_TIME'] == '1') & (match['M_TEAM1KEY'] != 't') & (match['M_DURATION'] != 138) | (match['M_SCORE2'] != 0) | (match['M_TEAM2KEY'] == 't') | (match['M_ATTENDANCE'] == 46337) | (match['M_MATCHKEY'] != 4) & (match['M_SCORE1'] != 5) & (match['M_TEAM1KEY'] != 't')][['M_ROUND']].groupby(by=['M_ROUND']).agg('sum', numeric_only=True)

match[['M_DURATION', 'M_DATE', 'M_ATTENDANCE', 'M_TEAM2KEY']].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT']).agg('count')

stadium[(stadium['S_STADIUMKEY'] < 5) & (stadium['S_CAPACITY'] < 58872) | (stadium['S_STADIUMKEY'] > 5) | (stadium['S_CAPACITY'] >= 84140) | (stadium['S_CITY'] == 'l')][['S_CITY', 'S_CAPACITY', 'S_STADIUMKEY', 'S_LOCATION']].groupby(by=['S_STADIUMKEY', 'S_CAPACITY']).agg('mean', numeric_only=True)

association.merge(team[(team['T_PLAYERCOUNT'] <= 23) & (team['T_GROUP'].isin(['f', 'g']))][['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_FOUNDEDYEAR', 'T_TEAMKEY', 'A_PRESIDENT', 'T_PLAYERCOUNT', 'A_TEAMKEY']).agg('sum', numeric_only=True)

association[(association['A_ASSOCKEY'] != 'f') & (association['A_TEAMKEY'] != 't')].merge(team[(team['T_GROUP'] != 'f') | (team['T_GROUP'] == 'h')][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_FOUNDEDYEAR', 'A_PRESIDENT']).agg('count')

association[(association['A_ASSOCKEY'] != 'f') & (association['A_TEAMKEY'] == 't') & (association['A_PRESIDENT'] != 'p') | (association['A_FOUNDEDYEAR'] > 1970)][['A_TEAMKEY']].merge(team[(team['T_TEAMKEY'].str.startswith('t'))][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_FOUNDEDYEAR'] >= 1944) | (association['A_TEAMKEY'] != 't')][['A_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] < 23) & (team['T_TEAMKEY'].str.startswith('t'))], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_TEAMKEY', 'T_GROUP']).agg('count')

association[(association['A_PRESIDENT'] == 'p') | (association['A_FOUNDEDYEAR'] == 1990) | (association['A_FOUNDEDYEAR'] != 1979)][['A_FOUNDEDYEAR', 'A_ASSOCKEY', 'A_PRESIDENT', 'A_TEAMKEY']].merge(team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_TEAMKEY'] == 't') & (association['A_PRESIDENT'].str.startswith('p'))][['A_FOUNDEDYEAR', 'A_TEAMKEY']].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_TEAMKEY']).agg('min', numeric_only=True)

coach[(coach['C_EXPYEARS'] <= 33) | (coach['C_EXPYEARS'] == 39)].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_TEAMKEY', 'C_NAME', 'T_PLAYERCOUNT', 'C_COACHKEY', 'C_ROLE']).agg('max', numeric_only=True)

coach[(coach['C_EXPYEARS'] == 2)][['C_EXPYEARS', 'C_COACHKEY', 'C_NAME', 'C_ROLE', 'C_TEAMKEY']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_COACHKEY', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

coach[(coach['C_NAME'].str.startswith('c')) & (coach['C_ROLE'] == 'fitness coach') & (coach['C_NAME'].str.startswith('c')) | (coach['C_ROLE'] == 'goalkeeper coach') | (coach['C_NAME'] == 'c')].merge(team[(team['T_PLAYERCOUNT'] < 21) & (team['T_GROUP'] != 'b') | (team['T_PLAYERCOUNT'] > 21)][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'].str.startswith('c')) | (coach['C_COACHKEY'] > 26)][['C_TEAMKEY', 'C_EXPYEARS', 'C_NAME']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP', 'C_NAME']).agg('sum', numeric_only=True)

coach[(coach['C_ROLE'] == 'fitness coach')].merge(team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'C_NAME', 'T_PLAYERCOUNT', 'C_ROLE', 'C_COACHKEY']).agg('count')

coach[(coach['C_ROLE'].isin(['assistant coach'])) | (coach['C_ROLE'].isin(['assistant coach'])) | (coach['C_EXPYEARS'] != 21) & (coach['C_ROLE'].isin(['fitness coach'])) & (coach['C_TEAMKEY'] == 't')].merge(team[(team['T_TEAMKEY'] != 't') | (team['T_PLAYERCOUNT'] < 24) | (team['T_GROUP'].isin(['e', 'b', 'a', 'g', 'd', 'c', 'h']))], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_ROLE']).agg('max', numeric_only=True)

coach[(coach['C_TEAMKEY'].str.startswith('t')) | (coach['C_TEAMKEY'].str.startswith('t')) & (coach['C_EXPYEARS'] == 9) & (coach['C_COACHKEY'] > 82) | (coach['C_COACHKEY'] < 23)].merge(team[(team['T_PLAYERCOUNT'] < 20) & (team['T_GROUP'].isin(['g', 'c', 'f', 'e', 'd', 'a']))], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'C_EXPYEARS']).agg('mean', numeric_only=True)

coach[['C_EXPYEARS', 'C_COACHKEY', 'C_TEAMKEY', 'C_ROLE', 'C_NAME']].merge(team[(team['T_TEAMKEY'] == 't') | (team['T_PLAYERCOUNT'] >= 24) | (team['T_GROUP'].isin(['d', 'a']))][['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

match.merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['M_DURATION', 'S_YEARBUILT', 'M_MATCHKEY', 'M_DATE', 'M_TIME']).agg('max', numeric_only=True)

match.merge(team[(team['T_PLAYERCOUNT'] == 18) & (team['T_GROUP'] != 'b')], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_STADIUMKEY'] > 10) & (stadium['S_CITY'] != 'd') | (stadium['S_CAPACITY'] < 60533)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_CAPACITY']).agg('sum', numeric_only=True)

match.merge(team[(team['T_TEAMKEY'] != 't')][['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_CITY'].str.startswith('l')) & (stadium['S_CAPACITY'] > 40145) & (stadium['S_STADIUMKEY'] >= 1) & (stadium['S_NAME'] == 's')], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match.merge(team[(team['T_TEAMKEY'].str.startswith('t'))], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_YEARBUILT'] >= 2004) | (stadium['S_LOCATION'] == 'w')][['S_CITY', 'S_NAME', 'S_CAPACITY', 'S_STADIUMKEY', 'S_LOCATION']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match.merge(team[['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_LOCATION'].str.startswith('c')) & (stadium['S_CITY'] == 'd') & (stadium['S_NAME'] != 's') | (stadium['S_CAPACITY'] > 49734) & (stadium['S_NAME'] == 's') | (stadium['S_STADIUMKEY'] <= 4)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_ATTENDANCE'] == 50582) & (match['M_SCORE1'] == 5)][['M_SCORE1', 'M_ATTENDANCE', 'M_SCORE2', 'M_ROUND', 'M_TIME']].groupby(by=['M_SCORE1', 'M_ATTENDANCE', 'M_SCORE2', 'M_TIME', 'M_ROUND']).agg('sum', numeric_only=True)

match[(match['M_ROUND'].isin(['round of 16', 'group stage'])) & (match['M_ROUND'] != 'group stage') | (match['M_ROUND'] == 'semi-final') | (match['M_ROUND'].isin(['group stage', 'final', 'round of 16', 'quarter-final', 'semi-final'])) & (match['M_STADIUMKEY'] > 10)].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_SCORE1'] >= 2) | (match['M_STADIUMKEY'] <= 1) | (match['M_DATE'] < '2022-11-20') | (match['M_ROUND'] != 'semi-final') | (match['M_MATCHKEY'] > 13)].merge(team[(team['T_PLAYERCOUNT'] < 22) & (team['T_PLAYERCOUNT'] != 18) | (team['T_GROUP'] != 'f')], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

stadium[(stadium['S_CAPACITY'] != 87112) | (stadium['S_STADIUMKEY'] != 11)][['S_YEARBUILT', 'S_CAPACITY', 'S_STADIUMKEY', 'S_CITY', 'S_NAME', 'S_LOCATION']].groupby(by=['S_LOCATION', 'S_STADIUMKEY', 'S_NAME', 'S_YEARBUILT']).agg('sum', numeric_only=True)

association[(association['A_FOUNDEDYEAR'] != 1912)][['A_PRESIDENT', 'A_ASSOCKEY', 'A_TEAMKEY', 'A_FOUNDEDYEAR']].merge(team[(team['T_GROUP'] != 'f') & (team['T_PLAYERCOUNT'] >= 23) & (team['T_GROUP'] != 'g')][['T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_FOUNDEDYEAR'] <= 1909) & (association['A_TEAMKEY'] == 't') & (association['A_ASSOCKEY'] != 'f') & (association['A_FOUNDEDYEAR'] >= 1987)][['A_ASSOCKEY', 'A_TEAMKEY', 'A_FOUNDEDYEAR']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_FOUNDEDYEAR', 'T_PLAYERCOUNT']).agg('count')

association[(association['A_FOUNDEDYEAR'] > 1911) & (association['A_TEAMKEY'] != 't') & (association['A_PRESIDENT'] == 'p')].merge(team[['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_PRESIDENT', 'A_ASSOCKEY', 'A_TEAMKEY', 'T_GROUP']).agg('count')

association[(association['A_PRESIDENT'].str.startswith('p')) | (association['A_TEAMKEY'].str.startswith('t')) | (association['A_ASSOCKEY'].str.startswith('f')) & (association['A_FOUNDEDYEAR'] > 1991)][['A_TEAMKEY', 'A_ASSOCKEY', 'A_PRESIDENT', 'A_FOUNDEDYEAR']].merge(team[(team['T_PLAYERCOUNT'] < 19) & (team['T_GROUP'] != 'b') & (team['T_PLAYERCOUNT'] == 19)], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[['A_ASSOCKEY', 'A_FOUNDEDYEAR', 'A_PRESIDENT', 'A_TEAMKEY']].merge(team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_TEAMKEY'].str.startswith('t')) & (team['T_GROUP'] == 'b')], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_PLAYERCOUNT', 'A_ASSOCKEY']).agg('max', numeric_only=True)

coach.merge(team[(team['T_TEAMKEY'] == 't') | (team['T_GROUP'] != 'g') & (team['T_TEAMKEY'].str.startswith('t'))][['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'C_COACHKEY', 'T_PLAYERCOUNT', 'C_NAME', 'C_EXPYEARS']).agg('max', numeric_only=True)

coach[(coach['C_COACHKEY'] > 61) | (coach['C_EXPYEARS'] == 29) | (coach['C_COACHKEY'] < 51)][['C_EXPYEARS', 'C_TEAMKEY', 'C_NAME']].merge(team[(team['T_GROUP'] == 'c')][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_EXPYEARS'] < 24) | (coach['C_COACHKEY'] >= 61)][['C_TEAMKEY', 'C_EXPYEARS', 'C_ROLE', 'C_COACHKEY', 'C_NAME']].merge(team[(team['T_TEAMKEY'] == 't')][['T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'].str.startswith('c')) | (coach['C_EXPYEARS'] <= 9) | (coach['C_EXPYEARS'] < 33)].merge(team[(team['T_GROUP'] == 'e') & (team['T_PLAYERCOUNT'] < 23) & (team['T_PLAYERCOUNT'] >= 25)][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_COACHKEY']).agg('max', numeric_only=True)

coach[(coach['C_ROLE'] != 'fitness coach') & (coach['C_TEAMKEY'].str.startswith('t'))][['C_TEAMKEY', 'C_ROLE', 'C_NAME', 'C_EXPYEARS']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_TEAMKEY', 'T_GROUP', 'C_NAME']).agg('max', numeric_only=True)

coach[(coach['C_TEAMKEY'] != 't') | (coach['C_ROLE'] == 'head coach') | (coach['C_TEAMKEY'] != 't') & (coach['C_TEAMKEY'] != 't') | (coach['C_NAME'] != 'c')][['C_EXPYEARS', 'C_TEAMKEY', 'C_COACHKEY']].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_TEAMKEY'] == 't') & (coach['C_ROLE'] == 'head coach') | (coach['C_TEAMKEY'] != 't') | (coach['C_EXPYEARS'] == 7) & (coach['C_NAME'].str.startswith('c'))].merge(team[['T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'C_NAME', 'C_TEAMKEY']).agg('min', numeric_only=True)

coach[(coach['C_TEAMKEY'] == 't') | (coach['C_EXPYEARS'] == 24) | (coach['C_EXPYEARS'] >= 31)].merge(team[['T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_NAME', 'C_EXPYEARS', 'C_COACHKEY', 'C_ROLE', 'T_TEAMKEY']).agg('sum', numeric_only=True)

match.merge(team[(team['T_TEAMKEY'] == 't') | (team['T_GROUP'].isin(['g', 'b']))][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_DATE', 'T_PLAYERCOUNT']).agg('mean', numeric_only=True)

match[(match['M_DURATION'] < 125) & (match['M_ATTENDANCE'] > 75127) & (match['M_ROUND'].isin(['round of 16', 'quarter-final', 'group stage', 'final'])) | (match['M_TEAM1KEY'].str.startswith('t'))][['M_MATCHKEY', 'M_STADIUMKEY', 'M_ATTENDANCE', 'M_DATE', 'M_DURATION', 'M_TIME', 'M_TEAM2KEY']].groupby(by=['M_DATE', 'M_MATCHKEY']).agg('mean', numeric_only=True)

match[(match['M_ROUND'] != 'semi-final')][['M_ROUND', 'M_STADIUMKEY', 'M_TIME', 'M_SCORE2', 'M_SCORE1']].merge(stadium[(stadium['S_STADIUMKEY'] == 9) & (stadium['S_CAPACITY'] == 57964)][['S_STADIUMKEY', 'S_LOCATION']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[['M_DATE', 'M_STADIUMKEY', 'M_TIME', 'M_TEAM2KEY', 'M_SCORE1']].merge(stadium[(stadium['S_NAME'].str.startswith('s'))], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[['M_STADIUMKEY', 'M_ATTENDANCE']].merge(stadium[['S_CAPACITY', 'S_STADIUMKEY', 'S_YEARBUILT', 'S_CITY', 'S_NAME']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_ATTENDANCE', 'S_STADIUMKEY', 'S_CAPACITY']).agg('sum', numeric_only=True)

match[['M_TEAM2KEY', 'M_MATCHKEY', 'M_SCORE1', 'M_ATTENDANCE']].merge(team[['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['M_SCORE1', 'M_ATTENDANCE', 'T_TEAMKEY']).agg('max', numeric_only=True)

stadium[(stadium['S_LOCATION'] == 'n') & (stadium['S_STADIUMKEY'] <= 9) | (stadium['S_STADIUMKEY'] < 2) | (stadium['S_CAPACITY'] == 86280)][['S_CAPACITY', 'S_LOCATION', 'S_STADIUMKEY', 'S_NAME', 'S_YEARBUILT']].groupby(by=['S_YEARBUILT', 'S_NAME', 'S_STADIUMKEY', 'S_CAPACITY']).agg('sum', numeric_only=True)

stadium[(stadium['S_LOCATION'].str.startswith('c')) & (stadium['S_LOCATION'].str.startswith('n')) | (stadium['S_LOCATION'].str.startswith('w')) & (stadium['S_LOCATION'].str.startswith('n')) | (stadium['S_CITY'].str.startswith('d'))][['S_LOCATION', 'S_CAPACITY', 'S_NAME', 'S_CITY', 'S_STADIUMKEY']].groupby(by=['S_CAPACITY', 'S_STADIUMKEY', 'S_NAME']).agg('count')

association[(association['A_ASSOCKEY'] != 'f') & (association['A_ASSOCKEY'].str.startswith('f'))][['A_FOUNDEDYEAR', 'A_PRESIDENT', 'A_TEAMKEY']].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_FOUNDEDYEAR', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

association[(association['A_ASSOCKEY'] == 'f') & (association['A_PRESIDENT'] != 'p') & (association['A_PRESIDENT'].str.startswith('p'))][['A_TEAMKEY', 'A_FOUNDEDYEAR', 'A_ASSOCKEY', 'A_PRESIDENT']].merge(team[(team['T_TEAMKEY'] == 't') & (team['T_PLAYERCOUNT'] != 22)][['T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_FOUNDEDYEAR'] == 1903) & (association['A_TEAMKEY'] != 't') & (association['A_FOUNDEDYEAR'] == 1934) & (association['A_PRESIDENT'] != 'p')].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'A_FOUNDEDYEAR', 'A_ASSOCKEY', 'A_TEAMKEY', 'A_PRESIDENT']).agg('mean', numeric_only=True)

association[(association['A_PRESIDENT'] == 'p') & (association['A_ASSOCKEY'] != 'f')][['A_PRESIDENT', 'A_ASSOCKEY', 'A_TEAMKEY', 'A_FOUNDEDYEAR']].merge(team, left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY', 'A_FOUNDEDYEAR']).agg('count')

coach[(coach['C_COACHKEY'] > 60) & (coach['C_ROLE'] != 'goalkeeper coach') | (coach['C_ROLE'] != 'fitness coach')].merge(team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_EXPYEARS', 'C_TEAMKEY', 'C_ROLE', 'T_GROUP', 'C_COACHKEY']).agg('mean', numeric_only=True)

coach[(coach['C_EXPYEARS'] < 4) | (coach['C_ROLE'] != 'head coach') & (coach['C_COACHKEY'] == 7) | (coach['C_ROLE'].isin(['assistant coach', 'fitness coach', 'goalkeeper coach', 'head coach']))][['C_EXPYEARS', 'C_COACHKEY', 'C_TEAMKEY', 'C_ROLE', 'C_NAME']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_TEAMKEY']).agg('sum', numeric_only=True)

coach[(coach['C_NAME'] == 'c')][['C_ROLE', 'C_EXPYEARS', 'C_NAME', 'C_COACHKEY', 'C_TEAMKEY']].merge(team[(team['T_GROUP'] != 'b') & (team['T_TEAMKEY'].str.startswith('t'))][['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'].str.startswith('c'))][['C_EXPYEARS', 'C_TEAMKEY', 'C_COACHKEY', 'C_NAME']].merge(team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_EXPYEARS']).agg('min', numeric_only=True)

coach[(coach['C_ROLE'] == 'head coach') & (coach['C_COACHKEY'] == 39) & (coach['C_ROLE'] != 'fitness coach') | (coach['C_ROLE'] == 'assistant coach') | (coach['C_NAME'].str.startswith('c'))].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_TEAMKEY', 'T_TEAMKEY', 'C_ROLE', 'C_NAME']).agg('mean', numeric_only=True)

coach[(coach['C_ROLE'] == 'head coach')][['C_EXPYEARS', 'C_TEAMKEY', 'C_NAME']].merge(team[(team['T_TEAMKEY'] == 't') & (team['T_TEAMKEY'] == 't')], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP', 'C_EXPYEARS']).agg('sum', numeric_only=True)

coach[(coach['C_ROLE'].isin(['goalkeeper coach', 'fitness coach'])) & (coach['C_TEAMKEY'].str.startswith('t')) | (coach['C_ROLE'].isin(['fitness coach'])) | (coach['C_COACHKEY'] < 80)][['C_TEAMKEY', 'C_EXPYEARS', 'C_ROLE', 'C_COACHKEY', 'C_NAME']].merge(team[(team['T_PLAYERCOUNT'] >= 25) | (team['T_GROUP'] != 'h') | (team['T_TEAMKEY'] == 't')], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_TEAMKEY'] != 't') | (coach['C_TEAMKEY'] == 't') | (coach['C_TEAMKEY'] == 't')][['C_TEAMKEY', 'C_EXPYEARS', 'C_NAME']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_NAME', 'C_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']).agg('count')

coach[['C_TEAMKEY', 'C_COACHKEY', 'C_ROLE']].merge(team[(team['T_GROUP'] == 'c') & (team['T_GROUP'] == 'f') & (team['T_TEAMKEY'] == 't')], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_TEAMKEY', 'C_ROLE', 'C_COACHKEY', 'T_PLAYERCOUNT', 'T_TEAMKEY']).agg('mean', numeric_only=True)

match.merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[(team['T_GROUP'].isin(['e', 'f', 'b', 'h', 'c', 'a', 'g', 'd']))][['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['S_CAPACITY', 'S_CITY', 'M_DURATION', 'S_NAME']).agg('max', numeric_only=True)

match.merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_LOCATION'] != 'n') | (stadium['S_NAME'] != 's') & (stadium['S_NAME'] == 's')][['S_NAME', 'S_LOCATION', 'S_CITY', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_CITY']).agg('mean', numeric_only=True)

match[(match['M_DATE'] == '2022-11-20') | (match['M_SCORE1'] <= 2) | (match['M_DATE'] <= '2022-12-18') | (match['M_ROUND'] != 'semi-final') & (match['M_MATCHKEY'] >= 10) | (match['M_STADIUMKEY'] > 5)][['M_DATE', 'M_TIME', 'M_ATTENDANCE', 'M_DURATION']].groupby(by=['M_DATE', 'M_DURATION', 'M_TIME', 'M_ATTENDANCE']).agg('min', numeric_only=True)

match[(match['M_MATCHKEY'] != 17) & (match['M_SCORE2'] < 4) | (match['M_DATE'] == '2022-11-20') | (match['M_MATCHKEY'] > 43) & (match['M_TEAM1KEY'] == 't') & (match['M_ROUND'] == 'group stage') & (match['M_DURATION'] != 131) | (match['M_TEAM1KEY'] != 't') | (match['M_STADIUMKEY'] == 4)][['M_SCORE2', 'M_DURATION', 'M_STADIUMKEY']].groupby(by=['M_DURATION', 'M_STADIUMKEY']).agg('max', numeric_only=True)

match[(match['M_MATCHKEY'] <= 40) | (match['M_ROUND'] != 'semi-final') | (match['M_TIME'].str.startswith('2')) & (match['M_TEAM2KEY'] != 't') & (match['M_STADIUMKEY'] < 3) & (match['M_TIME'] != '2') | (match['M_DATE'] >= '2022-12-18') & (match['M_ROUND'] == 'final') | (match['M_ROUND'].isin(['round of 16', 'semi-final', 'quarter-final']))][['M_SCORE2', 'M_DATE', 'M_TIME']].groupby(by=['M_TIME', 'M_SCORE2']).agg('count')

match[(match['M_MATCHKEY'] > 22)].merge(stadium[['S_YEARBUILT', 'S_CAPACITY', 'S_STADIUMKEY', 'S_NAME', 'S_LOCATION']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[(match['M_SCORE2'] == 6) | (match['M_ROUND'] == 'group stage') & (match['M_TEAM1KEY'] != 't') & (match['M_TIME'] != '2') | (match['M_TEAM2KEY'] != 't')].merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['S_NAME', 'M_DATE', 'S_LOCATION']).agg('count')

match[(match['M_STADIUMKEY'] == 10) | (match['M_TEAM2KEY'].str.startswith('t')) | (match['M_TIME'].str.startswith('1')) & (match['M_ROUND'] != 'final') & (match['M_ATTENDANCE'] == 80599) | (match['M_DATE'] >= '2022-11-20') | (match['M_SCORE1'] != 1) | (match['M_TEAM2KEY'] == 't')][['M_TEAM2KEY']].merge(team[(team['T_GROUP'] != 'c') & (team['T_GROUP'] != 'h') | (team['T_TEAMKEY'] == 't')], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[(match['M_TEAM2KEY'] == 't') & (match['M_ATTENDANCE'] != 76875) & (match['M_DATE'] < '2022-11-20') | (match['M_SCORE2'] <= 3) & (match['M_DURATION'] > 142) | (match['M_ATTENDANCE'] >= 80854) & (match['M_MATCHKEY'] != 42)][['M_MATCHKEY', 'M_TIME', 'M_SCORE1', 'M_SCORE2', 'M_DURATION']].groupby(by=['M_DURATION', 'M_SCORE1']).agg('count')

match[(match['M_TEAM2KEY'].str.startswith('t')) | (match['M_ATTENDANCE'] == 58566) | (match['M_TIME'] == '1') & (match['M_SCORE2'] >= 1) | (match['M_TIME'] == '2') & (match['M_ROUND'] != 'final') | (match['M_TIME'] != '2')][['M_ATTENDANCE', 'M_TEAM1KEY', 'M_SCORE2', 'M_MATCHKEY', 'M_TEAM2KEY', 'M_ROUND']].merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[['M_DATE', 'M_TEAM2KEY', 'M_TIME', 'M_SCORE1', 'M_SCORE2', 'M_MATCHKEY', 'M_TEAM1KEY', 'M_ATTENDANCE']].merge(team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_TEAMKEY'] != 't') | (team['T_TEAMKEY'].str.startswith('t'))][['T_GROUP', 'T_TEAMKEY']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

association[(association['A_ASSOCKEY'] != 'f') | (association['A_TEAMKEY'] != 't') | (association['A_FOUNDEDYEAR'] >= 1947) | (association['A_TEAMKEY'].str.startswith('t'))][['A_PRESIDENT', 'A_ASSOCKEY', 'A_TEAMKEY', 'A_FOUNDEDYEAR']].merge(team[(team['T_PLAYERCOUNT'] >= 20)][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_ASSOCKEY'].str.startswith('f')) & (association['A_TEAMKEY'] == 't') & (association['A_FOUNDEDYEAR'] < 1962)][['A_ASSOCKEY', 'A_TEAMKEY', 'A_FOUNDEDYEAR']].merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_TEAMKEY', 'T_GROUP']).agg('mean', numeric_only=True)

association[(association['A_FOUNDEDYEAR'] != 1948) | (association['A_TEAMKEY'].str.startswith('t')) & (association['A_FOUNDEDYEAR'] != 1966) | (association['A_ASSOCKEY'] == 'f')][['A_ASSOCKEY', 'A_TEAMKEY', 'A_FOUNDEDYEAR', 'A_PRESIDENT']].merge(team[(team['T_PLAYERCOUNT'] < 18) & (team['T_TEAMKEY'] == 't')][['T_GROUP', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY')

association[(association['A_PRESIDENT'] == 'p') & (association['A_FOUNDEDYEAR'] >= 1987) | (association['A_FOUNDEDYEAR'] > 1958)].merge(team[(team['T_GROUP'].isin(['a', 'h', 'c', 'e', 'd', 'g', 'b'])) & (team['T_TEAMKEY'] == 't') & (team['T_GROUP'] != 'b')][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_ASSOCKEY', 'T_PLAYERCOUNT', 'A_PRESIDENT']).agg('count')

association[(association['A_TEAMKEY'] != 't') & (association['A_PRESIDENT'] == 'p')].merge(team[(team['T_PLAYERCOUNT'] <= 24) & (team['T_TEAMKEY'] != 't') | (team['T_PLAYERCOUNT'] == 23)][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'A_TEAMKEY', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

association[(association['A_TEAMKEY'].str.startswith('t')) & (association['A_PRESIDENT'].str.startswith('p')) & (association['A_FOUNDEDYEAR'] < 1994)].merge(team[(team['T_GROUP'] == 'c') & (team['T_PLAYERCOUNT'] == 19)][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'A_TEAMKEY', 'T_TEAMKEY', 'A_FOUNDEDYEAR']).agg('max', numeric_only=True)

association[['A_ASSOCKEY', 'A_FOUNDEDYEAR', 'A_PRESIDENT', 'A_TEAMKEY']].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'A_PRESIDENT', 'A_ASSOCKEY', 'T_TEAMKEY', 'T_GROUP']).agg('max', numeric_only=True)

coach[(coach['C_EXPYEARS'] < 13) & (coach['C_EXPYEARS'] > 18) | (coach['C_NAME'] == 'c') | (coach['C_TEAMKEY'] == 't') & (coach['C_TEAMKEY'] == 't')][['C_EXPYEARS', 'C_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] > 22) & (team['T_TEAMKEY'] == 't')][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_NAME'] == 'c') | (coach['C_EXPYEARS'] < 9) | (coach['C_ROLE'] == 'assistant coach') & (coach['C_NAME'] != 'c')].merge(team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT', 'C_NAME', 'C_COACHKEY']).agg('max', numeric_only=True)

coach[(coach['C_NAME'].str.startswith('c')) & (coach['C_COACHKEY'] > 36) & (coach['C_COACHKEY'] >= 88) & (coach['C_EXPYEARS'] != 24) & (coach['C_COACHKEY'] != 19)][['C_EXPYEARS', 'C_COACHKEY', 'C_TEAMKEY', 'C_ROLE', 'C_NAME']].merge(team[(team['T_GROUP'].isin(['d', 'b', 'c'])) & (team['T_PLAYERCOUNT'] < 21) | (team['T_GROUP'] == 'c')], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_TEAMKEY'].str.startswith('t')) | (coach['C_NAME'] != 'c') | (coach['C_ROLE'] != 'fitness coach')][['C_TEAMKEY']].merge(team[(team['T_GROUP'].isin(['c', 'd', 'h', 'a', 'e', 'g', 'b'])) | (team['T_TEAMKEY'] == 't')][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('sum', numeric_only=True)

match.merge(stadium[(stadium['S_CITY'] != 'l') & (stadium['S_NAME'] != 's') | (stadium['S_STADIUMKEY'] <= 3)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['S_CITY', 'M_DURATION', 'S_CAPACITY', 'T_TEAMKEY']).agg('max', numeric_only=True)

match.merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_CITY'].str.startswith('r')) & (stadium['S_CAPACITY'] != 51017) | (stadium['S_YEARBUILT'] == 1987) & (stadium['S_STADIUMKEY'] > 3) & (stadium['S_CAPACITY'] > 42645) | (stadium['S_CITY'] == 'r')], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_NAME', 'S_CAPACITY', 'T_TEAMKEY', 'S_LOCATION']).agg('min', numeric_only=True)

match.merge(team[(team['T_PLAYERCOUNT'] >= 24) & (team['T_TEAMKEY'] == 't')], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[['S_CAPACITY', 'S_YEARBUILT', 'S_LOCATION', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_STADIUMKEY', 'M_MATCHKEY', 'M_DURATION']).agg('max', numeric_only=True)

match[(match['M_DURATION'] > 109) & (match['M_DATE'] <= '2022-12-18') & (match['M_ATTENDANCE'] == 82932) | (match['M_DURATION'] < 126) | (match['M_STADIUMKEY'] < 10) | (match['M_TIME'] != '1') | (match['M_DURATION'] > 119) & (match['M_DATE'] <= '2022-11-20')].merge(team[(team['T_GROUP'].isin(['f'])) & (team['T_PLAYERCOUNT'] < 20) & (team['T_TEAMKEY'] == 't')], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_MATCHKEY'] != 29) & (match['M_DATE'] > '2022-11-20') | (match['M_DURATION'] < 106) | (match['M_SCORE2'] < 5) & (match['M_SCORE2'] > 3) & (match['M_MATCHKEY'] <= 42) & (match['M_TEAM2KEY'].str.startswith('t')) & (match['M_TEAM1KEY'].str.startswith('t')) & (match['M_DURATION'] >= 139)].merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_STADIUMKEY', 'S_NAME', 'M_ROUND', 'M_MATCHKEY']).agg('count')

match[(match['M_MATCHKEY'] <= 18) | (match['M_DATE'] < '2022-12-18') | (match['M_DATE'] >= '2022-11-20')].merge(team[(team['T_PLAYERCOUNT'] != 20) & (team['T_TEAMKEY'] == 't')][['T_GROUP', 'T_TEAMKEY']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['M_SCORE2', 'M_TIME', 'M_ATTENDANCE', 'M_TEAM1KEY']).agg('min', numeric_only=True)

match[(match['M_MATCHKEY'] == 15) & (match['M_ATTENDANCE'] != 36997)].merge(stadium[(stadium['S_NAME'].str.startswith('s')) | (stadium['S_CITY'] == 'a')], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['S_CITY', 'M_DURATION', 'M_STADIUMKEY', 'S_LOCATION']).agg('min', numeric_only=True)

match[(match['M_ROUND'].isin(['semi-final', 'final', 'group stage', 'round of 16', 'quarter-final'])) | (match['M_TIME'].str.startswith('1')) | (match['M_DURATION'] <= 94) & (match['M_ROUND'] != 'quarter-final') | (match['M_ROUND'] != 'round of 16') | (match['M_SCORE2'] > 2)].merge(stadium[(stadium['S_YEARBUILT'] == 2002) & (stadium['S_YEARBUILT'] > 1965) | (stadium['S_CAPACITY'] == 79233)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[(team['T_PLAYERCOUNT'] != 24)], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[(match['M_SCORE1'] != 0) | (match['M_TEAM2KEY'] == 't') | (match['M_STADIUMKEY'] > 10) | (match['M_SCORE2'] <= 3) | (match['M_TEAM2KEY'] == 't')].merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_TIME', 'M_SCORE1', 'S_CITY', 'M_DATE']).agg('max', numeric_only=True)

match[(match['M_SCORE2'] <= 4) | (match['M_SCORE1'] == 1) & (match['M_DURATION'] > 102) | (match['M_DURATION'] != 90) | (match['M_STADIUMKEY'] > 8) | (match['M_TEAM1KEY'] == 't') | (match['M_TEAM2KEY'] == 't') | (match['M_DATE'] <= '2022-12-18') | (match['M_ATTENDANCE'] >= 42250)][['M_ROUND', 'M_DATE', 'M_MATCHKEY', 'M_STADIUMKEY', 'M_SCORE1', 'M_SCORE2', 'M_ATTENDANCE', 'M_DURATION', 'M_TEAM2KEY']]

match[(match['M_TEAM1KEY'] != 't') & (match['M_ATTENDANCE'] <= 76754) | (match['M_TIME'] == '2') & (match['M_SCORE2'] == 0)][['M_DATE', 'M_ATTENDANCE', 'M_DURATION', 'M_TIME', 'M_SCORE1', 'M_MATCHKEY', 'M_TEAM2KEY', 'M_TEAM1KEY']].merge(team[(team['T_TEAMKEY'].str.startswith('t'))], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[['M_TIME', 'M_TEAM1KEY']].merge(team[(team['T_GROUP'] != 'g') | (team['T_GROUP'] != 'e')][['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'M_TEAM1KEY', 'T_GROUP', 'T_TEAMKEY']).agg('min', numeric_only=True)

association[(association['A_TEAMKEY'] == 't')][['A_PRESIDENT', 'A_TEAMKEY']].merge(team[(team['T_TEAMKEY'].str.startswith('t')) & (team['T_TEAMKEY'] != 't') & (team['T_TEAMKEY'] != 't')], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'A_TEAMKEY', 'T_TEAMKEY', 'T_PLAYERCOUNT', 'A_PRESIDENT']).agg('count')

coach[(coach['C_NAME'] == 'c') | (coach['C_TEAMKEY'].str.startswith('t')) | (coach['C_TEAMKEY'] != 't') & (coach['C_COACHKEY'] == 55)][['C_NAME', 'C_COACHKEY', 'C_TEAMKEY']].merge(team, left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'C_COACHKEY', 'T_GROUP', 'C_NAME', 'C_TEAMKEY']).agg('sum', numeric_only=True)

coach[(coach['C_NAME'].str.startswith('c')) | (coach['C_COACHKEY'] >= 97)][['C_EXPYEARS', 'C_COACHKEY', 'C_NAME', 'C_TEAMKEY', 'C_ROLE']].merge(team[(team['T_GROUP'].isin(['c', 'd'])) & (team['T_TEAMKEY'] == 't')], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_EXPYEARS', 'C_ROLE']).agg('min', numeric_only=True)

coach[(coach['C_NAME'].str.startswith('c'))].merge(team[(team['T_PLAYERCOUNT'] > 24) & (team['T_PLAYERCOUNT'] == 23) | (team['T_GROUP'].isin(['d', 'c', 'h', 'a', 'e', 'f']))][['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_EXPYEARS', 'C_NAME', 'C_COACHKEY', 'C_ROLE', 'C_TEAMKEY']).agg('max', numeric_only=True)

coach[(coach['C_ROLE'] == 'fitness coach') & (coach['C_NAME'].str.startswith('c')) | (coach['C_EXPYEARS'] <= 37) | (coach['C_EXPYEARS'] >= 29)][['C_EXPYEARS', 'C_TEAMKEY', 'C_COACHKEY']].merge(team[(team['T_PLAYERCOUNT'] < 24) | (team['T_PLAYERCOUNT'] <= 18) & (team['T_PLAYERCOUNT'] > 25)][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

match.merge(stadium[(stadium['S_CAPACITY'] > 51826) | (stadium['S_STADIUMKEY'] <= 11) | (stadium['S_LOCATION'].str.startswith('s'))][['S_CITY', 'S_NAME', 'S_CAPACITY', 'S_STADIUMKEY', 'S_YEARBUILT', 'S_LOCATION']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match.merge(team[(team['T_GROUP'] != 'f')], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_CAPACITY'] < 80931) & (stadium['S_CAPACITY'] != 83084) | (stadium['S_CITY'] != 'l') | (stadium['S_NAME'].str.startswith('s')) | (stadium['S_CITY'] != 'l')][['S_CAPACITY', 'S_LOCATION', 'S_STADIUMKEY', 'S_CITY', 'S_NAME', 'S_YEARBUILT']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match.merge(team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_CITY'] == 'r') & (stadium['S_YEARBUILT'] == 1974) | (stadium['S_STADIUMKEY'] == 11) & (stadium['S_STADIUMKEY'] < 1)][['S_CITY', 'S_NAME', 'S_STADIUMKEY', 'S_YEARBUILT', 'S_LOCATION']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_ATTENDANCE'] == 59783) | (match['M_DATE'] > '2022-11-20') | (match['M_ROUND'] == 'final') | (match['M_DATE'] != '2022-12-18')][['M_STADIUMKEY', 'M_SCORE2']].merge(stadium[(stadium['S_CITY'] != 'd') & (stadium['S_NAME'].str.startswith('s')) | (stadium['S_STADIUMKEY'] != 11)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_LOCATION', 'S_NAME']).agg('min', numeric_only=True)

match[(match['M_SCORE1'] < 6)].merge(team[(team['T_PLAYERCOUNT'] > 22) & (team['T_PLAYERCOUNT'] > 24)][['T_GROUP', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_NAME'] == 's') | (stadium['S_CITY'] == 'l') & (stadium['S_NAME'] != 's') | (stadium['S_STADIUMKEY'] != 6) & (stadium['S_NAME'].str.startswith('s'))], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[['M_MATCHKEY', 'M_TEAM2KEY', 'M_SCORE2', 'M_TEAM1KEY', 'M_STADIUMKEY', 'M_SCORE1', 'M_ATTENDANCE', 'M_ROUND', 'M_DURATION', 'M_DATE']].merge(stadium[(stadium['S_LOCATION'] != 's')], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_NAME', 'M_SCORE2']).agg('max', numeric_only=True)

match[['M_SCORE2', 'M_DATE', 'M_STADIUMKEY', 'M_TEAM1KEY', 'M_TEAM2KEY', 'M_TIME', 'M_DURATION']].merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[['S_YEARBUILT', 'S_CITY', 'S_NAME', 'S_LOCATION', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

association[['A_ASSOCKEY', 'A_FOUNDEDYEAR', 'A_TEAMKEY', 'A_PRESIDENT']].merge(team[(team['T_PLAYERCOUNT'] < 24) | (team['T_TEAMKEY'] != 't')][['T_GROUP', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'A_FOUNDEDYEAR', 'A_PRESIDENT', 'A_ASSOCKEY', 'T_GROUP']).agg('count')

coach[(coach['C_COACHKEY'] < 63) & (coach['C_ROLE'].isin(['assistant coach', 'goalkeeper coach', 'fitness coach'])) | (coach['C_TEAMKEY'] == 't') & (coach['C_TEAMKEY'] != 't') | (coach['C_TEAMKEY'].str.startswith('t'))][['C_NAME', 'C_EXPYEARS', 'C_TEAMKEY', 'C_COACHKEY', 'C_ROLE']].merge(team[(team['T_TEAMKEY'] == 't')][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_COACHKEY'] == 42)][['C_TEAMKEY', 'C_EXPYEARS', 'C_NAME', 'C_ROLE']].merge(team[(team['T_PLAYERCOUNT'] >= 24) | (team['T_PLAYERCOUNT'] != 25) | (team['T_GROUP'].isin(['b', 'h', 'c', 'g', 'd', 'f', 'a', 'e']))], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'C_ROLE', 'T_GROUP', 'C_NAME']).agg('mean', numeric_only=True)

coach[(coach['C_EXPYEARS'] <= 10) & (coach['C_COACHKEY'] <= 84) & (coach['C_TEAMKEY'].str.startswith('t')) & (coach['C_ROLE'] == 'goalkeeper coach')][['C_EXPYEARS', 'C_COACHKEY', 'C_NAME', 'C_TEAMKEY', 'C_ROLE']].merge(team[(team['T_TEAMKEY'].str.startswith('t')) | (team['T_PLAYERCOUNT'] >= 21) & (team['T_TEAMKEY'] != 't')][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY')

coach[(coach['C_EXPYEARS'] == 38) & (coach['C_ROLE'].isin(['fitness coach', 'goalkeeper coach'])) | (coach['C_ROLE'].isin(['goalkeeper coach']))].merge(team[(team['T_GROUP'] != 'f') & (team['T_PLAYERCOUNT'] >= 18) & (team['T_PLAYERCOUNT'] <= 19)][['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_EXPYEARS', 'C_NAME', 'C_ROLE', 'T_TEAMKEY']).agg('count')

match[(match['M_DATE'] <= '2022-11-20')].merge(stadium[['S_YEARBUILT', 'S_LOCATION', 'S_CAPACITY', 'S_CITY', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[['T_GROUP', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['M_SCORE1']).agg('mean', numeric_only=True)

match[(match['M_SCORE2'] <= 2) & (match['M_TIME'] != '1') | (match['M_ROUND'] == 'quarter-final') | (match['M_TEAM1KEY'] == 't') | (match['M_DURATION'] > 149) & (match['M_STADIUMKEY'] <= 4) & (match['M_TEAM2KEY'] != 't') | (match['M_TEAM1KEY'] != 't') | (match['M_ROUND'].isin(['group stage', 'quarter-final']))].merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_LOCATION'].str.startswith('e')) | (stadium['S_STADIUMKEY'] >= 4) | (stadium['S_CAPACITY'] == 45186) | (stadium['S_LOCATION'] != 'w')], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_TIME'].str.startswith('2')) | (match['M_TIME'] == '1') | (match['M_SCORE2'] >= 4) & (match['M_DATE'] == '2022-12-18') & (match['M_SCORE2'] > 2)][['M_TEAM1KEY', 'M_DATE', 'M_SCORE1']].merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP', 'M_DATE', 'T_PLAYERCOUNT', 'M_SCORE1']).agg('sum', numeric_only=True)

match[['M_DURATION', 'M_DATE', 'M_ROUND', 'M_MATCHKEY', 'M_STADIUMKEY', 'M_SCORE2', 'M_SCORE1']].merge(stadium[(stadium['S_NAME'] != 's')][['S_NAME', 'S_CAPACITY', 'S_STADIUMKEY', 'S_LOCATION']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_NAME']).agg('mean', numeric_only=True)

match[['M_ROUND', 'M_DURATION', 'M_TEAM2KEY', 'M_SCORE2', 'M_MATCHKEY', 'M_ATTENDANCE', 'M_TEAM1KEY', 'M_SCORE1', 'M_TIME', 'M_STADIUMKEY']].merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[['S_YEARBUILT', 'S_NAME', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[['M_SCORE1', 'M_DATE', 'M_TEAM2KEY']].merge(team[(team['T_PLAYERCOUNT'] <= 21) & (team['T_GROUP'] != 'g') | (team['T_GROUP'].isin(['d', 'b', 'h']))][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'M_TEAM2KEY', 'T_TEAMKEY', 'M_SCORE1', 'M_DATE']).agg('min', numeric_only=True)

association[(association['A_ASSOCKEY'] != 'f') & (association['A_TEAMKEY'].str.startswith('t')) | (association['A_FOUNDEDYEAR'] <= 1952)][['A_ASSOCKEY', 'A_FOUNDEDYEAR', 'A_PRESIDENT', 'A_TEAMKEY']].merge(team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_ASSOCKEY', 'T_TEAMKEY', 'T_PLAYERCOUNT']).agg('count')

association[(association['A_FOUNDEDYEAR'] < 1949) | (association['A_FOUNDEDYEAR'] == 1998) & (association['A_ASSOCKEY'] != 'f') & (association['A_FOUNDEDYEAR'] > 1972)][['A_ASSOCKEY', 'A_PRESIDENT', 'A_TEAMKEY']].merge(team[(team['T_GROUP'].isin(['b', 'h', 'f', 'a', 'c']))], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_ASSOCKEY', 'T_PLAYERCOUNT', 'A_TEAMKEY', 'T_GROUP', 'A_PRESIDENT']).agg('sum', numeric_only=True)

coach[(coach['C_ROLE'] != 'assistant coach') | (coach['C_NAME'].str.startswith('c')) & (coach['C_COACHKEY'] != 8) & (coach['C_COACHKEY'] != 49) & (coach['C_ROLE'].isin(['head coach']))].merge(team[(team['T_TEAMKEY'] == 't') & (team['T_TEAMKEY'] != 't') & (team['T_TEAMKEY'] == 't')][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_ROLE', 'T_PLAYERCOUNT', 'C_TEAMKEY', 'C_NAME']).agg('mean', numeric_only=True)

match.merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_CITY'].str.startswith('r'))][['S_CITY', 'S_CAPACITY', 'S_YEARBUILT', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_STADIUMKEY', 'S_YEARBUILT', 'M_TEAM1KEY', 'M_TEAM2KEY']).agg('mean', numeric_only=True)

match[(match['M_ATTENDANCE'] < 88911) & (match['M_DATE'] != '2022-12-18')][['M_ATTENDANCE', 'M_DURATION', 'M_DATE', 'M_ROUND', 'M_STADIUMKEY', 'M_TEAM1KEY', 'M_SCORE1']].merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[(team['T_TEAMKEY'] != 't') & (team['T_TEAMKEY'].str.startswith('t')) & (team['T_PLAYERCOUNT'] == 21)], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[(match['M_DATE'] >= '2022-12-18') & (match['M_ROUND'] == 'round of 16') | (match['M_TEAM1KEY'] != 't') | (match['M_ATTENDANCE'] == 41471) & (match['M_DATE'] >= '2022-11-20')].merge(team[(team['T_TEAMKEY'] != 't') | (team['T_GROUP'] != 'h')][['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['M_DATE', 'M_ROUND', 'T_GROUP', 'M_TEAM2KEY']).agg('min', numeric_only=True)

match[(match['M_DURATION'] < 111) & (match['M_DURATION'] == 144) & (match['M_SCORE2'] > 2) | (match['M_TEAM2KEY'].str.startswith('t')) & (match['M_SCORE1'] >= 4) & (match['M_DATE'] != '2022-11-20') & (match['M_SCORE2'] == 5) & (match['M_TEAM2KEY'].str.startswith('t')) & (match['M_ATTENDANCE'] > 89920) & (match['M_SCORE1'] == 4)].merge(stadium[(stadium['S_NAME'] == 's') | (stadium['S_YEARBUILT'] >= 2004) | (stadium['S_LOCATION'] != 's') | (stadium['S_STADIUMKEY'] < 1) | (stadium['S_CAPACITY'] != 55940)][['S_CITY', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_DURATION'] == 104) | (match['M_ATTENDANCE'] <= 44813) | (match['M_ROUND'] != 'quarter-final') | (match['M_DURATION'] > 103) & (match['M_STADIUMKEY'] >= 9) | (match['M_SCORE2'] < 1) & (match['M_TIME'] != '2') | (match['M_TEAM1KEY'] != 't') | (match['M_MATCHKEY'] <= 35) | (match['M_TEAM2KEY'].str.startswith('t'))].merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_TEAM2KEY', 'M_SCORE1']).agg('count')

match[(match['M_MATCHKEY'] != 16) & (match['M_STADIUMKEY'] >= 1) & (match['M_MATCHKEY'] < 4) & (match['M_ATTENDANCE'] < 60855) | (match['M_DATE'] < '2022-12-18') & (match['M_STADIUMKEY'] >= 5) & (match['M_TEAM2KEY'].str.startswith('t')) & (match['M_ATTENDANCE'] != 30942) & (match['M_TIME'] == '1') | (match['M_SCORE2'] < 3)].merge(team[(team['T_PLAYERCOUNT'] != 21)][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_SCORE1'] < 2) & (match['M_TIME'].str.startswith('2')) | (match['M_MATCHKEY'] <= 60)].merge(team[(team['T_GROUP'] == 'f')][['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_LOCATION'].str.startswith('w')) & (stadium['S_CITY'] == 'a') & (stadium['S_LOCATION'] != 'e') | (stadium['S_STADIUMKEY'] >= 8) & (stadium['S_LOCATION'].str.startswith('w'))], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_SCORE2'] >= 4) | (match['M_TEAM2KEY'] == 't') & (match['M_ATTENDANCE'] < 60307) & (match['M_STADIUMKEY'] != 10) | (match['M_MATCHKEY'] >= 45) | (match['M_ATTENDANCE'] >= 86413) & (match['M_STADIUMKEY'] == 10) | (match['M_TIME'].str.startswith('2'))].merge(team[(team['T_GROUP'] != 'a') | (team['T_GROUP'].isin(['e', 'b', 'a', 'f', 'h', 'g', 'd']))][['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_STADIUMKEY'] <= 6) | (match['M_DURATION'] > 101) | (match['M_DATE'] < '2022-11-20') | (match['M_MATCHKEY'] < 42) | (match['M_TEAM1KEY'] != 't')].merge(stadium[(stadium['S_STADIUMKEY'] <= 3) & (stadium['S_LOCATION'] != 'e') & (stadium['S_YEARBUILT'] != 1991) | (stadium['S_CAPACITY'] != 54878) & (stadium['S_CITY'].str.startswith('a'))][['S_CAPACITY', 'S_LOCATION', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[(match['M_TEAM1KEY'] != 't') | (match['M_TEAM1KEY'] != 't') | (match['M_SCORE2'] > 2) & (match['M_DATE'] != '2022-12-18') & (match['M_SCORE2'] > 2)][['M_SCORE1', 'M_TEAM2KEY', 'M_ATTENDANCE', 'M_SCORE2', 'M_TEAM1KEY']].merge(team[(team['T_PLAYERCOUNT'] >= 25) | (team['T_GROUP'] != 'b')], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['M_TEAM2KEY']).agg('sum', numeric_only=True)

match[(match['M_TEAM1KEY'] == 't')][['M_ROUND', 'M_DATE', 'M_MATCHKEY', 'M_STADIUMKEY', 'M_SCORE2', 'M_TIME', 'M_ATTENDANCE', 'M_SCORE1']].merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_YEARBUILT', 'S_CITY', 'M_STADIUMKEY', 'S_CAPACITY', 'M_MATCHKEY']).agg('sum', numeric_only=True)

match[(match['M_TEAM1KEY'].str.startswith('t')) | (match['M_SCORE2'] >= 1) & (match['M_DURATION'] > 130)][['M_MATCHKEY', 'M_SCORE1', 'M_STADIUMKEY', 'M_TEAM2KEY', 'M_ROUND']].merge(team[['T_GROUP', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_YEARBUILT'] >= 2020)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[['M_ATTENDANCE', 'M_DURATION', 'M_TIME', 'M_TEAM2KEY', 'M_ROUND']].merge(team[(team['T_PLAYERCOUNT'] <= 18)][['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'M_ROUND', 'M_ATTENDANCE', 'T_PLAYERCOUNT', 'M_TIME']).agg('count')

match[['M_MATCHKEY', 'M_TEAM2KEY', 'M_SCORE2', 'M_TEAM1KEY', 'M_STADIUMKEY', 'M_ATTENDANCE', 'M_ROUND', 'M_DURATION', 'M_DATE']].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[['S_STADIUMKEY', 'S_NAME']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

association[(association['A_ASSOCKEY'] != 'f') & (association['A_TEAMKEY'] == 't') | (association['A_FOUNDEDYEAR'] <= 1950) | (association['A_PRESIDENT'] != 'p')][['A_ASSOCKEY', 'A_FOUNDEDYEAR', 'A_PRESIDENT', 'A_TEAMKEY']].merge(team[(team['T_TEAMKEY'] == 't')], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_TEAMKEY', 'T_TEAMKEY', 'A_ASSOCKEY', 'A_FOUNDEDYEAR', 'T_GROUP']).agg('count')

association[(association['A_FOUNDEDYEAR'] != 1914) & (association['A_FOUNDEDYEAR'] != 1966) & (association['A_ASSOCKEY'].str.startswith('f'))][['A_ASSOCKEY', 'A_TEAMKEY']].merge(team[(team['T_TEAMKEY'] == 't') | (team['T_GROUP'] == 'd') & (team['T_PLAYERCOUNT'] != 25)][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_ASSOCKEY', 'T_PLAYERCOUNT', 'A_TEAMKEY']).agg('sum', numeric_only=True)

coach[(coach['C_EXPYEARS'] == 25) | (coach['C_COACHKEY'] > 61) | (coach['C_EXPYEARS'] == 29) & (coach['C_ROLE'] == 'assistant coach') & (coach['C_ROLE'].isin(['goalkeeper coach']))][['C_EXPYEARS', 'C_NAME', 'C_TEAMKEY', 'C_ROLE']].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_GROUP', 'C_EXPYEARS']).agg('count')

coach[(coach['C_ROLE'] == 'goalkeeper coach') & (coach['C_NAME'].str.startswith('c')) & (coach['C_TEAMKEY'] == 't') | (coach['C_ROLE'] == 'assistant coach')][['C_TEAMKEY', 'C_ROLE', 'C_NAME']].merge(team[(team['T_GROUP'] == 'd') & (team['T_PLAYERCOUNT'] != 25)][['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY']).agg('count')

match.merge(stadium[['S_STADIUMKEY', 'S_CITY', 'S_CAPACITY', 'S_LOCATION']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[(team['T_PLAYERCOUNT'] > 21) | (team['T_GROUP'].isin(['f', 'c', 'e', 'g', 'b'])) & (team['T_TEAMKEY'] != 't')][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['M_MATCHKEY', 'M_TIME']).agg('mean', numeric_only=True)

match[(match['M_ATTENDANCE'] == 37450) & (match['M_DURATION'] < 137) | (match['M_TEAM2KEY'] == 't') | (match['M_MATCHKEY'] != 25) & (match['M_DURATION'] < 123)].merge(team[(team['T_TEAMKEY'] == 't') & (team['T_PLAYERCOUNT'] <= 19) & (team['T_TEAMKEY'] == 't')][['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[['S_YEARBUILT', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_STADIUMKEY'] >= 8) & (match['M_TEAM1KEY'] != 't') & (match['M_MATCHKEY'] != 45) | (match['M_TEAM1KEY'] == 't') & (match['M_TEAM2KEY'].str.startswith('t')) | (match['M_ATTENDANCE'] <= 53996)].merge(team[(team['T_TEAMKEY'].str.startswith('t'))][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_YEARBUILT'] >= 2010) | (stadium['S_CAPACITY'] == 56688) & (stadium['S_CITY'] == 'l') & (stadium['S_LOCATION'] == 's')], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_TEAM2KEY'] != 't') & (match['M_DURATION'] > 113) & (match['M_SCORE2'] > 3) | (match['M_TEAM1KEY'].str.startswith('t')) & (match['M_SCORE1'] < 2) & (match['M_DATE'] <= '2022-12-18') & (match['M_DATE'] < '2022-12-18') & (match['M_DURATION'] == 111) | (match['M_ATTENDANCE'] <= 73121)][['M_DURATION', 'M_ROUND', 'M_MATCHKEY', 'M_SCORE2', 'M_TEAM1KEY']].groupby(by=['M_SCORE2', 'M_MATCHKEY', 'M_TEAM1KEY', 'M_ROUND', 'M_DURATION']).agg('min', numeric_only=True)

match[(match['M_TIME'].str.startswith('1')) | (match['M_TEAM2KEY'] == 't') & (match['M_SCORE2'] >= 1) | (match['M_STADIUMKEY'] >= 8) | (match['M_ROUND'] == 'quarter-final') | (match['M_DATE'] == '2022-11-20') & (match['M_SCORE2'] != 3)].merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_CITY'] != 'a') & (stadium['S_LOCATION'] != 'e')][['S_CITY', 'S_NAME', 'S_CAPACITY', 'S_STADIUMKEY', 'S_LOCATION']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

association[(association['A_FOUNDEDYEAR'] >= 1926) & (association['A_ASSOCKEY'].str.startswith('f')) & (association['A_FOUNDEDYEAR'] < 1912) | (association['A_TEAMKEY'].str.startswith('t'))][['A_FOUNDEDYEAR', 'A_ASSOCKEY', 'A_PRESIDENT', 'A_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] == 25) & (team['T_GROUP'] != 'b') & (team['T_GROUP'] != 'c')], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_FOUNDEDYEAR', 'T_GROUP', 'A_ASSOCKEY', 'T_TEAMKEY']).agg('mean', numeric_only=True)

match.merge(team[(team['T_PLAYERCOUNT'] <= 22)][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_CITY'] != 'd') & (stadium['S_YEARBUILT'] < 1991) | (stadium['S_LOCATION'].str.startswith('w')) & (stadium['S_YEARBUILT'] < 1986) & (stadium['S_YEARBUILT'] != 1973) | (stadium['S_LOCATION'] == 'n')][['S_YEARBUILT', 'S_LOCATION', 'S_CAPACITY', 'S_NAME', 'S_CITY', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match.merge(team[(team['T_PLAYERCOUNT'] >= 22) | (team['T_GROUP'] != 'g')][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_NAME'].str.startswith('s')) & (stadium['S_STADIUMKEY'] <= 1) | (stadium['S_STADIUMKEY'] > 8) | (stadium['S_LOCATION'] != 'w') | (stadium['S_STADIUMKEY'] >= 2) & (stadium['S_CAPACITY'] < 75034)][['S_YEARBUILT', 'S_CAPACITY', 'S_CITY', 'S_STADIUMKEY', 'S_LOCATION']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match.merge(team[(team['T_TEAMKEY'] == 't') & (team['T_GROUP'] != 'e')], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_STADIUMKEY'] < 7) & (stadium['S_NAME'] == 's') | (stadium['S_LOCATION'] != 'n') | (stadium['S_CAPACITY'] >= 82826)][['S_YEARBUILT', 'S_CITY', 'S_NAME', 'S_LOCATION', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_CITY', 'M_TEAM2KEY']).agg('max', numeric_only=True)

match.merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_LOCATION'].str.startswith('c')) | (stadium['S_NAME'] == 's') | (stadium['S_YEARBUILT'] < 2014)][['S_YEARBUILT', 'S_LOCATION', 'S_CAPACITY', 'S_NAME', 'S_CITY', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_ROUND', 'S_YEARBUILT']).agg('count')

match[(match['M_STADIUMKEY'] > 11) | (match['M_TEAM1KEY'] != 't') & (match['M_DATE'] >= '2022-12-18') | (match['M_TEAM1KEY'].str.startswith('t')) | (match['M_DATE'] == '2022-11-20') & (match['M_ROUND'] != 'final') & (match['M_SCORE1'] >= 2) & (match['M_SCORE1'] < 2) & (match['M_SCORE1'] <= 5) & (match['M_DATE'] >= '2022-12-18')].merge(team[(team['T_GROUP'] == 'c')][['T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_YEARBUILT'] <= 1998)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

coach[(coach['C_EXPYEARS'] == 2) & (coach['C_NAME'] != 'c') & (coach['C_TEAMKEY'].str.startswith('t')) & (coach['C_TEAMKEY'] != 't') & (coach['C_EXPYEARS'] >= 9)][['C_ROLE', 'C_EXPYEARS', 'C_COACHKEY', 'C_TEAMKEY']].merge(team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'C_COACHKEY', 'C_ROLE', 'C_TEAMKEY']).agg('max', numeric_only=True)

coach[(coach['C_EXPYEARS'] == 25) | (coach['C_COACHKEY'] > 24)][['C_COACHKEY', 'C_TEAMKEY', 'C_ROLE']].merge(team[(team['T_GROUP'] == 'd') & (team['T_PLAYERCOUNT'] >= 24) | (team['T_PLAYERCOUNT'] <= 23)][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY', 'C_COACHKEY']).agg('sum', numeric_only=True)

coach[(coach['C_ROLE'] == 'goalkeeper coach') | (coach['C_TEAMKEY'].str.startswith('t')) | (coach['C_EXPYEARS'] != 38)][['C_ROLE', 'C_EXPYEARS', 'C_TEAMKEY', 'C_COACHKEY']].merge(team[(team['T_TEAMKEY'] == 't') & (team['T_PLAYERCOUNT'] == 21)][['T_TEAMKEY', 'T_GROUP']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'C_TEAMKEY', 'T_GROUP', 'C_COACHKEY']).agg('count')

match[(match['M_MATCHKEY'] <= 28) | (match['M_DATE'] != '2022-12-18') | (match['M_MATCHKEY'] >= 3) & (match['M_STADIUMKEY'] >= 11) | (match['M_ATTENDANCE'] > 56884) & (match['M_SCORE1'] > 3) & (match['M_SCORE1'] > 1) | (match['M_MATCHKEY'] <= 21) & (match['M_SCORE1'] >= 0)].merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_YEARBUILT'] <= 1956) | (stadium['S_STADIUMKEY'] != 5)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_CAPACITY', 'M_MATCHKEY', 'S_STADIUMKEY']).agg('min', numeric_only=True)

match[(match['M_MATCHKEY'] == 28) & (match['M_TEAM1KEY'] != 't') & (match['M_ROUND'].isin(['group stage', 'quarter-final', 'round of 16', 'final'])) | (match['M_TEAM2KEY'] != 't') & (match['M_TEAM2KEY'] != 't') | (match['M_ATTENDANCE'] == 81196) & (match['M_DURATION'] == 135) | (match['M_DATE'] < '2022-11-20') | (match['M_DURATION'] >= 101) & (match['M_ATTENDANCE'] >= 62909)].merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[(team['T_PLAYERCOUNT'] != 19) | (team['T_TEAMKEY'] == 't') & (team['T_TEAMKEY'] == 't')][['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[(match['M_TIME'] != '2') | (match['M_SCORE1'] <= 6) & (match['M_SCORE1'] < 6) | (match['M_MATCHKEY'] != 12) & (match['M_ROUND'].isin(['final', 'round of 16'])) & (match['M_TIME'] != '2')].merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['M_SCORE2', 'M_ATTENDANCE', 'M_TIME', 'M_ROUND', 'S_CAPACITY']).agg('count')

match[(match['M_TIME'] == '2') | (match['M_MATCHKEY'] <= 5) & (match['M_TEAM1KEY'] != 't') | (match['M_TEAM1KEY'].str.startswith('t')) & (match['M_ATTENDANCE'] == 59594)][['M_ROUND', 'M_DATE', 'M_MATCHKEY', 'M_STADIUMKEY', 'M_SCORE2', 'M_DURATION', 'M_ATTENDANCE', 'M_SCORE1', 'M_TEAM2KEY']].merge(stadium[(stadium['S_LOCATION'] != 'n')], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[['M_DATE', 'M_TIME', 'M_TEAM2KEY', 'M_ATTENDANCE', 'M_DURATION', 'M_ROUND', 'M_MATCHKEY', 'M_STADIUMKEY', 'M_SCORE2', 'M_SCORE1']].merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_STADIUMKEY'] > 7) & (stadium['S_STADIUMKEY'] < 4) | (stadium['S_LOCATION'].str.startswith('c'))], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['T_PLAYERCOUNT']).agg('sum', numeric_only=True)

match[['M_STADIUMKEY', 'M_TEAM1KEY', 'M_TIME', 'M_ROUND', 'M_SCORE1', 'M_DURATION', 'M_SCORE2', 'M_DATE', 'M_MATCHKEY']].merge(team[['T_GROUP', 'T_TEAMKEY']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_SCORE2', 'S_YEARBUILT', 'S_CITY']).agg('sum', numeric_only=True)

match[(match['M_MATCHKEY'] < 21) | (match['M_SCORE2'] < 1) & (match['M_DATE'] == '2022-11-20') | (match['M_SCORE1'] >= 5) & (match['M_SCORE1'] < 5) | (match['M_MATCHKEY'] <= 7) | (match['M_TEAM2KEY'].str.startswith('t')) & (match['M_DURATION'] != 132)].merge(team[['T_PLAYERCOUNT', 'T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[['S_LOCATION', 'S_CITY', 'S_CAPACITY', 'S_YEARBUILT', 'S_STADIUMKEY', 'S_NAME']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_ROUND'] == 'quarter-final')][['M_DURATION', 'M_TIME', 'M_ROUND', 'M_SCORE1', 'M_MATCHKEY', 'M_STADIUMKEY', 'M_SCORE2', 'M_TEAM2KEY', 'M_TEAM1KEY']].merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[(team['T_TEAMKEY'].str.startswith('t')) | (team['T_GROUP'].isin(['h', 'g', 'c', 'b', 'd'])) & (team['T_GROUP'] == 'h')][['T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[(match['M_SCORE1'] == 4) | (match['M_TEAM1KEY'].str.startswith('t')) | (match['M_DURATION'] <= 91) | (match['M_TEAM1KEY'].str.startswith('t')) & (match['M_SCORE1'] != 1) & (match['M_TEAM1KEY'] != 't')].merge(team[(team['T_GROUP'].isin(['h', 'e', 'd', 'c', 'f', 'a', 'g', 'b']))], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[['S_CAPACITY', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_TIME', 'M_TEAM1KEY', 'T_GROUP', 'M_ROUND', 'M_STADIUMKEY']).agg('sum', numeric_only=True)

match[(match['M_SCORE2'] > 5) | (match['M_TEAM2KEY'].str.startswith('t'))].merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_CITY'].str.startswith('a')) & (stadium['S_NAME'].str.startswith('s'))][['S_YEARBUILT', 'S_CAPACITY', 'S_NAME', 'S_CITY', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_NAME', 'M_TEAM2KEY', 'M_ROUND', 'M_SCORE2', 'T_TEAMKEY']).agg('mean', numeric_only=True)

match[(match['M_SCORE2'] > 6) | (match['M_ATTENDANCE'] != 38605) | (match['M_MATCHKEY'] < 12) | (match['M_ATTENDANCE'] >= 31681) | (match['M_STADIUMKEY'] < 3) & (match['M_SCORE1'] == 2) | (match['M_ATTENDANCE'] == 70108) | (match['M_STADIUMKEY'] <= 2) & (match['M_TIME'] == '2')][['M_TEAM1KEY', 'M_TEAM2KEY', 'M_TIME', 'M_ATTENDANCE', 'M_DURATION', 'M_ROUND', 'M_SCORE2', 'M_SCORE1']].merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['M_SCORE2']).agg('min', numeric_only=True)

match[(match['M_STADIUMKEY'] == 8) & (match['M_SCORE1'] <= 3) & (match['M_DURATION'] < 134) | (match['M_STADIUMKEY'] == 3)].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_NAME'].str.startswith('s')) & (stadium['S_STADIUMKEY'] < 1) | (stadium['S_CAPACITY'] != 72843) | (stadium['S_YEARBUILT'] == 2005)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_NAME', 'M_ROUND', 'M_SCORE1', 'M_TEAM2KEY']).agg('count')

match[['M_SCORE1', 'M_ATTENDANCE', 'M_DURATION', 'M_STADIUMKEY', 'M_TEAM2KEY', 'M_TIME', 'M_DATE', 'M_MATCHKEY', 'M_ROUND']].merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_YEARBUILT'] == 1962) & (stadium['S_NAME'] == 's') | (stadium['S_STADIUMKEY'] < 2) | (stadium['S_YEARBUILT'] > 2010) | (stadium['S_STADIUMKEY'] < 7)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_STADIUMKEY']).agg('max', numeric_only=True)

association[(association['A_PRESIDENT'] != 'p') & (association['A_FOUNDEDYEAR'] <= 1919) & (association['A_PRESIDENT'] == 'p')][['A_TEAMKEY', 'A_ASSOCKEY', 'A_PRESIDENT', 'A_FOUNDEDYEAR']].merge(team[(team['T_PLAYERCOUNT'] >= 21) | (team['T_TEAMKEY'] == 't') | (team['T_PLAYERCOUNT'] > 22)][['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='A_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['A_ASSOCKEY', 'T_GROUP', 'A_FOUNDEDYEAR', 'T_PLAYERCOUNT']).agg('min', numeric_only=True)

coach[(coach['C_COACHKEY'] < 96) | (coach['C_EXPYEARS'] >= 2) | (coach['C_NAME'] != 'c')][['C_EXPYEARS', 'C_COACHKEY', 'C_NAME', 'C_ROLE', 'C_TEAMKEY']].merge(team[(team['T_TEAMKEY'] != 't')][['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'C_TEAMKEY', 'C_EXPYEARS', 'T_PLAYERCOUNT', 'C_COACHKEY']).agg('count')

coach[(coach['C_COACHKEY'] > 31) | (coach['C_ROLE'].isin(['goalkeeper coach', 'head coach', 'assistant coach', 'fitness coach']))][['C_COACHKEY', 'C_TEAMKEY', 'C_ROLE', 'C_EXPYEARS', 'C_NAME']].merge(team[(team['T_PLAYERCOUNT'] >= 24) & (team['T_TEAMKEY'] == 't')][['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_COACHKEY', 'C_ROLE', 'C_NAME', 'T_TEAMKEY', 'C_TEAMKEY']).agg('count')

coach[(coach['C_NAME'] != 'c') & (coach['C_ROLE'].isin(['assistant coach']))][['C_TEAMKEY', 'C_EXPYEARS', 'C_ROLE', 'C_COACHKEY', 'C_NAME']].merge(team[(team['T_GROUP'].isin(['c', 'g', 'a', 'b', 'h'])) & (team['T_TEAMKEY'] != 't') | (team['T_TEAMKEY'].str.startswith('t'))][['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_NAME', 'T_GROUP', 'T_PLAYERCOUNT', 'C_ROLE']).agg('mean', numeric_only=True)

coach[(coach['C_NAME'].str.startswith('c')) | (coach['C_EXPYEARS'] <= 32) & (coach['C_NAME'] != 'c') & (coach['C_TEAMKEY'].str.startswith('t')) & (coach['C_EXPYEARS'] >= 32)][['C_EXPYEARS', 'C_COACHKEY', 'C_NAME', 'C_TEAMKEY']].merge(team[(team['T_PLAYERCOUNT'] <= 18) & (team['T_PLAYERCOUNT'] == 22) & (team['T_GROUP'] != 'e')][['T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_NAME', 'T_GROUP', 'C_TEAMKEY']).agg('min', numeric_only=True)

coach[(coach['C_NAME'].str.startswith('c')) | (coach['C_ROLE'].isin(['fitness coach', 'goalkeeper coach', 'assistant coach'])) & (coach['C_NAME'] == 'c') & (coach['C_TEAMKEY'] != 't')][['C_TEAMKEY', 'C_COACHKEY', 'C_NAME', 'C_ROLE']].merge(team[(team['T_PLAYERCOUNT'] == 20) | (team['T_PLAYERCOUNT'] < 18)][['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']], left_on='C_TEAMKEY', right_on='T_TEAMKEY').groupby(by=['C_COACHKEY', 'T_PLAYERCOUNT', 'C_ROLE', 'T_TEAMKEY']).agg('mean', numeric_only=True)

match[(match['M_DATE'] >= '2022-11-20') | (match['M_ROUND'].isin(['semi-final', 'round of 16', 'quarter-final', 'group stage', 'final'])) & (match['M_STADIUMKEY'] >= 6) | (match['M_SCORE1'] == 3) & (match['M_DATE'] > '2022-11-20') | (match['M_ATTENDANCE'] >= 55196) & (match['M_SCORE1'] != 6) | (match['M_SCORE1'] < 1) & (match['M_SCORE2'] != 0)].merge(stadium[(stadium['S_STADIUMKEY'] >= 5) | (stadium['S_LOCATION'] == 'w')][['S_YEARBUILT', 'S_NAME', 'S_STADIUMKEY', 'S_LOCATION']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_STADIUMKEY', 'S_YEARBUILT', 'M_DATE', 'M_TEAM1KEY']).agg('min', numeric_only=True)

match[(match['M_MATCHKEY'] <= 38) & (match['M_MATCHKEY'] == 8) | (match['M_SCORE1'] <= 0) & (match['M_MATCHKEY'] == 11) | (match['M_ATTENDANCE'] <= 68698) | (match['M_MATCHKEY'] <= 48) | (match['M_MATCHKEY'] == 41) & (match['M_TEAM1KEY'] != 't') | (match['M_ATTENDANCE'] <= 88047)][['M_DATE', 'M_TEAM1KEY', 'M_TEAM2KEY', 'M_TIME', 'M_ATTENDANCE', 'M_DURATION', 'M_ROUND', 'M_MATCHKEY', 'M_SCORE2']].merge(team[['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[(match['M_ROUND'] != 'group stage') | (match['M_MATCHKEY'] != 59) & (match['M_TEAM2KEY'].str.startswith('t')) | (match['M_SCORE2'] == 2) | (match['M_SCORE1'] >= 4) & (match['M_MATCHKEY'] >= 17) | (match['M_STADIUMKEY'] >= 11) | (match['M_ROUND'] == 'semi-final') | (match['M_ROUND'].isin(['round of 16', 'group stage'])) | (match['M_STADIUMKEY'] == 1)][['M_DURATION', 'M_DATE', 'M_SCORE2', 'M_TEAM1KEY', 'M_TIME', 'M_ATTENDANCE', 'M_ROUND']].merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['M_ROUND', 'T_PLAYERCOUNT']).agg('max', numeric_only=True)

match[(match['M_SCORE1'] == 2) & (match['M_SCORE2'] == 5) & (match['M_SCORE1'] != 5) | (match['M_ATTENDANCE'] <= 86774) | (match['M_SCORE1'] < 1) | (match['M_DURATION'] > 143) | (match['M_TEAM2KEY'] != 't') & (match['M_TIME'].str.startswith('1')) | (match['M_ROUND'] == 'quarter-final')][['M_STADIUMKEY', 'M_DATE', 'M_TEAM1KEY', 'M_SCORE1']].merge(stadium[['S_CAPACITY', 'S_LOCATION', 'S_CITY', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY')

match[(match['M_STADIUMKEY'] == 8) & (match['M_TEAM2KEY'] != 't') & (match['M_ROUND'] != 'final') & (match['M_DATE'] > '2022-11-20') | (match['M_TEAM2KEY'] == 't')][['M_SCORE2', 'M_ATTENDANCE', 'M_TEAM1KEY', 'M_SCORE1', 'M_TIME', 'M_STADIUMKEY']].merge(team[(team['T_PLAYERCOUNT'] < 21)], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_LOCATION'].str.startswith('w')) & (stadium['S_CAPACITY'] != 49889) | (stadium['S_NAME'] == 's') & (stadium['S_CITY'] == 'a')], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_TEAM1KEY'].str.startswith('t')) | (match['M_DURATION'] != 124) & (match['M_TEAM1KEY'] != 't') & (match['M_MATCHKEY'] > 16) | (match['M_MATCHKEY'] != 27) | (match['M_TEAM2KEY'] != 't') | (match['M_TEAM2KEY'].str.startswith('t'))][['M_SCORE1', 'M_STADIUMKEY']].merge(stadium[(stadium['S_CAPACITY'] < 52207) | (stadium['S_NAME'] == 's')][['S_CAPACITY', 'S_LOCATION', 'S_NAME', 'S_CITY', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_CAPACITY']).agg('count')

match[['M_DATE', 'M_TEAM1KEY', 'M_TEAM2KEY', 'M_ATTENDANCE', 'M_DURATION', 'M_ROUND', 'M_MATCHKEY', 'M_STADIUMKEY', 'M_SCORE2', 'M_SCORE1']].merge(stadium[(stadium['S_CAPACITY'] < 82076) | (stadium['S_YEARBUILT'] < 1952) | (stadium['S_CITY'] == 'a')], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[(team['T_PLAYERCOUNT'] > 21)], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['M_STADIUMKEY']).agg('sum', numeric_only=True)

match[(match['M_ATTENDANCE'] == 54021) | (match['M_ROUND'] == 'group stage') & (match['M_SCORE1'] > 3) | (match['M_ATTENDANCE'] == 34650) & (match['M_ATTENDANCE'] > 73338) & (match['M_MATCHKEY'] <= 17)].merge(team[(team['T_TEAMKEY'].str.startswith('t')) | (team['T_GROUP'].isin(['b'])) & (team['T_TEAMKEY'] != 't')], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[['S_YEARBUILT', 'S_NAME', 'S_CITY', 'S_CAPACITY', 'S_STADIUMKEY', 'S_LOCATION']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_TEAM2KEY']).agg('count')

match[(match['M_TEAM1KEY'].str.startswith('t')) | (match['M_SCORE2'] != 0) & (match['M_TIME'] == '2') | (match['M_SCORE2'] < 2) | (match['M_ROUND'].isin(['group stage', 'final', 'quarter-final', 'semi-final', 'round of 16'])) | (match['M_ATTENDANCE'] != 34372) & (match['M_SCORE1'] <= 4) & (match['M_SCORE2'] >= 5) & (match['M_MATCHKEY'] == 19)].merge(team[(team['T_TEAMKEY'] != 't')][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_LOCATION'] == 'e') & (stadium['S_STADIUMKEY'] <= 10) & (stadium['S_CAPACITY'] >= 64950) | (stadium['S_CITY'] == 'd') | (stadium['S_CAPACITY'] > 43988) & (stadium['S_NAME'].str.startswith('s'))], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_TIME'] != '2')].merge(team[(team['T_PLAYERCOUNT'] != 19)], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_CITY'] == 'l') | (stadium['S_LOCATION'] != 'w') | (stadium['S_NAME'].str.startswith('s')) | (stadium['S_STADIUMKEY'] < 2) & (stadium['S_YEARBUILT'] != 2012) & (stadium['S_CITY'] == 'r')][['S_LOCATION', 'S_STADIUMKEY', 'S_NAME', 'S_CAPACITY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_TEAM2KEY', 'M_SCORE1', 'M_DATE']).agg('sum', numeric_only=True)

match[(match['M_TIME'].str.startswith('2')) | (match['M_TEAM1KEY'] == 't') | (match['M_TEAM1KEY'].str.startswith('t')) | (match['M_ATTENDANCE'] < 34097) | (match['M_TEAM1KEY'] == 't') & (match['M_MATCHKEY'] == 3) | (match['M_TEAM1KEY'] != 't') | (match['M_MATCHKEY'] == 59) | (match['M_TIME'] == '1') | (match['M_DURATION'] != 126)][['M_ATTENDANCE', 'M_TEAM1KEY', 'M_SCORE2', 'M_STADIUMKEY', 'M_TIME']].merge(team[['T_GROUP', 'T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_MATCHKEY'] == 26) | (match['M_TEAM1KEY'] != 't') | (match['M_ATTENDANCE'] >= 85920) | (match['M_ATTENDANCE'] < 43723) | (match['M_TIME'] != '2') | (match['M_TEAM2KEY'] == 't') | (match['M_STADIUMKEY'] >= 3) & (match['M_SCORE1'] > 4) | (match['M_SCORE2'] != 2)].merge(team[(team['T_GROUP'] != 'e')][['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[['S_NAME', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_MATCHKEY']).agg('min', numeric_only=True)

match[(match['M_SCORE1'] <= 3)][['M_STADIUMKEY', 'M_SCORE2', 'M_DURATION', 'M_TEAM1KEY', 'M_ROUND']].merge(stadium[(stadium['S_LOCATION'] != 's')], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[(team['T_GROUP'].isin(['c', 'h', 'd', 'f', 'a', 'g', 'e'])) | (team['T_PLAYERCOUNT'] != 22) & (team['T_TEAMKEY'].str.startswith('t'))], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['M_DURATION', 'T_GROUP', 'S_CITY', 'S_YEARBUILT', 'S_LOCATION']).agg('min', numeric_only=True)

match[(match['M_STADIUMKEY'] > 2) | (match['M_TIME'] == '1') & (match['M_SCORE1'] == 1) | (match['M_MATCHKEY'] >= 18)][['M_ATTENDANCE', 'M_DURATION', 'M_DATE', 'M_STADIUMKEY', 'M_SCORE2', 'M_SCORE1']].merge(stadium[['S_CITY', 'S_CAPACITY', 'S_LOCATION', 'S_NAME', 'S_YEARBUILT', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_SCORE1', 'S_CAPACITY', 'M_STADIUMKEY', 'M_DATE']).agg('sum', numeric_only=True)

match[(match['M_TEAM2KEY'] != 't')][['M_ROUND', 'M_DURATION', 'M_SCORE2', 'M_DATE', 'M_ATTENDANCE', 'M_TEAM2KEY', 'M_SCORE1', 'M_STADIUMKEY']].merge(stadium[(stadium['S_CITY'] == 'a') | (stadium['S_CAPACITY'] < 57250) | (stadium['S_CAPACITY'] != 89355) | (stadium['S_CAPACITY'] == 65558)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['T_TEAMKEY', 'T_GROUP', 'M_STADIUMKEY']).agg('count')

match[(match['M_TIME'] == '2') | (match['M_ATTENDANCE'] > 88587) & (match['M_STADIUMKEY'] <= 8) | (match['M_SCORE1'] < 3)].merge(team[(team['T_GROUP'].isin(['f', 'a', 'd', 'e', 'h', 'g', 'b'])) | (team['T_PLAYERCOUNT'] == 18) | (team['T_GROUP'] != 'c')], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_NAME'].str.startswith('s')) & (stadium['S_CAPACITY'] < 45897) & (stadium['S_STADIUMKEY'] > 3) & (stadium['S_NAME'].str.startswith('s')) | (stadium['S_NAME'].str.startswith('s')) | (stadium['S_YEARBUILT'] <= 2001)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_STADIUMKEY', 'M_SCORE1', 'S_LOCATION', 'T_PLAYERCOUNT']).agg('count')

match[['M_DATE', 'M_TIME', 'M_SCORE1', 'M_ATTENDANCE', 'M_MATCHKEY', 'M_TEAM1KEY', 'M_TEAM2KEY', 'M_SCORE2', 'M_STADIUMKEY', 'M_ROUND']].merge(team[['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[['S_YEARBUILT', 'S_CAPACITY', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['T_TEAMKEY', 'S_CAPACITY']).agg('mean', numeric_only=True)

match[['M_ROUND', 'M_DURATION', 'M_MATCHKEY', 'M_SCORE2', 'M_DATE', 'M_TEAM1KEY', 'M_TEAM2KEY', 'M_SCORE1', 'M_TIME', 'M_STADIUMKEY']].merge(stadium[(stadium['S_NAME'] == 's') & (stadium['S_NAME'] == 's') & (stadium['S_NAME'] == 's') & (stadium['S_YEARBUILT'] < 1978) | (stadium['S_CAPACITY'] >= 46771) | (stadium['S_NAME'] != 's')][['S_YEARBUILT', 'S_CITY', 'S_CAPACITY', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY')

match[['M_TEAM1KEY', 'M_TIME', 'M_TEAM2KEY', 'M_ATTENDANCE', 'M_ROUND', 'M_MATCHKEY', 'M_STADIUMKEY', 'M_SCORE2', 'M_SCORE1']].merge(team[(team['T_TEAMKEY'] == 't') & (team['T_PLAYERCOUNT'] > 19)][['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_TEAM1KEY', 'T_TEAMKEY', 'S_CITY']).agg('sum', numeric_only=True)

match[(match['M_ATTENDANCE'] < 52249) & (match['M_SCORE2'] >= 0) & (match['M_MATCHKEY'] <= 32) | (match['M_ATTENDANCE'] != 73834) | (match['M_MATCHKEY'] > 51) & (match['M_STADIUMKEY'] <= 4) & (match['M_TIME'] == '1') | (match['M_ATTENDANCE'] == 34217) & (match['M_DURATION'] == 110) | (match['M_ROUND'] != 'final')].merge(team[(team['T_PLAYERCOUNT'] == 22) & (team['T_GROUP'].isin(['c', 'h', 'a', 'e', 'b', 'g', 'f'])) & (team['T_PLAYERCOUNT'] == 21)][['T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_LOCATION'].str.startswith('w')) & (stadium['S_YEARBUILT'] > 1995) | (stadium['S_NAME'].str.startswith('s')) | (stadium['S_STADIUMKEY'] > 2) | (stadium['S_LOCATION'] != 's')], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_MATCHKEY'] < 25) & (match['M_SCORE1'] <= 5) & (match['M_TEAM2KEY'] == 't') & (match['M_TEAM1KEY'] != 't') | (match['M_MATCHKEY'] >= 31) & (match['M_TEAM1KEY'].str.startswith('t')) | (match['M_TIME'] != '2') & (match['M_DURATION'] == 101)].merge(team[(team['T_GROUP'] != 'h')], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_CAPACITY'] == 59700) & (stadium['S_CITY'] == 'a') | (stadium['S_CAPACITY'] != 66266) & (stadium['S_STADIUMKEY'] >= 4) & (stadium['S_STADIUMKEY'] > 4)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_ROUND', 'S_CAPACITY', 'M_STADIUMKEY', 'M_SCORE2']).agg('count')

match.merge(team[(team['T_GROUP'].isin(['h', 'd', 'a', 'g', 'f', 'e'])) & (team['T_GROUP'] == 'c') | (team['T_TEAMKEY'] != 't')][['T_GROUP', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_CITY'] != 'r') | (stadium['S_CAPACITY'] >= 77104) & (stadium['S_CITY'].str.startswith('l')) & (stadium['S_YEARBUILT'] > 2008)][['S_CAPACITY', 'S_YEARBUILT', 'S_LOCATION', 'S_CITY', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_TEAM1KEY', 'S_CAPACITY', 'T_GROUP', 'S_STADIUMKEY', 'M_ROUND']).agg('max', numeric_only=True)

match[(match['M_TEAM2KEY'] != 't') & (match['M_TIME'] != '2') | (match['M_TEAM2KEY'] == 't') & (match['M_SCORE1'] <= 4) & (match['M_STADIUMKEY'] == 11) | (match['M_SCORE1'] > 2) | (match['M_SCORE2'] != 0) & (match['M_MATCHKEY'] >= 14)].merge(team[(team['T_GROUP'].isin(['e', 'g', 'd', 'b', 'f', 'h', 'c']))], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_NAME'] != 's') & (stadium['S_CITY'] != 'a') | (stadium['S_CAPACITY'] > 80908) & (stadium['S_CAPACITY'] < 43003) & (stadium['S_NAME'] != 's') | (stadium['S_LOCATION'].str.startswith('e'))][['S_CAPACITY', 'S_NAME', 'S_STADIUMKEY', 'S_CITY', 'S_LOCATION', 'S_YEARBUILT']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_TIME'] == '1') & (match['M_SCORE1'] == 4) | (match['M_ATTENDANCE'] >= 75344) & (match['M_MATCHKEY'] <= 41) | (match['M_TIME'] == '1') | (match['M_SCORE1'] > 2) | (match['M_MATCHKEY'] == 26) | (match['M_DURATION'] <= 132)].merge(team[(team['T_TEAMKEY'] == 't')], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_LOCATION'] != 'e') | (stadium['S_CAPACITY'] <= 47551)][['S_NAME', 'S_CITY', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_DURATION', 'M_ROUND', 'T_TEAMKEY', 'M_SCORE2']).agg('count')

match[['M_DATE', 'M_TIME', 'M_TEAM1KEY', 'M_ATTENDANCE', 'M_ROUND', 'M_MATCHKEY', 'M_STADIUMKEY', 'M_SCORE2']].merge(stadium[['S_CITY', 'S_NAME', 'S_YEARBUILT', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[(team['T_PLAYERCOUNT'] > 23)][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['M_ATTENDANCE', 'M_STADIUMKEY', 'M_MATCHKEY']).agg('max', numeric_only=True)

match[(match['M_ATTENDANCE'] >= 59030) & (match['M_SCORE2'] != 5) & (match['M_ROUND'].isin(['quarter-final', 'final', 'semi-final', 'group stage'])) | (match['M_DURATION'] != 143) & (match['M_SCORE1'] == 5)][['M_TEAM2KEY', 'M_SCORE2', 'M_STADIUMKEY', 'M_SCORE1', 'M_ATTENDANCE', 'M_ROUND', 'M_DATE', 'M_DURATION', 'M_TIME']].merge(stadium[(stadium['S_STADIUMKEY'] > 10) & (stadium['S_CAPACITY'] != 87537)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team, left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['M_SCORE2', 'M_ROUND', 'M_ATTENDANCE']).agg('min', numeric_only=True)

match[(match['M_STADIUMKEY'] == 7) & (match['M_STADIUMKEY'] != 2) & (match['M_SCORE1'] <= 6) | (match['M_DURATION'] == 93) | (match['M_ROUND'] != 'final') | (match['M_TEAM1KEY'] == 't') | (match['M_STADIUMKEY'] > 7) | (match['M_DURATION'] != 136) | (match['M_TEAM1KEY'].str.startswith('t'))].merge(team[(team['T_GROUP'] != 'c') & (team['T_PLAYERCOUNT'] < 18)][['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[['S_STADIUMKEY', 'S_NAME', 'S_YEARBUILT', 'S_LOCATION']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_SCORE2']).agg('mean', numeric_only=True)

match[(match['M_ATTENDANCE'] < 37694) | (match['M_TEAM1KEY'].str.startswith('t')) | (match['M_ROUND'] == 'round of 16') | (match['M_TEAM1KEY'] == 't') | (match['M_TEAM2KEY'].str.startswith('t')) & (match['M_SCORE2'] > 1) & (match['M_MATCHKEY'] >= 1)][['M_MATCHKEY', 'M_TEAM2KEY', 'M_SCORE2', 'M_TEAM1KEY', 'M_STADIUMKEY', 'M_SCORE1', 'M_ATTENDANCE', 'M_ROUND', 'M_TIME']].merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[['T_TEAMKEY', 'T_GROUP']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['M_TEAM2KEY', 'S_STADIUMKEY']).agg('sum', numeric_only=True)

match[(match['M_STADIUMKEY'] > 4) & (match['M_SCORE1'] == 5) | (match['M_TEAM2KEY'] != 't') | (match['M_DATE'] != '2022-11-20')][['M_DATE', 'M_TIME', 'M_SCORE1', 'M_ATTENDANCE', 'M_DURATION', 'M_MATCHKEY', 'M_TEAM1KEY', 'M_TEAM2KEY', 'M_SCORE2', 'M_STADIUMKEY']].merge(team[(team['T_PLAYERCOUNT'] < 20) & (team['T_TEAMKEY'] == 't') & (team['T_TEAMKEY'] != 't')], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_YEARBUILT'] == 1989) | (stadium['S_YEARBUILT'] != 1997) & (stadium['S_CAPACITY'] <= 83270) | (stadium['S_STADIUMKEY'] <= 4) | (stadium['S_YEARBUILT'] != 2011)], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_ATTENDANCE'] < 80893) & (match['M_SCORE2'] < 5) & (match['M_SCORE1'] < 3) | (match['M_SCORE2'] >= 0) | (match['M_SCORE2'] < 3) & (match['M_TEAM2KEY'] != 't') | (match['M_DURATION'] < 140) & (match['M_DATE'] <= '2022-12-18') & (match['M_DURATION'] != 148)][['M_DURATION', 'M_TIME', 'M_SCORE1', 'M_ROUND', 'M_MATCHKEY', 'M_STADIUMKEY', 'M_SCORE2', 'M_TEAM2KEY']].merge(team[['T_GROUP', 'T_PLAYERCOUNT', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_CITY'] == 'a') & (stadium['S_CITY'] == 'd') | (stadium['S_NAME'] == 's')], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_ATTENDANCE'] >= 64360) & (match['M_SCORE1'] == 6) & (match['M_TEAM2KEY'] != 't') | (match['M_STADIUMKEY'] < 1) & (match['M_ROUND'].isin(['group stage', 'quarter-final'])) & (match['M_TEAM1KEY'].str.startswith('t')) | (match['M_DATE'] < '2022-11-20') & (match['M_TIME'] != '2') | (match['M_MATCHKEY'] > 55) & (match['M_SCORE1'] != 2)][['M_STADIUMKEY', 'M_TEAM1KEY']].merge(stadium[['S_CAPACITY', 'S_LOCATION', 'S_NAME', 'S_YEARBUILT', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team, left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['S_CAPACITY', 'S_NAME', 'M_TEAM1KEY', 'T_GROUP']).agg('count')

match[(match['M_TEAM1KEY'].str.startswith('t')) & (match['M_DURATION'] < 139) & (match['M_TIME'].str.startswith('2')) | (match['M_ROUND'].isin(['final']))][['M_ROUND', 'M_DURATION', 'M_MATCHKEY', 'M_DATE', 'M_TEAM1KEY', 'M_TEAM2KEY', 'M_SCORE1', 'M_TIME', 'M_STADIUMKEY', 'M_ATTENDANCE']].merge(team[(team['T_PLAYERCOUNT'] > 19)], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[['S_STADIUMKEY', 'S_CAPACITY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['M_TEAM2KEY', 'T_GROUP', 'S_CAPACITY']).agg('mean', numeric_only=True)

match[['M_TEAM2KEY', 'M_STADIUMKEY', 'M_TEAM1KEY', 'M_TIME', 'M_ATTENDANCE', 'M_SCORE1', 'M_DURATION', 'M_SCORE2', 'M_DATE', 'M_MATCHKEY']].merge(stadium[(stadium['S_CITY'].str.startswith('a')) & (stadium['S_YEARBUILT'] >= 2015) | (stadium['S_NAME'] != 's') | (stadium['S_CAPACITY'] < 81510) & (stadium['S_NAME'] == 's') | (stadium['S_STADIUMKEY'] < 4)][['S_NAME', 'S_CAPACITY', 'S_STADIUMKEY', 'S_CITY', 'S_LOCATION', 'S_YEARBUILT']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_CITY', 'M_SCORE1', 'S_CAPACITY', 'S_STADIUMKEY']).agg('sum', numeric_only=True)

match[(match['M_ATTENDANCE'] <= 34529) | (match['M_SCORE1'] <= 0) & (match['M_SCORE2'] > 2) & (match['M_TIME'] != '1') | (match['M_DATE'] != '2022-12-18') | (match['M_MATCHKEY'] < 44) | (match['M_STADIUMKEY'] <= 9) & (match['M_SCORE2'] < 0)][['M_DATE', 'M_ATTENDANCE', 'M_DURATION', 'M_ROUND', 'M_SCORE1', 'M_MATCHKEY', 'M_STADIUMKEY', 'M_SCORE2', 'M_TEAM2KEY']].merge(stadium, left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[(team['T_GROUP'].isin(['g', 'a', 'e', 'd', 'c'])) | (team['T_GROUP'] != 'e')], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['M_DURATION', 'M_SCORE2', 'M_MATCHKEY']).agg('mean', numeric_only=True)

match[(match['M_TEAM1KEY'] != 't') & (match['M_MATCHKEY'] != 48) & (match['M_DATE'] < '2022-11-20') & (match['M_TEAM1KEY'].str.startswith('t')) & (match['M_TEAM1KEY'].str.startswith('t')) | (match['M_SCORE1'] > 4) | (match['M_MATCHKEY'] >= 33) | (match['M_DURATION'] < 131) | (match['M_SCORE2'] != 0)][['M_ATTENDANCE', 'M_STADIUMKEY', 'M_TEAM1KEY', 'M_ROUND']].merge(team[(team['T_GROUP'] == 'd')], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_LOCATION'] != 'n') & (stadium['S_CITY'] != 'a') | (stadium['S_LOCATION'] != 'e') | (stadium['S_CAPACITY'] < 87544) & (stadium['S_YEARBUILT'] == 1985) | (stadium['S_STADIUMKEY'] > 8)][['S_YEARBUILT', 'S_CAPACITY', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_TIME'] == '1') | (match['M_TEAM1KEY'].str.startswith('t')) | (match['M_MATCHKEY'] > 30) | (match['M_TEAM2KEY'] == 't') & (match['M_TIME'] == '2') & (match['M_ROUND'] == 'quarter-final') | (match['M_ATTENDANCE'] > 32428) & (match['M_DATE'] == '2022-12-18') & (match['M_MATCHKEY'] != 7) & (match['M_MATCHKEY'] != 38)].merge(stadium[(stadium['S_STADIUMKEY'] > 9) | (stadium['S_NAME'].str.startswith('s'))], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[(team['T_TEAMKEY'] != 't') & (team['T_TEAMKEY'] == 't') | (team['T_GROUP'].isin(['h', 'e', 'd', 'g', 'f', 'c']))][['T_TEAMKEY', 'T_PLAYERCOUNT', 'T_GROUP']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['M_DURATION', 'S_CAPACITY', 'S_STADIUMKEY', 'T_PLAYERCOUNT']).agg('sum', numeric_only=True)

match[(match['M_TEAM1KEY'] != 't') | (match['M_ROUND'] == 'final') | (match['M_DURATION'] < 129) & (match['M_TEAM1KEY'] != 't') | (match['M_ROUND'].isin(['group stage', 'quarter-final', 'round of 16', 'semi-final', 'final'])) | (match['M_TIME'].str.startswith('2')) & (match['M_TEAM1KEY'] == 't') | (match['M_TEAM2KEY'].str.startswith('t')) | (match['M_ATTENDANCE'] == 65834)][['M_DATE', 'M_ATTENDANCE', 'M_DURATION', 'M_ROUND', 'M_SCORE1', 'M_MATCHKEY', 'M_STADIUMKEY', 'M_SCORE2', 'M_TEAM2KEY', 'M_TEAM1KEY']].merge(team[(team['T_PLAYERCOUNT'] < 19) | (team['T_TEAMKEY'] == 't') & (team['T_TEAMKEY'] != 't')], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_CITY'].str.startswith('r'))][['S_YEARBUILT', 'S_LOCATION', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY')

match[(match['M_DURATION'] >= 112) | (match['M_DURATION'] <= 100) | (match['M_ROUND'] == 'semi-final') & (match['M_STADIUMKEY'] <= 5) & (match['M_TEAM2KEY'].str.startswith('t')) | (match['M_TEAM2KEY'].str.startswith('t')) | (match['M_TEAM1KEY'].str.startswith('t'))][['M_DATE', 'M_TIME', 'M_TEAM2KEY', 'M_DURATION', 'M_SCORE2', 'M_STADIUMKEY', 'M_TEAM1KEY']].merge(stadium[['S_STADIUMKEY', 'S_CITY', 'S_LOCATION']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[(team['T_GROUP'] != 'a') | (team['T_GROUP'] != 'g') & (team['T_PLAYERCOUNT'] <= 23)][['T_GROUP', 'T_TEAMKEY']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['M_DATE', 'M_TEAM2KEY', 'T_TEAMKEY']).agg('sum', numeric_only=True)

match[['M_ROUND', 'M_DURATION', 'M_MATCHKEY', 'M_SCORE2', 'M_TEAM1KEY', 'M_DATE', 'M_ATTENDANCE', 'M_TEAM2KEY', 'M_SCORE1', 'M_STADIUMKEY']].merge(team[(team['T_TEAMKEY'].str.startswith('t')) | (team['T_PLAYERCOUNT'] > 18) | (team['T_TEAMKEY'].str.startswith('t'))][['T_PLAYERCOUNT', 'T_GROUP', 'T_TEAMKEY']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').merge(stadium[(stadium['S_LOCATION'].str.startswith('e')) & (stadium['S_CAPACITY'] < 62004) & (stadium['S_YEARBUILT'] >= 1981) | (stadium['S_YEARBUILT'] >= 1966) | (stadium['S_STADIUMKEY'] != 9) | (stadium['S_CAPACITY'] != 67225)][['S_STADIUMKEY', 'S_CITY', 'S_CAPACITY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').groupby(by=['S_CITY', 'M_DURATION', 'M_SCORE1', 'M_STADIUMKEY']).agg('min', numeric_only=True)

match[(match['M_TIME'] != '2') & (match['M_TIME'] == '2') & (match['M_TEAM2KEY'].str.startswith('t')) & (match['M_SCORE1'] == 6) | (match['M_TIME'] != '1') & (match['M_TIME'] != '2') & (match['M_DATE'] <= '2022-12-18')][['M_DATE', 'M_TEAM1KEY', 'M_TEAM2KEY', 'M_TIME', 'M_DURATION', 'M_ROUND', 'M_MATCHKEY', 'M_STADIUMKEY', 'M_SCORE2', 'M_SCORE1']].merge(stadium[(stadium['S_YEARBUILT'] == 1997) & (stadium['S_LOCATION'] != 's')][['S_CITY', 'S_NAME', 'S_STADIUMKEY']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[(team['T_TEAMKEY'] == 't')][['T_TEAMKEY', 'T_GROUP', 'T_PLAYERCOUNT']], left_on='M_TEAM1KEY', right_on='T_TEAMKEY').groupby(by=['T_PLAYERCOUNT', 'M_STADIUMKEY', 'M_ROUND', 'M_DATE', 'S_CITY']).agg('max', numeric_only=True)

match[(match['M_DATE'] == '2022-11-20') & (match['M_ROUND'] != 'final') & (match['M_DURATION'] <= 112) | (match['M_TIME'].str.startswith('1')) | (match['M_TIME'] != '2') & (match['M_STADIUMKEY'] > 9) | (match['M_MATCHKEY'] == 18) & (match['M_TEAM1KEY'] != 't') & (match['M_TEAM2KEY'] == 't')][['M_ROUND', 'M_TEAM1KEY', 'M_STADIUMKEY', 'M_SCORE2', 'M_TIME', 'M_ATTENDANCE', 'M_SCORE1', 'M_TEAM2KEY']].merge(stadium[(stadium['S_CAPACITY'] > 82836) | (stadium['S_CITY'].str.startswith('a')) & (stadium['S_STADIUMKEY'] <= 10)][['S_YEARBUILT', 'S_STADIUMKEY', 'S_CAPACITY', 'S_LOCATION']], left_on='M_STADIUMKEY', right_on='S_STADIUMKEY').merge(team[(team['T_PLAYERCOUNT'] > 25) | (team['T_GROUP'].isin(['d', 'a', 'f', 'c', 'g', 'e', 'h'])) & (team['T_GROUP'] == 'a')][['T_TEAMKEY', 'T_PLAYERCOUNT']], left_on='M_TEAM2KEY', right_on='T_TEAMKEY').groupby(by=['S_CAPACITY', 'S_STADIUMKEY', 'M_SCORE1', 'M_STADIUMKEY', 'S_YEARBUILT']).agg('sum', numeric_only=True)