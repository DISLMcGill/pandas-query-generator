region[['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation[(nation['N_NAME'] != 'R') | (nation['N_NAME'] == 'C') | (nation['N_COMMENT'].str.startswith('u'))].merge(supplier.merge(nation[(nation['N_REGIONKEY'] != 3)], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'].str.startswith('i')) | (nation['N_REGIONKEY'] < 0) & (nation['N_REGIONKEY'] >= 2)].merge(customer.merge(orders[(orders['TOTALPRICE'] <= 24909.705484162652)][['O_ORDERKEY', 'SHIPPRIORITY', 'ORDERDATE', 'ORDERSTATUS']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_REGIONKEY'] == 2) & (region['R_NAME'].str.startswith('AME')) | (region['R_COMMENT'] != 'u')][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation[['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('max', numeric_only=True)

supplier[(supplier['S_ADDRESS'].str.startswith('X')) & (supplier['S_SUPPKEY'] <= 132) & (supplier['S_SUPPKEY'] < 48) & (supplier['S_NATIONKEY'] < 7)].merge(partsupp[(partsupp['PS_PARTKEY'] != 22) & (partsupp['PS_PARTKEY'] != 26) & (partsupp['AVAILQTY'] > 1105) & (partsupp['PS_PARTKEY'] != 41)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_COMMENT']).agg('sum', numeric_only=True)

nation[(nation['N_NATIONKEY'] >= 20) & (nation['N_NAME'] != 'F') | (nation['N_COMMENT'] == 'h')][['N_NATIONKEY', 'N_COMMENT', 'N_NAME', 'N_REGIONKEY']].merge(region[(region['R_NAME'] != 'E')].merge(nation[(nation['N_COMMENT'].str.startswith('c')) | (nation['N_NATIONKEY'] < 22) | (nation['N_NAME'] == 'V') | (nation['N_REGIONKEY'] != 0)][['N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY']].merge(region[['R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_REGIONKEY', 'N_NAME']).agg('min', numeric_only=True)

nation.merge(supplier[(supplier['S_ACCTBAL'] < -16.50859757187959) & (supplier['S_ACCTBAL'] == 7048.823813644215) | (supplier['S_ADDRESS'] == '0') | (supplier['S_SUPPKEY'] < 61)], left_on='N_NATIONKEY', right_on='S_NATIONKEY')

orders[(orders['O_CUSTKEY'] != 8858) | (orders['O_ORDERKEY'] > 342) | (orders['TOTALPRICE'] < 348109.7256383616)][['CLERK', 'ORDERSTATUS']].merge(supplier.merge(nation[(nation['N_REGIONKEY'] != 0) | (nation['N_REGIONKEY'] <= 0) & (nation['N_COMMENT'] != 'v')][['N_REGIONKEY', 'N_NAME']].merge(region[['R_COMMENT', 'R_REGIONKEY', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_NAME', 'N_NATIONKEY', 'N_COMMENT']].merge(supplier[(supplier['S_ACCTBAL'] != 4025.0450358079197) | (supplier['S_NAME'].str.startswith('S')) & (supplier['S_COMMENT'] != 'u') | (supplier['S_NAME'] == 'S')][['S_ADDRESS', 'S_NATIONKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='S_SUPPKEY').merge(part[(part['P_NAME'] == 'h') | (part['BRAND'] == 'Brand#43') & (part['RETAILPRICE'] <= 932.183988557405)][['PT_COMMENT', 'BRAND', 'SIZE', 'CONTAINER', 'P_NAME']], left_on='O_ORDERKEY', right_on='P_PARTKEY').groupby(by=['ORDERSTATUS', 'CLERK']).agg('min', numeric_only=True)

customer[['C_PHONE', 'C_ADDRESS', 'C_COMMENT', 'C_CUSTKEY']].merge(orders[(orders['SHIPPRIORITY'] < 0) & (orders['ORDERSTATUS'].isin(['F', 'O']))][['CLERK']].merge(customer[(customer['C_PHONE'].str.startswith('1'))][['C_ACCTBAL', 'MKTSEGMENT', 'C_ADDRESS', 'C_NAME', 'C_CUSTKEY']], left_on='O_ORDERKEY', right_on='C_CUSTKEY').merge(supplier.merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='S_SUPPKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

partsupp.merge(part[(part['CONTAINER'] == 'MED')].merge(partsupp[(partsupp['PS_SUPPKEY'] > 6771) & (partsupp['PS_SUPPKEY'] <= 6494) & (partsupp['AVAILQTY'] > 8576) | (partsupp['P_COMMENT'] != 'j')][['P_COMMENT', 'PS_PARTKEY', 'PS_SUPPKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part.merge(partsupp[['SUPPLYCOST', 'PS_SUPPKEY']].merge(supplier[(supplier['S_NAME'] != 'S') & (supplier['S_NAME'].str.startswith('S')) | (supplier['S_SUPPKEY'] == 50) & (supplier['S_PHONE'] != '1')][['S_COMMENT', 'S_ACCTBAL', 'S_NATIONKEY', 'S_PHONE', 'S_NAME']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(supplier[(supplier['S_SUPPKEY'] <= 22) | (supplier['S_NATIONKEY'] <= 1)][['S_COMMENT', 'S_ADDRESS', 'S_NAME', 'S_NATIONKEY', 'S_ACCTBAL']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['PS_PARTKEY']).agg('sum', numeric_only=True)

part[(part['BRAND'] != 'Brand#15') & (part['BRAND'].isin(['Brand#42', 'Brand#31', 'Brand#53', 'Brand#13', 'Brand#45', 'Brand#52', 'Brand#11', 'Brand#25', 'Brand#34', 'Brand#23', 'Brand#12', 'Brand#51', 'Brand#32', 'Brand#54', 'Brand#22', 'Brand#14', 'Brand#24', 'Brand#15', 'Brand#43', 'Brand#41', 'Brand#33', 'Brand#35', 'Brand#44', 'Brand#55', 'Brand#21']))][['P_PARTKEY', 'BRAND', 'SIZE', 'TYPE', 'P_NAME']].merge(partsupp[(partsupp['PS_SUPPKEY'] > 3210) & (partsupp['SUPPLYCOST'] >= 215.4241348577336) | (partsupp['AVAILQTY'] == 7474) | (partsupp['SUPPLYCOST'] >= 77.02404203408088)].merge(lineitem[(lineitem['SHIPDATE'] >= '1992-04-27')].merge(partsupp[(partsupp['AVAILQTY'] == 2438) & (partsupp['PS_PARTKEY'] > 13)], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['LINESTATUS'].isin(['O'])) & (lineitem['LINENUMBER'] > 4)], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_PARTKEY'] > 6)], left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['BRAND']).agg('mean', numeric_only=True)

partsupp.merge(lineitem[(lineitem['COMMITDATE'] >= '1992-05-15') & (lineitem['SHIPDATE'] <= '1992-04-27') & (lineitem['L_SUPPKEY'] <= 3714)].merge(orders[(orders['O_ORDERKEY'] < 213) & (orders['O_CUSTKEY'] == 38754) | (orders['ORDERSTATUS'] != 'F')][['O_ORDERKEY', 'ORDERSTATUS']].merge(lineitem[['SHIPINSTRUCT']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[['PS_SUPPKEY', 'SUPPLYCOST', 'P_COMMENT', 'AVAILQTY']].merge(lineitem[(lineitem['QUANTITY'] <= 10) | (lineitem['EXTENDEDPRICE'] != 75724.72106133857)], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier[(supplier['S_PHONE'] == '28-')][['S_ADDRESS', 'S_NATIONKEY']].merge(nation[(nation['N_NATIONKEY'] != 9) | (nation['N_NAME'] != 'S')].merge(supplier[(supplier['S_COMMENT'].str.startswith('u')) & (supplier['S_SUPPKEY'] != 171) | (supplier['S_ACCTBAL'] <= -28.624469786760073)][['S_ACCTBAL', 'S_PHONE', 'S_ADDRESS']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[(lineitem['RETURNFLAG'].isin(['R', 'N'])) | (lineitem['TAX'] == 0.05117422178138315) | (lineitem['L_COMMENT'].str.startswith(' ')) & (lineitem['RETURNFLAG'].isin(['A']))][['RETURNFLAG', 'L_SUPPKEY']].merge(partsupp[(partsupp['SUPPLYCOST'] >= 172.89655385590197)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY')

nation[(nation['N_NAME'] == 'F') | (nation['N_REGIONKEY'] <= 0) & (nation['N_REGIONKEY'] == 0)][['N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY', 'N_NAME']].merge(region[(region['R_COMMENT'] == 'g') | (region['R_REGIONKEY'] != 3) & (region['R_COMMENT'] != 'h') | (region['R_COMMENT'] == 'h')][['R_REGIONKEY', 'R_COMMENT']].merge(nation[(nation['N_COMMENT'] == 'i')], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[(supplier['S_ADDRESS'].str.startswith('6')) | (supplier['S_NATIONKEY'] > 7)].merge(partsupp[['AVAILQTY', 'PS_SUPPKEY', 'PS_PARTKEY', 'SUPPLYCOST', 'P_COMMENT']].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_NATIONKEY'] > 17) | (nation['N_NATIONKEY'] != 16) & (nation['N_REGIONKEY'] >= 3)].merge(supplier[(supplier['S_COMMENT'] != 's') | (supplier['S_PHONE'].str.startswith('32-')) | (supplier['S_COMMENT'] != 's')][['S_NAME', 'S_ACCTBAL', 'S_ADDRESS', 'S_NATIONKEY', 'S_SUPPKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_NATIONKEY']).agg('sum', numeric_only=True)

customer[(customer['C_NATIONKEY'] <= 16)].merge(nation[(nation['N_REGIONKEY'] >= 3) | (nation['N_NATIONKEY'] <= 9)], left_on='C_NATIONKEY', right_on='N_NATIONKEY')

region[(region['R_REGIONKEY'] >= 3) | (region['R_NAME'] != 'A') | (region['R_NAME'].str.startswith('ASI'))][['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].merge(nation[(nation['N_NAME'] != 'E') & (nation['N_NATIONKEY'] < 3) | (nation['N_COMMENT'].str.startswith('c')) & (nation['N_NATIONKEY'] >= 2)].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] != 'F') | (nation['N_NAME'].str.startswith('A')) & (nation['N_COMMENT'] != 'i') & (nation['N_COMMENT'] != 'p')][['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NAME', 'N_REGIONKEY']].merge(region[(region['R_NAME'].str.startswith('ASI')) | (region['R_COMMENT'] == 'g') & (region['R_COMMENT'].str.startswith('l')) | (region['R_COMMENT'] == 'h')][['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation[(nation['N_COMMENT'] != 'p') | (nation['N_REGIONKEY'] == 1) & (nation['N_NAME'].str.startswith('P'))], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_NAME'].str.startswith('AFR')) | (region['R_COMMENT'] == 'g')], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT']).agg('count')

lineitem.groupby(by=['L_ORDERKEY']).agg('mean', numeric_only=True)

part.merge(partsupp.merge(lineitem[['L_PARTKEY']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

region[(region['R_COMMENT'] != 'l') & (region['R_NAME'].str.startswith('E')) | (region['R_REGIONKEY'] == 0) & (region['R_NAME'] != 'AFR')].merge(nation[(nation['N_NAME'] != 'G')], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] != 3) | (nation['N_COMMENT'] != 'u') & (nation['N_NATIONKEY'] < 3) | (nation['N_NAME'] != 'E')], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('count')

part[['P_PARTKEY', 'RETAILPRICE', 'PT_COMMENT', 'P_NAME', 'SIZE']].merge(partsupp.merge(lineitem[(lineitem['LINESTATUS'].isin(['F', 'O'])) | (lineitem['SHIPDATE'] >= '1998-10-30')][['QUANTITY', 'TAX']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[['P_PARTKEY', 'PT_COMMENT', 'MFGR']].merge(partsupp[['PS_PARTKEY', 'PS_SUPPKEY', 'AVAILQTY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'].str.startswith(',')) & (partsupp['P_COMMENT'] == 'bli')][['SUPPLYCOST']].merge(orders[(orders['O_CUSTKEY'] == 40952) | (orders['O_ORDERKEY'] <= 229) | (orders['O_ORDERKEY'] > 788) & (orders['TOTALPRICE'] <= 286613.0169914645)][['O_ORDERKEY', 'O_COMMENT']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='O_ORDERKEY').merge(lineitem.merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['PT_COMMENT']).agg('sum', numeric_only=True)

supplier[(supplier['S_PHONE'].str.startswith('26-'))].merge(nation[['N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['AVAILQTY'] <= 6940) & (partsupp['SUPPLYCOST'] >= 925.3944049417097) | (partsupp['SUPPLYCOST'] < 966.5630153909945)][['PS_PARTKEY', 'PS_SUPPKEY', 'AVAILQTY', 'SUPPLYCOST']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp.merge(lineitem[(lineitem['EXTENDEDPRICE'] >= 42749.676694657304) & (lineitem['QUANTITY'] >= 39)][['COMMITDATE', 'TAX', 'SHIPDATE', 'L_SUPPKEY', 'L_PARTKEY']].merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

partsupp

partsupp[['PS_SUPPKEY', 'AVAILQTY', 'PS_PARTKEY']]

region[['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].merge(nation[(nation['N_REGIONKEY'] > 0)][['N_REGIONKEY']].merge(region[['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].merge(nation[(nation['N_REGIONKEY'] >= 1) | (nation['N_NAME'].str.startswith('R'))][['N_COMMENT', 'N_NAME', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] == 'n') | (nation['N_NAME'] == 'E')].merge(customer[(customer['C_PHONE'].str.startswith('18-')) | (customer['C_COMMENT'].str.startswith('o'))][['C_PHONE', 'C_COMMENT', 'C_CUSTKEY']].merge(orders[['O_COMMENT', 'SHIPPRIORITY', 'ORDERSTATUS', 'ORDERPRIORITY', 'O_ORDERKEY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

region[['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT']).agg('mean', numeric_only=True)

orders[(orders['CLERK'] != 'C') & (orders['ORDERPRIORITY'].isin(['5-LOW'])) | (orders['ORDERDATE'] != '1992-01-13')].merge(lineitem[(lineitem['LINESTATUS'].isin(['O', 'F'])) | (lineitem['LINESTATUS'] == 'O')].merge(orders[(orders['ORDERPRIORITY'] != '1-URGENT') & (orders['O_ORDERKEY'] != 251)][['O_COMMENT']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['TOTALPRICE'] == 202096.62483574994) & (orders['ORDERDATE'] != '1992-01-13') | (orders['O_COMMENT'] == 'e')][['O_ORDERKEY', 'O_COMMENT']].merge(lineitem[['DISCOUNT']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem.merge(orders[['ORDERDATE', 'ORDERPRIORITY', 'ORDERSTATUS', 'O_COMMENT']].merge(supplier[['S_NAME', 'S_NATIONKEY', 'S_ADDRESS', 'S_ACCTBAL', 'S_SUPPKEY']], left_on='O_ORDERKEY', right_on='S_SUPPKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders.merge(customer[(customer['C_NATIONKEY'] >= 14) & (customer['C_CUSTKEY'] == 69) & (customer['C_CUSTKEY'] <= 88) | (customer['C_NAME'] != 'C')], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[['L_PARTKEY', 'RETURNFLAG', 'SHIPMODE', 'SHIPINSTRUCT']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['O_CUSTKEY', 'ORDERPRIORITY']).agg('mean', numeric_only=True)

orders[['SHIPPRIORITY', 'ORDERDATE', 'O_COMMENT', 'O_CUSTKEY']].merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[['C_PHONE', 'C_NAME', 'C_CUSTKEY']].merge(orders[(orders['TOTALPRICE'] >= 125543.46471919496) | (orders['TOTALPRICE'] <= 235264.47380962825) | (orders['ORDERPRIORITY'].isin(['5-LOW'])) | (orders['O_ORDERKEY'] != 288)].merge(customer[(customer['C_NATIONKEY'] == 21) & (customer['C_NAME'].str.startswith('C')) | (customer['C_COMMENT'].str.startswith(' ')) & (customer['C_NAME'] == 'C')], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['SHIPPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['O_COMMENT', 'SHIPPRIORITY']).agg('max', numeric_only=True)

region.merge(nation[(nation['N_NATIONKEY'] != 18) | (nation['N_NAME'] == 'B') & (nation['N_COMMENT'] != 'h') & (nation['N_REGIONKEY'] > 0)].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_REGIONKEY', 'N_NAME', 'N_NATIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] != 'n') & (nation['N_COMMENT'] == 'y') | (nation['N_NAME'].str.startswith('V'))].merge(region[['R_NAME', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[['C_COMMENT', 'MKTSEGMENT', 'C_ACCTBAL', 'C_CUSTKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

orders

customer.merge(nation[(nation['N_COMMENT'] != 'h') | (nation['N_NATIONKEY'] <= 17) | (nation['N_REGIONKEY'] > 3)].merge(customer.merge(nation[(nation['N_NAME'] == 'U')][['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME', 'N_COMMENT']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[['R_NAME', 'R_REGIONKEY', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_REGIONKEY'] >= 1) & (nation['N_REGIONKEY'] != 1) & (nation['N_REGIONKEY'] == 3) & (nation['N_NAME'].str.startswith('A'))].merge(supplier[(supplier['S_ACCTBAL'] < 5455.610162400254)][['S_PHONE', 'S_NAME', 'S_ADDRESS']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NATIONKEY'] == 23) | (nation['N_NAME'] == 'M') & (nation['N_NATIONKEY'] < 15) | (nation['N_NATIONKEY'] == 10)], left_on='C_NATIONKEY', right_on='N_NATIONKEY')

nation[(nation['N_NAME'] == 'U') | (nation['N_COMMENT'] != 'n')].merge(supplier[(supplier['S_NAME'] == 'S') & (supplier['S_NAME'] != 'S')][['S_NATIONKEY', 'S_ACCTBAL', 'S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[(customer['C_CUSTKEY'] != 72) & (customer['C_ACCTBAL'] >= 1300.2042492987011)], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_ADDRESS'].str.startswith('f')) & (supplier['S_COMMENT'] != '.')][['S_NAME', 'S_PHONE', 'S_COMMENT', 'S_ACCTBAL']].merge(nation.merge(customer[(customer['C_ACCTBAL'] >= 2205.9451989471677) & (customer['C_CUSTKEY'] <= 85) & (customer['C_NATIONKEY'] == 5) & (customer['C_CUSTKEY'] > 18)][['C_CUSTKEY', 'MKTSEGMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_SUPPKEY', right_on='N_NATIONKEY').merge(nation, left_on='S_SUPPKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY')

customer.merge(nation[(nation['N_NAME'].str.startswith('C')) & (nation['N_COMMENT'].str.startswith('o'))].merge(region.merge(nation[['N_COMMENT', 'N_NATIONKEY', 'N_NAME', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[(supplier['S_NAME'].str.startswith('S')) & (supplier['S_ACCTBAL'] > 8382.967539563511)][['S_SUPPKEY', 'S_COMMENT', 'S_ACCTBAL']].merge(partsupp[['P_COMMENT', 'AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

orders[(orders['ORDERSTATUS'].isin(['P', 'O'])) | (orders['ORDERSTATUS'] == 'O')][['CLERK', 'ORDERPRIORITY']].merge(supplier, left_on='O_ORDERKEY', right_on='S_SUPPKEY').merge(nation[['N_COMMENT', 'N_NAME']], left_on='O_ORDERKEY', right_on='N_NATIONKEY')

part.groupby(by=['RETAILPRICE', 'CONTAINER']).agg('max', numeric_only=True)

nation[['N_REGIONKEY']].groupby(by=['N_REGIONKEY']).agg('count')

region[['R_REGIONKEY', 'R_NAME']].groupby(by=['R_NAME']).agg('mean', numeric_only=True)

region[(region['R_NAME'] != 'E') | (region['R_NAME'].str.startswith('A')) & (region['R_REGIONKEY'] != 3) & (region['R_NAME'] == 'AFR')].groupby(by=['R_NAME']).agg('count')

customer

supplier[(supplier['S_NATIONKEY'] >= 22) | (supplier['S_COMMENT'] != 'k')][['S_PHONE', 'S_ACCTBAL', 'S_COMMENT', 'S_ADDRESS', 'S_SUPPKEY']].merge(partsupp[['PS_PARTKEY', 'P_COMMENT']].merge(part[(part['PT_COMMENT'] == 'c') & (part['P_PARTKEY'] == 128) | (part['SIZE'] == 21)][['MFGR', 'PT_COMMENT']].merge(supplier[(supplier['S_ADDRESS'] == 'E') | (supplier['S_ACCTBAL'] == 653.6995203304989) & (supplier['S_NATIONKEY'] > 15) | (supplier['S_NAME'].str.startswith('S'))], left_on='P_PARTKEY', right_on='S_SUPPKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['PS_PARTKEY', 'SUPPLYCOST', 'P_COMMENT', 'PS_SUPPKEY']].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['AVAILQTY'] >= 8513) | (partsupp['P_COMMENT'] == '.')], left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

partsupp[['PS_SUPPKEY', 'PS_PARTKEY', 'P_COMMENT', 'SUPPLYCOST', 'AVAILQTY']].merge(part[(part['SIZE'] < 9) | (part['P_NAME'] != 'bis') | (part['TYPE'] != 'M')][['P_NAME', 'SIZE', 'RETAILPRICE', 'MFGR']].merge(partsupp, left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(partsupp[(partsupp['SUPPLYCOST'] >= 59.020379859890426) | (partsupp['AVAILQTY'] < 2643) & (partsupp['AVAILQTY'] < 7155)], left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem.merge(orders[(orders['ORDERDATE'] > '1992-01-13') & (orders['O_ORDERKEY'] <= 418) | (orders['O_CUSTKEY'] != 35308) & (orders['O_COMMENT'].str.startswith(','))][['TOTALPRICE', 'SHIPPRIORITY', 'ORDERPRIORITY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').groupby(by=['P_COMMENT', 'PS_PARTKEY']).agg('mean', numeric_only=True)

region[(region['R_REGIONKEY'] < 2) & (region['R_COMMENT'].str.startswith('l')) & (region['R_COMMENT'].str.startswith('g'))][['R_NAME', 'R_COMMENT']].merge(orders[['O_ORDERKEY', 'ORDERDATE', 'O_COMMENT', 'TOTALPRICE']].merge(lineitem[['TAX', 'L_SUPPKEY', 'L_ORDERKEY']].merge(partsupp[(partsupp['PS_SUPPKEY'] < 3499) & (partsupp['PS_SUPPKEY'] == 2638) & (partsupp['P_COMMENT'] != 'n')][['P_COMMENT', 'PS_SUPPKEY', 'AVAILQTY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['DISCOUNT'] < 0.03632781286418907) & (lineitem['SHIPINSTRUCT'].isin(['TAKE BACK RETURN', 'COLLECT COD', 'DELIVER IN PERSON', 'NONE'])) & (lineitem['TAX'] == 0.06919327444933565) & (lineitem['RETURNFLAG'] == 'R')], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='R_REGIONKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['P_COMMENT'] == ',')].merge(part[(part['CONTAINER'] != 'WRAP') & (part['P_NAME'].str.startswith('g')) & (part['MFGR'].isin(['Manufacturer#5', 'Manufacturer#1', 'Manufacturer#4', 'Manufacturer#3'])) & (part['SIZE'] <= 21)], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(supplier[(supplier['S_SUPPKEY'] != 15) & (supplier['S_COMMENT'] == 'j')][['S_NATIONKEY', 'S_ADDRESS', 'S_NAME', 'S_SUPPKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='R_REGIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(partsupp[(partsupp['PS_PARTKEY'] == 29)], left_on='R_REGIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY'])

part.merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(lineitem[(lineitem['LINESTATUS'].isin(['F']))], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['P_PARTKEY', 'TYPE']).agg('count')

region[(region['R_NAME'] != 'AFR') | (region['R_COMMENT'] == 'g')].merge(nation[(nation['N_REGIONKEY'] != 3) & (nation['N_NAME'] != 'M') | (nation['N_COMMENT'] == 'a') & (nation['N_COMMENT'] == 'r')], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

nation.merge(customer[(customer['C_ADDRESS'] == 'e') & (customer['C_ACCTBAL'] > 6546.356895180753) | (customer['C_CUSTKEY'] >= 26)], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[(customer['C_PHONE'] == '2') & (customer['C_CUSTKEY'] <= 92)][['MKTSEGMENT', 'C_CUSTKEY', 'C_ADDRESS']].merge(orders.merge(lineitem[['TAX', 'EXTENDEDPRICE', 'LINESTATUS', 'COMMITDATE', 'RECEIPTDATE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['ORDERSTATUS'] != 'F') & (orders['TOTALPRICE'] <= 111046.12445279033) & (orders['TOTALPRICE'] >= 250867.4976027517)][['O_COMMENT', 'ORDERSTATUS', 'O_CUSTKEY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[['S_SUPPKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY')

region[(region['R_REGIONKEY'] <= 1) & (region['R_NAME'] == 'E')][['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].groupby(by=['R_REGIONKEY']).agg('count')

customer[(customer['C_PHONE'] == '3')].merge(orders[['O_COMMENT', 'O_CUSTKEY', 'TOTALPRICE', 'ORDERPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['CLERK'].str.startswith('C')) & (orders['SHIPPRIORITY'] <= 0)][['CLERK']].merge(region, left_on='O_ORDERKEY', right_on='R_REGIONKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_ADDRESS', 'C_COMMENT']).agg('min', numeric_only=True)

partsupp[(partsupp['P_COMMENT'].str.startswith('q')) & (partsupp['AVAILQTY'] < 8040)]

lineitem[(lineitem['L_PARTKEY'] < 79551) & (lineitem['LINENUMBER'] < 5)][['EXTENDEDPRICE', 'L_SUPPKEY']].merge(partsupp.merge(supplier[(supplier['S_SUPPKEY'] != 4) & (supplier['S_PHONE'] == '17-') & (supplier['S_NAME'] != 'S')][['S_NAME']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(part[['BRAND', 'P_PARTKEY', 'P_NAME', 'SIZE', 'MFGR']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['P_COMMENT'] != 'k') | (partsupp['P_COMMENT'] == ',') & (partsupp['SUPPLYCOST'] >= 195.1090545982269) | (partsupp['AVAILQTY'] < 6649)][['SUPPLYCOST', 'PS_PARTKEY', 'P_COMMENT']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['L_SUPPKEY', 'EXTENDEDPRICE']).agg('min', numeric_only=True)

orders[['CLERK']].merge(region[(region['R_NAME'] != 'AME') & (region['R_COMMENT'].str.startswith('g')) & (region['R_COMMENT'].str.startswith('u')) | (region['R_COMMENT'] != 'u')][['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] != 14)][['N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='O_ORDERKEY', right_on='R_REGIONKEY')

supplier[(supplier['S_ACCTBAL'] <= 5476.594372752629) | (supplier['S_ACCTBAL'] <= 1108.4681844019722) & (supplier['S_NATIONKEY'] >= 8) | (supplier['S_PHONE'] == '26-')].merge(partsupp[(partsupp['PS_SUPPKEY'] >= 5353) & (partsupp['PS_PARTKEY'] >= 26) & (partsupp['PS_PARTKEY'] < 23) | (partsupp['AVAILQTY'] < 1873)][['PS_PARTKEY', 'AVAILQTY']].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['RECEIPTDATE'] <= '1998-11-06') & (lineitem['L_ORDERKEY'] < 147)], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

part[(part['SIZE'] >= 13) | (part['P_NAME'] != 'm') & (part['BRAND'] != 'Brand#14') & (part['CONTAINER'] == 'LG')][['SIZE', 'CONTAINER', 'P_NAME']].merge(supplier[(supplier['S_NAME'].str.startswith('S')) | (supplier['S_ACCTBAL'] == 8549.44074656477) & (supplier['S_NAME'] != 'S') | (supplier['S_PHONE'].str.startswith('3'))][['S_ACCTBAL', 'S_NATIONKEY', 'S_PHONE']], left_on='P_PARTKEY', right_on='S_SUPPKEY')

region[(region['R_NAME'] != 'AME') | (region['R_COMMENT'] != 'u') | (region['R_COMMENT'] == 'u') | (region['R_COMMENT'].str.startswith('l'))].merge(nation[(nation['N_COMMENT'] != 'y')].merge(customer[['C_PHONE', 'C_NATIONKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[['C_NATIONKEY', 'C_CUSTKEY', 'C_ACCTBAL']].merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NAME']].merge(part[(part['BRAND'] == 'Brand#43') & (part['TYPE'] == 'SMA') & (part['RETAILPRICE'] <= 936.9437145073671) | (part['RETAILPRICE'] < 938.6241150437482)][['BRAND', 'PT_COMMENT', 'RETAILPRICE', 'P_NAME', 'SIZE']], left_on='N_NATIONKEY', right_on='P_PARTKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT']).agg('max', numeric_only=True)

region[(region['R_COMMENT'].str.startswith('g')) & (region['R_COMMENT'] != 'g')][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] == 13) | (nation['N_COMMENT'].str.startswith('t'))].merge(region[(region['R_REGIONKEY'] > 0) & (region['R_COMMENT'].str.startswith('l')) & (region['R_COMMENT'] == 'g')][['R_REGIONKEY', 'R_COMMENT', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

lineitem[(lineitem['QUANTITY'] < 20) & (lineitem['SHIPINSTRUCT'] == 'DELIVER IN PERSON')].merge(partsupp[(partsupp['AVAILQTY'] >= 9121)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_PARTKEY'] == 21) & (partsupp['PS_SUPPKEY'] < 1480) | (partsupp['PS_PARTKEY'] >= 37)].merge(lineitem[(lineitem['SHIPDATE'] != '1998-10-30') | (lineitem['DISCOUNT'] == 0.08772050128527883)], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(orders[(orders['ORDERSTATUS'].isin(['P'])) & (orders['O_COMMENT'] == 'r') & (orders['ORDERDATE'] == '1992-01-13')][['O_CUSTKEY', 'SHIPPRIORITY', 'CLERK', 'O_ORDERKEY']].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').groupby(by=['L_COMMENT', 'QUANTITY']).agg('sum', numeric_only=True)

part[(part['PT_COMMENT'] != 'r') & (part['PT_COMMENT'] != 'k') | (part['TYPE'] != 'P')].merge(partsupp[(partsupp['SUPPLYCOST'] != 66.201390996895) & (partsupp['AVAILQTY'] < 445) | (partsupp['PS_PARTKEY'] > 28) & (partsupp['AVAILQTY'] == 4505)][['AVAILQTY']].merge(lineitem, left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(nation.merge(supplier[(supplier['S_ADDRESS'].str.startswith('2'))][['S_NAME', 'S_ADDRESS', 'S_ACCTBAL']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['CONTAINER']).agg('sum', numeric_only=True)

partsupp.merge(lineitem[(lineitem['RECEIPTDATE'] >= '1992-05-02')][['SHIPDATE', 'DISCOUNT']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier[(supplier['S_NAME'] != 'S')][['S_NATIONKEY', 'S_NAME']].merge(nation[['N_NATIONKEY']].merge(supplier[(supplier['S_ADDRESS'].str.startswith('U'))], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NATIONKEY'] <= 16) | (nation['N_NATIONKEY'] != 15) | (nation['N_COMMENT'] != 't') & (nation['N_NATIONKEY'] < 2)].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(part[(part['PT_COMMENT'].str.startswith('t'))][['BRAND', 'RETAILPRICE', 'PT_COMMENT']], left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['P_COMMENT']).agg('min', numeric_only=True)

lineitem[['L_COMMENT']].groupby(by=['L_COMMENT']).agg('max', numeric_only=True)

orders[(orders['ORDERSTATUS'].isin(['O', 'F', 'P'])) & (orders['CLERK'] == 'C') | (orders['ORDERPRIORITY'] == '2-HIGH') & (orders['O_COMMENT'] == 'uri')].merge(lineitem[['SHIPDATE', 'DISCOUNT', 'COMMITDATE', 'L_PARTKEY']].merge(partsupp[(partsupp['SUPPLYCOST'] != 600.2794221371772) | (partsupp['AVAILQTY'] == 2637) | (partsupp['P_COMMENT'] == ' ')].merge(part[(part['PT_COMMENT'] != 'y')], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_SUPPKEY', 'AVAILQTY', 'PS_PARTKEY', 'P_COMMENT', 'SUPPLYCOST']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY')

orders[(orders['TOTALPRICE'] < 76798.20132958585) | (orders['O_ORDERKEY'] >= 531)][['CLERK', 'O_ORDERKEY', 'SHIPPRIORITY', 'ORDERDATE', 'O_COMMENT']].groupby(by=['CLERK']).agg('sum', numeric_only=True)

orders[(orders['SHIPPRIORITY'] < 0) | (orders['O_COMMENT'] != 'l') & (orders['SHIPPRIORITY'] <= 0)].merge(lineitem[['L_ORDERKEY', 'L_COMMENT', 'RECEIPTDATE', 'SHIPDATE']].merge(orders[(orders['ORDERPRIORITY'] == '3-MEDIUM') & (orders['O_ORDERKEY'] >= 459) & (orders['O_COMMENT'] == 'l') & (orders['ORDERSTATUS'].isin(['P', 'O']))].merge(lineitem[(lineitem['COMMITDATE'] != '1998-10-16') & (lineitem['RETURNFLAG'] != 'N')][['RECEIPTDATE', 'EXTENDEDPRICE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[['ORDERPRIORITY', 'O_ORDERKEY', 'SHIPPRIORITY']].merge(lineitem[(lineitem['L_ORDERKEY'] == 64) & (lineitem['SHIPDATE'] > '1992-04-27')], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[['C_ADDRESS', 'C_NAME', 'C_ACCTBAL']].merge(partsupp[(partsupp['PS_PARTKEY'] == 43) & (partsupp['AVAILQTY'] <= 5216) | (partsupp['PS_SUPPKEY'] < 1899) | (partsupp['P_COMMENT'] != 'g')].merge(lineitem[(lineitem['QUANTITY'] != 13)], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

lineitem[(lineitem['LINESTATUS'] == 'O') | (lineitem['L_PARTKEY'] < 133714)].groupby(by=['SHIPINSTRUCT', 'COMMITDATE']).agg('count')

lineitem[['SHIPINSTRUCT', 'RETURNFLAG', 'EXTENDEDPRICE']].merge(supplier.merge(nation[['N_REGIONKEY', 'N_COMMENT']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp.merge(part[(part['MFGR'].isin(['Manufacturer#5', 'Manufacturer#2'])) | (part['TYPE'] == 'S') | (part['PT_COMMENT'] != 'kag') | (part['SIZE'] > 39)][['TYPE', 'P_NAME', 'RETAILPRICE', 'MFGR']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY').merge(supplier[['S_SUPPKEY', 'S_PHONE']].merge(partsupp[(partsupp['PS_PARTKEY'] <= 46) | (partsupp['AVAILQTY'] < 44) | (partsupp['PS_SUPPKEY'] < 3913) & (partsupp['AVAILQTY'] == 1745)][['SUPPLYCOST', 'P_COMMENT']].merge(nation[(nation['N_REGIONKEY'] <= 1) & (nation['N_COMMENT'].str.startswith('v')) | (nation['N_COMMENT'] != 't') | (nation['N_COMMENT'] != 's')], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] != 3600)].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY')

supplier.merge(nation.merge(supplier[(supplier['S_COMMENT'] == 'a')], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[(customer['C_COMMENT'] == 'r') & (customer['C_CUSTKEY'] > 46)], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NATIONKEY'] != 10)][['N_NATIONKEY', 'N_NAME', 'N_REGIONKEY', 'N_COMMENT']].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] > 6207) & (partsupp['P_COMMENT'] == 'the') | (partsupp['AVAILQTY'] >= 5830) & (partsupp['SUPPLYCOST'] > 182.50847995951185)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

part[(part['RETAILPRICE'] != 969.7109652418782) & (part['P_NAME'] == 'blu')]

region[(region['R_NAME'] == 'A') | (region['R_REGIONKEY'] < 2) | (region['R_REGIONKEY'] >= 3) | (region['R_REGIONKEY'] != 0)].merge(nation.merge(region[(region['R_COMMENT'] == 'h') & (region['R_COMMENT'].str.startswith('u')) | (region['R_NAME'] != 'ASI')].merge(nation[(nation['N_COMMENT'].str.startswith('o')) | (nation['N_REGIONKEY'] != 0) & (nation['N_NATIONKEY'] > 14)], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

partsupp[(partsupp['P_COMMENT'] == 'o') | (partsupp['PS_SUPPKEY'] <= 674)][['SUPPLYCOST', 'P_COMMENT', 'PS_SUPPKEY']].merge(lineitem[(lineitem['L_SUPPKEY'] > 1804) | (lineitem['SHIPMODE'] == 'AIR')][['L_PARTKEY', 'TAX', 'LINESTATUS']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier[['S_PHONE', 'S_ACCTBAL', 'S_NAME']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[(supplier['S_NATIONKEY'] < 2) & (supplier['S_NATIONKEY'] > 5) | (supplier['S_ACCTBAL'] < 1475.2796499995436)].merge(nation.merge(region[(region['R_NAME'] == 'E') & (region['R_COMMENT'] == 'l') | (region['R_COMMENT'] != 'g') | (region['R_REGIONKEY'] > 1)][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY')

orders[['ORDERPRIORITY', 'ORDERSTATUS']].merge(region[['R_REGIONKEY', 'R_COMMENT', 'R_NAME']].merge(nation[['N_REGIONKEY', 'N_NAME', 'N_COMMENT', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='O_ORDERKEY', right_on='R_REGIONKEY').merge(part[(part['TYPE'] == 'STA') & (part['P_NAME'].str.startswith('l'))][['P_PARTKEY', 'BRAND', 'RETAILPRICE']], left_on='O_ORDERKEY', right_on='P_PARTKEY').merge(region[(region['R_REGIONKEY'] != 0) & (region['R_REGIONKEY'] != 1)], left_on='O_ORDERKEY', right_on='R_REGIONKEY').groupby(by=['ORDERPRIORITY']).agg('sum', numeric_only=True)

customer[(customer['C_ACCTBAL'] > 8359.92115588079) & (customer['C_COMMENT'] == 'l') & (customer['C_CUSTKEY'] > 5) & (customer['C_NATIONKEY'] >= 0)].merge(orders[(orders['ORDERPRIORITY'] != '5-LOW')], left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_PHONE']).agg('min', numeric_only=True)

customer.merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT', 'N_NAME']].merge(customer[(customer['C_CUSTKEY'] < 54)][['C_PHONE', 'C_NATIONKEY', 'C_ADDRESS', 'C_CUSTKEY', 'C_COMMENT']].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer.merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_NAME']].merge(customer[['C_NATIONKEY', 'C_COMMENT', 'C_PHONE', 'C_CUSTKEY', 'C_NAME']], left_on='N_NATIONKEY', right_on='C_CUSTKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_COMMENT', 'C_ACCTBAL']).agg('min', numeric_only=True)

customer[['C_COMMENT', 'MKTSEGMENT', 'C_ADDRESS', 'C_NAME', 'C_NATIONKEY']].merge(nation[(nation['N_NAME'].str.startswith('V')) | (nation['N_NAME'] == 'K') & (nation['N_NAME'] == 'C') | (nation['N_COMMENT'] == 'u')].merge(customer[['C_PHONE', 'MKTSEGMENT']].merge(lineitem, left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[['C_ADDRESS', 'C_PHONE', 'C_ACCTBAL']].merge(orders[(orders['ORDERDATE'] > '1998-07-21') & (orders['O_CUSTKEY'] <= 7644) | (orders['O_CUSTKEY'] >= 133119) | (orders['ORDERDATE'] < '1992-01-13')][['CLERK', 'O_CUSTKEY', 'O_COMMENT']], left_on='C_CUSTKEY', right_on='O_ORDERKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_REGIONKEY', 'N_NAME', 'N_NATIONKEY', 'N_COMMENT']].merge(region[['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].merge(nation[(nation['N_NAME'] != 'M') & (nation['N_NAME'].str.startswith('E')) & (nation['N_COMMENT'] != 't') | (nation['N_COMMENT'] != 'i')], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[(supplier['S_NATIONKEY'] < 4) & (supplier['S_PHONE'] != '2')], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['MKTSEGMENT']).agg('sum', numeric_only=True)

customer.groupby(by=['C_ADDRESS', 'C_NAME']).agg('max', numeric_only=True)

lineitem.merge(orders[(orders['ORDERSTATUS'].isin(['O', 'F', 'P'])) | (orders['O_COMMENT'] == 'i') & (orders['TOTALPRICE'] != 294672.3139653531) | (orders['SHIPPRIORITY'] == 0)][['O_CUSTKEY', 'ORDERSTATUS', 'O_COMMENT', 'SHIPPRIORITY']].merge(customer[['C_CUSTKEY']].merge(orders[(orders['TOTALPRICE'] > 160206.2714209482) & (orders['SHIPPRIORITY'] < 0) | (orders['O_COMMENT'] != 't') & (orders['CLERK'] != 'C')][['TOTALPRICE', 'ORDERDATE', 'O_ORDERKEY', 'SHIPPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[['C_ADDRESS', 'C_CUSTKEY']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').groupby(by=['L_SUPPKEY', 'COMMITDATE']).agg('max', numeric_only=True)

orders[['O_COMMENT']].merge(part[['P_PARTKEY', 'CONTAINER', 'BRAND']], left_on='O_ORDERKEY', right_on='P_PARTKEY')

lineitem[(lineitem['SHIPINSTRUCT'] != 'DELIVER IN PERSON') | (lineitem['RECEIPTDATE'] <= '1992-05-02') | (lineitem['SHIPINSTRUCT'].isin(['COLLECT COD', 'DELIVER IN PERSON']))][['LINENUMBER', 'SHIPDATE', 'L_ORDERKEY', 'EXTENDEDPRICE', 'SHIPMODE']].groupby(by=['EXTENDEDPRICE', 'LINENUMBER']).agg('mean', numeric_only=True)

nation[['N_NAME']].merge(part[['RETAILPRICE', 'SIZE']], left_on='N_NATIONKEY', right_on='P_PARTKEY').merge(orders.merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='N_NATIONKEY', right_on='O_ORDERKEY').merge(region[(region['R_NAME'].str.startswith('E')) | (region['R_REGIONKEY'] == 1)].merge(nation.merge(supplier[(supplier['S_ADDRESS'] == '7') | (supplier['S_NAME'].str.startswith('S')) | (supplier['S_ADDRESS'] != 'l')][['S_NATIONKEY', 'S_ACCTBAL', 'S_COMMENT', 'S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_NATIONKEY', right_on='R_REGIONKEY').groupby(by=['N_NAME']).agg('mean', numeric_only=True)

orders[(orders['SHIPPRIORITY'] > 0) & (orders['TOTALPRICE'] > 95452.86388681813) | (orders['O_COMMENT'] != 'g')][['TOTALPRICE']].merge(nation[(nation['N_REGIONKEY'] > 0) | (nation['N_REGIONKEY'] <= 3) | (nation['N_NAME'].str.startswith('C'))][['N_NAME', 'N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY']].merge(supplier[['S_PHONE', 'S_SUPPKEY']].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[(supplier['S_SUPPKEY'] != 70)].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='O_ORDERKEY', right_on='N_NATIONKEY').merge(lineitem.merge(partsupp[['AVAILQTY', 'P_COMMENT', 'PS_PARTKEY', 'PS_SUPPKEY', 'SUPPLYCOST']].merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT']].merge(supplier[['S_SUPPKEY', 'S_ACCTBAL', 'S_NATIONKEY', 'S_NAME']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'])

orders[(orders['O_ORDERKEY'] <= 543) | (orders['O_CUSTKEY'] > 114789)][['SHIPPRIORITY']].merge(lineitem[['SHIPMODE', 'TAX', 'QUANTITY', 'L_PARTKEY', 'RETURNFLAG']].merge(partsupp[(partsupp['AVAILQTY'] == 355) & (partsupp['AVAILQTY'] >= 9813)], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['SUPPLYCOST'] > 313.42820229910217)].merge(supplier[['S_PHONE', 'S_SUPPKEY', 'S_NATIONKEY', 'S_COMMENT']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(region.merge(nation[['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(region[(region['R_REGIONKEY'] >= 0) | (region['R_NAME'] != 'E') | (region['R_REGIONKEY'] <= 3) | (region['R_COMMENT'] == 'l')][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='O_ORDERKEY', right_on='R_REGIONKEY')

lineitem[(lineitem['COMMITDATE'] < '1992-05-15') & (lineitem['L_SUPPKEY'] != 7755)][['L_ORDERKEY']].merge(orders[(orders['ORDERSTATUS'] != 'O') | (orders['O_COMMENT'].str.startswith('-')) | (orders['ORDERPRIORITY'] != '4-NOT SPECIFIED')][['O_CUSTKEY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['ORDERSTATUS'] == 'O')].merge(lineitem[['EXTENDEDPRICE', 'LINENUMBER', 'SHIPDATE', 'QUANTITY', 'L_ORDERKEY']].merge(orders[(orders['O_COMMENT'] != 'c') & (orders['SHIPPRIORITY'] != 0) & (orders['O_COMMENT'] == 'the') & (orders['ORDERDATE'] <= '1998-07-21')][['ORDERDATE']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_ACCTBAL'] > -408.8899489955158) | (customer['C_CUSTKEY'] >= 71) & (customer['C_ADDRESS'] == 'K') | (customer['C_ACCTBAL'] == 1233.437809667219)].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY')

nation[['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']].merge(region[(region['R_NAME'].str.startswith('AFR')) | (region['R_REGIONKEY'] == 2)][['R_COMMENT']].merge(lineitem, left_on='R_REGIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[['S_PHONE', 'S_COMMENT', 'S_ADDRESS', 'S_NATIONKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY')

lineitem[(lineitem['RECEIPTDATE'] <= '1992-05-02') | (lineitem['EXTENDEDPRICE'] != 3441.8479281894383) & (lineitem['TAX'] <= 0.0034144305789863163) | (lineitem['COMMITDATE'] != '1992-05-15')][['TAX', 'EXTENDEDPRICE', 'L_PARTKEY', 'L_SUPPKEY', 'SHIPINSTRUCT']].merge(partsupp.merge(lineitem[(lineitem['LINESTATUS'] != 'O') & (lineitem['L_COMMENT'] == 'y') & (lineitem['DISCOUNT'] <= 0.02218095955737468)][['DISCOUNT', 'QUANTITY', 'L_COMMENT']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(part[(part['CONTAINER'].str.startswith('LG')) | (part['RETAILPRICE'] != 954.2436177147036) & (part['SIZE'] <= 30) & (part['BRAND'] != 'Brand#14')], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_SUPPKEY', 'P_COMMENT', 'AVAILQTY', 'PS_PARTKEY', 'SUPPLYCOST']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['PS_PARTKEY', 'AVAILQTY']], left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['SHIPINSTRUCT']).agg('max', numeric_only=True)

nation[['N_COMMENT', 'N_NAME', 'N_REGIONKEY', 'N_NATIONKEY']].merge(customer[['C_ACCTBAL', 'C_NATIONKEY', 'MKTSEGMENT', 'C_COMMENT', 'C_PHONE']].merge(nation[(nation['N_NAME'] != 'M')], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_NAME'] != 'AFR') & (region['R_REGIONKEY'] == 1) & (region['R_REGIONKEY'] == 1)][['R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region.merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_REGIONKEY']).agg('min', numeric_only=True)

partsupp[(partsupp['PS_PARTKEY'] == 15)].merge(part[(part['PT_COMMENT'] != 'h') & (part['TYPE'] != 'M') & (part['SIZE'] == 3) & (part['TYPE'] == 'STA')][['SIZE']].merge(nation[['N_REGIONKEY', 'N_COMMENT', 'N_NAME', 'N_NATIONKEY']], left_on='P_PARTKEY', right_on='N_NATIONKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem.merge(partsupp[(partsupp['PS_SUPPKEY'] == 3336)][['SUPPLYCOST', 'AVAILQTY', 'PS_SUPPKEY', 'P_COMMENT', 'PS_PARTKEY']].merge(part[(part['BRAND'].isin(['Brand#35', 'Brand#24', 'Brand#42', 'Brand#33', 'Brand#11', 'Brand#13', 'Brand#45', 'Brand#25', 'Brand#14', 'Brand#53', 'Brand#41'])) & (part['MFGR'] == 'Manufacturer#2') & (part['P_NAME'].str.startswith('n'))], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['AVAILQTY', 'PS_PARTKEY', 'PS_SUPPKEY', 'SUPPLYCOST']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier.merge(nation[(nation['N_NAME'] != 'G') & (nation['N_REGIONKEY'] < 0) | (nation['N_NAME'].str.startswith('I')) & (nation['N_REGIONKEY'] > 3)][['N_NATIONKEY', 'N_COMMENT']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_COMMENT', 'N_NAME', 'N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['P_COMMENT', 'PS_PARTKEY']).agg('count')

orders

partsupp[(partsupp['P_COMMENT'] != 'g') | (partsupp['P_COMMENT'].str.startswith('l')) & (partsupp['PS_PARTKEY'] > 29) & (partsupp['PS_SUPPKEY'] <= 2022)].merge(lineitem[(lineitem['TAX'] < 0.0629605505485)][['RECEIPTDATE', 'COMMITDATE']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[['BRAND', 'P_NAME', 'P_PARTKEY', 'RETAILPRICE']].merge(partsupp[(partsupp['P_COMMENT'] == 'n')], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['RETURNFLAG'] == 'N')], left_on='PS_PARTKEY', right_on='L_PARTKEY').groupby(by=['PS_PARTKEY']).agg('sum', numeric_only=True)

region[(region['R_COMMENT'] != 'h') & (region['R_REGIONKEY'] != 0)].merge(nation[(nation['N_COMMENT'] != 's') | (nation['N_NAME'] != 'M') | (nation['N_REGIONKEY'] <= 3) & (nation['N_COMMENT'] == 'p')][['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME']].merge(customer[['C_NAME', 'C_NATIONKEY', 'C_PHONE', 'C_ADDRESS', 'C_CUSTKEY']].merge(nation[['N_REGIONKEY', 'N_NATIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_COMMENT'] != 't') & (supplier['S_ADDRESS'] != 'z')][['S_COMMENT']].merge(nation[['N_NAME', 'N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY']], left_on='S_SUPPKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

orders[['CLERK', 'TOTALPRICE', 'ORDERDATE', 'O_CUSTKEY', 'SHIPPRIORITY']].merge(customer[(customer['C_ADDRESS'] != 'B') & (customer['C_PHONE'].str.startswith('13-')) | (customer['C_ADDRESS'] != 'v')][['C_ADDRESS']].merge(nation, left_on='C_CUSTKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[['MKTSEGMENT']].merge(region[(region['R_NAME'].str.startswith('AFR')) & (region['R_REGIONKEY'] != 3) | (region['R_REGIONKEY'] == 3) | (region['R_REGIONKEY'] > 3)].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='C_CUSTKEY', right_on='R_REGIONKEY').merge(partsupp.merge(part[(part['P_PARTKEY'] <= 42)], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

orders[(orders['O_CUSTKEY'] > 22268)][['CLERK']].merge(partsupp[(partsupp['PS_PARTKEY'] == 21) & (partsupp['P_COMMENT'].str.startswith('g')) & (partsupp['AVAILQTY'] == 571) & (partsupp['AVAILQTY'] <= 5983)][['PS_SUPPKEY']].merge(lineitem[(lineitem['LINESTATUS'] == 'F')], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(customer[(customer['C_ACCTBAL'] <= 4339.429164147683) | (customer['C_CUSTKEY'] <= 44) & (customer['C_COMMENT'].str.startswith('e'))][['C_PHONE', 'MKTSEGMENT']], left_on='O_ORDERKEY', right_on='C_CUSTKEY').merge(part[(part['PT_COMMENT'].str.startswith('c')) & (part['BRAND'].isin(['Brand#21', 'Brand#55', 'Brand#24', 'Brand#15', 'Brand#25', 'Brand#41']))].merge(partsupp[['PS_PARTKEY', 'AVAILQTY', 'PS_SUPPKEY', 'P_COMMENT', 'SUPPLYCOST']], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['AVAILQTY', 'SUPPLYCOST']].merge(customer[(customer['MKTSEGMENT'] == 'AUTOMOBILE') & (customer['C_ACCTBAL'] <= 6975.671969984) & (customer['C_NAME'] == 'C') | (customer['C_NAME'].str.startswith('C'))][['C_NAME', 'C_COMMENT', 'C_NATIONKEY']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='C_CUSTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='P_PARTKEY').groupby(by=['CLERK']).agg('min', numeric_only=True)

region[(region['R_COMMENT'].str.startswith('u')) | (region['R_REGIONKEY'] != 0)][['R_REGIONKEY', 'R_NAME']].groupby(by=['R_NAME']).agg('sum', numeric_only=True)

part[(part['RETAILPRICE'] < 1053.6744177281923) | (part['TYPE'].str.startswith('STA'))].merge(partsupp[['SUPPLYCOST', 'P_COMMENT', 'PS_SUPPKEY', 'AVAILQTY', 'PS_PARTKEY']].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['SUPPLYCOST'] >= 630.437787061843) & (partsupp['PS_SUPPKEY'] != 5132) | (partsupp['PS_PARTKEY'] > 33) & (partsupp['PS_SUPPKEY'] < 3899)][['AVAILQTY', 'P_COMMENT', 'PS_PARTKEY']].merge(part[(part['TYPE'] != 'L')][['PT_COMMENT', 'RETAILPRICE', 'P_NAME']].merge(nation[(nation['N_COMMENT'].str.startswith('u')) | (nation['N_REGIONKEY'] == 0)], left_on='P_PARTKEY', right_on='N_NATIONKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[['L_PARTKEY', 'RETURNFLAG']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['BRAND', 'CONTAINER']).agg('count')

customer.merge(orders[(orders['CLERK'].str.startswith('C')) | (orders['ORDERSTATUS'] == 'O') & (orders['O_COMMENT'] == ' ') | (orders['ORDERSTATUS'] == 'F')], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_COMMENT'] == 's') & (nation['N_NAME'].str.startswith('R')) | (nation['N_COMMENT'].str.startswith('i')) | (nation['N_NAME'].str.startswith('M'))], left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_COMMENT', 'C_NAME']).agg('max', numeric_only=True)

supplier[(supplier['S_COMMENT'].str.startswith('v'))][['S_ACCTBAL']].groupby(by=['S_ACCTBAL']).agg('sum', numeric_only=True)

lineitem[(lineitem['L_COMMENT'].str.startswith('l')) & (lineitem['SHIPINSTRUCT'] == 'DELIVER IN PERSON') & (lineitem['DISCOUNT'] <= 0.03716019372161374) & (lineitem['COMMITDATE'] != '1998-10-16')].merge(orders.merge(lineitem[(lineitem['RECEIPTDATE'] >= '1992-05-02') & (lineitem['L_SUPPKEY'] < 3005)][['SHIPDATE', 'QUANTITY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').groupby(by=['EXTENDEDPRICE']).agg('count')

part[(part['TYPE'] != 'STA') & (part['P_PARTKEY'] < 174) & (part['MFGR'] == 'Manufacturer#3') | (part['CONTAINER'] == 'SM')].merge(partsupp[(partsupp['AVAILQTY'] >= 3782)][['SUPPLYCOST', 'AVAILQTY', 'PS_SUPPKEY', 'PS_PARTKEY']].merge(supplier.merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[(lineitem['EXTENDEDPRICE'] > 22988.15241944227)][['L_PARTKEY', 'L_ORDERKEY', 'EXTENDEDPRICE']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_PARTKEY'] <= 33) & (partsupp['PS_PARTKEY'] == 38)][['SUPPLYCOST', 'PS_SUPPKEY', 'PS_PARTKEY', 'P_COMMENT', 'AVAILQTY']].merge(lineitem[(lineitem['QUANTITY'] != 48) & (lineitem['SHIPINSTRUCT'].isin(['COLLECT COD', 'TAKE BACK RETURN', 'NONE'])) | (lineitem['L_PARTKEY'] <= 126915) | (lineitem['COMMITDATE'] >= '1998-10-16')], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier[(supplier['S_ACCTBAL'] >= 4611.414149393951) & (supplier['S_ACCTBAL'] == 2222.7835925547333) | (supplier['S_ACCTBAL'] > 1714.5595118058561) | (supplier['S_ADDRESS'] != 'B')].merge(nation[(nation['N_NAME'] == 'I') | (nation['N_COMMENT'] != 'r') & (nation['N_REGIONKEY'] == 2)], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

partsupp[(partsupp['P_COMMENT'].str.startswith(','))][['P_COMMENT', 'PS_PARTKEY']].merge(part[['BRAND', 'MFGR', 'SIZE', 'TYPE']].merge(orders[['O_ORDERKEY', 'ORDERSTATUS', 'O_COMMENT']].merge(lineitem[(lineitem['LINESTATUS'] == 'F') | (lineitem['L_SUPPKEY'] == 9021) & (lineitem['SHIPMODE'] != 'FOB')][['L_ORDERKEY', 'LINENUMBER', 'TAX', 'SHIPMODE', 'SHIPINSTRUCT']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='P_PARTKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[['P_PARTKEY', 'CONTAINER', 'MFGR', 'SIZE']].merge(partsupp[(partsupp['SUPPLYCOST'] <= 718.1698361796148) & (partsupp['PS_PARTKEY'] < 42) | (partsupp['PS_PARTKEY'] == 9) | (partsupp['SUPPLYCOST'] < 53.9432376535245)][['AVAILQTY', 'SUPPLYCOST', 'P_COMMENT', 'PS_PARTKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'].str.startswith('g')) & (partsupp['SUPPLYCOST'] <= 917.2819105544736) | (partsupp['SUPPLYCOST'] != 654.985469322008)][['P_COMMENT', 'AVAILQTY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY')

customer[(customer['C_PHONE'] == '22-') | (customer['C_NAME'].str.startswith('C'))][['C_NAME', 'C_ACCTBAL', 'MKTSEGMENT', 'C_COMMENT', 'C_NATIONKEY']].merge(nation[(nation['N_COMMENT'].str.startswith('c'))], left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['MKTSEGMENT']).agg('count')

customer[['MKTSEGMENT']].merge(supplier[(supplier['S_SUPPKEY'] == 124)], left_on='C_CUSTKEY', right_on='S_SUPPKEY').merge(partsupp.merge(supplier[(supplier['S_NATIONKEY'] > 14) & (supplier['S_ACCTBAL'] < 3491.9844735606184) | (supplier['S_NATIONKEY'] != 21) | (supplier['S_ACCTBAL'] > 9637.482366771996)][['S_COMMENT', 'S_NATIONKEY', 'S_NAME', 'S_ACCTBAL', 'S_SUPPKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[['S_PHONE', 'S_NATIONKEY', 'S_NAME', 'S_ACCTBAL', 'S_COMMENT']].merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(orders[(orders['SHIPPRIORITY'] > 0)].merge(customer[['C_NATIONKEY', 'C_ADDRESS', 'C_CUSTKEY', 'C_NAME', 'C_ACCTBAL']], left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem.merge(partsupp[['P_COMMENT', 'PS_PARTKEY', 'PS_SUPPKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_ORDERKEY')

region[(region['R_REGIONKEY'] != 3) | (region['R_NAME'] != 'M') & (region['R_NAME'].str.startswith('ASI'))].merge(nation[['N_REGIONKEY', 'N_NAME', 'N_COMMENT', 'N_NATIONKEY']].merge(region[(region['R_REGIONKEY'] < 1)], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[(supplier['S_ADDRESS'] != 'r') & (supplier['S_ADDRESS'] == 'e') & (supplier['S_ACCTBAL'] <= 7597.360465395349)][['S_NAME']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('max', numeric_only=True)

customer[(customer['C_PHONE'].str.startswith('3')) | (customer['C_NAME'] != 'C') | (customer['MKTSEGMENT'].isin(['HOUSEHOLD', 'AUTOMOBILE', 'FURNITURE']))].merge(orders[['O_COMMENT']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[['N_COMMENT', 'N_NAME']].merge(customer[(customer['C_CUSTKEY'] != 19)].merge(nation[(nation['N_COMMENT'] == 'n') | (nation['N_NAME'] != 'M')], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_CUSTKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(supplier[['S_PHONE', 'S_SUPPKEY', 'S_NAME', 'S_ADDRESS']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

supplier[(supplier['S_NAME'].str.startswith('S')) & (supplier['S_ADDRESS'] != 'h')].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp.merge(supplier[(supplier['S_SUPPKEY'] >= 120)].merge(partsupp[(partsupp['AVAILQTY'] != 1761) & (partsupp['P_COMMENT'] == ';') & (partsupp['AVAILQTY'] <= 1237)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['P_COMMENT'] != '.') | (partsupp['P_COMMENT'] != 'f') & (partsupp['PS_SUPPKEY'] != 4344)].merge(lineitem[['RECEIPTDATE', 'DISCOUNT', 'L_COMMENT', 'LINESTATUS', 'QUANTITY']].merge(region, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_COMMENT', 'S_NAME']).agg('sum', numeric_only=True)

nation

customer[(customer['C_CUSTKEY'] <= 12) & (customer['C_CUSTKEY'] == 89) & (customer['C_NAME'] == 'C')].merge(nation[['N_NATIONKEY', 'N_NAME', 'N_REGIONKEY', 'N_COMMENT']].merge(customer.merge(orders[(orders['SHIPPRIORITY'] == 0) | (orders['SHIPPRIORITY'] == 0) | (orders['TOTALPRICE'] == 193375.11842622238)], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_COMMENT'] != 'c') & (supplier['S_SUPPKEY'] < 181) & (supplier['S_ADDRESS'].str.startswith('x')) & (supplier['S_SUPPKEY'] < 43)][['S_PHONE', 'S_ADDRESS', 'S_SUPPKEY', 'S_ACCTBAL', 'S_NAME']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['MKTSEGMENT']).agg('max', numeric_only=True)

nation.merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_COMMENT'].str.startswith('u')) & (region['R_NAME'] == 'ASI') | (region['R_REGIONKEY'] < 2)].merge(nation[(nation['N_NATIONKEY'] != 18) & (nation['N_REGIONKEY'] < 0) | (nation['N_NAME'] == 'A')], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[(customer['C_PHONE'].str.startswith('22-')) | (customer['C_ADDRESS'].str.startswith('M')) | (customer['MKTSEGMENT'] != 'FURNITURE')][['C_PHONE', 'C_NAME', 'C_COMMENT', 'MKTSEGMENT', 'C_ADDRESS']].merge(supplier, left_on='C_CUSTKEY', right_on='S_SUPPKEY').merge(part[(part['MFGR'].isin(['Manufacturer#3', 'Manufacturer#2', 'Manufacturer#1', 'Manufacturer#4', 'Manufacturer#5'])) | (part['P_PARTKEY'] != 9) & (part['BRAND'].isin(['Brand#12', 'Brand#41', 'Brand#21', 'Brand#15', 'Brand#54', 'Brand#22', 'Brand#55', 'Brand#33', 'Brand#35', 'Brand#25', 'Brand#31', 'Brand#11', 'Brand#53', 'Brand#24', 'Brand#45', 'Brand#44', 'Brand#34', 'Brand#52', 'Brand#32', 'Brand#42', 'Brand#51']))][['P_NAME', 'TYPE']].merge(customer[['C_CUSTKEY', 'C_ACCTBAL', 'C_NATIONKEY', 'C_COMMENT', 'MKTSEGMENT']], left_on='P_PARTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='P_PARTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_NATIONKEY']).agg('min', numeric_only=True)

nation[(nation['N_NATIONKEY'] < 21) | (nation['N_NATIONKEY'] < 4) & (nation['N_NATIONKEY'] != 12) | (nation['N_REGIONKEY'] == 1)].merge(region[(region['R_NAME'].str.startswith('ASI')) & (region['R_NAME'].str.startswith('A'))].merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']].merge(customer[(customer['MKTSEGMENT'] == 'BUILDING') | (customer['C_NATIONKEY'] < 17)][['MKTSEGMENT', 'C_ADDRESS']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(region[(region['R_COMMENT'] == 'h') | (region['R_REGIONKEY'] == 3) | (region['R_COMMENT'] != 'l') | (region['R_REGIONKEY'] > 2)][['R_COMMENT', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY')

part[(part['P_PARTKEY'] < 123) | (part['BRAND'].isin(['Brand#13', 'Brand#55'])) | (part['PT_COMMENT'] == 's')].merge(partsupp[(partsupp['P_COMMENT'] == 'l')].merge(lineitem[['QUANTITY', 'COMMITDATE', 'L_ORDERKEY', 'TAX', 'SHIPMODE']].merge(orders[['ORDERDATE', 'O_COMMENT', 'CLERK', 'TOTALPRICE']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['SUPPLYCOST'] <= 669.4188960162616) & (partsupp['PS_SUPPKEY'] >= 5397) | (partsupp['P_COMMENT'] != ' ')], left_on='P_PARTKEY', right_on='PS_PARTKEY')

partsupp[(partsupp['AVAILQTY'] > 5573) & (partsupp['PS_SUPPKEY'] >= 5642)].merge(lineitem[(lineitem['L_SUPPKEY'] != 8710) & (lineitem['DISCOUNT'] != 0.0805244327959413)][['TAX', 'DISCOUNT', 'L_ORDERKEY', 'L_COMMENT', 'L_PARTKEY']].merge(orders[['O_ORDERKEY', 'ORDERPRIORITY']].merge(lineitem[['SHIPINSTRUCT', 'L_ORDERKEY', 'SHIPMODE', 'L_PARTKEY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier.merge(nation.merge(region[(region['R_COMMENT'] != 'u') & (region['R_REGIONKEY'] <= 0) & (region['R_COMMENT'] != 'l') | (region['R_NAME'] != 'M')][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['PS_PARTKEY', 'PS_SUPPKEY']).agg('count')

part[['MFGR', 'SIZE', 'TYPE', 'P_PARTKEY']].merge(partsupp[(partsupp['PS_SUPPKEY'] != 3695)][['SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT', 'PS_PARTKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY')

region[(region['R_REGIONKEY'] >= 2)].merge(nation[(nation['N_COMMENT'].str.startswith('o')) | (nation['N_NATIONKEY'] != 16)][['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(customer[(customer['C_COMMENT'] == 'k') & (customer['C_PHONE'].str.startswith('25-'))].merge(orders[(orders['O_CUSTKEY'] <= 131543) & (orders['O_COMMENT'] != 'i') & (orders['CLERK'] != 'C') & (orders['ORDERPRIORITY'] != '5-LOW')][['SHIPPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] > 4) | (nation['N_NATIONKEY'] >= 5)][['N_COMMENT', 'N_REGIONKEY', 'N_NAME', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT']).agg('sum', numeric_only=True)

supplier[(supplier['S_SUPPKEY'] < 80)][['S_PHONE', 'S_ACCTBAL', 'S_NAME']].merge(customer[(customer['MKTSEGMENT'].isin(['BUILDING', 'FURNITURE', 'AUTOMOBILE', 'HOUSEHOLD'])) & (customer['C_PHONE'] == '13-') | (customer['C_PHONE'] != '2') & (customer['C_CUSTKEY'] < 82)].merge(nation[(nation['N_NATIONKEY'] < 16) | (nation['N_COMMENT'] == 'u')], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT', 'N_NAME']].merge(supplier[(supplier['S_ACCTBAL'] > 4445.44919339907) | (supplier['S_NAME'] != 'S') & (supplier['S_PHONE'] == '26-')], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='S_SUPPKEY', right_on='C_CUSTKEY').merge(partsupp[(partsupp['AVAILQTY'] != 2340) | (partsupp['P_COMMENT'].str.startswith('c'))].merge(supplier[(supplier['S_PHONE'].str.startswith('26-')) | (supplier['S_PHONE'] != '17-')][['S_NAME', 'S_PHONE', 'S_NATIONKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(region[(region['R_REGIONKEY'] < 1)].merge(nation[['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='S_SUPPKEY', right_on='R_REGIONKEY')

part[['SIZE', 'MFGR', 'BRAND', 'CONTAINER']].groupby(by=['CONTAINER']).agg('count')

region[(region['R_NAME'] == 'A')].merge(nation[(nation['N_COMMENT'] == 'n') | (nation['N_NATIONKEY'] == 3)][['N_NATIONKEY', 'N_NAME', 'N_COMMENT', 'N_REGIONKEY']].merge(customer[(customer['MKTSEGMENT'].isin(['BUILDING', 'FURNITURE', 'AUTOMOBILE'])) & (customer['C_NAME'].str.startswith('C')) | (customer['C_ADDRESS'] == 'g') | (customer['C_ACCTBAL'] != 4654.90504427812)].merge(nation[(nation['N_NAME'] == 'J') | (nation['N_NATIONKEY'] <= 20) & (nation['N_NATIONKEY'] > 21) & (nation['N_NAME'] == 'A')][['N_NAME', 'N_COMMENT']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[(customer['C_CUSTKEY'] <= 49) & (customer['C_ADDRESS'] == 'E') | (customer['C_PHONE'].str.startswith('27-')) | (customer['C_ACCTBAL'] != 2284.6499622572214)][['C_PHONE']].merge(part[(part['P_PARTKEY'] <= 190) & (part['BRAND'].isin(['Brand#33', 'Brand#25', 'Brand#23', 'Brand#35', 'Brand#45', 'Brand#22', 'Brand#42', 'Brand#24', 'Brand#14', 'Brand#44', 'Brand#13', 'Brand#54', 'Brand#55', 'Brand#52', 'Brand#43', 'Brand#53', 'Brand#15', 'Brand#11', 'Brand#34'])) & (part['BRAND'] == 'Brand#35')], left_on='C_CUSTKEY', right_on='P_PARTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

supplier[(supplier['S_PHONE'] != '1') | (supplier['S_ADDRESS'] == '0') & (supplier['S_ACCTBAL'] != 8412.913892153349) & (supplier['S_ACCTBAL'] == 2481.4263070666657)].groupby(by=['S_COMMENT']).agg('min', numeric_only=True)

lineitem[['COMMITDATE', 'L_PARTKEY']].merge(partsupp[(partsupp['PS_SUPPKEY'] > 2404) | (partsupp['SUPPLYCOST'] <= 91.09338953269997)].merge(lineitem[['LINESTATUS', 'RECEIPTDATE', 'EXTENDEDPRICE']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] >= 2516) & (partsupp['PS_PARTKEY'] <= 1) | (partsupp['PS_PARTKEY'] == 26) | (partsupp['PS_SUPPKEY'] <= 330)][['PS_SUPPKEY', 'PS_PARTKEY', 'SUPPLYCOST', 'P_COMMENT']], left_on='L_PARTKEY', right_on='PS_PARTKEY')

partsupp.merge(lineitem[['LINENUMBER']].merge(supplier[(supplier['S_PHONE'].str.startswith('28-')) | (supplier['S_ACCTBAL'] == 5543.903825717924) & (supplier['S_NATIONKEY'] == 8) & (supplier['S_ADDRESS'] == 'Z')], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY').merge(orders[(orders['O_ORDERKEY'] > 526) | (orders['TOTALPRICE'] <= 254985.29295163826) | (orders['O_COMMENT'] == 's') & (orders['O_COMMENT'] != ' ')][['CLERK', 'O_ORDERKEY']].merge(lineitem[['RETURNFLAG', 'SHIPMODE', 'TAX']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').groupby(by=['PS_SUPPKEY', 'AVAILQTY']).agg('count')

partsupp[['AVAILQTY']].merge(supplier[['S_ACCTBAL', 'S_COMMENT', 'S_PHONE', 'S_NATIONKEY']].merge(nation[(nation['N_REGIONKEY'] == 3) & (nation['N_REGIONKEY'] != 3) | (nation['N_COMMENT'] != 'l') & (nation['N_COMMENT'] == 'n')][['N_NAME', 'N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='S_SUPPKEY').merge(nation[(nation['N_NAME'] == 'U')], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY').merge(lineitem[(lineitem['LINESTATUS'] != 'O') | (lineitem['RETURNFLAG'] != 'R') & (lineitem['LINESTATUS'] != 'O') & (lineitem['RETURNFLAG'] != 'A')][['L_SUPPKEY', 'SHIPDATE', 'DISCOUNT', 'COMMITDATE', 'LINESTATUS']].merge(partsupp[(partsupp['PS_SUPPKEY'] == 4327)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).groupby(by=['AVAILQTY']).agg('mean', numeric_only=True)

region[(region['R_REGIONKEY'] != 0)][['R_REGIONKEY']]

customer[['C_PHONE', 'C_ADDRESS', 'C_CUSTKEY', 'MKTSEGMENT', 'C_NAME']].merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders.merge(customer[(customer['C_PHONE'] == '25-')][['C_PHONE']].merge(lineitem, left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[['L_PARTKEY', 'RECEIPTDATE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

part[['CONTAINER', 'TYPE']].merge(customer[(customer['C_NATIONKEY'] == 12)], left_on='P_PARTKEY', right_on='C_CUSTKEY').merge(region[['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].merge(nation[(nation['N_NATIONKEY'] <= 1)], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NAME', 'N_NATIONKEY', 'N_COMMENT']].merge(supplier[(supplier['S_SUPPKEY'] == 171) & (supplier['S_NATIONKEY'] < 8) & (supplier['S_PHONE'] != '28-') | (supplier['S_ADDRESS'] != 'U')][['S_ACCTBAL', 'S_PHONE', 'S_COMMENT']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='P_PARTKEY', right_on='R_REGIONKEY')

part[(part['RETAILPRICE'] <= 1097.126512441929) | (part['P_PARTKEY'] == 124)][['P_PARTKEY', 'CONTAINER', 'TYPE', 'PT_COMMENT', 'MFGR']].groupby(by=['TYPE']).agg('mean', numeric_only=True)

partsupp[['SUPPLYCOST', 'AVAILQTY', 'PS_SUPPKEY', 'PS_PARTKEY', 'P_COMMENT']].merge(supplier[['S_SUPPKEY', 'S_PHONE', 'S_COMMENT']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[(supplier['S_PHONE'] != '17-') & (supplier['S_NAME'] == 'S') | (supplier['S_NATIONKEY'] <= 9) & (supplier['S_SUPPKEY'] >= 186)][['S_NAME', 'S_ADDRESS']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['PS_SUPPKEY']).agg('min', numeric_only=True)

region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation.merge(region[['R_COMMENT', 'R_REGIONKEY']].merge(nation[(nation['N_NAME'] != 'A')], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] != 'u') | (nation['N_COMMENT'] == 't') | (nation['N_COMMENT'] == 'l') & (nation['N_NATIONKEY'] < 5)].merge(region[(region['R_REGIONKEY'] > 2) | (region['R_REGIONKEY'] == 2) & (region['R_REGIONKEY'] != 1) | (region['R_NAME'] == 'AME')][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('sum', numeric_only=True)

supplier[(supplier['S_NAME'] != 'S') & (supplier['S_SUPPKEY'] > 195) | (supplier['S_ADDRESS'] == 'e') & (supplier['S_ADDRESS'] == '2')].merge(partsupp[(partsupp['AVAILQTY'] <= 5383) | (partsupp['AVAILQTY'] > 3459)].merge(supplier[(supplier['S_ACCTBAL'] == -29.305680514672872)][['S_COMMENT']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[['DISCOUNT']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

customer[(customer['C_NAME'].str.startswith('C')) & (customer['C_COMMENT'].str.startswith('o')) | (customer['C_PHONE'].str.startswith('1'))].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY')

supplier.merge(partsupp[(partsupp['SUPPLYCOST'] > 132.20027554412485) | (partsupp['AVAILQTY'] > 4330) | (partsupp['PS_PARTKEY'] <= 39) & (partsupp['AVAILQTY'] <= 1066)].merge(lineitem[(lineitem['RECEIPTDATE'] == '1998-11-06') & (lineitem['SHIPMODE'] != 'SHIP') | (lineitem['SHIPDATE'] > '1992-04-27') & (lineitem['COMMITDATE'] < '1992-05-15')][['L_ORDERKEY', 'SHIPDATE']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[['RETAILPRICE', 'P_NAME', 'CONTAINER']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

region[(region['R_REGIONKEY'] == 1) & (region['R_COMMENT'] != 'h') | (region['R_REGIONKEY'] != 1)][['R_REGIONKEY', 'R_COMMENT']].merge(nation[['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']].merge(customer[(customer['C_ADDRESS'].str.startswith('s')) & (customer['C_NAME'] != 'C') | (customer['C_CUSTKEY'] == 56) | (customer['C_PHONE'] != '25-')][['C_CUSTKEY', 'C_ADDRESS']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] <= 1) & (nation['N_NATIONKEY'] > 18)][['N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] == 'a') & (nation['N_NAME'].str.startswith('F'))][['N_REGIONKEY']].merge(region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

supplier[(supplier['S_ACCTBAL'] == 5851.470261118805) | (supplier['S_PHONE'].str.startswith('1')) & (supplier['S_ACCTBAL'] == 1271.8735308633125) | (supplier['S_SUPPKEY'] > 180)].merge(nation[(nation['N_REGIONKEY'] > 1)][['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT', 'N_NAME']].merge(customer[(customer['C_ADDRESS'] == 'E')], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

customer[['C_COMMENT', 'C_NAME', 'C_NATIONKEY', 'C_CUSTKEY']].merge(orders[['O_COMMENT', 'ORDERSTATUS', 'ORDERPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_COMMENT'] == 'r') & (nation['N_NAME'].str.startswith('K')) & (nation['N_REGIONKEY'] > 0) | (nation['N_NAME'] == 'S')].merge(supplier.merge(partsupp[['SUPPLYCOST', 'AVAILQTY', 'PS_SUPPKEY', 'P_COMMENT', 'PS_PARTKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[(region['R_COMMENT'].str.startswith('h')) | (region['R_NAME'] != 'ASI') & (region['R_REGIONKEY'] != 3)][['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[(orders['O_COMMENT'] != '.')][['ORDERDATE', 'O_ORDERKEY', 'ORDERSTATUS', 'O_COMMENT']].merge(lineitem[(lineitem['RETURNFLAG'] == 'N')][['EXTENDEDPRICE', 'SHIPDATE', 'RECEIPTDATE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['DISCOUNT'] != 0.0460292317755903) | (lineitem['TAX'] >= 0.029048542945571798) & (lineitem['RETURNFLAG'].isin(['R', 'A', 'N'])) & (lineitem['DISCOUNT'] < 0.07175907821080645)][['RETURNFLAG', 'SHIPMODE', 'L_PARTKEY', 'L_COMMENT', 'L_SUPPKEY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

supplier[(supplier['S_ACCTBAL'] > 1142.291716886549) | (supplier['S_ACCTBAL'] < -525.8119451524409)][['S_NAME', 'S_ACCTBAL', 'S_COMMENT', 'S_NATIONKEY', 'S_PHONE']].merge(nation[['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY']].merge(supplier[(supplier['S_NAME'].str.startswith('S')) & (supplier['S_SUPPKEY'] >= 54) & (supplier['S_NAME'].str.startswith('S'))][['S_NATIONKEY', 'S_ACCTBAL', 'S_SUPPKEY', 'S_COMMENT', 'S_NAME']], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[(customer['C_COMMENT'].str.startswith('u')) | (customer['C_PHONE'].str.startswith('25-')) & (customer['C_CUSTKEY'] != 16)], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NATIONKEY'] >= 14) | (nation['N_NAME'] != 'E') | (nation['N_NATIONKEY'] == 2) & (nation['N_REGIONKEY'] > 1)][['N_NAME', 'N_COMMENT', 'N_REGIONKEY']].merge(region[(region['R_NAME'] == 'AME') & (region['R_NAME'].str.startswith('A'))].merge(nation[['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_COMMENT'] == 'g') & (region['R_NAME'] == 'A') & (region['R_NAME'] != 'A')].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NATIONKEY'] > 19) | (nation['N_NATIONKEY'] <= 7)], left_on='S_NATIONKEY', right_on='N_NATIONKEY')

supplier[(supplier['S_PHONE'].str.startswith('2'))]

partsupp[(partsupp['AVAILQTY'] > 527) & (partsupp['P_COMMENT'] != 't') | (partsupp['P_COMMENT'].str.startswith('k'))].groupby(by=['P_COMMENT']).agg('mean', numeric_only=True)

lineitem[(lineitem['LINENUMBER'] < 4) & (lineitem['SHIPMODE'] != 'SHIP')][['RETURNFLAG', 'LINESTATUS', 'COMMITDATE', 'SHIPDATE', 'SHIPMODE']]

customer[(customer['C_NATIONKEY'] > 14) | (customer['C_COMMENT'].str.startswith('i')) | (customer['C_ACCTBAL'] < 9856.088739953346) & (customer['C_ACCTBAL'] == 652.7520324812597)].groupby(by=['C_ADDRESS', 'C_CUSTKEY']).agg('max', numeric_only=True)

orders[['TOTALPRICE', 'ORDERSTATUS', 'SHIPPRIORITY', 'CLERK']].merge(partsupp[['AVAILQTY']].merge(nation[(nation['N_COMMENT'].str.startswith('v')) & (nation['N_NAME'] != 'G')][['N_REGIONKEY', 'N_COMMENT', 'N_NAME', 'N_NATIONKEY']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(customer, left_on='O_ORDERKEY', right_on='C_CUSTKEY').merge(customer[(customer['MKTSEGMENT'] != 'MACHINERY')].merge(nation[['N_REGIONKEY', 'N_NAME']].merge(region[(region['R_NAME'] != 'M') | (region['R_NAME'] != 'A')], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NATIONKEY'] < 19) & (nation['N_NATIONKEY'] == 16) & (nation['N_COMMENT'].str.startswith('l'))].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='C_CUSTKEY').groupby(by=['SHIPPRIORITY', 'CLERK']).agg('min', numeric_only=True)

partsupp[(partsupp['SUPPLYCOST'] > 922.9920960514155) | (partsupp['P_COMMENT'].str.startswith('n')) | (partsupp['P_COMMENT'] == 'p')]

nation.merge(supplier[(supplier['S_SUPPKEY'] == 60)].merge(partsupp[(partsupp['PS_PARTKEY'] >= 24) & (partsupp['SUPPLYCOST'] <= 113.80192296008774)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_REGIONKEY']).agg('max', numeric_only=True)

orders.merge(lineitem.merge(partsupp[['PS_SUPPKEY', 'P_COMMENT', 'PS_PARTKEY', 'AVAILQTY']].merge(part[['BRAND', 'P_PARTKEY']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['RECEIPTDATE'] < '1998-11-06') & (lineitem['EXTENDEDPRICE'] < 29743.722095316094)], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem.merge(orders[(orders['TOTALPRICE'] > 204950.7268449903)], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders.merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['SHIPPRIORITY']).agg('mean', numeric_only=True)

partsupp.merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[['DISCOUNT', 'L_ORDERKEY']].merge(orders[(orders['TOTALPRICE'] == 249560.95651359123)][['ORDERSTATUS', 'O_COMMENT', 'ORDERDATE', 'O_ORDERKEY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').groupby(by=['PS_SUPPKEY', 'AVAILQTY']).agg('max', numeric_only=True)

supplier[(supplier['S_SUPPKEY'] != 115) & (supplier['S_SUPPKEY'] > 158) | (supplier['S_NATIONKEY'] == 0) | (supplier['S_NATIONKEY'] > 12)][['S_COMMENT', 'S_PHONE', 'S_NAME']]

customer[(customer['MKTSEGMENT'].isin(['FURNITURE', 'AUTOMOBILE', 'BUILDING', 'HOUSEHOLD', 'MACHINERY']))].merge(nation[['N_NATIONKEY', 'N_NAME', 'N_COMMENT']].merge(customer.merge(orders[(orders['TOTALPRICE'] < 261502.88684698884) & (orders['ORDERPRIORITY'] != '4-NOT SPECIFIED')][['O_ORDERKEY', 'TOTALPRICE', 'O_COMMENT', 'ORDERSTATUS']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[(customer['C_PHONE'] == '27-') & (customer['C_ACCTBAL'] <= 4335.614986149616) | (customer['C_ACCTBAL'] <= 6841.379502636002) & (customer['C_CUSTKEY'] > 6)].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[(orders['O_ORDERKEY'] != 552)].merge(lineitem[(lineitem['TAX'] > 0.02901648174018126) & (lineitem['SHIPDATE'] < '1992-04-27')][['COMMITDATE', 'RETURNFLAG', 'TAX', 'EXTENDEDPRICE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['DISCOUNT'] <= 0.04158023852799935)], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders.merge(lineitem.merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['SHIPINSTRUCT'] == 'COLLECT COD') | (lineitem['COMMITDATE'] >= '1998-10-16') | (lineitem['L_ORDERKEY'] != 4) & (lineitem['LINENUMBER'] == 3)], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

nation.groupby(by=['N_NAME']).agg('sum', numeric_only=True)

region.merge(nation[['N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']].merge(customer[['C_NATIONKEY', 'MKTSEGMENT', 'C_ACCTBAL', 'C_PHONE']].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_ACCTBAL'] <= 7844.01460027526)][['S_SUPPKEY', 'S_PHONE', 'S_ADDRESS', 'S_NATIONKEY', 'S_NAME']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] > 0) | (nation['N_REGIONKEY'] < 3) | (nation['N_REGIONKEY'] == 0)], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

customer[(customer['C_ACCTBAL'] != -59.850199121344644)].merge(nation[['N_REGIONKEY', 'N_NATIONKEY']].merge(supplier[(supplier['S_PHONE'] == '14-') & (supplier['S_NATIONKEY'] == 0) | (supplier['S_NATIONKEY'] < 9)].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[['S_NATIONKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_COMMENT', 'C_PHONE']).agg('sum', numeric_only=True)

supplier[(supplier['S_PHONE'] == '28-')]

part[(part['CONTAINER'].str.startswith('WRAP')) & (part['BRAND'] == 'Brand#51')][['SIZE']].merge(supplier, left_on='P_PARTKEY', right_on='S_SUPPKEY').merge(supplier[(supplier['S_PHONE'].str.startswith('2')) & (supplier['S_ADDRESS'] != 'Y') & (supplier['S_ACCTBAL'] == 9024.023072165674) & (supplier['S_ACCTBAL'] == 1870.260553317339)].merge(nation[(nation['N_NAME'].str.startswith('F'))][['N_NATIONKEY', 'N_NAME', 'N_REGIONKEY', 'N_COMMENT']].merge(supplier[(supplier['S_SUPPKEY'] < 29) & (supplier['S_NATIONKEY'] == 10)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='P_PARTKEY', right_on='S_SUPPKEY')

customer.merge(orders[['TOTALPRICE']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders.merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

region[(region['R_COMMENT'] == 'g') | (region['R_COMMENT'].str.startswith('u')) & (region['R_REGIONKEY'] > 0)][['R_REGIONKEY']].merge(nation[(nation['N_NAME'].str.startswith('A'))].merge(region[['R_NAME', 'R_REGIONKEY', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[(customer['C_PHONE'] == '2') & (customer['C_NAME'] == 'C') | (customer['C_NAME'].str.startswith('C'))], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

partsupp[(partsupp['P_COMMENT'].str.startswith('ly ')) & (partsupp['PS_PARTKEY'] >= 42) | (partsupp['PS_PARTKEY'] != 41)][['PS_SUPPKEY']].merge(supplier[['S_SUPPKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[(supplier['S_PHONE'] != '14-')][['S_PHONE', 'S_NAME']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['PS_SUPPKEY']).agg('sum', numeric_only=True)

part.merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(part[(part['MFGR'] == 'Manufacturer#5') & (part['SIZE'] != 17) & (part['P_PARTKEY'] != 23)][['BRAND', 'RETAILPRICE', 'CONTAINER', 'MFGR', 'TYPE']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

orders.merge(customer[(customer['C_ACCTBAL'] <= 9233.640047019406) & (customer['C_PHONE'] != '18-') & (customer['C_ACCTBAL'] > 2340.1613119437257) | (customer['C_PHONE'].str.startswith('18-'))][['C_PHONE', 'C_NATIONKEY', 'MKTSEGMENT', 'C_NAME']].merge(nation[(nation['N_REGIONKEY'] >= 1)][['N_REGIONKEY', 'N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[['C_ADDRESS', 'C_ACCTBAL', 'C_NATIONKEY', 'MKTSEGMENT', 'C_COMMENT']].merge(nation[(nation['N_NATIONKEY'] > 7) & (nation['N_NATIONKEY'] >= 4)], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NAME'] == 'I') & (nation['N_NATIONKEY'] <= 9)][['N_REGIONKEY', 'N_COMMENT', 'N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

partsupp[(partsupp['PS_SUPPKEY'] < 2314)][['P_COMMENT']].merge(lineitem[(lineitem['SHIPINSTRUCT'] == 'NONE')], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).groupby(by=['P_COMMENT']).agg('mean', numeric_only=True)

partsupp.merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY')

supplier[(supplier['S_SUPPKEY'] != 29) & (supplier['S_COMMENT'] == 'k')].groupby(by=['S_ADDRESS']).agg('sum', numeric_only=True)

supplier[(supplier['S_NAME'] == 'S') & (supplier['S_SUPPKEY'] < 164) | (supplier['S_COMMENT'].str.startswith('g'))][['S_COMMENT', 'S_ACCTBAL']].merge(lineitem[(lineitem['LINENUMBER'] > 4) & (lineitem['SHIPINSTRUCT'].isin(['DELIVER IN PERSON']))], left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(orders[['SHIPPRIORITY', 'CLERK', 'ORDERDATE', 'O_ORDERKEY']], left_on='S_SUPPKEY', right_on='O_ORDERKEY').merge(customer, left_on='S_SUPPKEY', right_on='C_CUSTKEY').groupby(by=['S_COMMENT', 'S_ACCTBAL']).agg('min', numeric_only=True)

region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_REGIONKEY'] == 3) & (nation['N_REGIONKEY'] <= 3) & (nation['N_NATIONKEY'] != 8) & (nation['N_COMMENT'] != 'y')].merge(region[(region['R_COMMENT'] != 'l') | (region['R_REGIONKEY'] != 1)][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[['R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME', 'R_REGIONKEY']).agg('min', numeric_only=True)

nation.merge(region[(region['R_COMMENT'].str.startswith('h')) & (region['R_NAME'].str.startswith('A')) & (region['R_COMMENT'] == 'l') & (region['R_COMMENT'] == 'u')].merge(nation[(nation['N_REGIONKEY'] < 0) | (nation['N_NATIONKEY'] != 7) | (nation['N_REGIONKEY'] <= 1)].merge(region[(region['R_REGIONKEY'] != 1) & (region['R_REGIONKEY'] == 2) & (region['R_REGIONKEY'] != 3)][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] == 'V') & (nation['N_NATIONKEY'] <= 9)][['N_REGIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_REGIONKEY', 'N_NAME']).agg('max', numeric_only=True)

nation[(nation['N_COMMENT'] == 'e')].merge(supplier[['S_NATIONKEY', 'S_NAME', 'S_SUPPKEY', 'S_PHONE', 'S_ACCTBAL']].merge(nation[['N_COMMENT', 'N_REGIONKEY', 'N_NAME', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY')

lineitem[['LINENUMBER']].merge(nation[(nation['N_NATIONKEY'] != 16)][['N_NAME', 'N_NATIONKEY']].merge(supplier.merge(partsupp[(partsupp['SUPPLYCOST'] >= 523.8551070427292) | (partsupp['PS_PARTKEY'] > 45) & (partsupp['AVAILQTY'] != 7501)][['PS_SUPPKEY', 'AVAILQTY', 'SUPPLYCOST', 'PS_PARTKEY', 'P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY').merge(customer, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY')

nation[(nation['N_NAME'] != 'I')][['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME', 'N_COMMENT']].merge(region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_NAME', 'N_NATIONKEY']).agg('mean', numeric_only=True)

customer[(customer['C_ADDRESS'].str.startswith('7')) | (customer['MKTSEGMENT'] == 'MACHINERY') & (customer['C_NAME'] == 'C') | (customer['C_ADDRESS'].str.startswith('M'))].merge(nation[(nation['N_REGIONKEY'] <= 0) | (nation['N_REGIONKEY'] <= 1) & (nation['N_NATIONKEY'] >= 17) | (nation['N_NAME'] == 'G')], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_REGIONKEY'] == 3) | (nation['N_NAME'].str.startswith('U')) | (nation['N_REGIONKEY'] < 3) & (nation['N_NAME'].str.startswith('P'))][['N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

orders[['O_COMMENT']]

lineitem.merge(orders[(orders['ORDERSTATUS'].isin(['P'])) | (orders['ORDERSTATUS'] == 'P')][['ORDERPRIORITY', 'ORDERDATE', 'SHIPPRIORITY', 'O_COMMENT']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[['P_COMMENT', 'PS_SUPPKEY', 'SUPPLYCOST']], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['AVAILQTY', 'PS_SUPPKEY', 'PS_PARTKEY', 'SUPPLYCOST', 'P_COMMENT']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY')

region[['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].merge(nation[['N_REGIONKEY', 'N_COMMENT', 'N_NAME']].merge(region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_REGIONKEY'] < 0) & (nation['N_REGIONKEY'] >= 3) & (nation['N_NAME'].str.startswith('B'))], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region.merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] == 'a') & (nation['N_NATIONKEY'] == 11) | (nation['N_NATIONKEY'] == 21) & (nation['N_NATIONKEY'] >= 11)][['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']].merge(supplier[(supplier['S_NAME'] != 'S')], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_COMMENT', 'N_NAME', 'N_REGIONKEY', 'N_NATIONKEY']].merge(supplier[(supplier['S_PHONE'] == '17-')], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT', 'R_NAME']).agg('count')

partsupp[(partsupp['P_COMMENT'] != 'r') | (partsupp['PS_PARTKEY'] > 49) | (partsupp['SUPPLYCOST'] >= 348.79124446450805) & (partsupp['AVAILQTY'] >= 6025)][['AVAILQTY', 'P_COMMENT', 'PS_SUPPKEY', 'PS_PARTKEY']].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['RETURNFLAG'] == 'N')][['SHIPMODE', 'RETURNFLAG', 'SHIPINSTRUCT', 'L_SUPPKEY']].merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['AVAILQTY'] > 3624) | (partsupp['AVAILQTY'] <= 1272) & (partsupp['AVAILQTY'] >= 1977) | (partsupp['SUPPLYCOST'] == 853.7841438897356)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier[(supplier['S_COMMENT'] == 'b') & (supplier['S_ACCTBAL'] >= -37.85795970023946)].merge(partsupp[(partsupp['PS_SUPPKEY'] <= 6902) | (partsupp['PS_SUPPKEY'] != 2911) & (partsupp['PS_SUPPKEY'] < 4654)].merge(lineitem[['RETURNFLAG', 'COMMITDATE', 'DISCOUNT', 'SHIPMODE']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[['N_REGIONKEY', 'N_COMMENT', 'N_NAME']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['AVAILQTY']).agg('min', numeric_only=True)

orders[(orders['O_COMMENT'] != 'd') | (orders['ORDERSTATUS'] == 'F') & (orders['SHIPPRIORITY'] != 0)].merge(lineitem[['SHIPDATE', 'SHIPINSTRUCT', 'QUANTITY', 'LINESTATUS']].merge(nation[(nation['N_COMMENT'].str.startswith('l')) & (nation['N_NATIONKEY'] >= 20)].merge(supplier[['S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[['SHIPINSTRUCT']].merge(nation[(nation['N_NAME'] == 'F') | (nation['N_REGIONKEY'] > 0) | (nation['N_REGIONKEY'] >= 2) & (nation['N_NATIONKEY'] == 22)], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY').merge(partsupp[(partsupp['SUPPLYCOST'] == 381.2498981790702) | (partsupp['P_COMMENT'] != 'j') & (partsupp['P_COMMENT'].str.startswith(' th'))][['P_COMMENT']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='O_ORDERKEY', right_on='L_ORDERKEY')

lineitem.merge(partsupp[(partsupp['AVAILQTY'] >= 51) | (partsupp['SUPPLYCOST'] > 910.8295864729532) & (partsupp['PS_PARTKEY'] == 8)].merge(lineitem[(lineitem['RECEIPTDATE'] <= '1998-11-06') | (lineitem['RECEIPTDATE'] != '1998-11-06') & (lineitem['L_COMMENT'] == 'y')][['DISCOUNT']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY')

supplier[(supplier['S_COMMENT'].str.startswith('w')) & (supplier['S_COMMENT'].str.startswith('g'))].merge(partsupp.merge(lineitem[(lineitem['SHIPDATE'] != '1992-04-27') & (lineitem['QUANTITY'] < 40)], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_NAME', 'S_PHONE']).agg('mean', numeric_only=True)

part[['P_NAME', 'CONTAINER', 'P_PARTKEY', 'PT_COMMENT']].merge(partsupp.merge(lineitem[['LINESTATUS', 'L_COMMENT', 'L_ORDERKEY', 'SHIPDATE']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['SUPPLYCOST']].merge(nation.merge(customer[['C_PHONE', 'C_NAME', 'C_COMMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] == 1216)].merge(supplier[['S_SUPPKEY', 'S_ADDRESS', 'S_COMMENT']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

orders.merge(lineitem[(lineitem['RECEIPTDATE'] >= '1998-11-06') & (lineitem['TAX'] == 0.03178964285857668) | (lineitem['L_COMMENT'] != 'n') | (lineitem['SHIPINSTRUCT'].isin(['NONE', 'TAKE BACK RETURN']))][['L_SUPPKEY', 'QUANTITY', 'EXTENDEDPRICE', 'SHIPMODE']].merge(partsupp[['P_COMMENT', 'PS_PARTKEY', 'AVAILQTY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY')

nation[['N_NAME', 'N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY']]

supplier[(supplier['S_NATIONKEY'] >= 20)][['S_SUPPKEY', 'S_NAME']]

region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']]

customer.merge(nation.merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['MKTSEGMENT']).agg('count')

customer.merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['ORDERPRIORITY'].isin(['3-MEDIUM'])) & (orders['O_COMMENT'] != 'the') & (orders['O_CUSTKEY'] == 25004)][['O_ORDERKEY', 'ORDERPRIORITY', 'ORDERSTATUS', 'CLERK', 'O_COMMENT']].merge(lineitem[['RECEIPTDATE', 'SHIPMODE']].merge(supplier, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['L_COMMENT'] == 'e') & (lineitem['SHIPMODE'] != 'FOB') & (lineitem['L_PARTKEY'] >= 128033)], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

region[(region['R_COMMENT'].str.startswith('h'))][['R_REGIONKEY']].merge(nation[(nation['N_NATIONKEY'] >= 6)][['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT']].merge(supplier[(supplier['S_ACCTBAL'] != 4113.563205008432)][['S_ADDRESS', 'S_NAME', 'S_NATIONKEY', 'S_ACCTBAL', 'S_COMMENT']].merge(nation[(nation['N_COMMENT'] == 'h') & (nation['N_COMMENT'] != ' ') | (nation['N_NATIONKEY'] != 3) | (nation['N_REGIONKEY'] <= 3)], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] == 20) & (nation['N_COMMENT'] != 'c')], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NATIONKEY']].merge(supplier[(supplier['S_NAME'] == 'S') & (supplier['S_COMMENT'].str.startswith('es ')) | (supplier['S_ADDRESS'].str.startswith('E')) & (supplier['S_SUPPKEY'] < 25)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('max', numeric_only=True)

partsupp[['PS_PARTKEY', 'PS_SUPPKEY', 'SUPPLYCOST', 'AVAILQTY']].merge(lineitem[(lineitem['RETURNFLAG'] != 'R') | (lineitem['SHIPMODE'] != 'FOB') | (lineitem['LINESTATUS'].isin(['F'])) & (lineitem['L_COMMENT'] == 'ly ')][['DISCOUNT', 'L_PARTKEY', 'LINESTATUS']].merge(partsupp[['PS_SUPPKEY', 'PS_PARTKEY', 'SUPPLYCOST', 'P_COMMENT', 'AVAILQTY']].merge(lineitem[(lineitem['EXTENDEDPRICE'] > 59734.658653456965)], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[(part['P_PARTKEY'] == 43) & (part['BRAND'] != 'Brand#35')], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(supplier[(supplier['S_ACCTBAL'] < 3220.015131834859) | (supplier['S_ACCTBAL'] > 5402.9261699703175) & (supplier['S_PHONE'] == '3') | (supplier['S_NAME'] != 'S')].merge(partsupp[['AVAILQTY', 'PS_PARTKEY', 'PS_SUPPKEY', 'P_COMMENT', 'SUPPLYCOST']].merge(part[['MFGR', 'P_PARTKEY']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['PS_SUPPKEY', 'SUPPLYCOST']).agg('count')

nation[(nation['N_COMMENT'] == 's') | (nation['N_REGIONKEY'] >= 3) & (nation['N_NAME'] == 'P')].merge(region[(region['R_COMMENT'].str.startswith('u'))], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation.merge(region[['R_REGIONKEY', 'R_COMMENT', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier.merge(nation[(nation['N_COMMENT'] != 'p') & (nation['N_REGIONKEY'] < 1) | (nation['N_NATIONKEY'] < 13)][['N_NATIONKEY', 'N_COMMENT', 'N_NAME']].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_NAME']).agg('count')

supplier.merge(partsupp.merge(lineitem[(lineitem['SHIPDATE'] > '1998-10-30')].merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_PHONE', 'S_NATIONKEY']).agg('min', numeric_only=True)

nation[(nation['N_NATIONKEY'] < 23) | (nation['N_COMMENT'].str.startswith('t'))].groupby(by=['N_NAME', 'N_REGIONKEY']).agg('mean', numeric_only=True)

nation

supplier[['S_COMMENT', 'S_SUPPKEY', 'S_NATIONKEY', 'S_NAME']].merge(partsupp[(partsupp['SUPPLYCOST'] == 87.63673301921493) & (partsupp['SUPPLYCOST'] < 657.989647610274)][['PS_SUPPKEY', 'P_COMMENT', 'SUPPLYCOST', 'AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp.merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_NATIONKEY'] >= 21) & (nation['N_REGIONKEY'] != 0) & (nation['N_NAME'].str.startswith('R')) | (nation['N_NAME'] == 'A')].merge(customer[(customer['C_CUSTKEY'] >= 83) | (customer['MKTSEGMENT'].isin(['AUTOMOBILE', 'MACHINERY'])) & (customer['C_CUSTKEY'] != 7)].merge(nation[['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY')

customer[(customer['C_ADDRESS'] == 'r')].merge(orders[(orders['CLERK'].str.startswith('C'))][['TOTALPRICE', 'ORDERPRIORITY', 'ORDERSTATUS']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders.merge(customer[['C_PHONE', 'C_NAME', 'C_CUSTKEY']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_NATIONKEY'] != 21) & (nation['N_COMMENT'].str.startswith('n')) & (nation['N_REGIONKEY'] <= 3) & (nation['N_COMMENT'].str.startswith('t'))][['N_COMMENT', 'N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']].merge(region[(region['R_REGIONKEY'] >= 2) | (region['R_REGIONKEY'] > 3) | (region['R_NAME'].str.startswith('A')) & (region['R_NAME'].str.startswith('AME'))], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

orders.merge(customer.merge(nation.merge(supplier[(supplier['S_COMMENT'] != ',') | (supplier['S_ADDRESS'] == 'B') & (supplier['S_SUPPKEY'] == 64) & (supplier['S_ADDRESS'] == 's')], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders.merge(lineitem[(lineitem['LINENUMBER'] <= 5) & (lineitem['SHIPINSTRUCT'].isin(['COLLECT COD', 'NONE', 'DELIVER IN PERSON', 'TAKE BACK RETURN'])) | (lineitem['COMMITDATE'] > '1998-10-16') | (lineitem['LINESTATUS'].isin(['F']))][['SHIPINSTRUCT', 'TAX']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[['C_NAME', 'C_CUSTKEY', 'C_NATIONKEY', 'C_ADDRESS']].merge(orders[(orders['O_ORDERKEY'] > 137) | (orders['O_CUSTKEY'] >= 24675)], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_COMMENT'] != 'l')].merge(region[(region['R_COMMENT'].str.startswith('l')) | (region['R_REGIONKEY'] < 3) & (region['R_COMMENT'].str.startswith('h'))][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[(lineitem['TAX'] >= 0.016369938381326908)], left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['ORDERDATE']).agg('max', numeric_only=True)

orders.merge(lineitem[['SHIPMODE', 'QUANTITY', 'L_ORDERKEY', 'L_COMMENT', 'DISCOUNT']].merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[['O_CUSTKEY', 'TOTALPRICE', 'O_COMMENT', 'ORDERSTATUS']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['EXTENDEDPRICE'] >= 3167.9822711679344) & (lineitem['L_COMMENT'] == 'lit') & (lineitem['RETURNFLAG'] != 'A')], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['RECEIPTDATE'] < '1992-05-02') & (lineitem['EXTENDEDPRICE'] > 12372.56688610115) & (lineitem['RETURNFLAG'] != 'N') | (lineitem['EXTENDEDPRICE'] > 83371.76285417259)], left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['ORDERPRIORITY', 'O_ORDERKEY']).agg('max', numeric_only=True)

customer[(customer['C_NATIONKEY'] != 10) | (customer['C_NATIONKEY'] > 13)][['C_NATIONKEY', 'C_CUSTKEY', 'MKTSEGMENT', 'C_ADDRESS']].merge(nation[(nation['N_COMMENT'] == 'y')][['N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NAME'].str.startswith('V')) | (nation['N_NAME'].str.startswith('V')) | (nation['N_REGIONKEY'] > 0) & (nation['N_NAME'] != 'V')].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY')

supplier.merge(partsupp[(partsupp['PS_SUPPKEY'] < 6344)].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] == 247)][['PS_SUPPKEY', 'P_COMMENT', 'SUPPLYCOST', 'PS_PARTKEY', 'AVAILQTY']].merge(supplier[(supplier['S_COMMENT'].str.startswith('d')) | (supplier['S_COMMENT'] != 'es ')].merge(partsupp[['SUPPLYCOST', 'PS_SUPPKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

part.groupby(by=['PT_COMMENT', 'SIZE']).agg('min', numeric_only=True)

partsupp.merge(lineitem.merge(partsupp[['PS_SUPPKEY', 'PS_PARTKEY', 'P_COMMENT', 'AVAILQTY', 'SUPPLYCOST']].merge(supplier[(supplier['S_NAME'] == 'S')][['S_PHONE', 'S_NATIONKEY', 'S_COMMENT', 'S_NAME']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').groupby(by=['PS_SUPPKEY']).agg('min', numeric_only=True)

supplier.merge(nation[['N_NAME']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(customer[(customer['C_NAME'].str.startswith('C'))][['MKTSEGMENT', 'C_COMMENT', 'C_CUSTKEY']].merge(orders[(orders['SHIPPRIORITY'] >= 0) | (orders['ORDERSTATUS'] == 'F')], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NATIONKEY'] <= 1) & (nation['N_NATIONKEY'] < 3) & (nation['N_NATIONKEY'] <= 23)], left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_SUPPKEY']).agg('count')

lineitem.merge(partsupp[['SUPPLYCOST', 'P_COMMENT', 'AVAILQTY', 'PS_SUPPKEY', 'PS_PARTKEY']].merge(part[(part['P_NAME'].str.startswith('b')) & (part['RETAILPRICE'] > 1050.5572352667286) & (part['PT_COMMENT'] == 'n') | (part['CONTAINER'] == 'SM')].merge(partsupp[(partsupp['P_COMMENT'] == 'd')], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY')

nation[(nation['N_NAME'].str.startswith('E')) & (nation['N_COMMENT'] == 'p') | (nation['N_REGIONKEY'] == 0)].merge(region[(region['R_COMMENT'] != 'u') | (region['R_COMMENT'] == 'g') | (region['R_NAME'] != 'A')].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region.merge(nation[(nation['N_NATIONKEY'] <= 2)].merge(region[(region['R_REGIONKEY'] > 3) & (region['R_REGIONKEY'] <= 1)], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_NAME'] != 'ASI')].merge(nation.merge(supplier[(supplier['S_ACCTBAL'] != 5241.789501689117) & (supplier['S_NAME'].str.startswith('S')) & (supplier['S_PHONE'] != '1') & (supplier['S_PHONE'] != '17-')], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(customer[['C_NATIONKEY', 'C_CUSTKEY', 'C_ADDRESS', 'C_PHONE', 'MKTSEGMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY')

nation.merge(customer.merge(nation[(nation['N_NATIONKEY'] == 16) | (nation['N_NAME'].str.startswith('M')) & (nation['N_NATIONKEY'] == 8) | (nation['N_NATIONKEY'] > 5)][['N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY', 'N_NAME']].merge(region[(region['R_REGIONKEY'] != 0) & (region['R_REGIONKEY'] <= 1)][['R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

lineitem[['L_PARTKEY', 'TAX']].merge(partsupp[(partsupp['PS_SUPPKEY'] >= 7123) & (partsupp['PS_PARTKEY'] > 45)][['PS_PARTKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY')

part.merge(partsupp[['P_COMMENT', 'PS_PARTKEY', 'PS_SUPPKEY', 'SUPPLYCOST', 'AVAILQTY']], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] < 2208)].merge(lineitem[(lineitem['LINESTATUS'] != 'F')], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[['SHIPMODE', 'LINESTATUS', 'L_COMMENT']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(lineitem[(lineitem['TAX'] != 0.06848909434237768) | (lineitem['LINENUMBER'] <= 2)], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['MFGR']).agg('min', numeric_only=True)

nation[['N_NATIONKEY', 'N_NAME', 'N_REGIONKEY', 'N_COMMENT']].merge(customer[(customer['C_COMMENT'].str.startswith('e')) | (customer['C_ADDRESS'].str.startswith('X')) | (customer['C_COMMENT'] == 'r') | (customer['C_ADDRESS'] != 'j')].merge(orders[['ORDERSTATUS', 'O_CUSTKEY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_REGIONKEY'] < 1) | (region['R_NAME'] == 'ASI') & (region['R_COMMENT'] != 'l')][['R_NAME']].merge(customer[(customer['C_CUSTKEY'] >= 53) | (customer['C_COMMENT'].str.startswith('o')) & (customer['C_PHONE'] == '22-')][['C_PHONE', 'C_NATIONKEY', 'C_ACCTBAL', 'C_CUSTKEY']].merge(nation[['N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY', 'N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='R_REGIONKEY', right_on='C_CUSTKEY').merge(nation[['N_NATIONKEY', 'N_NAME', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_NATIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY')

supplier[(supplier['S_ACCTBAL'] > -632.2447025364388) | (supplier['S_ADDRESS'] == '2') & (supplier['S_NAME'] == 'S')][['S_NATIONKEY', 'S_SUPPKEY', 'S_ADDRESS']].merge(nation[(nation['N_NATIONKEY'] < 14) | (nation['N_COMMENT'] == 'l') & (nation['N_NAME'].str.startswith('J')) | (nation['N_REGIONKEY'] < 2)][['N_COMMENT', 'N_REGIONKEY', 'N_NAME', 'N_NATIONKEY']].merge(region[['R_REGIONKEY', 'R_COMMENT', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_NAME'] != 'AFR') & (region['R_REGIONKEY'] < 1) | (region['R_COMMENT'] != 'h') & (region['R_COMMENT'] == 'l')][['R_COMMENT', 'R_NAME']].merge(orders[['O_CUSTKEY', 'O_ORDERKEY', 'ORDERSTATUS']], left_on='R_REGIONKEY', right_on='O_ORDERKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_NATIONKEY', 'S_SUPPKEY']).agg('max', numeric_only=True)

partsupp.merge(part[['PT_COMMENT', 'P_NAME', 'BRAND', 'MFGR', 'TYPE']].merge(lineitem[['L_PARTKEY']], left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(region[(region['R_NAME'] == 'AME')][['R_REGIONKEY']], left_on='P_PARTKEY', right_on='R_REGIONKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(supplier.merge(nation[['N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[['AVAILQTY', 'P_COMMENT', 'SUPPLYCOST']].merge(customer[(customer['C_PHONE'] != '18-') | (customer['C_NATIONKEY'] < 16)][['C_ACCTBAL', 'C_PHONE']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='C_CUSTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['PS_SUPPKEY']).agg('max', numeric_only=True)

customer[['MKTSEGMENT', 'C_COMMENT']].merge(part[(part['MFGR'] == 'Manufacturer#4')][['P_PARTKEY', 'PT_COMMENT']], left_on='C_CUSTKEY', right_on='P_PARTKEY').merge(nation[(nation['N_COMMENT'].str.startswith('e'))].merge(supplier[(supplier['S_NAME'].str.startswith('S')) & (supplier['S_COMMENT'] == ',') | (supplier['S_PHONE'] != '2') | (supplier['S_COMMENT'] != 'l')], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[['C_PHONE', 'C_ADDRESS', 'C_ACCTBAL', 'MKTSEGMENT', 'C_CUSTKEY']].merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_CUSTKEY', right_on='N_NATIONKEY').merge(lineitem[['L_SUPPKEY', 'SHIPMODE', 'DISCOUNT', 'TAX']].merge(partsupp[['AVAILQTY', 'P_COMMENT', 'PS_PARTKEY', 'PS_SUPPKEY', 'SUPPLYCOST']].merge(lineitem[['L_SUPPKEY', 'EXTENDEDPRICE', 'L_ORDERKEY']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).groupby(by=['MKTSEGMENT']).agg('min', numeric_only=True)

partsupp[['P_COMMENT', 'PS_SUPPKEY', 'AVAILQTY', 'PS_PARTKEY']].merge(part[(part['BRAND'].isin(['Brand#54']))][['P_PARTKEY']], left_on='PS_PARTKEY', right_on='P_PARTKEY')

part[(part['P_NAME'] != 's')][['CONTAINER', 'TYPE']].groupby(by=['CONTAINER', 'TYPE']).agg('max', numeric_only=True)

customer[(customer['C_ADDRESS'] == '0') & (customer['MKTSEGMENT'] == 'BUILDING') & (customer['C_COMMENT'] != ',') | (customer['C_CUSTKEY'] == 94)][['C_NATIONKEY', 'C_PHONE']].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_NATIONKEY']).agg('min', numeric_only=True)

orders[(orders['ORDERSTATUS'] != 'F')]

lineitem.groupby(by=['SHIPMODE', 'L_ORDERKEY']).agg('sum', numeric_only=True)

supplier[['S_PHONE', 'S_NATIONKEY', 'S_COMMENT', 'S_NAME', 'S_SUPPKEY']].merge(partsupp.merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_REGIONKEY'] == 3) & (nation['N_REGIONKEY'] != 0)][['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT', 'N_NAME']].merge(region[(region['R_NAME'].str.startswith('E')) & (region['R_REGIONKEY'] > 3)][['R_NAME']].merge(part, left_on='R_REGIONKEY', right_on='P_PARTKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY')

customer[['C_ACCTBAL', 'MKTSEGMENT', 'C_PHONE']].merge(part.merge(partsupp[(partsupp['PS_PARTKEY'] <= 8) | (partsupp['AVAILQTY'] <= 5033) & (partsupp['AVAILQTY'] <= 837)][['P_COMMENT', 'PS_PARTKEY', 'SUPPLYCOST']].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT', 'AVAILQTY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='C_CUSTKEY', right_on='P_PARTKEY').merge(region[(region['R_NAME'].str.startswith('E'))].merge(nation[['N_NATIONKEY', 'N_NAME', 'N_REGIONKEY', 'N_COMMENT']].merge(supplier[(supplier['S_NATIONKEY'] != 6) | (supplier['S_NATIONKEY'] <= 12) & (supplier['S_ACCTBAL'] <= 350.274541431726)][['S_NAME', 'S_SUPPKEY', 'S_COMMENT', 'S_PHONE', 'S_NATIONKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] <= 2) & (nation['N_REGIONKEY'] <= 3) | (nation['N_COMMENT'].str.startswith('n')) & (nation['N_NATIONKEY'] != 21)][['N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='C_CUSTKEY', right_on='R_REGIONKEY').merge(partsupp[(partsupp['SUPPLYCOST'] >= 503.1137230642491) & (partsupp['PS_SUPPKEY'] == 2818)][['PS_SUPPKEY', 'P_COMMENT', 'SUPPLYCOST', 'AVAILQTY', 'PS_PARTKEY']].merge(supplier[['S_SUPPKEY']].merge(partsupp[(partsupp['PS_PARTKEY'] <= 16)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).groupby(by=['MKTSEGMENT']).agg('sum', numeric_only=True)

partsupp

lineitem[(lineitem['EXTENDEDPRICE'] < 39402.272732110614) & (lineitem['L_COMMENT'].str.startswith('v')) | (lineitem['QUANTITY'] <= 44) | (lineitem['SHIPMODE'] == 'AIR')][['LINESTATUS', 'TAX', 'SHIPDATE']].merge(nation, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY').merge(customer[(customer['C_COMMENT'] == 'f') | (customer['C_COMMENT'] == 'h') | (customer['C_PHONE'].str.startswith('2')) | (customer['C_ACCTBAL'] == 2491.3977618427753)].merge(nation[['N_NAME', 'N_COMMENT', 'N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY').groupby(by=['TAX', 'LINESTATUS']).agg('mean', numeric_only=True)

customer[(customer['MKTSEGMENT'] == 'HOUSEHOLD')][['C_PHONE', 'C_CUSTKEY', 'C_NAME', 'C_NATIONKEY', 'C_ADDRESS']].merge(orders[['O_ORDERKEY', 'ORDERPRIORITY']].merge(lineitem[['L_SUPPKEY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_ADDRESS']).agg('count')

orders[(orders['ORDERDATE'] <= '1992-01-13')].merge(lineitem.merge(partsupp[(partsupp['P_COMMENT'] == 'n') | (partsupp['AVAILQTY'] != 6557) | (partsupp['P_COMMENT'] != 'j') | (partsupp['P_COMMENT'] != 'l')], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['AVAILQTY'] > 4541)], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['SHIPPRIORITY', 'CLERK']).agg('max', numeric_only=True)

region[(region['R_NAME'].str.startswith('A')) | (region['R_COMMENT'] != 'h') | (region['R_NAME'] != 'M') | (region['R_COMMENT'] != 'l')][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']]

partsupp[['P_COMMENT', 'PS_PARTKEY', 'SUPPLYCOST', 'AVAILQTY']].groupby(by=['PS_PARTKEY']).agg('max', numeric_only=True)

nation[(nation['N_REGIONKEY'] > 2)][['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']].merge(customer[(customer['C_NAME'] == 'C') & (customer['C_ADDRESS'] != 'U')][['C_PHONE', 'C_NAME', 'C_NATIONKEY', 'C_COMMENT', 'C_CUSTKEY']].merge(nation[['N_COMMENT']].merge(region, left_on='N_NATIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

orders[(orders['CLERK'] != 'C') | (orders['CLERK'] == 'C') & (orders['O_COMMENT'].str.startswith('the'))].merge(lineitem[(lineitem['EXTENDEDPRICE'] == 7173.526315365743) & (lineitem['RETURNFLAG'] == 'A')], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[['SHIPINSTRUCT', 'COMMITDATE', 'QUANTITY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_ADDRESS'].str.startswith('K')) & (customer['C_NATIONKEY'] <= 4) & (customer['MKTSEGMENT'] == 'HOUSEHOLD') & (customer['C_PHONE'].str.startswith('25-'))][['C_PHONE', 'C_ADDRESS', 'C_ACCTBAL']].merge(partsupp[(partsupp['PS_PARTKEY'] == 29) | (partsupp['AVAILQTY'] > 4963) | (partsupp['SUPPLYCOST'] == 243.7201569149365)][['PS_PARTKEY', 'SUPPLYCOST', 'P_COMMENT', 'PS_SUPPKEY', 'AVAILQTY']].merge(part[(part['MFGR'].isin(['Manufacturer#2', 'Manufacturer#4'])) | (part['P_NAME'].str.startswith('h')) & (part['CONTAINER'] == 'LG')][['MFGR', 'P_NAME', 'CONTAINER', 'RETAILPRICE', 'TYPE']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['CLERK']).agg('count')

region[(region['R_COMMENT'] != 'l') | (region['R_NAME'] != 'E')].merge(nation[(nation['N_COMMENT'] != 'e') | (nation['N_REGIONKEY'] >= 1) & (nation['N_REGIONKEY'] == 1) | (nation['N_REGIONKEY'] > 1)][['N_COMMENT', 'N_REGIONKEY', 'N_NAME', 'N_NATIONKEY']].merge(region[(region['R_NAME'] == 'AME') & (region['R_NAME'] == 'M') | (region['R_NAME'].str.startswith('E')) | (region['R_REGIONKEY'] <= 2)][['R_COMMENT', 'R_NAME']].merge(supplier[(supplier['S_SUPPKEY'] >= 91) | (supplier['S_ADDRESS'] != 'o') & (supplier['S_ACCTBAL'] == 7190.754609079004) | (supplier['S_COMMENT'] == 'al ')], left_on='R_REGIONKEY', right_on='S_SUPPKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer.merge(nation[(nation['N_NAME'] != 'M') | (nation['N_REGIONKEY'] > 1) & (nation['N_COMMENT'] != 'i')][['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] != 3) | (nation['N_NATIONKEY'] != 22)][['N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_NAME', 'N_COMMENT']].merge(customer[(customer['C_COMMENT'].str.startswith('c')) | (customer['C_ADDRESS'] == 'Y')][['C_ADDRESS', 'C_PHONE', 'C_COMMENT', 'C_NATIONKEY', 'C_CUSTKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_PHONE'] == '32-') & (supplier['S_COMMENT'].str.startswith('j')) | (supplier['S_NATIONKEY'] > 0)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

part[(part['PT_COMMENT'] == 'kag') & (part['P_PARTKEY'] < 178) | (part['MFGR'] != 'Manufacturer#5') | (part['MFGR'] != 'Manufacturer#5')][['PT_COMMENT', 'BRAND', 'MFGR', 'TYPE', 'SIZE']].merge(region[(region['R_NAME'].str.startswith('AME')) | (region['R_REGIONKEY'] <= 1) & (region['R_COMMENT'].str.startswith('u')) | (region['R_REGIONKEY'] > 0)][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation[(nation['N_COMMENT'] == 'e')][['N_COMMENT', 'N_NATIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='P_PARTKEY', right_on='R_REGIONKEY').merge(nation.merge(customer[['C_NATIONKEY', 'C_ACCTBAL']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='P_PARTKEY', right_on='N_NATIONKEY')

part[(part['SIZE'] >= 38) & (part['P_PARTKEY'] < 184) | (part['P_NAME'] != 'o') | (part['BRAND'] == 'Brand#12')][['TYPE', 'SIZE', 'P_NAME', 'RETAILPRICE']].merge(partsupp[(partsupp['SUPPLYCOST'] < 643.0698457005632) & (partsupp['PS_SUPPKEY'] <= 5265) & (partsupp['SUPPLYCOST'] > 101.76974956404895) | (partsupp['SUPPLYCOST'] < 821.6209487253703)][['PS_SUPPKEY', 'AVAILQTY', 'P_COMMENT', 'PS_PARTKEY', 'SUPPLYCOST']], left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(partsupp.merge(lineitem[(lineitem['SHIPMODE'] == 'FOB') & (lineitem['SHIPMODE'] == 'FOB') | (lineitem['L_ORDERKEY'] == 2)][['L_ORDERKEY', 'RETURNFLAG', 'L_COMMENT', 'COMMITDATE']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[['RECEIPTDATE']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).groupby(by=['RETAILPRICE', 'TYPE']).agg('sum', numeric_only=True)

lineitem[(lineitem['L_COMMENT'].str.startswith('e'))]

lineitem[(lineitem['RETURNFLAG'] == 'N') & (lineitem['RETURNFLAG'].isin(['N', 'R'])) | (lineitem['EXTENDEDPRICE'] == 67483.76034262162)][['RETURNFLAG']].merge(orders, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY').merge(part[['SIZE', 'PT_COMMENT', 'MFGR', 'TYPE', 'BRAND']].merge(supplier[(supplier['S_PHONE'].str.startswith('17-')) | (supplier['S_NATIONKEY'] == 7)][['S_ACCTBAL', 'S_NATIONKEY', 'S_SUPPKEY']].merge(nation[(nation['N_NAME'] != 'G') | (nation['N_NAME'] == 'J')][['N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='P_PARTKEY', right_on='S_SUPPKEY').merge(lineitem[['L_ORDERKEY', 'EXTENDEDPRICE', 'LINESTATUS', 'L_PARTKEY']], left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY').merge(region[(region['R_NAME'] != 'A') & (region['R_COMMENT'] == 'g') | (region['R_REGIONKEY'] > 1)][['R_REGIONKEY', 'R_NAME']].merge(nation[(nation['N_COMMENT'] != 'h') & (nation['N_NAME'].str.startswith('C')) | (nation['N_COMMENT'].str.startswith('a')) & (nation['N_COMMENT'] == 'h')].merge(supplier[(supplier['S_NATIONKEY'] > 3) & (supplier['S_ADDRESS'] != 'Y') & (supplier['S_ACCTBAL'] != 2766.9597677462634) | (supplier['S_SUPPKEY'] >= 32)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] > 1)], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY').groupby(by=['RETURNFLAG']).agg('max', numeric_only=True)

supplier[(supplier['S_ACCTBAL'] == 6461.669287959651) | (supplier['S_NAME'] == 'S') | (supplier['S_ADDRESS'].str.startswith('w')) & (supplier['S_SUPPKEY'] == 156)].groupby(by=['S_COMMENT']).agg('mean', numeric_only=True)

part[(part['PT_COMMENT'].str.startswith('l')) & (part['P_PARTKEY'] != 89) & (part['PT_COMMENT'].str.startswith('n')) | (part['BRAND'] != 'Brand#21')][['CONTAINER', 'TYPE', 'P_NAME', 'BRAND', 'RETAILPRICE']]

supplier.merge(partsupp[(partsupp['PS_PARTKEY'] > 8) | (partsupp['P_COMMENT'] != 'h')][['PS_SUPPKEY', 'AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_ACCTBAL', 'S_COMMENT']).agg('count')

customer[(customer['C_NAME'].str.startswith('C')) & (customer['C_COMMENT'] != 'q')][['MKTSEGMENT', 'C_CUSTKEY', 'C_COMMENT']].merge(orders.merge(lineitem[(lineitem['SHIPINSTRUCT'].isin(['NONE', 'TAKE BACK RETURN'])) | (lineitem['QUANTITY'] == 41) & (lineitem['L_PARTKEY'] == 30922) | (lineitem['COMMITDATE'] > '1992-05-15')][['L_SUPPKEY', 'TAX', 'SHIPINSTRUCT', 'LINESTATUS', 'RECEIPTDATE']].merge(partsupp[['P_COMMENT', 'PS_SUPPKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['CLERK'] != 'C')][['ORDERPRIORITY', 'CLERK', 'TOTALPRICE']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['CLERK'] == 'C') & (orders['TOTALPRICE'] == 111328.66503539956) & (orders['SHIPPRIORITY'] == 0) | (orders['O_ORDERKEY'] >= 100)][['SHIPPRIORITY', 'ORDERPRIORITY']].merge(supplier, left_on='O_ORDERKEY', right_on='S_SUPPKEY').merge(lineitem[['L_PARTKEY', 'RECEIPTDATE', 'L_SUPPKEY', 'LINENUMBER']], left_on='O_ORDERKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_CUSTKEY', 'MKTSEGMENT']).agg('sum', numeric_only=True)

lineitem.merge(orders[(orders['ORDERPRIORITY'] != '5-LOW') | (orders['ORDERPRIORITY'] != '4-NOT SPECIFIED')].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_COMMENT'] == 'c') & (customer['C_PHONE'] == '18-')].merge(nation[['N_NATIONKEY', 'N_NAME', 'N_REGIONKEY', 'N_COMMENT']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY')

part[['RETAILPRICE']]

lineitem[['L_ORDERKEY', 'RECEIPTDATE', 'L_SUPPKEY', 'SHIPMODE', 'L_PARTKEY']]

region[['R_NAME']].merge(partsupp[(partsupp['AVAILQTY'] == 1459)].merge(lineitem[(lineitem['L_COMMENT'].str.startswith('r'))], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['SHIPMODE'] == 'MAIL') & (lineitem['L_PARTKEY'] < 153919) | (lineitem['TAX'] != 0.025595352951135703) | (lineitem['RETURNFLAG'] != 'R')], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='R_REGIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(supplier[(supplier['S_NATIONKEY'] <= 3)].merge(nation[(nation['N_COMMENT'] != 'y') | (nation['N_COMMENT'] == 'u')][['N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='R_REGIONKEY', right_on='S_SUPPKEY').merge(part.merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['SUPPLYCOST']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='R_REGIONKEY', right_on='P_PARTKEY')

orders[(orders['ORDERPRIORITY'].isin(['4-NOT SPECIFIED', '1-URGENT', '3-MEDIUM', '5-LOW'])) | (orders['TOTALPRICE'] <= 294630.4774364777) & (orders['ORDERSTATUS'] != 'O') & (orders['ORDERSTATUS'] == 'O')]

nation[['N_COMMENT', 'N_NATIONKEY', 'N_NAME', 'N_REGIONKEY']].groupby(by=['N_REGIONKEY', 'N_COMMENT']).agg('count')

part[(part['RETAILPRICE'] == 1042.1401626239483) | (part['CONTAINER'] != 'LG')][['RETAILPRICE', 'TYPE', 'P_NAME']].merge(nation.merge(supplier[(supplier['S_ACCTBAL'] >= 6653.935672550994)][['S_ADDRESS', 'S_COMMENT', 'S_NATIONKEY', 'S_PHONE', 'S_NAME']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='P_PARTKEY', right_on='N_NATIONKEY').groupby(by=['TYPE']).agg('min', numeric_only=True)

lineitem[(lineitem['SHIPINSTRUCT'].isin(['NONE', 'DELIVER IN PERSON', 'COLLECT COD', 'TAKE BACK RETURN'])) | (lineitem['SHIPINSTRUCT'] == 'DELIVER IN PERSON') | (lineitem['QUANTITY'] > 47)][['L_PARTKEY']].merge(partsupp[['P_COMMENT', 'AVAILQTY']].merge(customer[['C_PHONE', 'C_ACCTBAL', 'C_NATIONKEY', 'MKTSEGMENT', 'C_COMMENT']].merge(nation[(nation['N_COMMENT'].str.startswith('l')) | (nation['N_REGIONKEY'] <= 2)][['N_REGIONKEY', 'N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='C_CUSTKEY').merge(part[['SIZE', 'CONTAINER', 'RETAILPRICE', 'TYPE']].merge(supplier[(supplier['S_ACCTBAL'] == 7649.966146576685) & (supplier['S_ADDRESS'].str.startswith('U')) | (supplier['S_NAME'] == 'S')], left_on='P_PARTKEY', right_on='S_SUPPKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY')

partsupp[(partsupp['P_COMMENT'] != 'j') | (partsupp['P_COMMENT'] == 'n') | (partsupp['AVAILQTY'] >= 2922) & (partsupp['P_COMMENT'].str.startswith('d'))].merge(lineitem.merge(partsupp.merge(supplier[(supplier['S_COMMENT'].str.startswith('!')) | (supplier['S_COMMENT'] != '!')][['S_NAME', 'S_PHONE', 'S_COMMENT', 'S_SUPPKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier[['S_NAME', 'S_COMMENT', 'S_ACCTBAL', 'S_ADDRESS']].merge(part[(part['P_NAME'] == 'bis') | (part['CONTAINER'] == 'SM') | (part['PT_COMMENT'].str.startswith('g'))][['SIZE', 'CONTAINER', 'RETAILPRICE', 'TYPE']].merge(region, left_on='P_PARTKEY', right_on='R_REGIONKEY'), left_on='S_SUPPKEY', right_on='P_PARTKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY')

orders[(orders['O_CUSTKEY'] >= 107710) & (orders['ORDERDATE'] > '1998-07-21') | (orders['ORDERDATE'] >= '1992-01-13')].merge(customer[(customer['C_ACCTBAL'] != 171.3707911481888) | (customer['C_ADDRESS'].str.startswith('u'))][['C_NATIONKEY', 'C_CUSTKEY', 'MKTSEGMENT', 'C_PHONE', 'C_ADDRESS']], left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[['L_PARTKEY', 'LINESTATUS', 'SHIPDATE', 'EXTENDEDPRICE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY')

nation.merge(customer.merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer.merge(nation.merge(customer[(customer['C_NAME'] == 'C') | (customer['C_NATIONKEY'] < 22) & (customer['C_ACCTBAL'] != 7639.834372615502)][['C_NAME', 'MKTSEGMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

customer.groupby(by=['C_ACCTBAL']).agg('count')

region.groupby(by=['R_REGIONKEY', 'R_NAME']).agg('count')

part[['SIZE']].groupby(by=['SIZE']).agg('mean', numeric_only=True)

supplier[['S_ACCTBAL', 'S_PHONE', 'S_SUPPKEY', 'S_ADDRESS', 'S_COMMENT']].merge(partsupp[['P_COMMENT', 'SUPPLYCOST', 'PS_SUPPKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_COMMENT']).agg('max', numeric_only=True)

partsupp[['PS_SUPPKEY', 'SUPPLYCOST', 'AVAILQTY', 'PS_PARTKEY']].merge(part[(part['PT_COMMENT'] == 'x') | (part['TYPE'] != 'S')][['P_PARTKEY', 'MFGR', 'TYPE', 'P_NAME', 'SIZE']].merge(partsupp[(partsupp['SUPPLYCOST'] == 378.35662532951886) & (partsupp['SUPPLYCOST'] >= 709.0360172591105)].merge(lineitem[['SHIPINSTRUCT', 'L_ORDERKEY']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'] == 'i') & (partsupp['PS_SUPPKEY'] < 1902) & (partsupp['PS_PARTKEY'] < 29) | (partsupp['PS_PARTKEY'] != 38)][['PS_PARTKEY', 'P_COMMENT', 'AVAILQTY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['TAX'] != 0.03801786530349435) | (lineitem['L_PARTKEY'] >= 20452) & (lineitem['L_ORDERKEY'] > 134)].merge(partsupp[['AVAILQTY', 'PS_SUPPKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_PARTKEY'] == 18) & (partsupp['PS_SUPPKEY'] == 4035)][['PS_SUPPKEY', 'P_COMMENT', 'AVAILQTY', 'SUPPLYCOST']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier[(supplier['S_NAME'].str.startswith('S')) & (supplier['S_COMMENT'] == 'bli') & (supplier['S_NATIONKEY'] <= 1)][['S_ADDRESS', 'S_ACCTBAL', 'S_NAME', 'S_NATIONKEY']].merge(nation[['N_REGIONKEY']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY')

supplier[(supplier['S_COMMENT'] == ' sl') | (supplier['S_SUPPKEY'] <= 76) & (supplier['S_NAME'] != 'S') | (supplier['S_NAME'].str.startswith('S'))].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['SUPPLYCOST'] >= 234.05663243313637) | (partsupp['P_COMMENT'].str.startswith('l'))][['PS_SUPPKEY', 'P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_ADDRESS', 'S_ACCTBAL']).agg('sum', numeric_only=True)

supplier[['S_COMMENT', 'S_NATIONKEY']].groupby(by=['S_NATIONKEY']).agg('count')

customer

partsupp[(partsupp['AVAILQTY'] != 6914) | (partsupp['PS_SUPPKEY'] < 3251)].merge(part[(part['P_NAME'] == 'i') & (part['SIZE'] != 26) | (part['TYPE'] == 'L') | (part['MFGR'].isin(['Manufacturer#1', 'Manufacturer#2', 'Manufacturer#5']))][['P_PARTKEY']].merge(partsupp.merge(part[(part['MFGR'] != 'Manufacturer#3') & (part['RETAILPRICE'] == 981.1617616843095)], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(supplier.merge(partsupp.merge(lineitem[(lineitem['DISCOUNT'] >= 0.06219962508821633) & (lineitem['COMMITDATE'] >= '1992-05-15') & (lineitem['L_ORDERKEY'] < 74)], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem.merge(partsupp[(partsupp['AVAILQTY'] > 3063)][['AVAILQTY', 'P_COMMENT', 'PS_SUPPKEY', 'PS_PARTKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(supplier[(supplier['S_COMMENT'] == 'al ') | (supplier['S_SUPPKEY'] >= 100)][['S_NAME', 'S_PHONE', 'S_NATIONKEY', 'S_COMMENT']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').groupby(by=['PS_PARTKEY']).agg('count')

nation[(nation['N_REGIONKEY'] >= 2)].merge(region[(region['R_REGIONKEY'] > 1) | (region['R_COMMENT'] == 'g') | (region['R_COMMENT'] != 'g') & (region['R_COMMENT'] == 'l')], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[['C_ADDRESS', 'C_PHONE', 'C_NAME', 'C_CUSTKEY', 'MKTSEGMENT']].merge(orders[(orders['SHIPPRIORITY'] < 0) & (orders['TOTALPRICE'] >= 22967.23024189922)][['SHIPPRIORITY', 'O_ORDERKEY']].merge(lineitem[['SHIPDATE', 'EXTENDEDPRICE', 'L_ORDERKEY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[(customer['C_ACCTBAL'] != 2522.056299054353) & (customer['C_ACCTBAL'] > 840.1326962878304) & (customer['MKTSEGMENT'] != 'FURNITURE')].merge(orders[(orders['ORDERPRIORITY'] != '2-HIGH')], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_NATIONKEY'] != 23) | (nation['N_NAME'] == 'B') & (nation['N_NAME'] == 'C') | (nation['N_REGIONKEY'] > 2)][['N_REGIONKEY']].merge(region[['R_COMMENT', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_NAME', 'N_COMMENT']).agg('count')

supplier[['S_PHONE', 'S_NAME']].merge(lineitem.merge(partsupp[(partsupp['PS_PARTKEY'] == 6) | (partsupp['AVAILQTY'] == 4887) & (partsupp['PS_PARTKEY'] < 35) & (partsupp['PS_PARTKEY'] >= 47)][['SUPPLYCOST', 'P_COMMENT', 'PS_SUPPKEY', 'PS_PARTKEY', 'AVAILQTY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(customer[(customer['C_CUSTKEY'] < 5) | (customer['C_ADDRESS'] == 'm')][['C_COMMENT', 'C_NAME', 'C_NATIONKEY', 'C_PHONE', 'MKTSEGMENT']].merge(nation[(nation['N_COMMENT'] != 'a') | (nation['N_NATIONKEY'] <= 21) & (nation['N_COMMENT'] == 'o') & (nation['N_NAME'] != 'B')][['N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='S_SUPPKEY', right_on='C_CUSTKEY').groupby(by=['S_PHONE', 'S_NAME']).agg('max', numeric_only=True)

part[['TYPE', 'P_PARTKEY']].merge(partsupp[(partsupp['PS_SUPPKEY'] != 4678) | (partsupp['SUPPLYCOST'] == 725.1180721969332)][['SUPPLYCOST']].merge(orders[(orders['ORDERSTATUS'].isin(['O', 'F', 'P']))].merge(customer[(customer['C_PHONE'] != '1')][['C_CUSTKEY']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='O_ORDERKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['SUPPLYCOST'] > 256.98062447471256)], left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['TYPE']).agg('sum', numeric_only=True)

region.merge(nation[(nation['N_NATIONKEY'] != 9) | (nation['N_NATIONKEY'] != 22) | (nation['N_NATIONKEY'] != 13)][['N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY', 'N_NAME']].merge(region.merge(nation[(nation['N_COMMENT'].str.startswith('p')) & (nation['N_NAME'] != 'S') | (nation['N_NATIONKEY'] <= 23) | (nation['N_REGIONKEY'] < 0)], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer.merge(orders[(orders['O_ORDERKEY'] == 675) | (orders['CLERK'] != 'C')][['CLERK', 'ORDERDATE', 'O_COMMENT', 'O_CUSTKEY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] != 8) | (nation['N_NATIONKEY'] == 15) & (nation['N_NATIONKEY'] >= 16) & (nation['N_NAME'] == 'M')].merge(supplier[(supplier['S_NAME'].str.startswith('S'))][['S_NATIONKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY', 'R_COMMENT']).agg('mean', numeric_only=True)

lineitem[['L_COMMENT']].merge(part[['P_PARTKEY', 'TYPE', 'PT_COMMENT']].merge(partsupp[['PS_PARTKEY', 'PS_SUPPKEY', 'AVAILQTY', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY').merge(customer[(customer['C_ADDRESS'].str.startswith('M')) | (customer['C_PHONE'] == '27-') | (customer['C_NAME'].str.startswith('C'))], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY').merge(region[(region['R_COMMENT'].str.startswith('l'))][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY').groupby(by=['L_COMMENT']).agg('sum', numeric_only=True)

orders[(orders['O_COMMENT'] != 'egu') | (orders['TOTALPRICE'] < 9619.165308616783) | (orders['SHIPPRIORITY'] >= 0) | (orders['SHIPPRIORITY'] <= 0)][['CLERK', 'ORDERSTATUS', 'SHIPPRIORITY', 'ORDERPRIORITY', 'ORDERDATE']].groupby(by=['ORDERSTATUS', 'SHIPPRIORITY']).agg('max', numeric_only=True)

orders[['O_COMMENT', 'O_ORDERKEY', 'ORDERSTATUS', 'O_CUSTKEY']]

partsupp[(partsupp['PS_PARTKEY'] == 36) | (partsupp['PS_PARTKEY'] != 36) | (partsupp['PS_PARTKEY'] >= 47) & (partsupp['P_COMMENT'] != 'd')].merge(part[['TYPE', 'RETAILPRICE', 'BRAND', 'CONTAINER']], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[['P_NAME', 'BRAND', 'PT_COMMENT', 'P_PARTKEY']].merge(partsupp[(partsupp['AVAILQTY'] == 3855) | (partsupp['P_COMMENT'] == 'y') & (partsupp['PS_SUPPKEY'] != 1436) | (partsupp['AVAILQTY'] >= 4039)][['AVAILQTY', 'SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT', 'PS_PARTKEY']].merge(supplier[['S_ACCTBAL']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'] != 's') | (partsupp['PS_SUPPKEY'] < 3893) | (partsupp['P_COMMENT'] == 'h') | (partsupp['PS_PARTKEY'] >= 2)].merge(supplier[(supplier['S_ADDRESS'] == 'r') | (supplier['S_PHONE'] != '32-') & (supplier['S_ADDRESS'] != 'g') | (supplier['S_NAME'] != 'S')][['S_ADDRESS', 'S_COMMENT', 'S_NATIONKEY', 'S_ACCTBAL']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY')

customer[['C_ACCTBAL', 'MKTSEGMENT', 'C_NAME', 'C_COMMENT']].merge(orders[(orders['O_ORDERKEY'] != 381) | (orders['ORDERDATE'] != '1992-01-13') & (orders['TOTALPRICE'] != 247843.39805098667) & (orders['O_COMMENT'] == 'uri')][['CLERK']].merge(partsupp.merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='C_CUSTKEY', right_on='O_ORDERKEY').merge(part[['SIZE', 'TYPE', 'P_PARTKEY']].merge(partsupp.merge(supplier[(supplier['S_SUPPKEY'] < 43) & (supplier['S_ACCTBAL'] >= 8919.844468444548) & (supplier['S_SUPPKEY'] > 109) & (supplier['S_PHONE'].str.startswith('1'))], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='C_CUSTKEY', right_on='P_PARTKEY').groupby(by=['C_NAME']).agg('count')

nation[['N_NAME', 'N_COMMENT', 'N_NATIONKEY']].merge(customer.merge(nation.merge(customer[(customer['C_ACCTBAL'] <= 5091.541387900586) | (customer['C_PHONE'] == '25-') & (customer['C_COMMENT'] != 'y') | (customer['C_NATIONKEY'] >= 14)], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_ACCTBAL'] < 4859.71057363771) & (supplier['S_NATIONKEY'] > 9) | (supplier['S_ADDRESS'] == 'b') | (supplier['S_NAME'] != 'S')], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[(supplier['S_NAME'] == 'S') & (supplier['S_SUPPKEY'] == 177) & (supplier['S_ADDRESS'] == ',')][['S_NATIONKEY', 'S_NAME', 'S_ACCTBAL', 'S_SUPPKEY', 'S_COMMENT']].merge(partsupp[(partsupp['PS_PARTKEY'] > 47) & (partsupp['PS_PARTKEY'] < 1) & (partsupp['AVAILQTY'] == 4252)].merge(lineitem[(lineitem['COMMITDATE'] >= '1992-05-15') | (lineitem['RETURNFLAG'] != 'A') | (lineitem['RETURNFLAG'].isin(['R', 'N']))], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_NAME']).agg('sum', numeric_only=True)

orders[['ORDERDATE']].merge(lineitem[(lineitem['SHIPDATE'] >= '1992-04-27')], left_on='O_ORDERKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'])

customer[(customer['MKTSEGMENT'].isin(['MACHINERY', 'AUTOMOBILE'])) & (customer['C_ADDRESS'] == 'B')].merge(nation.merge(customer[(customer['C_ACCTBAL'] <= 4536.803463565287) | (customer['C_CUSTKEY'] >= 73) & (customer['C_ADDRESS'] == 'M')].merge(nation[(nation['N_COMMENT'] != 'i') | (nation['N_NAME'] != 'G') | (nation['N_COMMENT'] == 'c') | (nation['N_REGIONKEY'] <= 1)], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer.merge(orders[(orders['TOTALPRICE'] <= 268603.37839507224) | (orders['SHIPPRIORITY'] != 0)], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_COMMENT', 'N_NAME', 'N_REGIONKEY', 'N_NATIONKEY']].merge(region[(region['R_REGIONKEY'] < 0) & (region['R_COMMENT'].str.startswith('l')) | (region['R_COMMENT'] != 'g')].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_COMMENT', 'N_REGIONKEY']].merge(region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_NAME'] == 'M') & (nation['N_COMMENT'] == 'u') | (nation['N_COMMENT'].str.startswith('i'))][['N_REGIONKEY', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

part[(part['PT_COMMENT'] == 'e')][['TYPE']].merge(orders[['SHIPPRIORITY', 'TOTALPRICE', 'ORDERDATE', 'CLERK']].merge(nation[(nation['N_COMMENT'].str.startswith(' ')) & (nation['N_REGIONKEY'] != 3)][['N_NATIONKEY', 'N_REGIONKEY']], left_on='O_ORDERKEY', right_on='N_NATIONKEY'), left_on='P_PARTKEY', right_on='O_ORDERKEY').merge(lineitem[(lineitem['RECEIPTDATE'] > '1992-05-02')][['SHIPMODE', 'L_PARTKEY']].merge(partsupp.merge(lineitem[(lineitem['SHIPMODE'] != 'FOB') | (lineitem['RECEIPTDATE'] != '1992-05-02') | (lineitem['L_PARTKEY'] <= 143951) & (lineitem['L_PARTKEY'] >= 104750)], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['P_COMMENT', 'AVAILQTY', 'PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'])

supplier.merge(nation[['N_COMMENT', 'N_NAME', 'N_NATIONKEY']].merge(customer[(customer['C_COMMENT'] != 'a') & (customer['C_PHONE'] == '22-') & (customer['C_CUSTKEY'] != 15) | (customer['C_ACCTBAL'] <= 6519.948953062015)][['C_PHONE', 'C_ADDRESS', 'MKTSEGMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] < 3829) & (partsupp['AVAILQTY'] > 644) & (partsupp['PS_SUPPKEY'] == 3565) | (partsupp['P_COMMENT'] != 'g')][['P_COMMENT', 'PS_SUPPKEY', 'PS_PARTKEY', 'AVAILQTY']].merge(part[(part['BRAND'] != 'Brand#13') & (part['P_PARTKEY'] >= 14) | (part['TYPE'] != 'STA') | (part['TYPE'] == 'L')][['BRAND', 'PT_COMMENT', 'P_PARTKEY', 'CONTAINER']].merge(partsupp[(partsupp['P_COMMENT'] != 'i')][['P_COMMENT', 'PS_PARTKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

lineitem[(lineitem['COMMITDATE'] == '1998-10-16') & (lineitem['EXTENDEDPRICE'] == 30225.481001060478) | (lineitem['SHIPDATE'] != '1998-10-30')].merge(orders[(orders['O_COMMENT'].str.startswith('x'))][['CLERK']].merge(supplier[(supplier['S_ADDRESS'] == 'o')][['S_COMMENT', 'S_ADDRESS', 'S_SUPPKEY', 'S_PHONE', 'S_NATIONKEY']].merge(nation[(nation['N_COMMENT'] == 'i')], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='S_SUPPKEY').merge(nation.merge(region[(region['R_COMMENT'] == 'h')][['R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='O_ORDERKEY', right_on='N_NATIONKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY')

orders[(orders['ORDERSTATUS'].isin(['O', 'P', 'F'])) | (orders['CLERK'] == 'C')].merge(customer[(customer['C_ADDRESS'].str.startswith('6'))], left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['ORDERPRIORITY']).agg('max', numeric_only=True)

part[(part['P_PARTKEY'] > 119)].groupby(by=['PT_COMMENT']).agg('mean', numeric_only=True)

part.merge(partsupp[['PS_PARTKEY', 'PS_SUPPKEY', 'P_COMMENT']].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'].str.startswith('n')) | (partsupp['PS_PARTKEY'] < 24) | (partsupp['SUPPLYCOST'] != 972.6606627832502) & (partsupp['AVAILQTY'] <= 7646)][['P_COMMENT', 'PS_PARTKEY', 'SUPPLYCOST', 'AVAILQTY', 'PS_SUPPKEY']].merge(part[['MFGR', 'BRAND']].merge(nation[(nation['N_NAME'].str.startswith('J')) & (nation['N_COMMENT'] == 'y') | (nation['N_REGIONKEY'] > 2) | (nation['N_REGIONKEY'] <= 1)][['N_NATIONKEY']], left_on='P_PARTKEY', right_on='N_NATIONKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(supplier[['S_PHONE', 'S_SUPPKEY', 'S_COMMENT', 'S_ACCTBAL']].merge(partsupp[['SUPPLYCOST', 'PS_PARTKEY', 'AVAILQTY', 'P_COMMENT', 'PS_SUPPKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(lineitem[['SHIPDATE', 'LINENUMBER', 'SHIPMODE', 'QUANTITY', 'LINESTATUS']].merge(supplier[(supplier['S_ADDRESS'] == 'y') & (supplier['S_NAME'] != 'S') | (supplier['S_NATIONKEY'] <= 2) & (supplier['S_ACCTBAL'] == 1710.3430644075554)], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[['P_NAME', 'MFGR', 'CONTAINER', 'BRAND']].merge(partsupp[(partsupp['PS_PARTKEY'] != 40) & (partsupp['AVAILQTY'] == 5828)], left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

nation

partsupp.merge(part[['SIZE']].merge(lineitem[(lineitem['SHIPINSTRUCT'] != 'TAKE BACK RETURN') | (lineitem['RECEIPTDATE'] != '1998-11-06')][['EXTENDEDPRICE', 'L_PARTKEY', 'SHIPINSTRUCT', 'L_ORDERKEY']].merge(orders[(orders['ORDERPRIORITY'] != '5-LOW')], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(customer[(customer['C_NAME'].str.startswith('C')) | (customer['C_COMMENT'] != 'o') & (customer['C_CUSTKEY'] > 64) & (customer['C_CUSTKEY'] >= 92)].merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='P_PARTKEY', right_on='C_CUSTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY')

region[['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] != 0)], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] <= 1) & (nation['N_COMMENT'].str.startswith('p'))][['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT', 'N_NAME']].merge(customer[['MKTSEGMENT', 'C_ACCTBAL', 'C_NAME', 'C_ADDRESS']].merge(supplier[(supplier['S_SUPPKEY'] <= 18) | (supplier['S_NAME'].str.startswith('S'))], left_on='C_CUSTKEY', right_on='S_SUPPKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_REGIONKEY'] == 3) | (region['R_REGIONKEY'] != 3) & (region['R_REGIONKEY'] == 3)][['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation[(nation['N_REGIONKEY'] > 0) & (nation['N_REGIONKEY'] < 0)][['N_REGIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME', 'R_COMMENT']).agg('sum', numeric_only=True)

supplier[(supplier['S_PHONE'] != '14-')][['S_NAME', 'S_ACCTBAL', 'S_COMMENT']]

supplier[['S_NATIONKEY']].groupby(by=['S_NATIONKEY']).agg('count')

partsupp[(partsupp['P_COMMENT'].str.startswith('h')) | (partsupp['AVAILQTY'] < 5281)][['AVAILQTY', 'P_COMMENT', 'PS_PARTKEY']].merge(part[(part['P_PARTKEY'] >= 19) | (part['BRAND'] != 'Brand#52') & (part['SIZE'] >= 38) | (part['PT_COMMENT'] != 'm')][['PT_COMMENT', 'SIZE', 'P_PARTKEY', 'P_NAME']].merge(partsupp[(partsupp['SUPPLYCOST'] < 189.4792053363314)][['AVAILQTY', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] < 7080) & (partsupp['AVAILQTY'] == 4037)], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[['P_NAME', 'P_PARTKEY']].merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_SUPPKEY', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['AVAILQTY']).agg('sum', numeric_only=True)

supplier[(supplier['S_NAME'] == 'S')].merge(partsupp[(partsupp['PS_SUPPKEY'] <= 4666) & (partsupp['PS_SUPPKEY'] >= 4547) | (partsupp['PS_PARTKEY'] <= 30)][['PS_SUPPKEY', 'P_COMMENT', 'AVAILQTY', 'SUPPLYCOST', 'PS_PARTKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_ACCTBAL', 'S_COMMENT']).agg('sum', numeric_only=True)

nation

orders[(orders['ORDERDATE'] <= '1992-01-13') | (orders['SHIPPRIORITY'] == 0) | (orders['ORDERDATE'] <= '1998-07-21') | (orders['ORDERSTATUS'] != 'F')][['SHIPPRIORITY', 'ORDERDATE', 'ORDERPRIORITY']].merge(partsupp[(partsupp['PS_PARTKEY'] <= 30)][['P_COMMENT', 'PS_SUPPKEY', 'PS_PARTKEY', 'SUPPLYCOST', 'AVAILQTY']].merge(supplier[['S_NAME']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier.merge(partsupp[(partsupp['AVAILQTY'] >= 5753) | (partsupp['SUPPLYCOST'] >= 51.71319649210246) | (partsupp['PS_PARTKEY'] < 25) | (partsupp['SUPPLYCOST'] == 889.5155851422694)][['AVAILQTY', 'PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(customer[['MKTSEGMENT', 'C_ADDRESS', 'C_PHONE']].merge(part, left_on='C_CUSTKEY', right_on='P_PARTKEY'), left_on='O_ORDERKEY', right_on='C_CUSTKEY')

supplier.merge(nation[(nation['N_REGIONKEY'] > 3) | (nation['N_COMMENT'] == 'n') | (nation['N_NAME'].str.startswith('B'))][['N_REGIONKEY', 'N_NAME', 'N_NATIONKEY', 'N_COMMENT']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY', 'N_NAME']].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['PS_PARTKEY'] != 7)][['AVAILQTY', 'PS_SUPPKEY', 'P_COMMENT', 'SUPPLYCOST']].merge(supplier[['S_NAME', 'S_ACCTBAL', 'S_PHONE']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

nation[(nation['N_COMMENT'] != 's') & (nation['N_REGIONKEY'] > 0) | (nation['N_NATIONKEY'] > 22) & (nation['N_NAME'] == 'C')][['N_NAME', 'N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']].merge(customer[(customer['C_ADDRESS'] != 'S') | (customer['C_ADDRESS'] != '3') & (customer['C_PHONE'] != '3') & (customer['C_NAME'] != 'C')].merge(orders[(orders['O_CUSTKEY'] <= 147088) | (orders['O_COMMENT'] != 's') | (orders['TOTALPRICE'] < 164447.46245291986)], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['ORDERPRIORITY'] != '2-HIGH') & (orders['ORDERSTATUS'].isin(['F'])) | (orders['ORDERPRIORITY'].isin(['4-NOT SPECIFIED', '3-MEDIUM', '1-URGENT', '2-HIGH', '5-LOW'])) | (orders['O_CUSTKEY'] < 20142)].merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer.merge(orders[(orders['ORDERSTATUS'] != 'O')], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders.merge(lineitem[(lineitem['RECEIPTDATE'] != '1998-11-06') | (lineitem['LINENUMBER'] == 3) | (lineitem['SHIPDATE'] <= '1998-10-30') & (lineitem['RECEIPTDATE'] == '1992-05-02')][['EXTENDEDPRICE', 'L_COMMENT', 'COMMITDATE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

supplier[(supplier['S_SUPPKEY'] > 62)].merge(partsupp[(partsupp['AVAILQTY'] != 5000) | (partsupp['AVAILQTY'] > 7992)][['PS_SUPPKEY', 'P_COMMENT', 'SUPPLYCOST', 'PS_PARTKEY', 'AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

part.groupby(by=['SIZE', 'P_NAME']).agg('mean', numeric_only=True)

lineitem.merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY')

orders[(orders['O_COMMENT'] != 'q') & (orders['CLERK'] != 'C') & (orders['ORDERPRIORITY'].isin(['3-MEDIUM']))].merge(customer[(customer['C_NAME'].str.startswith('C')) | (customer['C_ADDRESS'] == 'r') | (customer['C_NAME'] != 'C')].merge(orders[['O_COMMENT', 'CLERK', 'SHIPPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['O_ORDERKEY', 'ORDERDATE', 'CLERK']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

orders[['ORDERPRIORITY', 'CLERK', 'SHIPPRIORITY']].merge(partsupp.merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(region[(region['R_REGIONKEY'] < 3)][['R_NAME']].merge(lineitem[(lineitem['SHIPINSTRUCT'] == 'DELIVER IN PERSON') | (lineitem['SHIPINSTRUCT'] != 'TAKE BACK RETURN')].merge(partsupp[['PS_SUPPKEY', 'PS_PARTKEY', 'AVAILQTY', 'P_COMMENT', 'SUPPLYCOST']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='R_REGIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(customer[(customer['C_ADDRESS'].str.startswith('S'))][['C_ADDRESS', 'C_PHONE', 'C_NATIONKEY', 'C_ACCTBAL']].merge(nation[(nation['N_REGIONKEY'] > 1)], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='R_REGIONKEY', right_on='C_CUSTKEY'), left_on='O_ORDERKEY', right_on='R_REGIONKEY').merge(part.merge(partsupp[(partsupp['SUPPLYCOST'] == 506.18252861785936) & (partsupp['AVAILQTY'] != 251) & (partsupp['AVAILQTY'] == 1318)], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='P_PARTKEY').groupby(by=['ORDERPRIORITY', 'CLERK']).agg('mean', numeric_only=True)

partsupp.merge(lineitem[['RECEIPTDATE', 'LINESTATUS', 'L_SUPPKEY', 'COMMITDATE', 'RETURNFLAG']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(part[(part['RETAILPRICE'] != 945.6599521645202)], left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['AVAILQTY', 'SUPPLYCOST']).agg('min', numeric_only=True)

nation[(nation['N_REGIONKEY'] == 0)].merge(customer[(customer['C_NAME'] != 'C') & (customer['C_ADDRESS'].str.startswith('i')) | (customer['MKTSEGMENT'] != 'AUTOMOBILE') & (customer['C_NATIONKEY'] < 14)][['MKTSEGMENT', 'C_NAME']].merge(lineitem.merge(orders[(orders['ORDERSTATUS'] == 'F') & (orders['SHIPPRIORITY'] != 0)][['O_COMMENT', 'O_CUSTKEY', 'TOTALPRICE']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_ADDRESS'] == '5') & (supplier['S_ACCTBAL'] < 5415.319059020757)][['S_SUPPKEY', 'S_NATIONKEY', 'S_ADDRESS']].merge(nation[['N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY')

customer.merge(nation[(nation['N_REGIONKEY'] != 3) | (nation['N_NATIONKEY'] > 6)], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['O_CUSTKEY'] == 101994) | (orders['ORDERPRIORITY'].isin(['1-URGENT'])) | (orders['ORDERSTATUS'] != 'F') | (orders['O_ORDERKEY'] < 7)][['TOTALPRICE', 'O_CUSTKEY', 'O_ORDERKEY', 'ORDERSTATUS', 'O_COMMENT']].merge(lineitem[(lineitem['TAX'] != 0.029883133746530028) | (lineitem['L_COMMENT'].str.startswith('u')) & (lineitem['RETURNFLAG'].isin(['A', 'N', 'R']))].merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

orders.merge(lineitem[(lineitem['SHIPDATE'] != '1992-04-27') | (lineitem['TAX'] >= 0.07143003704882028) | (lineitem['L_SUPPKEY'] < 4944)][['L_COMMENT', 'L_PARTKEY', 'QUANTITY', 'L_SUPPKEY']].merge(partsupp[(partsupp['AVAILQTY'] < 5510)][['SUPPLYCOST', 'AVAILQTY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_PARTKEY'] < 17) | (partsupp['AVAILQTY'] < 1710)].merge(supplier[(supplier['S_ADDRESS'] == 'Q') | (supplier['S_NATIONKEY'] == 14) & (supplier['S_ADDRESS'].str.startswith('p'))][['S_ADDRESS']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_PHONE'] != '25-') | (customer['C_ADDRESS'].str.startswith('g'))].merge(orders[(orders['ORDERPRIORITY'] == '3-MEDIUM') | (orders['O_ORDERKEY'] == 422) | (orders['O_COMMENT'] != 'q') | (orders['O_CUSTKEY'] == 136734)][['ORDERSTATUS']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_NATIONKEY'] >= 23)][['N_NAME', 'N_NATIONKEY']].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

customer[(customer['C_ACCTBAL'] >= 1165.2726183771251) | (customer['C_COMMENT'].str.startswith(','))][['C_COMMENT', 'C_NAME', 'C_NATIONKEY', 'C_ACCTBAL', 'MKTSEGMENT']].merge(nation[(nation['N_NATIONKEY'] > 20)][['N_COMMENT', 'N_NAME']].merge(partsupp[(partsupp['PS_PARTKEY'] != 43) | (partsupp['PS_PARTKEY'] >= 10)][['PS_SUPPKEY', 'PS_PARTKEY']].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='N_NATIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(orders[['O_ORDERKEY', 'O_COMMENT']], left_on='N_NATIONKEY', right_on='O_ORDERKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_REGIONKEY'] == 2) | (nation['N_REGIONKEY'] != 2) & (nation['N_REGIONKEY'] != 2) | (nation['N_NAME'].str.startswith('U'))][['N_NATIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY')

orders[(orders['O_COMMENT'].str.startswith('uri')) & (orders['ORDERSTATUS'] == 'F') | (orders['CLERK'] != 'C')][['O_CUSTKEY', 'ORDERSTATUS', 'SHIPPRIORITY', 'O_COMMENT']].groupby(by=['O_COMMENT']).agg('min', numeric_only=True)

orders[(orders['O_ORDERKEY'] >= 437)].merge(customer[['C_NAME', 'C_PHONE', 'C_COMMENT', 'C_NATIONKEY', 'C_ACCTBAL']].merge(nation[['N_NATIONKEY', 'N_REGIONKEY']].merge(region[(region['R_NAME'] == 'ASI') & (region['R_NAME'] == 'M')][['R_REGIONKEY', 'R_COMMENT', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_CUSTKEY'] == 5) | (customer['C_NATIONKEY'] > 5) & (customer['C_NATIONKEY'] > 18)][['C_NATIONKEY', 'C_COMMENT', 'C_CUSTKEY']].merge(nation[(nation['N_NATIONKEY'] != 7)][['N_NAME']].merge(partsupp[(partsupp['AVAILQTY'] < 44) & (partsupp['AVAILQTY'] <= 4037) & (partsupp['SUPPLYCOST'] <= 478.4273276997154) & (partsupp['P_COMMENT'] == 'v')], left_on='N_NATIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[['CLERK', 'ORDERSTATUS', 'ORDERDATE', 'ORDERPRIORITY', 'O_CUSTKEY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY')

lineitem.merge(orders[(orders['O_CUSTKEY'] > 29811) | (orders['ORDERSTATUS'] == 'P')][['ORDERPRIORITY', 'CLERK', 'O_CUSTKEY', 'O_COMMENT']].merge(customer[['C_PHONE']].merge(lineitem, left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['PS_PARTKEY'] == 45) | (partsupp['P_COMMENT'] == 'x') | (partsupp['P_COMMENT'].str.startswith('ly ')) & (partsupp['P_COMMENT'].str.startswith('the'))][['PS_SUPPKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(orders[(orders['TOTALPRICE'] != 128813.41451738248) & (orders['TOTALPRICE'] <= 197222.74733000933) & (orders['O_ORDERKEY'] < 534)], left_on='L_ORDERKEY', right_on='O_ORDERKEY').groupby(by=['EXTENDEDPRICE']).agg('max', numeric_only=True)

region[['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation[(nation['N_COMMENT'] != 'n') & (nation['N_REGIONKEY'] != 1) | (nation['N_NAME'] == 'R') & (nation['N_NATIONKEY'] < 5)][['N_REGIONKEY', 'N_NATIONKEY', 'N_NAME', 'N_COMMENT']].merge(region[(region['R_NAME'] != 'AFR') & (region['R_COMMENT'].str.startswith('h')) & (region['R_REGIONKEY'] >= 0) | (region['R_COMMENT'] != 'l')][['R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_NAME', 'N_COMMENT']].merge(supplier[(supplier['S_ADDRESS'].str.startswith('h'))].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[(supplier['S_ACCTBAL'] == 5736.495075937012) & (supplier['S_NAME'] == 'S')][['S_NATIONKEY', 'S_COMMENT']].merge(nation[['N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

part[['MFGR', 'PT_COMMENT']].merge(region.merge(nation[['N_COMMENT', 'N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'].str.startswith('J')) | (nation['N_NAME'] != 'I') | (nation['N_NAME'] == 'U')][['N_COMMENT', 'N_REGIONKEY', 'N_NAME', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='P_PARTKEY', right_on='R_REGIONKEY').merge(orders[(orders['ORDERDATE'] > '1998-07-21')], left_on='P_PARTKEY', right_on='O_ORDERKEY').groupby(by=['MFGR']).agg('mean', numeric_only=True)

customer[['C_NATIONKEY', 'C_ACCTBAL', 'C_CUSTKEY', 'MKTSEGMENT']].groupby(by=['C_CUSTKEY', 'C_NATIONKEY']).agg('count')

orders[(orders['ORDERSTATUS'] != 'O') | (orders['SHIPPRIORITY'] == 0)][['CLERK', 'O_COMMENT', 'ORDERDATE', 'O_CUSTKEY', 'ORDERSTATUS']].merge(customer[(customer['C_ACCTBAL'] <= 2967.4857028537663) | (customer['C_CUSTKEY'] >= 95)][['C_NATIONKEY', 'MKTSEGMENT', 'C_PHONE']].merge(nation[['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

partsupp[['AVAILQTY', 'PS_PARTKEY', 'P_COMMENT', 'SUPPLYCOST', 'PS_SUPPKEY']].groupby(by=['AVAILQTY', 'SUPPLYCOST']).agg('count')

customer[['C_NAME']].merge(part[(part['MFGR'] == 'Manufacturer#3')], left_on='C_CUSTKEY', right_on='P_PARTKEY').merge(region[['R_REGIONKEY', 'R_COMMENT', 'R_NAME']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'].str.startswith('V')) & (nation['N_REGIONKEY'] != 3) & (nation['N_COMMENT'].str.startswith('i'))], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='C_CUSTKEY', right_on='R_REGIONKEY').merge(lineitem[(lineitem['DISCOUNT'] < 0.001991541427284449)][['SHIPMODE', 'RECEIPTDATE', 'TAX']].merge(part[(part['PT_COMMENT'].str.startswith('c'))][['P_PARTKEY', 'SIZE', 'P_NAME', 'MFGR', 'TYPE']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY').merge(partsupp[(partsupp['PS_PARTKEY'] == 9) | (partsupp['SUPPLYCOST'] < 565.9503742193568) & (partsupp['SUPPLYCOST'] == 644.2865176481349)][['P_COMMENT', 'SUPPLYCOST', 'PS_SUPPKEY', 'PS_PARTKEY', 'AVAILQTY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).groupby(by=['C_NAME']).agg('max', numeric_only=True)

partsupp[(partsupp['PS_SUPPKEY'] < 308)].merge(supplier[(supplier['S_SUPPKEY'] == 64) & (supplier['S_PHONE'] == '32-') | (supplier['S_PHONE'] == '32-')][['S_SUPPKEY']].merge(partsupp[['SUPPLYCOST', 'PS_PARTKEY', 'P_COMMENT', 'AVAILQTY', 'PS_SUPPKEY']].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_PARTKEY'] != 7) | (partsupp['PS_PARTKEY'] > 18)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[(lineitem['RECEIPTDATE'] != '1992-05-02') & (lineitem['DISCOUNT'] == 0.028329357835108183)], left_on='PS_SUPPKEY', right_on='L_SUPPKEY')

orders[(orders['O_COMMENT'].str.startswith('s')) & (orders['CLERK'] == 'C')][['O_CUSTKEY', 'ORDERSTATUS', 'TOTALPRICE']]

nation[['N_COMMENT', 'N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']].merge(supplier[['S_NAME', 'S_NATIONKEY', 'S_SUPPKEY']].merge(partsupp[['P_COMMENT', 'SUPPLYCOST', 'PS_PARTKEY', 'AVAILQTY', 'PS_SUPPKEY']].merge(lineitem[['DISCOUNT']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region.merge(nation[(nation['N_NAME'] != 'U') & (nation['N_COMMENT'] == 'e') & (nation['N_REGIONKEY'] > 1)][['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NATIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_COMMENT']).agg('max', numeric_only=True)

region[(region['R_REGIONKEY'] == 0) | (region['R_REGIONKEY'] != 2)].merge(nation.merge(region[['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_REGIONKEY'] > 3) & (region['R_REGIONKEY'] <= 2) | (region['R_NAME'] != 'E')].merge(nation[(nation['N_NATIONKEY'] > 15) & (nation['N_NATIONKEY'] < 11) | (nation['N_NAME'] != 'P')][['N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME', 'R_COMMENT']).agg('sum', numeric_only=True)

lineitem[(lineitem['COMMITDATE'] != '1998-10-16') | (lineitem['SHIPINSTRUCT'] == 'NONE') & (lineitem['QUANTITY'] <= 19) | (lineitem['SHIPDATE'] > '1992-04-27')][['SHIPMODE']].merge(supplier[(supplier['S_ACCTBAL'] < 8726.833205756144) & (supplier['S_PHONE'].str.startswith('3')) & (supplier['S_COMMENT'] != 'q') | (supplier['S_COMMENT'] != 'q')].merge(partsupp[(partsupp['PS_SUPPKEY'] == 5171) & (partsupp['SUPPLYCOST'] > 638.3637836298765) & (partsupp['AVAILQTY'] <= 9728) | (partsupp['SUPPLYCOST'] == 992.2769668945315)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY')

nation[(nation['N_NATIONKEY'] < 13) | (nation['N_COMMENT'] == 'h')].merge(region[['R_REGIONKEY', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY')

nation[['N_COMMENT', 'N_NATIONKEY', 'N_NAME']].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[(customer['C_ADDRESS'].str.startswith('Y')) & (customer['C_COMMENT'] == 'd')].merge(orders.merge(customer[(customer['C_ACCTBAL'] != 6501.090632617694) | (customer['C_PHONE'] != '13-')][['C_COMMENT']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

orders[['O_ORDERKEY', 'TOTALPRICE']]

region.merge(nation.merge(supplier[(supplier['S_NAME'] == 'S') & (supplier['S_NATIONKEY'] < 4)].merge(nation[(nation['N_REGIONKEY'] == 1) & (nation['N_REGIONKEY'] > 2) & (nation['N_NATIONKEY'] <= 12)][['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT', 'N_NAME']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

lineitem[['LINENUMBER']].merge(orders, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY').groupby(by=['LINENUMBER']).agg('mean', numeric_only=True)

customer[(customer['C_NATIONKEY'] != 18) & (customer['C_ADDRESS'] != 'X')][['C_ACCTBAL', 'C_COMMENT', 'C_CUSTKEY']]

orders[(orders['SHIPPRIORITY'] <= 0) | (orders['O_COMMENT'].str.startswith('w')) | (orders['O_ORDERKEY'] < 274) | (orders['CLERK'].str.startswith('C'))][['ORDERPRIORITY', 'TOTALPRICE', 'ORDERSTATUS', 'O_COMMENT']].merge(supplier[(supplier['S_NAME'].str.startswith('S')) & (supplier['S_ACCTBAL'] >= 9624.861636895619) & (supplier['S_NAME'] == 'S')][['S_NAME', 'S_SUPPKEY', 'S_PHONE', 'S_ADDRESS', 'S_COMMENT']], left_on='O_ORDERKEY', right_on='S_SUPPKEY')

customer[['C_NATIONKEY']].merge(nation[(nation['N_NATIONKEY'] >= 23) | (nation['N_REGIONKEY'] >= 2) & (nation['N_NAME'].str.startswith('C')) & (nation['N_NAME'] == 'K')].merge(customer[['C_COMMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier.merge(nation[(nation['N_REGIONKEY'] < 3) | (nation['N_NAME'] == 'B')][['N_COMMENT', 'N_NATIONKEY', 'N_NAME']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_NATIONKEY']).agg('min', numeric_only=True)

region[(region['R_REGIONKEY'] == 1) & (region['R_REGIONKEY'] < 2) & (region['R_REGIONKEY'] > 1) & (region['R_REGIONKEY'] == 1)][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation[(nation['N_NAME'] != 'I')].merge(region[['R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[['S_ADDRESS', 'S_PHONE', 'S_SUPPKEY', 'S_NATIONKEY', 'S_COMMENT']].merge(partsupp[(partsupp['PS_SUPPKEY'] > 4024) & (partsupp['SUPPLYCOST'] <= 293.33161142339156) & (partsupp['SUPPLYCOST'] == 384.6283641396109) & (partsupp['PS_PARTKEY'] < 6)][['SUPPLYCOST', 'PS_SUPPKEY', 'AVAILQTY', 'P_COMMENT', 'PS_PARTKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

supplier[(supplier['S_NATIONKEY'] != 18) | (supplier['S_NAME'] != 'S') | (supplier['S_NATIONKEY'] < 15)].merge(nation.merge(region[(region['R_NAME'] == 'A')][['R_COMMENT']].merge(supplier[(supplier['S_ACCTBAL'] == 5438.4707287769525) | (supplier['S_ACCTBAL'] <= 9405.152074129677)], left_on='R_REGIONKEY', right_on='S_SUPPKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_COMMENT'] != 'u')][['N_REGIONKEY', 'N_NAME', 'N_COMMENT', 'N_NATIONKEY']].merge(supplier[(supplier['S_NATIONKEY'] < 23) & (supplier['S_NATIONKEY'] == 18) | (supplier['S_COMMENT'] == 'f') & (supplier['S_NATIONKEY'] >= 14)].merge(partsupp[(partsupp['AVAILQTY'] <= 8334)][['SUPPLYCOST']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_PHONE', 'S_NATIONKEY']).agg('max', numeric_only=True)

orders[['O_CUSTKEY', 'O_ORDERKEY']].merge(lineitem[(lineitem['SHIPINSTRUCT'].isin(['TAKE BACK RETURN'])) | (lineitem['RECEIPTDATE'] <= '1998-11-06') | (lineitem['L_SUPPKEY'] > 9574) | (lineitem['LINENUMBER'] != 2)].merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] >= 2785) | (partsupp['PS_PARTKEY'] != 20) | (partsupp['PS_PARTKEY'] != 22)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['O_CUSTKEY']).agg('sum', numeric_only=True)

lineitem.merge(partsupp[['PS_PARTKEY']].merge(part[(part['P_PARTKEY'] <= 164) & (part['CONTAINER'] != 'WRAP') | (part['BRAND'] != 'Brand#51') & (part['P_NAME'] == 'i')].merge(partsupp[(partsupp['PS_PARTKEY'] >= 48) | (partsupp['PS_PARTKEY'] != 37) & (partsupp['PS_SUPPKEY'] <= 5197) | (partsupp['PS_SUPPKEY'] != 2228)], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[['L_SUPPKEY']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(orders[(orders['ORDERDATE'] == '1992-01-13') & (orders['O_COMMENT'] == 'b')][['O_ORDERKEY', 'O_CUSTKEY']].merge(lineitem[['LINESTATUS']].merge(nation, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['AVAILQTY'] < 2287) & (partsupp['PS_PARTKEY'] > 26) & (partsupp['AVAILQTY'] <= 6049)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY')

region.merge(nation[['N_NATIONKEY']].merge(customer[(customer['C_ACCTBAL'] == 7299.95700025762)][['MKTSEGMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier.merge(partsupp[(partsupp['AVAILQTY'] < 2246) | (partsupp['AVAILQTY'] <= 3574) | (partsupp['SUPPLYCOST'] >= 202.59663755727044)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

nation[['N_COMMENT', 'N_NAME']]

supplier[(supplier['S_SUPPKEY'] == 30) & (supplier['S_ADDRESS'].str.startswith('2')) | (supplier['S_NATIONKEY'] == 4) & (supplier['S_NAME'] == 'S')][['S_SUPPKEY', 'S_COMMENT', 'S_PHONE', 'S_ADDRESS']].groupby(by=['S_PHONE', 'S_SUPPKEY']).agg('count')

region[(region['R_NAME'] == 'AME') & (region['R_NAME'] == 'M') | (region['R_COMMENT'] == 'g') & (region['R_REGIONKEY'] > 2)].merge(nation[(nation['N_COMMENT'] == 'p') | (nation['N_NATIONKEY'] >= 19) | (nation['N_REGIONKEY'] > 0) | (nation['N_NAME'].str.startswith('J'))].merge(customer[['C_COMMENT']].merge(partsupp[['PS_PARTKEY']], left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region.merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_REGIONKEY']].merge(region.merge(nation[['N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY')

supplier[(supplier['S_COMMENT'] == 'a') & (supplier['S_ADDRESS'] == '5') | (supplier['S_NATIONKEY'] <= 22)][['S_NAME', 'S_NATIONKEY']].merge(nation[(nation['N_REGIONKEY'] <= 3)].merge(customer.merge(nation[(nation['N_NAME'].str.startswith('U')) | (nation['N_NAME'] != 'B') & (nation['N_COMMENT'] == 'n')], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[['R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_NAME']).agg('mean', numeric_only=True)

nation.merge(customer.merge(nation[(nation['N_REGIONKEY'] >= 0) | (nation['N_COMMENT'] != 'n')], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders.merge(lineitem[(lineitem['L_PARTKEY'] <= 109643)], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY')

nation.groupby(by=['N_REGIONKEY']).agg('max', numeric_only=True)

lineitem[(lineitem['DISCOUNT'] == 0.07910254194706481) | (lineitem['L_PARTKEY'] == 175508) | (lineitem['L_PARTKEY'] < 15965) & (lineitem['COMMITDATE'] != '1992-05-15')].groupby(by=['LINENUMBER']).agg('max', numeric_only=True)

supplier[(supplier['S_NATIONKEY'] < 23)].merge(partsupp[(partsupp['PS_PARTKEY'] != 43) & (partsupp['PS_SUPPKEY'] >= 5500) & (partsupp['P_COMMENT'] == ';') & (partsupp['P_COMMENT'] == 'l')].merge(lineitem[(lineitem['SHIPMODE'] == 'RAIL') & (lineitem['TAX'] <= 0.053669325630230295) & (lineitem['LINENUMBER'] >= 6)], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_NAME'] != 'R') | (nation['N_COMMENT'] != 'v')][['N_COMMENT']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(customer[(customer['C_NATIONKEY'] < 19)].merge(orders[(orders['ORDERSTATUS'] == 'F')][['O_COMMENT', 'CLERK', 'TOTALPRICE', 'O_ORDERKEY', 'ORDERPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY')

part[(part['MFGR'] != 'Manufacturer#3') & (part['PT_COMMENT'] == '!') | (part['RETAILPRICE'] > 936.1547063331586)][['MFGR', 'CONTAINER', 'P_PARTKEY', 'BRAND']]

nation[(nation['N_NAME'] == 'S') & (nation['N_COMMENT'].str.startswith('h')) | (nation['N_COMMENT'] == 'v') | (nation['N_REGIONKEY'] == 0)][['N_NAME', 'N_COMMENT', 'N_REGIONKEY']].merge(region[(region['R_COMMENT'] != 'u') & (region['R_NAME'] != 'M')].merge(nation[(nation['N_NAME'] != 'U') | (nation['N_NAME'] != 'M') & (nation['N_REGIONKEY'] < 2)], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_NAME'] == 'A') & (region['R_REGIONKEY'] <= 3) & (region['R_REGIONKEY'] > 2)], left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_COMMENT', 'N_NAME']).agg('count')

orders[(orders['O_COMMENT'].str.startswith('u')) | (orders['TOTALPRICE'] != 220899.1313428654) | (orders['ORDERDATE'] == '1992-01-13')].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_ACCTBAL'] < -250.84534598402615) & (customer['MKTSEGMENT'].isin(['AUTOMOBILE', 'FURNITURE', 'BUILDING'])) & (customer['C_ACCTBAL'] >= 391.48840673377254) | (customer['C_NAME'] == 'C')].merge(nation[(nation['N_NAME'].str.startswith('I')) | (nation['N_NATIONKEY'] > 3)][['N_NATIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_COMMENT'] == 'd') & (customer['C_COMMENT'].str.startswith('u')) | (customer['C_PHONE'] != '25-')][['C_NAME']], left_on='O_CUSTKEY', right_on='C_CUSTKEY')

partsupp[(partsupp['P_COMMENT'] == 'j')][['SUPPLYCOST', 'P_COMMENT', 'PS_SUPPKEY', 'PS_PARTKEY', 'AVAILQTY']].merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['EXTENDEDPRICE'] > 52538.84231146377) & (lineitem['L_COMMENT'].str.startswith('d')) | (lineitem['SHIPMODE'] != 'TRUCK') | (lineitem['L_COMMENT'].str.startswith('lit'))][['COMMITDATE', 'LINENUMBER']].merge(partsupp[(partsupp['SUPPLYCOST'] >= 639.204250926201) | (partsupp['P_COMMENT'] != 'k')].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_PARTKEY', right_on='L_PARTKEY')

part[['SIZE', 'PT_COMMENT', 'P_NAME']].merge(nation.merge(region[['R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region.merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='P_PARTKEY', right_on='N_NATIONKEY').merge(customer[(customer['C_COMMENT'] == 'h') | (customer['C_NAME'].str.startswith('C')) | (customer['C_COMMENT'].str.startswith('o'))][['C_PHONE', 'C_CUSTKEY']].merge(orders[(orders['ORDERSTATUS'].isin(['O', 'P']))][['CLERK', 'SHIPPRIORITY']].merge(partsupp[(partsupp['P_COMMENT'] == 'are')], left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders.merge(lineitem[(lineitem['RETURNFLAG'] != 'N')], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='P_PARTKEY', right_on='C_CUSTKEY').merge(supplier[['S_PHONE']].merge(part[['SIZE', 'PT_COMMENT', 'TYPE', 'RETAILPRICE', 'P_NAME']], left_on='S_SUPPKEY', right_on='P_PARTKEY').merge(region[(region['R_NAME'] != 'AFR')][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation[['N_NAME', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='S_SUPPKEY', right_on='R_REGIONKEY'), left_on='P_PARTKEY', right_on='S_SUPPKEY').groupby(by=['PT_COMMENT', 'SIZE']).agg('sum', numeric_only=True)

partsupp[['P_COMMENT']]

part.merge(partsupp.merge(lineitem[(lineitem['COMMITDATE'] != '1992-05-15') & (lineitem['L_SUPPKEY'] <= 3069) | (lineitem['L_ORDERKEY'] < 64)][['L_PARTKEY', 'SHIPDATE', 'SHIPINSTRUCT']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['AVAILQTY'] != 1168)], left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['TYPE']).agg('mean', numeric_only=True)

orders[(orders['O_ORDERKEY'] != 375) | (orders['ORDERSTATUS'] == 'O')]

customer[(customer['C_COMMENT'].str.startswith('t')) | (customer['C_COMMENT'].str.startswith('s'))].merge(orders[(orders['ORDERPRIORITY'] == '4-NOT SPECIFIED') & (orders['ORDERPRIORITY'] != '1-URGENT')], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['O_ORDERKEY'] >= 527) | (orders['TOTALPRICE'] < 328737.5316226123) | (orders['CLERK'] == 'C') & (orders['SHIPPRIORITY'] > 0)].merge(lineitem[(lineitem['TAX'] == 0.0032376540088757365) | (lineitem['RETURNFLAG'] == 'N') | (lineitem['LINENUMBER'] <= 6) & (lineitem['L_COMMENT'].str.startswith('f'))][['SHIPDATE', 'COMMITDATE', 'LINENUMBER', 'TAX', 'QUANTITY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_PHONE', 'MKTSEGMENT']).agg('sum', numeric_only=True)

part[['TYPE', 'P_PARTKEY', 'SIZE', 'P_NAME', 'CONTAINER']].merge(partsupp[['PS_PARTKEY', 'P_COMMENT']].merge(lineitem[['COMMITDATE']].merge(part[['BRAND', 'TYPE', 'MFGR', 'SIZE', 'P_PARTKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(lineitem[['LINENUMBER']].merge(nation[(nation['N_NAME'].str.startswith('G')) | (nation['N_REGIONKEY'] >= 1) & (nation['N_COMMENT'] == 'a')][['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[['L_PARTKEY', 'TAX', 'QUANTITY', 'DISCOUNT', 'L_ORDERKEY']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

orders[['CLERK', 'O_COMMENT', 'SHIPPRIORITY', 'TOTALPRICE']].merge(customer.merge(nation[(nation['N_REGIONKEY'] <= 1)], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_COMMENT'] != 'n') | (nation['N_NAME'] == 'S') & (nation['N_NATIONKEY'] >= 13)].merge(region[(region['R_COMMENT'] == 'g') | (region['R_COMMENT'].str.startswith('g')) | (region['R_COMMENT'] != 'g')][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='C_CUSTKEY')

nation[(nation['N_REGIONKEY'] <= 2)][['N_COMMENT', 'N_NAME', 'N_REGIONKEY', 'N_NATIONKEY']].merge(supplier[(supplier['S_ACCTBAL'] != 3685.6507574977786)].merge(nation[(nation['N_NAME'].str.startswith('S')) | (nation['N_COMMENT'] == 'e') | (nation['N_REGIONKEY'] != 1)][['N_REGIONKEY', 'N_COMMENT', 'N_NAME', 'N_NATIONKEY']].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_NATIONKEY', 'N_REGIONKEY']).agg('mean', numeric_only=True)

part[(part['P_PARTKEY'] > 163) & (part['RETAILPRICE'] < 1049.628056991766) & (part['MFGR'] != 'Manufacturer#4') & (part['PT_COMMENT'] == 'ly ')].groupby(by=['MFGR', 'RETAILPRICE']).agg('min', numeric_only=True)

part[(part['P_PARTKEY'] <= 184) | (part['MFGR'] == 'Manufacturer#2') & (part['PT_COMMENT'] != 's') | (part['PT_COMMENT'] != 's')][['CONTAINER']].merge(nation[(nation['N_NAME'] == 'K') | (nation['N_NAME'].str.startswith('S'))], left_on='P_PARTKEY', right_on='N_NATIONKEY').merge(nation[['N_REGIONKEY', 'N_NAME', 'N_COMMENT', 'N_NATIONKEY']].merge(region[(region['R_NAME'] != 'AME') | (region['R_COMMENT'] == 'g') & (region['R_COMMENT'] != 'h') | (region['R_COMMENT'].str.startswith('l'))].merge(nation[['N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='P_PARTKEY', right_on='N_NATIONKEY').merge(orders[['SHIPPRIORITY', 'O_ORDERKEY', 'CLERK', 'O_CUSTKEY']], left_on='P_PARTKEY', right_on='O_ORDERKEY').groupby(by=['CONTAINER']).agg('mean', numeric_only=True)

region[(region['R_REGIONKEY'] < 2) & (region['R_REGIONKEY'] != 0) | (region['R_NAME'] == 'ASI') | (region['R_REGIONKEY'] >= 2)][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_REGIONKEY'] > 2) | (nation['N_NATIONKEY'] != 2) | (nation['N_NATIONKEY'] == 14) & (nation['N_NATIONKEY'] != 14)][['N_NAME', 'N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'].str.startswith('S'))][['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_PHONE'] != '32-') | (supplier['S_COMMENT'] != 'r')][['S_COMMENT', 'S_NAME']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'].str.startswith('c')) & (nation['N_REGIONKEY'] != 0)][['N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

partsupp.merge(lineitem[(lineitem['COMMITDATE'] != '1998-10-16') & (lineitem['L_SUPPKEY'] >= 7482) | (lineitem['TAX'] <= 0.005905940135506098)][['TAX', 'DISCOUNT']].merge(supplier[(supplier['S_PHONE'].str.startswith('32-')) & (supplier['S_NAME'] == 'S') | (supplier['S_NAME'] == 'S')][['S_ADDRESS', 'S_SUPPKEY', 'S_ACCTBAL', 'S_COMMENT', 'S_NATIONKEY']].merge(partsupp[(partsupp['AVAILQTY'] < 2977) & (partsupp['P_COMMENT'].str.startswith('o')) | (partsupp['PS_SUPPKEY'] <= 5946) & (partsupp['AVAILQTY'] == 5145)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY').merge(part[['P_NAME']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier[['S_ACCTBAL', 'S_COMMENT', 'S_SUPPKEY', 'S_ADDRESS']].merge(partsupp[(partsupp['AVAILQTY'] > 1449) | (partsupp['P_COMMENT'].str.startswith('g'))], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY')

orders[['CLERK', 'ORDERDATE', 'O_COMMENT', 'SHIPPRIORITY']]

customer.merge(orders[['CLERK']].merge(part[(part['P_PARTKEY'] == 89)], left_on='O_ORDERKEY', right_on='P_PARTKEY').merge(part, left_on='O_ORDERKEY', right_on='P_PARTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['ORDERSTATUS', 'O_ORDERKEY', 'O_COMMENT']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['ORDERSTATUS', 'O_ORDERKEY', 'O_COMMENT', 'ORDERPRIORITY', 'ORDERDATE']].merge(lineitem[(lineitem['RECEIPTDATE'] != '1992-05-02') & (lineitem['SHIPDATE'] == '1992-04-27')][['L_PARTKEY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[['L_COMMENT', 'EXTENDEDPRICE', 'LINENUMBER']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

partsupp[(partsupp['AVAILQTY'] >= 8708)][['AVAILQTY', 'SUPPLYCOST', 'PS_SUPPKEY']].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['AVAILQTY']).agg('count')

region[(region['R_COMMENT'].str.startswith('u')) | (region['R_COMMENT'] != 'h') & (region['R_REGIONKEY'] < 2)][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']]

region[(region['R_NAME'] == 'AME') | (region['R_REGIONKEY'] == 1) | (region['R_COMMENT'] == 'u') & (region['R_COMMENT'] == 'l')].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] > 9) & (nation['N_NATIONKEY'] > 1)][['N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY', 'R_COMMENT']).agg('mean', numeric_only=True)

customer[['C_CUSTKEY']].merge(orders[(orders['ORDERPRIORITY'].isin(['4-NOT SPECIFIED', '5-LOW', '2-HIGH', '3-MEDIUM', '1-URGENT']))][['CLERK', 'ORDERSTATUS', 'SHIPPRIORITY']].merge(partsupp[(partsupp['PS_PARTKEY'] > 43) & (partsupp['PS_PARTKEY'] <= 45) & (partsupp['AVAILQTY'] > 606) | (partsupp['SUPPLYCOST'] <= 32.482093796884655)].merge(lineitem[(lineitem['TAX'] > 0.06851643589644141) | (lineitem['LINENUMBER'] <= 1)], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(nation.merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='O_ORDERKEY', right_on='N_NATIONKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

orders[(orders['O_COMMENT'] != 'c')][['SHIPPRIORITY', 'TOTALPRICE', 'O_CUSTKEY', 'O_COMMENT']].merge(customer[(customer['MKTSEGMENT'] != 'HOUSEHOLD')], left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_NAME'] != 'C') & (customer['C_NATIONKEY'] >= 6) & (customer['C_NAME'] != 'C')][['C_NAME', 'C_CUSTKEY', 'C_ACCTBAL']].merge(orders[['CLERK', 'ORDERDATE', 'O_COMMENT', 'ORDERPRIORITY', 'TOTALPRICE']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['ORDERPRIORITY'] != '3-MEDIUM') | (orders['CLERK'] != 'C') & (orders['TOTALPRICE'] <= 123882.23589206708) | (orders['ORDERSTATUS'] == 'F')][['SHIPPRIORITY', 'O_ORDERKEY', 'CLERK', 'TOTALPRICE']].merge(lineitem[(lineitem['L_SUPPKEY'] >= 467)][['COMMITDATE', 'L_COMMENT', 'DISCOUNT']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['SHIPPRIORITY']).agg('count')

partsupp[(partsupp['PS_PARTKEY'] > 33) & (partsupp['P_COMMENT'] != 'are') & (partsupp['PS_SUPPKEY'] < 1589)][['SUPPLYCOST']].merge(region[(region['R_NAME'].str.startswith('ASI')) | (region['R_NAME'] == 'A') & (region['R_NAME'].str.startswith('AME'))][['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation[(nation['N_REGIONKEY'] <= 0) | (nation['N_COMMENT'] != 'c') | (nation['N_NATIONKEY'] >= 14)][['N_REGIONKEY', 'N_COMMENT']].merge(region[(region['R_NAME'].str.startswith('ASI')) & (region['R_REGIONKEY'] > 2) | (region['R_COMMENT'].str.startswith('g'))], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='R_REGIONKEY').merge(lineitem[(lineitem['L_PARTKEY'] >= 165696) & (lineitem['LINESTATUS'] != 'F') & (lineitem['COMMITDATE'] == '1998-10-16')].merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'])

nation[(nation['N_REGIONKEY'] < 0)].merge(customer[(customer['C_ACCTBAL'] < 4352.921571038829) & (customer['C_NAME'] == 'C')], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_NAME'].str.startswith('ASI'))], left_on='N_REGIONKEY', right_on='R_REGIONKEY')

supplier[(supplier['S_NAME'] == 'S') & (supplier['S_NAME'] == 'S') | (supplier['S_SUPPKEY'] > 135)].merge(partsupp[(partsupp['SUPPLYCOST'] >= 897.0789044903422) | (partsupp['AVAILQTY'] > 2039) & (partsupp['SUPPLYCOST'] != 963.7045437766432) & (partsupp['PS_PARTKEY'] < 25)][['AVAILQTY']].merge(part[(part['RETAILPRICE'] >= 928.8330923564852) | (part['CONTAINER'].str.startswith('LG'))][['MFGR', 'RETAILPRICE', 'BRAND']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

supplier[(supplier['S_NATIONKEY'] == 23)].groupby(by=['S_ADDRESS', 'S_NAME']).agg('count')

part.merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_PARTKEY'] <= 8) | (partsupp['PS_SUPPKEY'] != 1982) | (partsupp['PS_PARTKEY'] <= 27) & (partsupp['PS_PARTKEY'] <= 24)][['PS_PARTKEY', 'P_COMMENT', 'PS_SUPPKEY', 'AVAILQTY']].merge(part[['CONTAINER', 'PT_COMMENT', 'TYPE', 'P_NAME']], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['LINESTATUS'] != 'F') & (lineitem['QUANTITY'] != 2) | (lineitem['DISCOUNT'] > 0.010993134849420905) & (lineitem['SHIPINSTRUCT'] != 'COLLECT COD')], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['PT_COMMENT']).agg('max', numeric_only=True)

orders[['ORDERDATE']]

region.merge(nation[(nation['N_REGIONKEY'] == 0) & (nation['N_NATIONKEY'] < 6) & (nation['N_NAME'] == 'G')][['N_REGIONKEY', 'N_COMMENT']].merge(region.merge(nation[(nation['N_NAME'] != 'C') & (nation['N_NATIONKEY'] > 23) | (nation['N_NATIONKEY'] > 18) & (nation['N_REGIONKEY'] >= 2)], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] < 7)][['N_NATIONKEY']].merge(supplier[(supplier['S_NATIONKEY'] != 13) & (supplier['S_NAME'] != 'S') & (supplier['S_NATIONKEY'] > 4)][['S_NAME', 'S_SUPPKEY', 'S_COMMENT']].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(supplier[(supplier['S_ACCTBAL'] <= 7162.49328412324) | (supplier['S_NATIONKEY'] <= 18) & (supplier['S_ADDRESS'].str.startswith('d')) & (supplier['S_ACCTBAL'] > 2673.3849993915665)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

orders[['ORDERDATE', 'TOTALPRICE', 'ORDERSTATUS']].merge(region.merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] >= 2)], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='O_ORDERKEY', right_on='R_REGIONKEY').groupby(by=['TOTALPRICE']).agg('count')

supplier.merge(nation.merge(supplier[['S_COMMENT']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_NATIONKEY', 'N_NAME']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_COMMENT'].str.startswith('l')) | (nation['N_COMMENT'] != 't') & (nation['N_NATIONKEY'] == 5) & (nation['N_REGIONKEY'] > 0)][['N_REGIONKEY', 'N_COMMENT', 'N_NAME']].merge(region[(region['R_COMMENT'] != 'h') & (region['R_REGIONKEY'] <= 3) & (region['R_NAME'].str.startswith('AFR')) | (region['R_REGIONKEY'] != 0)].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_REGIONKEY'] >= 2) | (region['R_NAME'] == 'M') | (region['R_REGIONKEY'] < 0) | (region['R_COMMENT'].str.startswith('l'))][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_REGIONKEY'] != 0) | (nation['N_COMMENT'] == 't') | (nation['N_NAME'].str.startswith('B'))][['N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY')

region[['R_REGIONKEY', 'R_NAME']].merge(nation[(nation['N_NAME'] == 'M') & (nation['N_NATIONKEY'] <= 14) & (nation['N_COMMENT'] != 'v')][['N_REGIONKEY', 'N_NAME']].merge(region[['R_COMMENT']].merge(lineitem, left_on='R_REGIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_COMMENT'].str.startswith('l'))][['R_NAME', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] == 1) | (nation['N_REGIONKEY'] == 1) | (nation['N_NATIONKEY'] > 20)][['N_COMMENT', 'N_REGIONKEY']].merge(region[['R_NAME', 'R_COMMENT', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_NAME'] != 'M')][['R_NAME']].merge(orders[(orders['SHIPPRIORITY'] > 0) | (orders['O_ORDERKEY'] != 73) | (orders['ORDERSTATUS'] == 'P')][['ORDERDATE', 'ORDERPRIORITY', 'O_ORDERKEY', 'TOTALPRICE', 'ORDERSTATUS']], left_on='R_REGIONKEY', right_on='O_ORDERKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NATIONKEY', 'N_NAME', 'N_REGIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

supplier[(supplier['S_NAME'] == 'S') | (supplier['S_ACCTBAL'] < 5357.335443766474) & (supplier['S_NAME'].str.startswith('S'))].merge(partsupp.merge(lineitem[(lineitem['RETURNFLAG'] != 'A') | (lineitem['L_PARTKEY'] != 57927) & (lineitem['DISCOUNT'] <= 0.006867669983558278)][['QUANTITY', 'L_PARTKEY', 'COMMITDATE']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['SUPPLYCOST'] > 801.8140852336004)][['PS_PARTKEY', 'PS_SUPPKEY', 'P_COMMENT', 'SUPPLYCOST']].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']].merge(supplier[(supplier['S_NATIONKEY'] >= 7) | (supplier['S_SUPPKEY'] > 95) & (supplier['S_SUPPKEY'] == 106)], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_SUPPKEY', 'S_ACCTBAL']).agg('mean', numeric_only=True)

orders[['O_COMMENT']]

supplier[['S_SUPPKEY', 'S_PHONE', 'S_ACCTBAL', 'S_COMMENT', 'S_NATIONKEY']].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_PHONE', 'S_SUPPKEY']).agg('sum', numeric_only=True)

nation[(nation['N_COMMENT'].str.startswith('o')) & (nation['N_NATIONKEY'] <= 0)][['N_REGIONKEY']].merge(region[['R_COMMENT', 'R_REGIONKEY', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_REGIONKEY']).agg('sum', numeric_only=True)

customer[(customer['C_NAME'] == 'C') | (customer['C_PHONE'].str.startswith('25-')) | (customer['C_ADDRESS'].str.startswith('f'))][['MKTSEGMENT']]

region.merge(nation.merge(supplier[(supplier['S_COMMENT'].str.startswith('r')) & (supplier['S_NAME'] == 'S') & (supplier['S_PHONE'] != '3') & (supplier['S_COMMENT'] != 'g')], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[(region['R_REGIONKEY'] > 1)][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation[(nation['N_REGIONKEY'] < 3) & (nation['N_NAME'].str.startswith('P')) & (nation['N_COMMENT'].str.startswith('i')) | (nation['N_NATIONKEY'] <= 4)], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY']].merge(supplier[(supplier['S_PHONE'] != '32-') & (supplier['S_SUPPKEY'] <= 44) | (supplier['S_SUPPKEY'] != 119)].merge(partsupp[(partsupp['P_COMMENT'].str.startswith('s')) | (partsupp['PS_SUPPKEY'] != 2976) & (partsupp['AVAILQTY'] != 5334)][['SUPPLYCOST', 'PS_PARTKEY', 'P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_COMMENT', 'N_NATIONKEY', 'N_NAME']].merge(supplier[['S_COMMENT', 'S_NAME', 'S_NATIONKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT', 'R_REGIONKEY']).agg('sum', numeric_only=True)

part[['P_NAME', 'BRAND']].merge(nation, left_on='P_PARTKEY', right_on='N_NATIONKEY').merge(region[(region['R_REGIONKEY'] == 1) | (region['R_REGIONKEY'] <= 3) | (region['R_REGIONKEY'] < 3) & (region['R_COMMENT'] != 'l')].merge(nation[(nation['N_NATIONKEY'] > 21) | (nation['N_REGIONKEY'] == 1) | (nation['N_NAME'].str.startswith('J'))][['N_REGIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='P_PARTKEY', right_on='R_REGIONKEY').merge(supplier[['S_PHONE', 'S_ADDRESS', 'S_COMMENT', 'S_SUPPKEY', 'S_NAME']].merge(partsupp[(partsupp['PS_PARTKEY'] <= 15) & (partsupp['PS_PARTKEY'] < 11) & (partsupp['PS_SUPPKEY'] == 524)][['SUPPLYCOST', 'PS_PARTKEY', 'AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp.merge(lineitem[(lineitem['L_SUPPKEY'] != 4666) | (lineitem['COMMITDATE'] == '1998-10-16') | (lineitem['EXTENDEDPRICE'] > 64554.21774148508) & (lineitem['COMMITDATE'] > '1992-05-15')], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='P_PARTKEY', right_on='S_SUPPKEY')

region.merge(nation[['N_NAME', 'N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY']].merge(customer[(customer['C_COMMENT'].str.startswith('l'))].merge(orders[(orders['ORDERDATE'] < '1992-01-13') & (orders['SHIPPRIORITY'] < 0)][['ORDERSTATUS', 'ORDERDATE', 'TOTALPRICE']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT', 'R_NAME']).agg('max', numeric_only=True)

part[(part['TYPE'] != 'M') | (part['RETAILPRICE'] < 976.059102182639) & (part['TYPE'] == 'STA')][['P_NAME']]

orders[(orders['O_COMMENT'].str.startswith(' ')) & (orders['ORDERDATE'] < '1998-07-21')][['SHIPPRIORITY']].merge(part[(part['P_NAME'] != 'v') | (part['SIZE'] > 30) | (part['SIZE'] != 43)][['P_NAME', 'TYPE', 'BRAND', 'SIZE']], left_on='O_ORDERKEY', right_on='P_PARTKEY').groupby(by=['SHIPPRIORITY']).agg('min', numeric_only=True)

orders[(orders['ORDERDATE'] != '1992-01-13') & (orders['O_COMMENT'] != 'a')].merge(lineitem.merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer.merge(orders[(orders['SHIPPRIORITY'] > 0) | (orders['ORDERSTATUS'] != 'O') | (orders['CLERK'].str.startswith('C')) & (orders['ORDERPRIORITY'] == '4-NOT SPECIFIED')][['ORDERPRIORITY', 'SHIPPRIORITY']].merge(part, left_on='O_ORDERKEY', right_on='P_PARTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

lineitem[(lineitem['L_SUPPKEY'] != 992) | (lineitem['LINESTATUS'] != 'F') & (lineitem['L_COMMENT'] == ',')][['SHIPINSTRUCT']].merge(nation[['N_NAME', 'N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY').merge(supplier[['S_ACCTBAL']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY')

lineitem[(lineitem['SHIPINSTRUCT'].isin(['TAKE BACK RETURN', 'NONE', 'COLLECT COD', 'DELIVER IN PERSON'])) & (lineitem['RECEIPTDATE'] == '1992-05-02') | (lineitem['SHIPDATE'] == '1998-10-30')][['L_COMMENT', 'SHIPINSTRUCT', 'L_SUPPKEY', 'COMMITDATE']].merge(partsupp[(partsupp['AVAILQTY'] < 3702) & (partsupp['SUPPLYCOST'] < 447.4521820458869) | (partsupp['AVAILQTY'] < 5576)][['AVAILQTY']].merge(part[(part['TYPE'] == 'SMA')], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['SHIPINSTRUCT', 'COMMITDATE']).agg('min', numeric_only=True)

orders[(orders['ORDERDATE'] > '1998-07-21') & (orders['ORDERSTATUS'].isin(['F', 'O', 'P']))].merge(lineitem[['LINESTATUS']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['QUANTITY'] <= 5) | (lineitem['RECEIPTDATE'] > '1992-05-02') | (lineitem['L_PARTKEY'] >= 146395) & (lineitem['COMMITDATE'] > '1992-05-15')], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY')

region[(region['R_COMMENT'] == 'g') | (region['R_REGIONKEY'] != 2) & (region['R_REGIONKEY'] >= 3)][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT', 'N_NAME']].merge(region[(region['R_NAME'] != 'AME') & (region['R_NAME'] != 'AFR')].merge(nation[(nation['N_NATIONKEY'] > 19) & (nation['N_NAME'] == 'A')], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[(customer['C_ACCTBAL'] != 4545.90920202122) | (customer['MKTSEGMENT'].isin(['HOUSEHOLD', 'MACHINERY'])) & (customer['C_ACCTBAL'] > 1039.425323538049) & (customer['C_NAME'] == 'C')].merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] > 2) | (nation['N_COMMENT'] != 'v') | (nation['N_NATIONKEY'] == 9) & (nation['N_NAME'] != 'P')][['N_NAME', 'N_NATIONKEY', 'N_COMMENT']].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

part[['RETAILPRICE', 'P_PARTKEY']].merge(partsupp[['SUPPLYCOST', 'PS_SUPPKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['P_PARTKEY']).agg('max', numeric_only=True)

part.groupby(by=['TYPE']).agg('max', numeric_only=True)

partsupp[(partsupp['AVAILQTY'] == 3341) | (partsupp['PS_PARTKEY'] <= 18) | (partsupp['PS_PARTKEY'] < 7) | (partsupp['P_COMMENT'] != 'k')][['AVAILQTY', 'P_COMMENT', 'SUPPLYCOST', 'PS_PARTKEY', 'PS_SUPPKEY']].merge(part[['P_PARTKEY']], left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['SUPPLYCOST']).agg('min', numeric_only=True)

orders[(orders['CLERK'] != 'C') | (orders['SHIPPRIORITY'] == 0)][['ORDERDATE']].merge(partsupp[['PS_PARTKEY']], left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY'])

lineitem.merge(orders[(orders['ORDERSTATUS'] == 'O') & (orders['CLERK'].str.startswith('C')) | (orders['ORDERSTATUS'].isin(['O'])) & (orders['O_ORDERKEY'] < 581)], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders.merge(customer[(customer['C_COMMENT'].str.startswith('k')) & (customer['C_CUSTKEY'] >= 3) & (customer['C_CUSTKEY'] <= 18) & (customer['C_ADDRESS'] == 'z')], left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[(lineitem['COMMITDATE'] != '1992-05-15')][['L_SUPPKEY', 'QUANTITY', 'LINENUMBER', 'COMMITDATE', 'RETURNFLAG']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[['AVAILQTY', 'PS_PARTKEY', 'P_COMMENT']].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY')

partsupp[['PS_PARTKEY', 'PS_SUPPKEY', 'SUPPLYCOST', 'AVAILQTY', 'P_COMMENT']].merge(lineitem[['SHIPMODE', 'L_SUPPKEY']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier[(supplier['S_ACCTBAL'] >= 4504.60936550842) | (supplier['S_SUPPKEY'] > 127) & (supplier['S_COMMENT'].str.startswith('y')) & (supplier['S_NATIONKEY'] <= 1)][['S_SUPPKEY', 'S_PHONE', 'S_COMMENT', 'S_ADDRESS']].merge(partsupp[['AVAILQTY', 'PS_SUPPKEY', 'PS_PARTKEY', 'SUPPLYCOST']].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY')

supplier[(supplier['S_NATIONKEY'] > 11) | (supplier['S_PHONE'].str.startswith('3'))][['S_SUPPKEY', 'S_PHONE', 'S_NAME']].merge(partsupp[['PS_PARTKEY', 'SUPPLYCOST', 'P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

orders[(orders['ORDERDATE'] >= '1998-07-21') | (orders['ORDERSTATUS'] == 'F')].merge(lineitem[(lineitem['LINENUMBER'] > 2) & (lineitem['L_SUPPKEY'] == 7935) & (lineitem['L_COMMENT'] != 'r')][['RETURNFLAG', 'DISCOUNT']].merge(nation.merge(customer[(customer['C_PHONE'] == '2')][['C_ACCTBAL']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY').merge(orders[['ORDERPRIORITY', 'TOTALPRICE', 'SHIPPRIORITY', 'O_ORDERKEY', 'O_COMMENT']].merge(lineitem[(lineitem['TAX'] <= 0.02839325486911391) | (lineitem['SHIPDATE'] >= '1992-04-27') | (lineitem['LINESTATUS'] == 'O') | (lineitem['COMMITDATE'] >= '1992-05-15')], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['RECEIPTDATE'] <= '1992-05-02')][['LINESTATUS', 'COMMITDATE']].merge(orders[(orders['ORDERPRIORITY'].isin(['5-LOW', '2-HIGH', '3-MEDIUM', '4-NOT SPECIFIED', '1-URGENT'])) & (orders['O_COMMENT'].str.startswith('s')) | (orders['ORDERPRIORITY'] == '1-URGENT')].merge(lineitem[['L_PARTKEY', 'LINENUMBER', 'SHIPMODE', 'RECEIPTDATE', 'EXTENDEDPRICE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY').merge(customer[['C_PHONE', 'C_ACCTBAL', 'MKTSEGMENT', 'C_CUSTKEY', 'C_COMMENT']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY')

customer[(customer['C_PHONE'] == '3') & (customer['C_ADDRESS'] == 'e') | (customer['C_ADDRESS'] == 'm')].merge(orders[(orders['ORDERPRIORITY'] == '1-URGENT') | (orders['O_COMMENT'].str.startswith('.')) | (orders['ORDERPRIORITY'] == '5-LOW') & (orders['ORDERSTATUS'] == 'F')], left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_COMMENT']).agg('max', numeric_only=True)

partsupp.merge(part[['SIZE']].merge(orders[(orders['ORDERSTATUS'].isin(['O'])) | (orders['O_COMMENT'] != 'ly ') | (orders['TOTALPRICE'] < 250592.1387264815)][['ORDERSTATUS', 'SHIPPRIORITY', 'O_ORDERKEY', 'CLERK']].merge(lineitem[(lineitem['L_PARTKEY'] < 54338) | (lineitem['LINESTATUS'] != 'O')][['LINENUMBER', 'EXTENDEDPRICE', 'L_ORDERKEY', 'DISCOUNT', 'RETURNFLAG']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='P_PARTKEY', right_on='O_ORDERKEY').merge(orders[(orders['O_COMMENT'] != 'l') & (orders['O_COMMENT'] == 's')], left_on='P_PARTKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['AVAILQTY', 'P_COMMENT']).agg('max', numeric_only=True)

supplier[(supplier['S_ACCTBAL'] >= 1563.6086834846553) | (supplier['S_SUPPKEY'] != 176) & (supplier['S_COMMENT'] != 't') | (supplier['S_NAME'].str.startswith('S'))].merge(nation[(nation['N_NATIONKEY'] == 7) & (nation['N_COMMENT'].str.startswith('y'))][['N_NATIONKEY', 'N_COMMENT', 'N_NAME', 'N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY')

supplier[(supplier['S_COMMENT'].str.startswith(' sl')) | (supplier['S_ADDRESS'].str.startswith('x'))]

lineitem[(lineitem['RETURNFLAG'] != 'N') | (lineitem['LINESTATUS'] == 'O')][['L_PARTKEY', 'RETURNFLAG', 'SHIPDATE', 'L_SUPPKEY', 'COMMITDATE']].merge(partsupp.merge(lineitem[(lineitem['RETURNFLAG'] == 'R') & (lineitem['EXTENDEDPRICE'] < 80678.14616376694) | (lineitem['L_SUPPKEY'] == 6316)].merge(orders[['ORDERPRIORITY', 'TOTALPRICE', 'CLERK', 'SHIPPRIORITY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp.merge(supplier[(supplier['S_NATIONKEY'] == 9) | (supplier['S_PHONE'].str.startswith('2')) & (supplier['S_COMMENT'] != 'l') & (supplier['S_NATIONKEY'] <= 21)][['S_NAME', 'S_ADDRESS', 'S_PHONE', 'S_ACCTBAL', 'S_COMMENT']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[(lineitem['L_COMMENT'].str.startswith('n')) & (lineitem['SHIPDATE'] > '1998-10-30')][['SHIPDATE', 'LINESTATUS', 'TAX', 'L_PARTKEY', 'SHIPMODE']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['RETURNFLAG']).agg('sum', numeric_only=True)

orders[(orders['O_COMMENT'] != 'f') & (orders['CLERK'].str.startswith('C')) & (orders['ORDERDATE'] <= '1998-07-21') | (orders['ORDERSTATUS'] == 'F')].merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['O_CUSTKEY', 'ORDERSTATUS']).agg('mean', numeric_only=True)

part[(part['P_PARTKEY'] > 1) | (part['MFGR'] != 'Manufacturer#4') & (part['TYPE'].str.startswith('P')) & (part['SIZE'] <= 23)][['MFGR', 'P_NAME', 'CONTAINER', 'PT_COMMENT']].merge(customer[(customer['C_COMMENT'].str.startswith('i'))].merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_NAME'].str.startswith('M')) | (nation['N_NAME'] != 'V')], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='P_PARTKEY', right_on='C_CUSTKEY').merge(lineitem[(lineitem['SHIPMODE'].isin(['AIR', 'SHIP', 'REG AIR', 'MAIL', 'RAIL', 'TRUCK', 'FOB']))].merge(partsupp.merge(part[(part['MFGR'].isin(['Manufacturer#1', 'Manufacturer#5', 'Manufacturer#4', 'Manufacturer#3']))][['TYPE']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(supplier[(supplier['S_ADDRESS'].str.startswith('B'))].merge(nation[(nation['N_REGIONKEY'] <= 3) & (nation['N_COMMENT'] != 'y') | (nation['N_COMMENT'].str.startswith('c')) & (nation['N_REGIONKEY'] >= 3)].merge(region[['R_NAME', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='P_PARTKEY', right_on='S_SUPPKEY')

lineitem.merge(partsupp.merge(part[['MFGR']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp.merge(part[['CONTAINER', 'PT_COMMENT', 'P_PARTKEY']].merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['RECEIPTDATE', 'EXTENDEDPRICE']).agg('min', numeric_only=True)

supplier[['S_NAME']].merge(part[(part['P_PARTKEY'] < 165)][['P_PARTKEY', 'PT_COMMENT', 'P_NAME', 'RETAILPRICE']].merge(partsupp[['P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='S_SUPPKEY', right_on='P_PARTKEY')

orders[['ORDERDATE', 'O_COMMENT']].merge(part, left_on='O_ORDERKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['LINESTATUS'].isin(['O'])) | (lineitem['SHIPMODE'] != 'TRUCK') & (lineitem['L_PARTKEY'] > 109760)][['EXTENDEDPRICE']].merge(supplier[(supplier['S_NATIONKEY'] < 14) | (supplier['S_ACCTBAL'] <= 1631.3391385952066)][['S_COMMENT', 'S_ADDRESS']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY').merge(orders[(orders['O_COMMENT'] != 'i') | (orders['ORDERPRIORITY'] != '1-URGENT')][['CLERK']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).groupby(by=['O_COMMENT', 'ORDERDATE']).agg('min', numeric_only=True)

region

orders.merge(lineitem[(lineitem['SHIPMODE'] != 'SHIP') | (lineitem['SHIPINSTRUCT'] != 'TAKE BACK RETURN')], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer.merge(nation.merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_COMMENT'] != ' ') | (nation['N_REGIONKEY'] > 0)][['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME', 'N_COMMENT']].merge(customer[['C_ADDRESS']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

nation[(nation['N_NAME'] == 'S')][['N_NAME', 'N_COMMENT']]

orders[(orders['O_CUSTKEY'] < 42457) | (orders['TOTALPRICE'] < 240647.8048100257) & (orders['CLERK'] == 'C') & (orders['ORDERSTATUS'] == 'O')][['ORDERDATE', 'O_CUSTKEY']].merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer.merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['ORDERDATE']).agg('sum', numeric_only=True)

lineitem[(lineitem['SHIPMODE'] == 'RAIL') | (lineitem['RETURNFLAG'].isin(['R', 'A']))]

nation.merge(region[(region['R_REGIONKEY'] != 2) | (region['R_REGIONKEY'] <= 2) | (region['R_NAME'] != 'AFR') | (region['R_NAME'] == 'AME')][['R_NAME', 'R_COMMENT', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY')

supplier[['S_PHONE', 'S_NAME']].merge(partsupp[['SUPPLYCOST']], left_on='S_SUPPKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).groupby(by=['S_PHONE', 'S_NAME']).agg('mean', numeric_only=True)

region.groupby(by=['R_COMMENT', 'R_REGIONKEY']).agg('mean', numeric_only=True)

customer[['C_NAME', 'C_NATIONKEY', 'C_COMMENT']].merge(nation[['N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_REGIONKEY', 'N_COMMENT', 'N_NAME']].merge(region[['R_COMMENT']].merge(part[(part['TYPE'].str.startswith('E'))][['BRAND']], left_on='R_REGIONKEY', right_on='P_PARTKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_NAME'] == 'AFR') & (region['R_COMMENT'] != 'u')][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_NATIONKEY'] <= 8) & (nation['N_COMMENT'] != 'y')], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NAME'] == 'U') & (nation['N_NATIONKEY'] >= 6)].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_REGIONKEY'] == 0) | (region['R_REGIONKEY'] >= 1) | (region['R_REGIONKEY'] == 0)].merge(nation[['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

part[(part['SIZE'] == 18) & (part['CONTAINER'].str.startswith('JUMBO')) | (part['BRAND'].isin(['Brand#35', 'Brand#55', 'Brand#15', 'Brand#32', 'Brand#12', 'Brand#13', 'Brand#21', 'Brand#11', 'Brand#25', 'Brand#43', 'Brand#51', 'Brand#24', 'Brand#52', 'Brand#23', 'Brand#53', 'Brand#44', 'Brand#34', 'Brand#14', 'Brand#41', 'Brand#42', 'Brand#22', 'Brand#33', 'Brand#54'])) | (part['PT_COMMENT'] != 'o')][['MFGR', 'CONTAINER', 'SIZE']]

supplier[(supplier['S_SUPPKEY'] != 31) & (supplier['S_COMMENT'] == ' sl')].merge(nation[(nation['N_NATIONKEY'] > 1) | (nation['N_NATIONKEY'] == 2) & (nation['N_REGIONKEY'] != 1) & (nation['N_NAME'] != 'M')][['N_NAME', 'N_REGIONKEY', 'N_COMMENT']].merge(region[(region['R_REGIONKEY'] < 3) | (region['R_REGIONKEY'] < 2) | (region['R_REGIONKEY'] <= 0)][['R_REGIONKEY', 'R_COMMENT', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_REGIONKEY'] != 1) | (region['R_COMMENT'] != 'l') | (region['R_REGIONKEY'] >= 1)][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] <= 5955) & (partsupp['PS_SUPPKEY'] > 799)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_COMMENT']).agg('sum', numeric_only=True)

part.merge(partsupp[['PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT', 'AVAILQTY']].merge(part[(part['RETAILPRICE'] != 950.9227412041621) | (part['P_PARTKEY'] < 61) & (part['CONTAINER'] == 'LG') & (part['SIZE'] < 42)][['SIZE', 'P_PARTKEY', 'CONTAINER', 'RETAILPRICE']].merge(partsupp[['AVAILQTY', 'P_COMMENT', 'SUPPLYCOST', 'PS_SUPPKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['SHIPDATE'] >= '1992-04-27') | (lineitem['RECEIPTDATE'] == '1998-11-06') | (lineitem['L_ORDERKEY'] < 92)].merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['TYPE']).agg('min', numeric_only=True)

supplier[(supplier['S_NATIONKEY'] < 19) | (supplier['S_SUPPKEY'] == 85) & (supplier['S_SUPPKEY'] >= 77) & (supplier['S_NATIONKEY'] < 8)][['S_ACCTBAL', 'S_SUPPKEY', 'S_ADDRESS', 'S_COMMENT']].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp.merge(lineitem[['L_ORDERKEY', 'L_SUPPKEY']].merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_COMMENT']).agg('min', numeric_only=True)

partsupp[['AVAILQTY', 'PS_SUPPKEY', 'PS_PARTKEY']]

orders

nation[['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT', 'N_NAME']].merge(customer[(customer['C_CUSTKEY'] <= 57) & (customer['MKTSEGMENT'] != 'FURNITURE') | (customer['MKTSEGMENT'] == 'FURNITURE') | (customer['MKTSEGMENT'].isin(['MACHINERY', 'FURNITURE']))].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_NAME', 'N_REGIONKEY']).agg('count')

nation[['N_COMMENT', 'N_REGIONKEY']].groupby(by=['N_COMMENT', 'N_REGIONKEY']).agg('mean', numeric_only=True)

partsupp[(partsupp['AVAILQTY'] != 4148) & (partsupp['SUPPLYCOST'] <= 319.6570453771769) & (partsupp['PS_PARTKEY'] != 35) & (partsupp['PS_SUPPKEY'] != 5930)][['P_COMMENT', 'SUPPLYCOST']].merge(customer, left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='C_CUSTKEY').merge(lineitem[(lineitem['L_PARTKEY'] <= 153044) | (lineitem['LINESTATUS'] == 'O') & (lineitem['RECEIPTDATE'] == '1992-05-02')].merge(partsupp[['P_COMMENT', 'PS_SUPPKEY']].merge(supplier[(supplier['S_ACCTBAL'] <= 8918.400423422509)], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(part[['TYPE']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(supplier[(supplier['S_NAME'] == 'S') | (supplier['S_COMMENT'] == 'o') | (supplier['S_ACCTBAL'] <= 6987.39679581207) & (supplier['S_SUPPKEY'] > 175)][['S_NATIONKEY']].merge(nation[(nation['N_REGIONKEY'] != 2) | (nation['N_NATIONKEY'] < 16)][['N_NAME']].merge(customer[(customer['MKTSEGMENT'].isin(['MACHINERY', 'BUILDING', 'AUTOMOBILE', 'HOUSEHOLD'])) | (customer['C_NAME'].str.startswith('C')) & (customer['C_PHONE'].str.startswith('27-')) | (customer['C_COMMENT'] == 'c')][['C_PHONE', 'C_NAME', 'C_COMMENT', 'C_CUSTKEY', 'MKTSEGMENT']], left_on='N_NATIONKEY', right_on='C_CUSTKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_NATIONKEY', 'N_COMMENT', 'N_NAME']].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='S_SUPPKEY')

nation[(nation['N_NATIONKEY'] < 13) | (nation['N_NAME'].str.startswith('V')) | (nation['N_NATIONKEY'] != 3) & (nation['N_NATIONKEY'] < 2)][['N_REGIONKEY', 'N_NAME', 'N_NATIONKEY', 'N_COMMENT']].merge(customer[(customer['C_COMMENT'] != 'o')].merge(orders[(orders['SHIPPRIORITY'] < 0) & (orders['O_ORDERKEY'] == 756) & (orders['SHIPPRIORITY'] <= 0) | (orders['ORDERDATE'] <= '1998-07-21')].merge(customer[(customer['C_ACCTBAL'] != -624.8984896920806) | (customer['C_NAME'].str.startswith('C')) & (customer['C_COMMENT'] == 'e') | (customer['C_NAME'] == 'C')], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[['R_NAME']].merge(lineitem[(lineitem['L_PARTKEY'] < 194817) & (lineitem['DISCOUNT'] < 0.005492576913711811) & (lineitem['RETURNFLAG'].isin(['A', 'R', 'N'])) & (lineitem['L_COMMENT'] != 'r')][['EXTENDEDPRICE', 'QUANTITY', 'LINENUMBER', 'RECEIPTDATE', 'DISCOUNT']], left_on='R_REGIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(part[(part['MFGR'] == 'Manufacturer#2')][['SIZE', 'P_PARTKEY', 'TYPE']], left_on='R_REGIONKEY', right_on='P_PARTKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY')

customer[(customer['C_CUSTKEY'] <= 24) | (customer['C_ADDRESS'] != 'U') | (customer['C_ACCTBAL'] >= 1870.9056258358605)][['C_CUSTKEY']].merge(orders.merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_PHONE'].str.startswith('2'))][['C_ACCTBAL', 'C_PHONE', 'C_ADDRESS']].merge(part[(part['BRAND'] == 'Brand#12') & (part['P_PARTKEY'] <= 51)][['P_PARTKEY', 'BRAND']], left_on='C_CUSTKEY', right_on='P_PARTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['CLERK'] == 'C')], left_on='C_CUSTKEY', right_on='O_CUSTKEY')

orders[['CLERK', 'TOTALPRICE', 'O_CUSTKEY', 'O_COMMENT', 'ORDERSTATUS']].merge(customer.merge(nation[['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME', 'N_COMMENT']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['ORDERSTATUS']).agg('max', numeric_only=True)

orders[(orders['O_CUSTKEY'] >= 25247) | (orders['O_CUSTKEY'] < 125100) & (orders['O_COMMENT'] != 'f') | (orders['ORDERDATE'] <= '1998-07-21')][['TOTALPRICE', 'O_ORDERKEY']].merge(lineitem[(lineitem['TAX'] != 0.05694879641414415) | (lineitem['RECEIPTDATE'] >= '1998-11-06') & (lineitem['L_SUPPKEY'] != 427)][['SHIPMODE', 'LINENUMBER', 'SHIPINSTRUCT']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[['SHIPMODE']].merge(orders[(orders['SHIPPRIORITY'] != 0) & (orders['ORDERPRIORITY'] == '1-URGENT')], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[['TAX', 'QUANTITY', 'EXTENDEDPRICE', 'L_PARTKEY']].merge(partsupp[(partsupp['SUPPLYCOST'] < 67.16753368423923)][['PS_SUPPKEY', 'AVAILQTY', 'PS_PARTKEY', 'SUPPLYCOST', 'P_COMMENT']].merge(lineitem[(lineitem['TAX'] >= 0.05450713816941745) | (lineitem['L_SUPPKEY'] >= 1097) & (lineitem['RECEIPTDATE'] < '1998-11-06') & (lineitem['QUANTITY'] != 19)][['L_COMMENT', 'SHIPMODE', 'SHIPINSTRUCT', 'LINENUMBER', 'COMMITDATE']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['O_ORDERKEY', 'TOTALPRICE']).agg('min', numeric_only=True)

orders[(orders['TOTALPRICE'] != 215431.7763680725) & (orders['ORDERSTATUS'].isin(['F', 'P', 'O'])) & (orders['O_COMMENT'].str.startswith('q'))][['O_COMMENT', 'O_ORDERKEY', 'SHIPPRIORITY', 'TOTALPRICE']].merge(lineitem[(lineitem['DISCOUNT'] > 0.03694040146720079)][['EXTENDEDPRICE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['EXTENDEDPRICE'] == 75949.85009284907) | (lineitem['RETURNFLAG'] == 'R')].merge(partsupp.merge(lineitem[['LINENUMBER']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem.merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['AVAILQTY'] >= 3815) | (partsupp['P_COMMENT'] != 'f')][['PS_PARTKEY']].merge(part[['RETAILPRICE', 'CONTAINER', 'BRAND', 'PT_COMMENT', 'P_PARTKEY']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['TOTALPRICE']).agg('sum', numeric_only=True)

partsupp[(partsupp['AVAILQTY'] >= 710) | (partsupp['AVAILQTY'] >= 1833) & (partsupp['SUPPLYCOST'] != 957.2979801312152) | (partsupp['SUPPLYCOST'] > 207.76403750218816)][['PS_SUPPKEY', 'AVAILQTY']].merge(supplier[(supplier['S_NAME'].str.startswith('S')) | (supplier['S_NAME'].str.startswith('S')) & (supplier['S_PHONE'].str.startswith('26-')) & (supplier['S_NATIONKEY'] == 12)], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[(lineitem['LINESTATUS'].isin(['O', 'F'])) & (lineitem['TAX'] >= 0.01745637148701367)][['L_SUPPKEY', 'DISCOUNT']].merge(partsupp.merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['SUPPLYCOST'] <= 350.1447343776322) | (partsupp['P_COMMENT'] != 'h') | (partsupp['SUPPLYCOST'] > 132.5293840830413)].merge(part[['P_NAME']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').groupby(by=['PS_SUPPKEY']).agg('sum', numeric_only=True)

orders[(orders['ORDERDATE'] == '1992-01-13') & (orders['ORDERDATE'] != '1992-01-13') & (orders['O_COMMENT'] != 'y')][['TOTALPRICE', 'SHIPPRIORITY', 'O_COMMENT', 'ORDERPRIORITY', 'O_ORDERKEY']].merge(lineitem.merge(orders[(orders['O_COMMENT'].str.startswith('.')) | (orders['ORDERDATE'] > '1992-01-13') & (orders['CLERK'] != 'C')][['O_CUSTKEY']].merge(customer[(customer['C_PHONE'] != '3') & (customer['C_NAME'].str.startswith('C'))][['C_PHONE', 'C_ACCTBAL']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['EXTENDEDPRICE'] >= 17104.931206331497) & (lineitem['L_PARTKEY'] <= 8531) | (lineitem['L_ORDERKEY'] > 120) & (lineitem['L_ORDERKEY'] < 122)].merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['RETURNFLAG'].isin(['A', 'N', 'R']))], left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['TOTALPRICE']).agg('sum', numeric_only=True)

nation[(nation['N_NATIONKEY'] < 6) & (nation['N_NATIONKEY'] >= 2) & (nation['N_NAME'].str.startswith('A')) | (nation['N_REGIONKEY'] >= 1)][['N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY', 'N_NAME']]

lineitem.merge(partsupp[['AVAILQTY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['SHIPINSTRUCT']).agg('max', numeric_only=True)

orders.merge(lineitem[['LINESTATUS', 'QUANTITY', 'COMMITDATE']].merge(region.merge(nation[['N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY')

customer[(customer['C_NAME'] != 'C') & (customer['C_ACCTBAL'] == 3391.3162315999107)].merge(orders[(orders['O_CUSTKEY'] > 103242) & (orders['CLERK'] == 'C') & (orders['CLERK'].str.startswith('C')) & (orders['ORDERSTATUS'].isin(['P']))].merge(lineitem[(lineitem['L_ORDERKEY'] != 72)][['L_ORDERKEY', 'LINESTATUS']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

partsupp[(partsupp['PS_PARTKEY'] < 27) & (partsupp['PS_SUPPKEY'] == 6589) | (partsupp['PS_SUPPKEY'] >= 844)].merge(part[['RETAILPRICE', 'CONTAINER', 'MFGR', 'BRAND']].merge(partsupp[['PS_SUPPKEY', 'AVAILQTY']].merge(lineitem[['LINENUMBER', 'L_PARTKEY']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(nation[['N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY', 'N_NAME']].merge(supplier[['S_COMMENT', 'S_PHONE', 'S_NATIONKEY', 'S_ACCTBAL']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='P_PARTKEY', right_on='N_NATIONKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem.merge(partsupp[(partsupp['SUPPLYCOST'] <= 752.0581033154987) | (partsupp['AVAILQTY'] > 7364)][['SUPPLYCOST', 'AVAILQTY', 'PS_PARTKEY', 'P_COMMENT', 'PS_SUPPKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['AVAILQTY'] <= 6929) | (partsupp['SUPPLYCOST'] == 727.36823960298) | (partsupp['PS_SUPPKEY'] != 5708)].merge(lineitem[(lineitem['RETURNFLAG'].isin(['R', 'A'])) | (lineitem['SHIPMODE'] == 'SHIP') | (lineitem['LINENUMBER'] > 6)][['SHIPMODE']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier[(supplier['S_NAME'].str.startswith('S'))][['S_NATIONKEY', 'S_ACCTBAL', 'S_ADDRESS', 'S_PHONE']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['AVAILQTY']).agg('max', numeric_only=True)

part[(part['TYPE'].str.startswith('STA'))].merge(partsupp.merge(lineitem.merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['SHIPDATE'] <= '1998-10-30') & (lineitem['L_ORDERKEY'] == 181)][['SHIPMODE', 'EXTENDEDPRICE', 'L_PARTKEY', 'L_COMMENT']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] != 5379) & (partsupp['P_COMMENT'].str.startswith('a'))], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['SUPPLYCOST'] < 344.5554340956001) | (partsupp['SUPPLYCOST'] != 616.1275290871952) | (partsupp['SUPPLYCOST'] > 422.2616419736398) | (partsupp['SUPPLYCOST'] >= 526.1130257502319)][['P_COMMENT', 'PS_PARTKEY']].merge(lineitem[(lineitem['QUANTITY'] <= 19) & (lineitem['SHIPMODE'] != 'SHIP') | (lineitem['COMMITDATE'] <= '1992-05-15') & (lineitem['RECEIPTDATE'] != '1998-11-06')].merge(partsupp[['PS_SUPPKEY', 'SUPPLYCOST', 'PS_PARTKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['L_ORDERKEY'] < 166) | (lineitem['TAX'] != 0.039282923675047245) | (lineitem['RECEIPTDATE'] < '1998-11-06')][['L_COMMENT', 'L_PARTKEY', 'QUANTITY', 'SHIPINSTRUCT']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

nation[(nation['N_COMMENT'] != 'v') | (nation['N_REGIONKEY'] >= 0) & (nation['N_COMMENT'] != 'c')].merge(supplier[['S_NATIONKEY', 'S_COMMENT', 'S_ACCTBAL', 'S_PHONE', 'S_SUPPKEY']].merge(nation[['N_REGIONKEY', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY')

supplier.merge(partsupp[(partsupp['SUPPLYCOST'] >= 971.5719726099879) & (partsupp['P_COMMENT'].str.startswith('.')) & (partsupp['PS_SUPPKEY'] != 5588)][['PS_PARTKEY']].merge(part[(part['PT_COMMENT'] == 'a') | (part['PT_COMMENT'] != 'w')], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation.merge(customer[(customer['MKTSEGMENT'].isin(['BUILDING', 'HOUSEHOLD', 'FURNITURE', 'MACHINERY'])) & (customer['C_NAME'] == 'C') | (customer['C_NAME'] != 'C') | (customer['C_ACCTBAL'] <= 3018.657320595674)], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_NATIONKEY', 'S_ADDRESS']).agg('mean', numeric_only=True)

orders[(orders['ORDERPRIORITY'] == '4-NOT SPECIFIED') | (orders['ORDERDATE'] <= '1992-01-13')].merge(customer[(customer['C_ACCTBAL'] >= -636.0948109823662) | (customer['C_COMMENT'].str.startswith('w')) & (customer['C_PHONE'] != '18-') | (customer['C_ACCTBAL'] == 8956.84288591982)].merge(nation[(nation['N_COMMENT'].str.startswith('v')) | (nation['N_COMMENT'] != 'r') & (nation['N_NAME'] != 'C')][['N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NAME'] != 'J') | (nation['N_COMMENT'] != 'p')].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['ORDERDATE']).agg('sum', numeric_only=True)

partsupp[['SUPPLYCOST', 'AVAILQTY']].merge(nation[(nation['N_NATIONKEY'] < 10)].merge(region[['R_COMMENT']].merge(orders[(orders['O_COMMENT'] == 'a') | (orders['ORDERSTATUS'].isin(['P'])) & (orders['O_CUSTKEY'] == 3132) & (orders['TOTALPRICE'] > 344911.54365760495)][['O_CUSTKEY']], left_on='R_REGIONKEY', right_on='O_ORDERKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY').groupby(by=['SUPPLYCOST', 'AVAILQTY']).agg('min', numeric_only=True)

part[['PT_COMMENT', 'P_NAME', 'SIZE']].merge(supplier[(supplier['S_ADDRESS'] == 'y') | (supplier['S_PHONE'] != '28-') | (supplier['S_NATIONKEY'] <= 3)][['S_SUPPKEY']], left_on='P_PARTKEY', right_on='S_SUPPKEY').groupby(by=['SIZE']).agg('sum', numeric_only=True)

lineitem[(lineitem['EXTENDEDPRICE'] < 69962.96183560058) | (lineitem['TAX'] >= 0.03163233464784837)][['RECEIPTDATE', 'SHIPINSTRUCT', 'RETURNFLAG', 'L_PARTKEY']].merge(partsupp.merge(supplier.merge(partsupp[(partsupp['PS_SUPPKEY'] < 1777)][['PS_PARTKEY', 'AVAILQTY', 'SUPPLYCOST']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY')

nation[(nation['N_COMMENT'] == 'v') | (nation['N_NAME'].str.startswith('B')) & (nation['N_NAME'] != 'I') | (nation['N_REGIONKEY'] > 3)].merge(customer[(customer['C_NATIONKEY'] < 7)].merge(nation[['N_NAME', 'N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders.merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_COMMENT'].str.startswith('u')) & (region['R_NAME'].str.startswith('AFR')) | (region['R_COMMENT'] != 'u') | (region['R_REGIONKEY'] < 1)].merge(nation[(nation['N_NAME'].str.startswith('C'))][['N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_NAME']).agg('count')

region[(region['R_REGIONKEY'] <= 0) | (region['R_NAME'] != 'M')].merge(nation.merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT']).agg('count')

part[(part['SIZE'] != 26) | (part['BRAND'] == 'Brand#25') & (part['TYPE'] == 'E')].merge(partsupp[['AVAILQTY', 'SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT', 'PS_PARTKEY']].merge(part[['TYPE', 'CONTAINER', 'MFGR', 'PT_COMMENT', 'P_NAME']], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['RETAILPRICE', 'PT_COMMENT']).agg('mean', numeric_only=True)

supplier[(supplier['S_NATIONKEY'] >= 6)][['S_NAME', 'S_PHONE', 'S_ACCTBAL', 'S_ADDRESS', 'S_COMMENT']].merge(customer[(customer['C_PHONE'] != '3') | (customer['C_PHONE'] == '13-') | (customer['C_ACCTBAL'] >= 3944.4626254605955) & (customer['C_ACCTBAL'] > 8608.932307539197)], left_on='S_SUPPKEY', right_on='C_CUSTKEY').groupby(by=['S_ADDRESS', 'S_COMMENT']).agg('max', numeric_only=True)

region[(region['R_COMMENT'].str.startswith('u')) | (region['R_REGIONKEY'] == 3) | (region['R_NAME'] != 'A')][['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation[(nation['N_COMMENT'].str.startswith('i')) & (nation['N_REGIONKEY'] > 3) & (nation['N_NATIONKEY'] != 8) | (nation['N_REGIONKEY'] == 1)][['N_NATIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] == 'h') | (nation['N_COMMENT'] == 'o') | (nation['N_NATIONKEY'] <= 6)][['N_NAME']].merge(lineitem[['COMMITDATE', 'SHIPDATE', 'RETURNFLAG', 'LINENUMBER']], left_on='N_NATIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME']).agg('count')

region[['R_NAME', 'R_COMMENT']].merge(partsupp[(partsupp['PS_SUPPKEY'] != 1946) | (partsupp['PS_SUPPKEY'] > 2849) & (partsupp['P_COMMENT'].str.startswith('l'))].merge(part[(part['P_PARTKEY'] <= 80) | (part['MFGR'] != 'Manufacturer#4') | (part['SIZE'] == 27) | (part['PT_COMMENT'] == 'x')][['BRAND', 'MFGR', 'CONTAINER']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='R_REGIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(partsupp[(partsupp['PS_PARTKEY'] >= 2) & (partsupp['AVAILQTY'] <= 7218) | (partsupp['P_COMMENT'] != 'o')].merge(lineitem[['LINENUMBER', 'TAX', 'DISCOUNT', 'QUANTITY']].merge(region, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='R_REGIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY'])

part

supplier[(supplier['S_COMMENT'] == 'd') | (supplier['S_SUPPKEY'] != 194)].merge(nation[(nation['N_NAME'] == 'J') & (nation['N_REGIONKEY'] > 3)][['N_NAME', 'N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_REGIONKEY'] < 1) & (nation['N_NAME'] == 'A') & (nation['N_NAME'].str.startswith('C'))][['N_NATIONKEY', 'N_NAME', 'N_REGIONKEY']].merge(customer[(customer['C_ACCTBAL'] == 3909.6748431097867) & (customer['C_ADDRESS'].str.startswith('g')) | (customer['MKTSEGMENT'] == 'HOUSEHOLD')][['C_NAME', 'MKTSEGMENT']].merge(nation[(nation['N_REGIONKEY'] < 0) | (nation['N_NATIONKEY'] == 1) | (nation['N_NATIONKEY'] != 2) & (nation['N_REGIONKEY'] > 0)], left_on='C_CUSTKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[['R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NATIONKEY'] <= 22) & (nation['N_REGIONKEY'] < 1)][['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME', 'N_COMMENT']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_SUPPKEY', 'S_ADDRESS']).agg('mean', numeric_only=True)

orders[(orders['O_ORDERKEY'] >= 100) & (orders['ORDERSTATUS'] != 'F') & (orders['O_ORDERKEY'] <= 131)][['ORDERPRIORITY']].merge(lineitem, left_on='O_ORDERKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(part[(part['P_NAME'] != 'd')].merge(partsupp[(partsupp['P_COMMENT'] == 'g') | (partsupp['AVAILQTY'] >= 9260) | (partsupp['AVAILQTY'] != 5487)].merge(lineitem[(lineitem['SHIPINSTRUCT'].isin(['COLLECT COD'])) | (lineitem['RECEIPTDATE'] >= '1998-11-06') & (lineitem['SHIPINSTRUCT'] != 'NONE') & (lineitem['EXTENDEDPRICE'] < 53447.904713868964)], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_PARTKEY'] != 22) | (partsupp['AVAILQTY'] != 3617) | (partsupp['AVAILQTY'] == 4299)].merge(lineitem[['SHIPINSTRUCT', 'L_PARTKEY', 'SHIPMODE', 'QUANTITY']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='P_PARTKEY').merge(supplier.merge(partsupp[(partsupp['SUPPLYCOST'] <= 497.8739894542145) | (partsupp['SUPPLYCOST'] > 18.50272656786894) & (partsupp['P_COMMENT'] == 'r')][['P_COMMENT', 'SUPPLYCOST', 'AVAILQTY', 'PS_PARTKEY', 'PS_SUPPKEY']].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='S_SUPPKEY').groupby(by=['ORDERPRIORITY']).agg('max', numeric_only=True)

lineitem[(lineitem['L_ORDERKEY'] <= 81) & (lineitem['RETURNFLAG'] != 'A') | (lineitem['TAX'] != 0.074032205183071)].merge(partsupp[(partsupp['PS_SUPPKEY'] < 1160) | (partsupp['PS_PARTKEY'] == 48) | (partsupp['SUPPLYCOST'] != 346.25763063358045)][['PS_SUPPKEY', 'PS_PARTKEY', 'AVAILQTY', 'SUPPLYCOST']].merge(lineitem[['SHIPINSTRUCT', 'SHIPMODE']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['L_PARTKEY'] < 167165) | (lineitem['DISCOUNT'] == 0.06984825190791964)][['DISCOUNT']].merge(nation[['N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY', 'N_NAME']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(lineitem[(lineitem['L_SUPPKEY'] > 9010)], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[['RETAILPRICE', 'MFGR']].merge(nation[(nation['N_REGIONKEY'] >= 1)][['N_NATIONKEY', 'N_REGIONKEY']], left_on='P_PARTKEY', right_on='N_NATIONKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['DISCOUNT']).agg('count')

region[['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation[(nation['N_COMMENT'] != 'p')][['N_REGIONKEY', 'N_NAME']].merge(region[(region['R_REGIONKEY'] != 0)].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_NAME'] != 'AME')][['R_COMMENT', 'R_REGIONKEY']].merge(nation[['N_COMMENT', 'N_REGIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] == 'S') & (nation['N_COMMENT'] != ' ') & (nation['N_NATIONKEY'] != 11)][['N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY', 'N_NAME']].merge(customer[(customer['MKTSEGMENT'] == 'HOUSEHOLD')].merge(orders[(orders['O_CUSTKEY'] == 8889) & (orders['O_ORDERKEY'] != 180)], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_REGIONKEY'] >= 3) | (region['R_COMMENT'] == 'h') & (region['R_REGIONKEY'] != 2) & (region['R_REGIONKEY'] < 1)][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY', 'R_COMMENT']).agg('count')

part[(part['MFGR'] == 'Manufacturer#5') | (part['CONTAINER'] != 'JUMBO') & (part['P_PARTKEY'] <= 134) & (part['MFGR'] == 'Manufacturer#3')][['MFGR', 'BRAND', 'P_PARTKEY']].groupby(by=['P_PARTKEY', 'BRAND']).agg('mean', numeric_only=True)

orders[['TOTALPRICE', 'O_CUSTKEY', 'CLERK']].merge(customer[(customer['C_CUSTKEY'] == 25)].merge(nation.merge(region[(region['R_REGIONKEY'] <= 3) & (region['R_COMMENT'] != 'h') | (region['R_REGIONKEY'] >= 0)][['R_NAME', 'R_COMMENT', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_CUSTKEY'] >= 8) | (customer['C_NATIONKEY'] > 15)].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

customer[(customer['C_ADDRESS'] == '6') & (customer['MKTSEGMENT'] == 'AUTOMOBILE') & (customer['C_PHONE'] != '3') & (customer['C_ADDRESS'] != '7')][['C_NATIONKEY', 'C_ADDRESS']].merge(nation[['N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NAME'].str.startswith('U')) & (nation['N_NAME'] != 'J') | (nation['N_COMMENT'] == 'o')].merge(customer[['C_COMMENT', 'C_ADDRESS']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_NATIONKEY', 'C_ADDRESS']).agg('count')

nation[['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT', 'N_NAME']].merge(supplier.merge(partsupp[(partsupp['P_COMMENT'].str.startswith('u')) | (partsupp['PS_PARTKEY'] > 47) & (partsupp['AVAILQTY'] > 3073)][['P_COMMENT', 'SUPPLYCOST', 'PS_SUPPKEY', 'AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_NAME']).agg('max', numeric_only=True)

part[['SIZE', 'P_NAME', 'RETAILPRICE']].merge(partsupp[(partsupp['AVAILQTY'] <= 4693) | (partsupp['P_COMMENT'] == 'b') & (partsupp['PS_PARTKEY'] < 25)].merge(supplier.merge(nation[(nation['N_NAME'] != 'C') | (nation['N_NAME'].str.startswith('A'))][['N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(part[(part['SIZE'] > 33)], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(supplier[['S_NATIONKEY', 'S_SUPPKEY', 'S_COMMENT', 'S_ADDRESS', 'S_PHONE']], left_on='P_PARTKEY', right_on='S_SUPPKEY')

orders[(orders['TOTALPRICE'] >= 329690.71912138816) | (orders['O_ORDERKEY'] < 449)].groupby(by=['ORDERSTATUS']).agg('min', numeric_only=True)

partsupp[['PS_PARTKEY', 'SUPPLYCOST', 'AVAILQTY', 'P_COMMENT']].merge(lineitem[(lineitem['SHIPDATE'] <= '1992-04-27') & (lineitem['LINENUMBER'] != 5)][['LINESTATUS', 'L_ORDERKEY', 'LINENUMBER', 'SHIPDATE']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[['COMMITDATE', 'L_PARTKEY']].merge(partsupp[['SUPPLYCOST', 'P_COMMENT', 'PS_PARTKEY']].merge(part[(part['P_NAME'] != 'd')][['SIZE', 'P_NAME', 'RETAILPRICE', 'CONTAINER']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['EXTENDEDPRICE'] <= 60586.34659067776) & (lineitem['L_ORDERKEY'] <= 36) & (lineitem['COMMITDATE'] <= '1998-10-16') | (lineitem['L_SUPPKEY'] >= 5839)].merge(orders[['SHIPPRIORITY', 'ORDERDATE', 'ORDERPRIORITY', 'O_CUSTKEY', 'O_COMMENT']].merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY')

nation[['N_REGIONKEY', 'N_COMMENT', 'N_NAME', 'N_NATIONKEY']].merge(customer[['C_PHONE']].merge(orders[['CLERK', 'O_ORDERKEY', 'TOTALPRICE']].merge(lineitem[(lineitem['L_PARTKEY'] != 189148) & (lineitem['LINENUMBER'] > 5) | (lineitem['DISCOUNT'] != 0.04266474801641601) | (lineitem['L_SUPPKEY'] == 5498)][['LINENUMBER', 'EXTENDEDPRICE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_ORDERKEY').merge(orders[['O_ORDERKEY', 'TOTALPRICE', 'O_COMMENT']], left_on='C_CUSTKEY', right_on='O_ORDERKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[['MKTSEGMENT', 'C_COMMENT']].merge(region[(region['R_REGIONKEY'] < 1) & (region['R_REGIONKEY'] >= 3) & (region['R_NAME'] == 'A')][['R_NAME', 'R_REGIONKEY']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='C_CUSTKEY', right_on='R_REGIONKEY').merge(orders[(orders['O_ORDERKEY'] == 418) | (orders['O_CUSTKEY'] == 78063) | (orders['ORDERSTATUS'].isin(['P'])) & (orders['O_ORDERKEY'] < 438)].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_ORDERKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

lineitem[(lineitem['L_PARTKEY'] != 103523) | (lineitem['EXTENDEDPRICE'] <= 63328.18473832604)][['L_ORDERKEY', 'L_PARTKEY', 'LINENUMBER']].merge(orders[(orders['ORDERSTATUS'].isin(['O'])) | (orders['ORDERPRIORITY'] == '2-HIGH') | (orders['ORDERPRIORITY'] != '4-NOT SPECIFIED')][['ORDERDATE', 'O_ORDERKEY', 'O_CUSTKEY', 'SHIPPRIORITY', 'CLERK']].merge(lineitem[(lineitem['L_SUPPKEY'] < 5704) & (lineitem['L_SUPPKEY'] == 9627)], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['SHIPMODE'].isin(['MAIL', 'TRUCK', 'RAIL'])) & (lineitem['L_PARTKEY'] <= 28169) | (lineitem['LINESTATUS'] != 'O')], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['O_ORDERKEY'] == 651) & (orders['CLERK'] != 'C') | (orders['ORDERPRIORITY'].isin(['5-LOW', '1-URGENT', '3-MEDIUM', '2-HIGH', '4-NOT SPECIFIED'])) & (orders['O_COMMENT'] != 'g')].merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer.merge(nation[(nation['N_NATIONKEY'] != 4) | (nation['N_REGIONKEY'] < 1) & (nation['N_COMMENT'].str.startswith('y'))][['N_NATIONKEY', 'N_COMMENT', 'N_NAME', 'N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[['PS_SUPPKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY')

supplier.merge(partsupp[(partsupp['AVAILQTY'] > 1153) | (partsupp['AVAILQTY'] < 9515)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_ADDRESS']).agg('count')

partsupp[(partsupp['PS_SUPPKEY'] >= 3023)][['SUPPLYCOST', 'PS_PARTKEY', 'P_COMMENT', 'AVAILQTY']].merge(part.merge(partsupp.merge(supplier[['S_SUPPKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[(part['CONTAINER'].str.startswith('WRAP')) | (part['CONTAINER'] != 'LG')].merge(partsupp[(partsupp['PS_SUPPKEY'] > 5517) & (partsupp['PS_SUPPKEY'] != 4133) & (partsupp['AVAILQTY'] == 8038)][['SUPPLYCOST']], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['AVAILQTY'] != 5525) | (partsupp['PS_PARTKEY'] <= 19) & (partsupp['AVAILQTY'] <= 2732) | (partsupp['PS_SUPPKEY'] < 6457)].merge(supplier[['S_ADDRESS', 'S_ACCTBAL', 'S_PHONE', 'S_NATIONKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY')

nation[(nation['N_REGIONKEY'] < 2)][['N_NAME', 'N_NATIONKEY']].groupby(by=['N_NAME']).agg('min', numeric_only=True)

lineitem[(lineitem['LINESTATUS'] == 'O') & (lineitem['QUANTITY'] > 23)][['L_PARTKEY', 'QUANTITY', 'EXTENDEDPRICE', 'DISCOUNT', 'TAX']].merge(partsupp[(partsupp['PS_SUPPKEY'] <= 4103)], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['SUPPLYCOST'] < 855.1503296077589) | (partsupp['PS_PARTKEY'] < 6)].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['RECEIPTDATE'] < '1992-05-02')].merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['P_COMMENT', 'AVAILQTY', 'PS_PARTKEY', 'PS_SUPPKEY', 'SUPPLYCOST']].merge(part.merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY')

customer[(customer['C_NATIONKEY'] <= 20) & (customer['C_ADDRESS'] == '6') & (customer['C_ACCTBAL'] == 9554.161351148761)][['C_CUSTKEY', 'C_NATIONKEY', 'C_NAME']].merge(nation[(nation['N_COMMENT'] == 'p')][['N_NAME', 'N_COMMENT', 'N_REGIONKEY']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[['TOTALPRICE', 'O_CUSTKEY']].merge(customer[['C_PHONE', 'MKTSEGMENT']].merge(part[['PT_COMMENT', 'MFGR', 'RETAILPRICE', 'TYPE', 'BRAND']], left_on='C_CUSTKEY', right_on='P_PARTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[['C_CUSTKEY', 'MKTSEGMENT', 'C_COMMENT']].merge(orders[(orders['ORDERDATE'] == '1998-07-21') | (orders['ORDERPRIORITY'] == '1-URGENT') & (orders['ORDERDATE'] == '1998-07-21')][['SHIPPRIORITY', 'O_ORDERKEY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

lineitem.merge(orders[(orders['TOTALPRICE'] != 189486.66190062338) & (orders['SHIPPRIORITY'] == 0) & (orders['ORDERDATE'] > '1992-01-13') & (orders['CLERK'] != 'C')][['ORDERSTATUS']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[['AVAILQTY', 'PS_SUPPKEY', 'PS_PARTKEY', 'P_COMMENT', 'SUPPLYCOST']], left_on='L_PARTKEY', right_on='PS_PARTKEY')

part[['P_PARTKEY', 'RETAILPRICE']].groupby(by=['P_PARTKEY', 'RETAILPRICE']).agg('mean', numeric_only=True)

region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].groupby(by=['R_REGIONKEY', 'R_NAME']).agg('max', numeric_only=True)

partsupp[(partsupp['AVAILQTY'] > 436) | (partsupp['SUPPLYCOST'] <= 742.9378309631072) | (partsupp['AVAILQTY'] >= 2836)]

orders[(orders['O_COMMENT'] != 'l') | (orders['ORDERPRIORITY'] != '1-URGENT') | (orders['ORDERPRIORITY'].isin(['5-LOW', '2-HIGH', '3-MEDIUM', '4-NOT SPECIFIED']))][['O_ORDERKEY', 'TOTALPRICE', 'O_COMMENT', 'O_CUSTKEY']].groupby(by=['O_ORDERKEY', 'O_CUSTKEY']).agg('min', numeric_only=True)

customer[(customer['C_ADDRESS'] == 'g')][['MKTSEGMENT', 'C_NATIONKEY', 'C_COMMENT', 'C_NAME']].merge(nation.merge(region.merge(nation[['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[(supplier['S_NATIONKEY'] == 17) & (supplier['S_COMMENT'] != 'h') | (supplier['S_SUPPKEY'] <= 140) & (supplier['S_SUPPKEY'] != 168)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_NATIONKEY', 'C_NAME']).agg('mean', numeric_only=True)

lineitem.merge(partsupp[['PS_SUPPKEY', 'PS_PARTKEY', 'SUPPLYCOST', 'AVAILQTY', 'P_COMMENT']].merge(part[['MFGR', 'SIZE']].merge(customer[(customer['C_COMMENT'].str.startswith('l')) & (customer['C_ADDRESS'] != 'M') & (customer['MKTSEGMENT'] == 'MACHINERY') & (customer['C_NAME'].str.startswith('C'))][['C_ADDRESS', 'C_COMMENT', 'C_NATIONKEY']], left_on='P_PARTKEY', right_on='C_CUSTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['QUANTITY'] > 33) & (lineitem['L_ORDERKEY'] >= 62)][['LINESTATUS']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] < 7296) & (partsupp['SUPPLYCOST'] > 825.8011710586939) | (partsupp['PS_SUPPKEY'] < 5882) | (partsupp['PS_SUPPKEY'] >= 6171)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['L_COMMENT', 'SHIPINSTRUCT']).agg('sum', numeric_only=True)

region[['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation.merge(customer[(customer['MKTSEGMENT'].isin(['AUTOMOBILE', 'FURNITURE']))][['C_NATIONKEY', 'C_ACCTBAL', 'C_NAME']].merge(nation[['N_COMMENT']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

partsupp.merge(supplier[(supplier['S_SUPPKEY'] <= 97) | (supplier['S_PHONE'] != '17-') & (supplier['S_SUPPKEY'] > 161)][['S_COMMENT', 'S_SUPPKEY', 'S_NAME']].merge(partsupp[(partsupp['PS_PARTKEY'] < 28) & (partsupp['SUPPLYCOST'] >= 67.61950060888645) | (partsupp['P_COMMENT'] != '.')][['PS_SUPPKEY', 'PS_PARTKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp.merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem.merge(orders[['ORDERPRIORITY', 'O_CUSTKEY']].merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[['P_PARTKEY', 'MFGR']], left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['P_COMMENT']).agg('mean', numeric_only=True)

orders[['ORDERPRIORITY', 'O_COMMENT', 'ORDERSTATUS', 'ORDERDATE', 'CLERK']].merge(lineitem[['RECEIPTDATE', 'SHIPMODE', 'L_SUPPKEY', 'DISCOUNT', 'EXTENDEDPRICE']].merge(partsupp.merge(supplier[(supplier['S_COMMENT'] != ',') | (supplier['S_COMMENT'].str.startswith('d')) & (supplier['S_SUPPKEY'] <= 137) & (supplier['S_SUPPKEY'] >= 34)][['S_PHONE', 'S_NATIONKEY', 'S_COMMENT']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['P_COMMENT'] == 'ly ') & (partsupp['PS_PARTKEY'] >= 41) & (partsupp['P_COMMENT'] == 'q') & (partsupp['P_COMMENT'] != 'y')][['AVAILQTY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).groupby(by=['O_COMMENT']).agg('sum', numeric_only=True)

region[(region['R_COMMENT'].str.startswith('h')) & (region['R_REGIONKEY'] != 2)][['R_COMMENT', 'R_REGIONKEY', 'R_NAME']]

customer[(customer['C_ACCTBAL'] > 5146.598684271006) | (customer['C_NATIONKEY'] > 12)][['C_ADDRESS', 'C_NAME', 'C_CUSTKEY', 'C_NATIONKEY']].merge(nation[['N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY')

partsupp[['PS_SUPPKEY', 'P_COMMENT', 'AVAILQTY', 'PS_PARTKEY', 'SUPPLYCOST']].merge(lineitem[(lineitem['EXTENDEDPRICE'] != 4178.168782682666) & (lineitem['LINENUMBER'] == 2) | (lineitem['SHIPDATE'] > '1998-10-30')], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier[(supplier['S_PHONE'] == '3') & (supplier['S_NATIONKEY'] != 23)][['S_ACCTBAL', 'S_ADDRESS', 'S_NAME', 'S_NATIONKEY', 'S_PHONE']].merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT', 'N_NAME']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[['QUANTITY', 'L_PARTKEY', 'DISCOUNT', 'TAX', 'COMMITDATE']].merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['AVAILQTY'] < 3777) | (partsupp['PS_SUPPKEY'] == 597)][['P_COMMENT', 'SUPPLYCOST']].merge(supplier[(supplier['S_NAME'].str.startswith('S'))], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY')

orders.merge(lineitem[(lineitem['LINENUMBER'] <= 5) | (lineitem['L_COMMENT'] != 'c')][['LINENUMBER', 'LINESTATUS', 'SHIPINSTRUCT', 'L_SUPPKEY']].merge(partsupp.merge(supplier[(supplier['S_COMMENT'].str.startswith('h')) | (supplier['S_NATIONKEY'] < 11) | (supplier['S_ADDRESS'] == 't')], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_PHONE'] != '1') | (customer['C_CUSTKEY'] < 7)][['C_PHONE', 'C_COMMENT', 'C_ACCTBAL']], left_on='O_CUSTKEY', right_on='C_CUSTKEY')

customer[(customer['C_PHONE'].str.startswith('22-'))][['MKTSEGMENT', 'C_CUSTKEY']].merge(orders[(orders['ORDERDATE'] <= '1992-01-13')], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders.merge(lineitem[(lineitem['DISCOUNT'] > 0.09193687985258647)].merge(orders[(orders['O_COMMENT'] == ' ') & (orders['ORDERSTATUS'].isin(['P', 'O']))], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders.merge(customer[(customer['C_NAME'].str.startswith('C')) | (customer['MKTSEGMENT'] == 'BUILDING') & (customer['C_ADDRESS'] != 'u') | (customer['C_ACCTBAL'] == 9714.318193144089)][['C_ADDRESS', 'MKTSEGMENT', 'C_NATIONKEY', 'C_ACCTBAL']].merge(nation[(nation['N_COMMENT'] == ' ') | (nation['N_NATIONKEY'] <= 0) & (nation['N_REGIONKEY'] > 0)], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_CUSTKEY'] > 94)].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

region[(region['R_NAME'] != 'E') & (region['R_NAME'] == 'M') | (region['R_NAME'].str.startswith('M'))].merge(nation[(nation['N_REGIONKEY'] > 1)].merge(customer[['C_COMMENT']].merge(nation[['N_REGIONKEY', 'N_COMMENT', 'N_NAME', 'N_NATIONKEY']], left_on='C_CUSTKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

supplier[(supplier['S_PHONE'] == '2') & (supplier['S_COMMENT'].str.startswith('y'))].merge(partsupp[(partsupp['PS_PARTKEY'] < 44) & (partsupp['P_COMMENT'].str.startswith('u')) & (partsupp['AVAILQTY'] != 6002)][['AVAILQTY', 'PS_PARTKEY', 'PS_SUPPKEY', 'SUPPLYCOST']].merge(part[['RETAILPRICE', 'P_NAME']].merge(supplier[['S_NAME', 'S_ACCTBAL', 'S_COMMENT', 'S_PHONE', 'S_SUPPKEY']], left_on='P_PARTKEY', right_on='S_SUPPKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[['LINESTATUS', 'SHIPINSTRUCT']].merge(supplier[(supplier['S_SUPPKEY'] < 146) & (supplier['S_PHONE'].str.startswith('17-')) | (supplier['S_ADDRESS'] != 'n') | (supplier['S_ADDRESS'].str.startswith('u'))][['S_SUPPKEY', 'S_NAME', 'S_PHONE', 'S_ADDRESS']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

customer[(customer['C_ADDRESS'] == 'M') | (customer['MKTSEGMENT'] == 'AUTOMOBILE')].groupby(by=['C_PHONE', 'C_ADDRESS']).agg('mean', numeric_only=True)

orders[(orders['O_COMMENT'] == 'g') & (orders['ORDERPRIORITY'] == '2-HIGH') | (orders['ORDERSTATUS'] == 'P')].merge(customer[['C_ACCTBAL', 'C_NAME', 'C_CUSTKEY', 'MKTSEGMENT']].merge(orders[(orders['ORDERPRIORITY'] == '3-MEDIUM') & (orders['TOTALPRICE'] < 231121.0813110274) & (orders['ORDERDATE'] >= '1992-01-13')], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['O_COMMENT', 'O_CUSTKEY']).agg('max', numeric_only=True)

customer[['C_ADDRESS', 'C_NATIONKEY', 'MKTSEGMENT', 'C_PHONE', 'C_ACCTBAL']].merge(nation[(nation['N_REGIONKEY'] >= 3)][['N_REGIONKEY', 'N_NAME', 'N_NATIONKEY']].merge(region[['R_REGIONKEY', 'R_NAME', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_ADDRESS']).agg('mean', numeric_only=True)

supplier.merge(partsupp.merge(part[(part['P_PARTKEY'] != 135) & (part['P_NAME'] != 'r')].merge(partsupp[(partsupp['PS_SUPPKEY'] >= 6869) | (partsupp['AVAILQTY'] > 3548) & (partsupp['AVAILQTY'] == 5238)][['PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

partsupp[(partsupp['PS_SUPPKEY'] > 1785) | (partsupp['SUPPLYCOST'] >= 521.0124856814645)][['AVAILQTY', 'P_COMMENT']].merge(part[(part['RETAILPRICE'] == 1010.8523434492782) & (part['SIZE'] >= 44) & (part['P_NAME'] == 'w') & (part['P_PARTKEY'] > 192)], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='P_PARTKEY').merge(nation.merge(customer[(customer['C_PHONE'] == '3') & (customer['C_NAME'].str.startswith('C')) | (customer['C_NATIONKEY'] >= 12) & (customer['C_NATIONKEY'] == 13)].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY').merge(nation[(nation['N_REGIONKEY'] <= 0) & (nation['N_COMMENT'].str.startswith('o')) | (nation['N_NATIONKEY'] >= 6)].merge(customer.merge(nation[['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_REGIONKEY'] == 3)][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY')

partsupp[['SUPPLYCOST', 'AVAILQTY', 'PS_PARTKEY']].merge(part[(part['RETAILPRICE'] >= 985.1744210342466)][['P_PARTKEY', 'TYPE']].merge(partsupp[(partsupp['AVAILQTY'] < 9691) & (partsupp['PS_PARTKEY'] > 2) & (partsupp['SUPPLYCOST'] < 343.4228703283395)][['SUPPLYCOST']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[(part['CONTAINER'] != 'WRAP') | (part['P_NAME'] != 't') & (part['PT_COMMENT'].str.startswith('ly ')) & (part['TYPE'] == 'L')][['TYPE', 'P_NAME']].merge(lineitem.merge(partsupp[(partsupp['SUPPLYCOST'] <= 331.7105884618679) | (partsupp['SUPPLYCOST'] >= 751.7095501715544) & (partsupp['PS_SUPPKEY'] == 1942) & (partsupp['PS_SUPPKEY'] >= 1789)], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[(part['RETAILPRICE'] != 976.8650067546108)], left_on='PS_PARTKEY', right_on='P_PARTKEY')

partsupp[(partsupp['PS_SUPPKEY'] >= 3476) | (partsupp['PS_SUPPKEY'] >= 4327)][['PS_PARTKEY', 'P_COMMENT', 'SUPPLYCOST', 'PS_SUPPKEY', 'AVAILQTY']].merge(part[['PT_COMMENT', 'CONTAINER', 'P_NAME', 'BRAND']].merge(partsupp[(partsupp['PS_SUPPKEY'] >= 887) | (partsupp['SUPPLYCOST'] == 736.5015724298185) | (partsupp['PS_SUPPKEY'] <= 5832) | (partsupp['PS_SUPPKEY'] >= 7032)], left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY').groupby(by=['P_COMMENT', 'PS_SUPPKEY']).agg('sum', numeric_only=True)

lineitem[(lineitem['COMMITDATE'] == '1998-10-16') & (lineitem['L_SUPPKEY'] == 7793) | (lineitem['QUANTITY'] != 27)][['EXTENDEDPRICE', 'TAX']].merge(supplier[['S_ACCTBAL', 'S_ADDRESS', 'S_SUPPKEY', 'S_NAME']].merge(partsupp[(partsupp['PS_SUPPKEY'] == 5239) & (partsupp['P_COMMENT'].str.startswith(';')) & (partsupp['PS_SUPPKEY'] == 2716) & (partsupp['PS_SUPPKEY'] == 963)].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['P_COMMENT', 'PS_PARTKEY', 'SUPPLYCOST', 'AVAILQTY', 'PS_SUPPKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY')

customer[['C_NATIONKEY']].merge(nation.merge(customer[(customer['C_NAME'].str.startswith('C')) & (customer['C_PHONE'] != '3') | (customer['C_ADDRESS'] == 'r')][['C_COMMENT', 'C_ADDRESS', 'MKTSEGMENT']].merge(region, left_on='C_CUSTKEY', right_on='R_REGIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region.merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_REGIONKEY', 'N_COMMENT', 'N_NAME', 'N_NATIONKEY']].merge(customer[['C_NAME', 'C_NATIONKEY', 'C_PHONE']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[['S_COMMENT', 'S_NAME', 'S_ADDRESS', 'S_SUPPKEY', 'S_NATIONKEY']].merge(partsupp[(partsupp['AVAILQTY'] >= 7158) | (partsupp['AVAILQTY'] >= 382) & (partsupp['P_COMMENT'] == 'l')], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_NATIONKEY']).agg('sum', numeric_only=True)

region.merge(nation[['N_REGIONKEY', 'N_COMMENT', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_COMMENT', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME', 'R_REGIONKEY']).agg('mean', numeric_only=True)

partsupp[(partsupp['AVAILQTY'] > 8923) & (partsupp['AVAILQTY'] != 3390)][['AVAILQTY', 'PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY']].merge(lineitem[['L_COMMENT', 'RECEIPTDATE', 'EXTENDEDPRICE']].merge(supplier[(supplier['S_NAME'] == 'S') & (supplier['S_PHONE'] != '14-') | (supplier['S_SUPPKEY'] == 11)][['S_ADDRESS', 'S_SUPPKEY', 'S_NAME', 'S_ACCTBAL', 'S_COMMENT']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[['TYPE', 'RETAILPRICE']].merge(orders[(orders['O_ORDERKEY'] <= 590) & (orders['CLERK'] != 'C') | (orders['ORDERPRIORITY'].isin(['5-LOW', '4-NOT SPECIFIED', '3-MEDIUM', '2-HIGH', '1-URGENT'])) & (orders['ORDERSTATUS'] != 'P')][['ORDERPRIORITY']].merge(supplier[['S_COMMENT', 'S_ACCTBAL', 'S_NATIONKEY', 'S_NAME']], left_on='O_ORDERKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['QUANTITY'] > 6)], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').groupby(by=['PS_PARTKEY']).agg('sum', numeric_only=True)

customer.merge(nation[(nation['N_NAME'].str.startswith('V')) | (nation['N_NAME'] == 'B') & (nation['N_NAME'].str.startswith('J'))].merge(customer[['C_CUSTKEY', 'C_ADDRESS', 'MKTSEGMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NATIONKEY'] == 17) & (nation['N_NATIONKEY'] < 9)][['N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY']].merge(customer[(customer['MKTSEGMENT'] == 'MACHINERY') & (customer['C_CUSTKEY'] != 89) | (customer['MKTSEGMENT'] == 'FURNITURE') | (customer['MKTSEGMENT'] == 'MACHINERY')].merge(orders[(orders['SHIPPRIORITY'] > 0)], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_COMMENT', 'C_CUSTKEY']).agg('sum', numeric_only=True)

nation[['N_COMMENT', 'N_NAME', 'N_REGIONKEY', 'N_NATIONKEY']].merge(customer.merge(orders[(orders['ORDERDATE'] <= '1998-07-21') & (orders['SHIPPRIORITY'] < 0)][['ORDERDATE', 'TOTALPRICE', 'CLERK', 'ORDERSTATUS']].merge(supplier[(supplier['S_ACCTBAL'] == 6233.384875884786)][['S_PHONE', 'S_ACCTBAL']], left_on='O_ORDERKEY', right_on='S_SUPPKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[['S_ADDRESS', 'S_PHONE', 'S_SUPPKEY', 'S_ACCTBAL', 'S_NATIONKEY']].merge(nation[(nation['N_NATIONKEY'] > 13) | (nation['N_NAME'].str.startswith('U')) & (nation['N_REGIONKEY'] <= 2) | (nation['N_NATIONKEY'] > 0)].merge(customer[(customer['C_CUSTKEY'] <= 51) & (customer['C_NAME'].str.startswith('C'))], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_REGIONKEY']).agg('sum', numeric_only=True)

region[(region['R_REGIONKEY'] >= 0) | (region['R_NAME'] != 'E') & (region['R_NAME'] == 'A')][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'].str.startswith('M')) | (nation['N_COMMENT'].str.startswith(' ')) | (nation['N_REGIONKEY'] == 2)][['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT']].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

partsupp[(partsupp['SUPPLYCOST'] <= 268.90110984182246) | (partsupp['SUPPLYCOST'] >= 843.3143741981474)][['PS_PARTKEY', 'PS_SUPPKEY']].merge(part.merge(partsupp.merge(lineitem[(lineitem['L_SUPPKEY'] >= 2679) | (lineitem['L_ORDERKEY'] >= 136)][['L_PARTKEY']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['SUPPLYCOST'] == 966.7905437070891) & (partsupp['PS_SUPPKEY'] == 6113) & (partsupp['P_COMMENT'] != 't')][['P_COMMENT', 'SUPPLYCOST', 'PS_SUPPKEY', 'AVAILQTY', 'PS_PARTKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[(part['SIZE'] >= 16) & (part['MFGR'].isin(['Manufacturer#3', 'Manufacturer#5'])) | (part['RETAILPRICE'] > 952.506201002408)].merge(partsupp.merge(supplier[['S_ACCTBAL', 'S_PHONE']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'] == ';') | (partsupp['P_COMMENT'].str.startswith('t')) & (partsupp['PS_SUPPKEY'] == 3753) | (partsupp['SUPPLYCOST'] == 343.0581701129405)][['PS_SUPPKEY', 'P_COMMENT', 'SUPPLYCOST', 'AVAILQTY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['TAX'] < 0.016664691005340453) | (lineitem['SHIPINSTRUCT'] != 'NONE')][['SHIPDATE']], left_on='PS_PARTKEY', right_on='L_PARTKEY')

orders.groupby(by=['ORDERDATE']).agg('mean', numeric_only=True)

nation.merge(supplier.merge(partsupp[(partsupp['P_COMMENT'] == 'a') | (partsupp['SUPPLYCOST'] < 114.85027117353756)][['AVAILQTY', 'PS_PARTKEY']].merge(part[['TYPE', 'MFGR', 'RETAILPRICE', 'CONTAINER']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[['MKTSEGMENT', 'C_NAME']].merge(lineitem[['L_PARTKEY', 'SHIPDATE', 'LINENUMBER', 'L_COMMENT', 'LINESTATUS']], left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(region[(region['R_COMMENT'].str.startswith('h'))].merge(nation[(nation['N_REGIONKEY'] >= 0)][['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='C_CUSTKEY', right_on='R_REGIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier.merge(nation.merge(supplier[(supplier['S_COMMENT'] != ',') | (supplier['S_COMMENT'] == 'o') | (supplier['S_ACCTBAL'] != 913.2677625761594)][['S_COMMENT', 'S_NATIONKEY', 'S_SUPPKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_NATIONKEY', 'N_NAME']).agg('sum', numeric_only=True)

part.merge(partsupp[(partsupp['PS_SUPPKEY'] != 927) & (partsupp['P_COMMENT'] == 'p')].merge(part[(part['MFGR'].isin(['Manufacturer#5', 'Manufacturer#2', 'Manufacturer#4'])) | (part['PT_COMMENT'] == 'u') & (part['P_NAME'] != 'o')], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['BRAND']).agg('mean', numeric_only=True)

nation.merge(customer[(customer['C_ACCTBAL'] >= 8662.899050573387)][['C_NATIONKEY', 'C_COMMENT', 'MKTSEGMENT', 'C_PHONE']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[['C_ADDRESS', 'C_NATIONKEY', 'C_CUSTKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_COMMENT']).agg('count')

lineitem[['TAX', 'L_COMMENT']].merge(orders[(orders['O_CUSTKEY'] > 13881) | (orders['O_CUSTKEY'] >= 137428)][['ORDERPRIORITY', 'ORDERDATE', 'O_ORDERKEY', 'ORDERSTATUS']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY').merge(orders[(orders['O_COMMENT'].str.startswith('t')) | (orders['O_ORDERKEY'] <= 667) & (orders['ORDERDATE'] == '1992-01-13') | (orders['ORDERPRIORITY'] == '3-MEDIUM')].merge(customer[(customer['C_ACCTBAL'] <= 935.5570291272818) | (customer['C_COMMENT'].str.startswith('i')) & (customer['MKTSEGMENT'] != 'BUILDING')].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[['MKTSEGMENT', 'C_NATIONKEY', 'C_CUSTKEY', 'C_PHONE', 'C_NAME']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY').merge(supplier[(supplier['S_ADDRESS'].str.startswith(' ')) | (supplier['S_NATIONKEY'] > 12) & (supplier['S_PHONE'] == '17-')].merge(partsupp[(partsupp['AVAILQTY'] == 9496) | (partsupp['PS_SUPPKEY'] < 5073)][['SUPPLYCOST', 'AVAILQTY', 'PS_SUPPKEY', 'PS_PARTKEY', 'P_COMMENT']].merge(part[(part['P_NAME'] == 'bis')][['P_NAME']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_NATIONKEY'] > 2) & (nation['N_NATIONKEY'] != 19) & (nation['N_NATIONKEY'] >= 15)][['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME']].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY')

customer.merge(nation[['N_REGIONKEY', 'N_NAME']].merge(region[(region['R_COMMENT'].str.startswith('g')) | (region['R_NAME'] != 'M')][['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation[(nation['N_REGIONKEY'] < 2) & (nation['N_NAME'] == 'M')], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_NAME', 'C_ACCTBAL']).agg('mean', numeric_only=True)

customer[(customer['MKTSEGMENT'].isin(['HOUSEHOLD', 'AUTOMOBILE', 'FURNITURE']))][['C_COMMENT', 'C_PHONE', 'C_ADDRESS']].merge(lineitem[['LINESTATUS', 'SHIPINSTRUCT', 'QUANTITY']], left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).groupby(by=['C_COMMENT', 'C_PHONE']).agg('sum', numeric_only=True)

customer[['C_COMMENT', 'C_CUSTKEY']].merge(orders[(orders['CLERK'].str.startswith('C')) | (orders['O_ORDERKEY'] < 753) | (orders['ORDERPRIORITY'] != '2-HIGH') & (orders['O_CUSTKEY'] == 67217)], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['TOTALPRICE', 'O_CUSTKEY', 'SHIPPRIORITY', 'ORDERDATE', 'O_COMMENT']].merge(customer[['C_COMMENT', 'C_CUSTKEY', 'C_ACCTBAL', 'C_PHONE', 'C_NAME']].merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[['MKTSEGMENT', 'C_PHONE', 'C_ACCTBAL']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

supplier[(supplier['S_ACCTBAL'] < 4016.079940426085) & (supplier['S_PHONE'] != '28-') & (supplier['S_ACCTBAL'] < 1220.5114758484267) | (supplier['S_SUPPKEY'] != 11)].merge(partsupp[(partsupp['SUPPLYCOST'] == 682.1925469714774) & (partsupp['PS_PARTKEY'] != 32)].merge(supplier[(supplier['S_ADDRESS'].str.startswith('j')) | (supplier['S_NAME'].str.startswith('S')) & (supplier['S_ADDRESS'] == '2') & (supplier['S_NATIONKEY'] > 8)][['S_NATIONKEY', 'S_ADDRESS', 'S_NAME', 'S_ACCTBAL']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_REGIONKEY'] == 1) | (nation['N_COMMENT'].str.startswith('n'))].merge(region[(region['R_REGIONKEY'] < 2) | (region['R_COMMENT'].str.startswith('h')) | (region['R_NAME'] != 'ASI')][['R_NAME', 'R_COMMENT']].merge(partsupp[['PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT']], left_on='R_REGIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['P_COMMENT'].str.startswith('d')) | (partsupp['PS_SUPPKEY'] > 3627) & (partsupp['SUPPLYCOST'] >= 720.3748586859139)].merge(lineitem[(lineitem['L_PARTKEY'] == 12594) & (lineitem['EXTENDEDPRICE'] > 60176.264628311576)][['L_SUPPKEY']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[(part['MFGR'] == 'Manufacturer#3') | (part['CONTAINER'] == 'MED') & (part['CONTAINER'] != 'JUMBO')].merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

nation[(nation['N_REGIONKEY'] > 3) & (nation['N_REGIONKEY'] < 2) | (nation['N_NATIONKEY'] <= 9)][['N_REGIONKEY', 'N_NAME']].merge(region[(region['R_COMMENT'] == 'g') & (region['R_NAME'] == 'M') & (region['R_NAME'] != 'M')][['R_COMMENT', 'R_REGIONKEY', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_REGIONKEY'] < 0) & (region['R_NAME'] == 'E') | (region['R_COMMENT'].str.startswith('g'))], left_on='N_REGIONKEY', right_on='R_REGIONKEY')

region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_REGIONKEY'] == 3) & (nation['N_NATIONKEY'] < 4)][['N_NATIONKEY', 'N_NAME', 'N_REGIONKEY', 'N_COMMENT']].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[(customer['C_PHONE'] != '27-') | (customer['C_ADDRESS'].str.startswith('B'))], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NATIONKEY', 'N_NAME']].merge(customer[['C_COMMENT', 'C_ACCTBAL', 'C_PHONE']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[(customer['C_CUSTKEY'] <= 81) & (customer['C_ADDRESS'] != 'b')][['C_COMMENT', 'C_NATIONKEY', 'C_PHONE', 'C_ACCTBAL', 'MKTSEGMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME']).agg('count')

orders[(orders['O_COMMENT'] == 'y') & (orders['O_ORDERKEY'] <= 128)]

region[['R_COMMENT', 'R_REGIONKEY']].groupby(by=['R_COMMENT']).agg('min', numeric_only=True)

part[(part['CONTAINER'].str.startswith('WRAP')) & (part['SIZE'] >= 24) & (part['CONTAINER'] == 'MED')][['BRAND', 'MFGR']].merge(nation[['N_NAME', 'N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY']], left_on='P_PARTKEY', right_on='N_NATIONKEY').merge(lineitem[(lineitem['LINENUMBER'] < 4) & (lineitem['SHIPDATE'] > '1992-04-27') & (lineitem['L_SUPPKEY'] < 7628)][['LINESTATUS']].merge(part[(part['P_NAME'] == 'v') & (part['SIZE'] <= 47)].merge(partsupp[(partsupp['SUPPLYCOST'] <= 931.5488869207876)], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'])

supplier[(supplier['S_ACCTBAL'] > 862.898266497486) | (supplier['S_NATIONKEY'] == 8) & (supplier['S_PHONE'] == '3') & (supplier['S_SUPPKEY'] > 21)].merge(partsupp[(partsupp['AVAILQTY'] >= 7773)][['P_COMMENT', 'SUPPLYCOST', 'PS_PARTKEY', 'PS_SUPPKEY', 'AVAILQTY']].merge(lineitem[(lineitem['COMMITDATE'] >= '1992-05-15') | (lineitem['QUANTITY'] >= 22) & (lineitem['RETURNFLAG'] != 'R') | (lineitem['LINESTATUS'].isin(['O']))][['SHIPMODE', 'COMMITDATE', 'L_COMMENT']].merge(customer, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation.merge(region[(region['R_REGIONKEY'] >= 0) | (region['R_NAME'] == 'E') & (region['R_COMMENT'].str.startswith('u')) & (region['R_REGIONKEY'] > 0)].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[(supplier['S_ADDRESS'] == 's') & (supplier['S_ADDRESS'] == 'n')][['S_COMMENT']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NATIONKEY'] <= 0) & (nation['N_NAME'].str.startswith('E')) | (nation['N_COMMENT'] != 'e')][['N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY')

customer[['C_CUSTKEY', 'C_ACCTBAL', 'C_PHONE', 'MKTSEGMENT']].merge(orders[['CLERK', 'SHIPPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders.merge(lineitem[(lineitem['TAX'] > 0.07914060026884717) & (lineitem['EXTENDEDPRICE'] > 54110.97923380042)][['RECEIPTDATE', 'SHIPDATE', 'COMMITDATE', 'SHIPMODE']].merge(partsupp[['PS_SUPPKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_ACCTBAL']).agg('min', numeric_only=True)

customer.merge(orders[(orders['ORDERSTATUS'] != 'O') | (orders['O_COMMENT'].str.startswith('e'))][['O_CUSTKEY']].merge(customer[(customer['C_COMMENT'] == '.') | (customer['MKTSEGMENT'].isin(['BUILDING', 'FURNITURE', 'MACHINERY']))][['C_NAME', 'C_CUSTKEY', 'MKTSEGMENT']].merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['ORDERDATE', 'O_CUSTKEY', 'ORDERPRIORITY', 'ORDERSTATUS', 'O_COMMENT']].merge(customer[['C_ADDRESS', 'C_COMMENT', 'C_CUSTKEY']].merge(orders[['SHIPPRIORITY', 'CLERK']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['ORDERDATE'] > '1998-07-21')], left_on='C_CUSTKEY', right_on='O_CUSTKEY')

supplier[(supplier['S_ACCTBAL'] != 864.8300049329478) | (supplier['S_ADDRESS'] == 'a') & (supplier['S_ACCTBAL'] != 1802.1501761314391)].merge(partsupp[(partsupp['PS_PARTKEY'] > 39) & (partsupp['AVAILQTY'] >= 8950) | (partsupp['PS_PARTKEY'] < 33) & (partsupp['P_COMMENT'] != 'bli')][['P_COMMENT', 'PS_PARTKEY', 'AVAILQTY', 'PS_SUPPKEY']].merge(supplier.merge(nation[(nation['N_NATIONKEY'] < 14) & (nation['N_COMMENT'].str.startswith('o')) & (nation['N_REGIONKEY'] != 2) & (nation['N_COMMENT'] == 'o')][['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[['S_NAME', 'S_PHONE', 'S_COMMENT', 'S_ACCTBAL']].merge(lineitem[(lineitem['LINENUMBER'] != 6) & (lineitem['SHIPDATE'] <= '1992-04-27')][['DISCOUNT', 'L_SUPPKEY', 'LINENUMBER', 'RECEIPTDATE']], left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp.merge(lineitem[(lineitem['L_PARTKEY'] > 106796) & (lineitem['RECEIPTDATE'] < '1992-05-02') | (lineitem['L_SUPPKEY'] > 8421)][['QUANTITY', 'DISCOUNT', 'TAX', 'RECEIPTDATE']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['RETURNFLAG'].isin(['N'])) | (lineitem['TAX'] > 0.04514497843772746) & (lineitem['L_ORDERKEY'] != 161)][['RETURNFLAG', 'SHIPMODE', 'COMMITDATE', 'L_ORDERKEY']].merge(orders[(orders['CLERK'].str.startswith('C')) & (orders['ORDERPRIORITY'] != '1-URGENT') | (orders['O_CUSTKEY'] > 20802)], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_REGIONKEY'] != 1) | (nation['N_REGIONKEY'] != 2) & (nation['N_COMMENT'].str.startswith('e'))], left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_SUPPKEY']).agg('count')

region.merge(nation[['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('sum', numeric_only=True)

part[['PT_COMMENT', 'SIZE']].merge(orders, left_on='P_PARTKEY', right_on='O_ORDERKEY').merge(customer[['C_ACCTBAL', 'C_NATIONKEY', 'C_NAME', 'C_PHONE']], left_on='P_PARTKEY', right_on='C_CUSTKEY').merge(lineitem[(lineitem['RETURNFLAG'].isin(['N'])) & (lineitem['RECEIPTDATE'] == '1998-11-06') & (lineitem['SHIPINSTRUCT'].isin(['COLLECT COD', 'NONE', 'DELIVER IN PERSON', 'TAKE BACK RETURN'])) | (lineitem['LINESTATUS'] == 'O')][['SHIPINSTRUCT', 'SHIPDATE', 'L_ORDERKEY']].merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'])

partsupp[(partsupp['AVAILQTY'] >= 6108)][['P_COMMENT', 'PS_SUPPKEY', 'PS_PARTKEY']].merge(part[(part['MFGR'] == 'Manufacturer#1') | (part['TYPE'] == 'M')].merge(partsupp[(partsupp['SUPPLYCOST'] <= 200.16117385697666) | (partsupp['AVAILQTY'] > 872)], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY')

part[['BRAND']].merge(lineitem[['L_PARTKEY', 'QUANTITY', 'EXTENDEDPRICE', 'LINESTATUS']].merge(partsupp[['P_COMMENT']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(lineitem[(lineitem['L_PARTKEY'] != 167062) & (lineitem['RETURNFLAG'] != 'N') | (lineitem['RETURNFLAG'].isin(['A', 'N', 'R'])) & (lineitem['SHIPDATE'] >= '1992-04-27')].merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(nation[(nation['N_NAME'] == 'G') & (nation['N_NAME'] == 'S')].merge(region[['R_COMMENT', 'R_REGIONKEY']].merge(nation[(nation['N_COMMENT'].str.startswith('i')) & (nation['N_NATIONKEY'] == 3) & (nation['N_COMMENT'].str.startswith(' ')) & (nation['N_NATIONKEY'] > 6)], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region.merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_NAME', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='P_PARTKEY', right_on='N_NATIONKEY')

lineitem[(lineitem['LINENUMBER'] > 3) | (lineitem['DISCOUNT'] > 0.032998714640213714) | (lineitem['SHIPMODE'] != 'AIR')][['L_PARTKEY', 'SHIPMODE']].merge(partsupp.merge(part.merge(partsupp[['PS_SUPPKEY', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(supplier.merge(nation[(nation['N_NATIONKEY'] != 11) & (nation['N_COMMENT'] == 'r') & (nation['N_REGIONKEY'] >= 1) | (nation['N_NATIONKEY'] <= 2)][['N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY', 'N_NAME']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'] == 'q') & (partsupp['AVAILQTY'] != 9052) & (partsupp['P_COMMENT'] != 'p') & (partsupp['AVAILQTY'] > 2877)].merge(part.merge(partsupp[['SUPPLYCOST', 'PS_PARTKEY', 'AVAILQTY', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['AVAILQTY'] <= 672) & (partsupp['P_COMMENT'] == 's') & (partsupp['AVAILQTY'] == 3828)].merge(supplier[(supplier['S_ACCTBAL'] > 663.2067053365831) | (supplier['S_ADDRESS'] != 'm')][['S_SUPPKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[(lineitem['EXTENDEDPRICE'] == 84084.09391765263) | (lineitem['RETURNFLAG'] == 'N')], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['L_PARTKEY']).agg('max', numeric_only=True)

supplier[(supplier['S_COMMENT'] != ' ')][['S_COMMENT', 'S_ACCTBAL', 'S_SUPPKEY']]

partsupp.merge(lineitem[(lineitem['RECEIPTDATE'] != '1998-11-06')][['COMMITDATE', 'L_COMMENT', 'SHIPMODE', 'LINENUMBER', 'SHIPINSTRUCT']], left_on='PS_PARTKEY', right_on='L_PARTKEY').groupby(by=['AVAILQTY']).agg('max', numeric_only=True)

customer[(customer['C_ADDRESS'].str.startswith('z')) & (customer['C_COMMENT'] == 'n') & (customer['C_CUSTKEY'] == 24)].merge(nation[(nation['N_COMMENT'] != 'y') | (nation['N_COMMENT'] == 's') & (nation['N_NAME'].str.startswith('V')) & (nation['N_NATIONKEY'] < 11)].merge(customer[(customer['C_CUSTKEY'] >= 72) & (customer['C_COMMENT'] != 'u') & (customer['C_ACCTBAL'] != 9333.528315466592) | (customer['C_PHONE'] != '18-')][['C_CUSTKEY']].merge(orders[['O_ORDERKEY', 'O_COMMENT', 'TOTALPRICE', 'O_CUSTKEY', 'SHIPPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_REGIONKEY'] == 1) | (nation['N_NATIONKEY'] < 10) | (nation['N_COMMENT'] == 'i') & (nation['N_REGIONKEY'] != 1)].merge(region.merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier.merge(nation[['N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY', 'N_NAME']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['MKTSEGMENT']).agg('sum', numeric_only=True)

customer[(customer['C_ACCTBAL'] != 263.9230370046612)][['C_NAME', 'C_PHONE', 'C_COMMENT']].merge(partsupp[['PS_SUPPKEY', 'SUPPLYCOST']], left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(part[(part['BRAND'].isin(['Brand#35', 'Brand#51', 'Brand#53'])) | (part['MFGR'].isin(['Manufacturer#5'])) | (part['CONTAINER'].str.startswith('SM'))][['P_PARTKEY', 'BRAND', 'RETAILPRICE', 'PT_COMMENT']].merge(partsupp[(partsupp['PS_SUPPKEY'] != 6844) & (partsupp['SUPPLYCOST'] == 490.99804965514056)].merge(supplier[(supplier['S_PHONE'] == '2')][['S_NATIONKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='C_CUSTKEY', right_on='P_PARTKEY').merge(part[['BRAND']].merge(customer[(customer['C_ADDRESS'] != 'x')][['C_CUSTKEY', 'MKTSEGMENT', 'C_NATIONKEY', 'C_COMMENT']], left_on='P_PARTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='P_PARTKEY')

nation[['N_REGIONKEY', 'N_COMMENT', 'N_NAME', 'N_NATIONKEY']].groupby(by=['N_COMMENT']).agg('min', numeric_only=True)

nation.merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[(customer['C_NAME'] == 'C') & (customer['C_ADDRESS'].str.startswith('B')) & (customer['C_COMMENT'] != 'r')][['C_CUSTKEY', 'MKTSEGMENT', 'C_NATIONKEY', 'C_NAME']].merge(nation[(nation['N_REGIONKEY'] == 3)].merge(customer[['C_CUSTKEY', 'C_NATIONKEY', 'C_ACCTBAL']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[(orders['ORDERSTATUS'] == 'F')][['CLERK', 'ORDERSTATUS', 'ORDERDATE', 'SHIPPRIORITY']].merge(lineitem[(lineitem['COMMITDATE'] < '1998-10-16') & (lineitem['TAX'] != 0.0533195416039509) | (lineitem['EXTENDEDPRICE'] < 46755.064128452526) & (lineitem['SHIPDATE'] == '1992-04-27')], left_on='O_ORDERKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_NATIONKEY'] < 0) & (supplier['S_NATIONKEY'] != 7) | (supplier['S_SUPPKEY'] > 18)].merge(nation[(nation['N_NAME'] == 'G')], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_NAME']).agg('max', numeric_only=True)

region[(region['R_REGIONKEY'] < 2) | (region['R_NAME'] == 'M') | (region['R_COMMENT'] == 'g')][['R_REGIONKEY', 'R_COMMENT', 'R_NAME']].merge(nation[['N_NAME', 'N_COMMENT']].merge(part[(part['PT_COMMENT'] != 't') | (part['CONTAINER'] != 'SM') | (part['MFGR'] == 'Manufacturer#1') & (part['P_NAME'] != 'lem')].merge(partsupp[['P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='N_NATIONKEY', right_on='P_PARTKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'].str.startswith('e')) & (nation['N_NATIONKEY'] == 0) | (nation['N_NAME'] == 'B') & (nation['N_NAME'].str.startswith('M'))], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

region.merge(nation[(nation['N_COMMENT'] != 's') | (nation['N_NATIONKEY'] != 21) & (nation['N_NAME'].str.startswith('R')) & (nation['N_REGIONKEY'] < 3)][['N_NATIONKEY', 'N_COMMENT', 'N_NAME', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] != 'u') | (nation['N_REGIONKEY'] >= 1) | (nation['N_REGIONKEY'] != 1) & (nation['N_REGIONKEY'] <= 0)][['N_REGIONKEY', 'N_NAME', 'N_NATIONKEY']].merge(customer[(customer['C_CUSTKEY'] >= 99) | (customer['C_ADDRESS'] != 'a')][['C_NATIONKEY', 'C_COMMENT', 'C_PHONE', 'C_ADDRESS']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT', 'R_REGIONKEY']).agg('count')

part[(part['RETAILPRICE'] >= 1011.3405211125588)][['TYPE', 'MFGR', 'CONTAINER', 'PT_COMMENT']].groupby(by=['TYPE', 'CONTAINER']).agg('mean', numeric_only=True)

nation[(nation['N_NATIONKEY'] <= 22) & (nation['N_REGIONKEY'] > 3) & (nation['N_COMMENT'].str.startswith('n'))].groupby(by=['N_NAME', 'N_NATIONKEY']).agg('mean', numeric_only=True)

nation[['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']].merge(region.merge(nation.merge(supplier[(supplier['S_COMMENT'] != 'u') & (supplier['S_COMMENT'].str.startswith('c')) & (supplier['S_SUPPKEY'] >= 50)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[['C_CUSTKEY', 'C_COMMENT']].merge(orders[(orders['CLERK'].str.startswith('C')) & (orders['ORDERPRIORITY'] != '1-URGENT')][['O_CUSTKEY', 'TOTALPRICE', 'ORDERPRIORITY', 'O_ORDERKEY', 'ORDERSTATUS']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_NATIONKEY']).agg('sum', numeric_only=True)

region[(region['R_COMMENT'] == 'h') | (region['R_REGIONKEY'] > 2) & (region['R_NAME'] == 'M')].merge(nation[(nation['N_NATIONKEY'] != 2) & (nation['N_NAME'] != 'R') & (nation['N_COMMENT'] != 'v')][['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

supplier[(supplier['S_COMMENT'] == 'y') | (supplier['S_ACCTBAL'] >= 1905.6154353859308) & (supplier['S_ADDRESS'] != 'D') & (supplier['S_COMMENT'] != 'n')][['S_SUPPKEY', 'S_ADDRESS']].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp.merge(supplier[(supplier['S_ACCTBAL'] <= 4257.917228956657) & (supplier['S_COMMENT'].str.startswith('h'))], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_SUPPKEY']).agg('mean', numeric_only=True)

part[(part['MFGR'] != 'Manufacturer#5') & (part['SIZE'] <= 29) | (part['SIZE'] <= 26)].merge(partsupp[(partsupp['P_COMMENT'] != 'bli')].merge(lineitem[(lineitem['LINESTATUS'].isin(['O', 'F'])) | (lineitem['LINENUMBER'] <= 3)], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(lineitem[(lineitem['L_COMMENT'].str.startswith('r')) & (lineitem['SHIPDATE'] == '1998-10-30')][['L_COMMENT', 'DISCOUNT']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[['COMMITDATE', 'RECEIPTDATE', 'LINESTATUS', 'SHIPMODE']].merge(supplier[['S_NAME', 'S_ACCTBAL', 'S_NATIONKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['PT_COMMENT']).agg('sum', numeric_only=True)

supplier.merge(nation.merge(supplier.merge(nation[(nation['N_REGIONKEY'] <= 1) & (nation['N_NATIONKEY'] < 13)], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[(supplier['S_COMMENT'] == ' sl')], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[['PS_PARTKEY', 'AVAILQTY', 'PS_SUPPKEY', 'SUPPLYCOST']].merge(supplier[(supplier['S_NATIONKEY'] < 0) & (supplier['S_NAME'] == 'S')].merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

region[(region['R_COMMENT'] != 'h') & (region['R_COMMENT'].str.startswith('l')) | (region['R_COMMENT'].str.startswith('h')) | (region['R_NAME'] == 'ASI')].groupby(by=['R_REGIONKEY', 'R_NAME']).agg('count')

supplier[['S_COMMENT']]

region[['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation[(nation['N_REGIONKEY'] <= 2) & (nation['N_REGIONKEY'] >= 3) & (nation['N_COMMENT'] != 'e') & (nation['N_COMMENT'] == 's')][['N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY', 'N_NAME']].merge(region[(region['R_NAME'].str.startswith('A'))].merge(nation[(nation['N_NAME'].str.startswith('C')) | (nation['N_REGIONKEY'] < 1) | (nation['N_NAME'] != 'U') | (nation['N_NAME'].str.startswith('S'))][['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[(customer['MKTSEGMENT'] != 'MACHINERY') | (customer['C_ADDRESS'] == '9')], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME']).agg('count')

lineitem[['SHIPMODE', 'SHIPDATE']].merge(part[(part['RETAILPRICE'] > 1071.2802096201144) | (part['P_PARTKEY'] == 13)][['SIZE', 'CONTAINER', 'BRAND', 'RETAILPRICE']].merge(region.merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='P_PARTKEY', right_on='R_REGIONKEY').merge(partsupp[(partsupp['PS_PARTKEY'] == 49) & (partsupp['PS_PARTKEY'] > 27) & (partsupp['P_COMMENT'].str.startswith('d')) | (partsupp['PS_SUPPKEY'] >= 1331)][['PS_SUPPKEY']].merge(lineitem[(lineitem['COMMITDATE'] > '1998-10-16')][['RECEIPTDATE', 'SHIPINSTRUCT', 'TAX']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY').merge(customer[['C_CUSTKEY', 'MKTSEGMENT', 'C_COMMENT', 'C_ACCTBAL', 'C_ADDRESS']].merge(orders[(orders['SHIPPRIORITY'] != 0) | (orders['O_CUSTKEY'] >= 64318)][['ORDERSTATUS', 'O_COMMENT', 'CLERK']].merge(partsupp[(partsupp['AVAILQTY'] >= 3498) & (partsupp['SUPPLYCOST'] > 184.00805906573459)], left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders.merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY').groupby(by=['SHIPDATE', 'SHIPMODE']).agg('max', numeric_only=True)

nation.merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_REGIONKEY'] <= 2) | (region['R_REGIONKEY'] >= 1)].merge(nation[(nation['N_REGIONKEY'] > 1) & (nation['N_NAME'].str.startswith('V')) & (nation['N_NAME'].str.startswith('S'))], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] == 'S')][['N_REGIONKEY', 'N_NATIONKEY']].merge(customer[['C_NATIONKEY', 'C_COMMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY')

lineitem[(lineitem['DISCOUNT'] < 0.09357175796389744) & (lineitem['L_COMMENT'].str.startswith('o')) | (lineitem['COMMITDATE'] > '1998-10-16')][['EXTENDEDPRICE', 'RECEIPTDATE']].merge(customer[(customer['C_NATIONKEY'] <= 6) & (customer['C_COMMENT'] != 'f') & (customer['C_COMMENT'].str.startswith('p'))][['C_COMMENT', 'C_ACCTBAL', 'MKTSEGMENT']].merge(region.merge(nation[(nation['N_NATIONKEY'] >= 2) | (nation['N_COMMENT'] == 't') | (nation['N_NAME'].str.startswith('J'))], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='C_CUSTKEY', right_on='R_REGIONKEY').merge(partsupp[['P_COMMENT']], left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY').merge(supplier[(supplier['S_ACCTBAL'] > 9666.249953784) & (supplier['S_PHONE'] == '26-') | (supplier['S_NATIONKEY'] < 0) | (supplier['S_ACCTBAL'] < -826.5346400067917)], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY').groupby(by=['RECEIPTDATE', 'EXTENDEDPRICE']).agg('mean', numeric_only=True)

partsupp[['PS_PARTKEY', 'P_COMMENT', 'SUPPLYCOST', 'AVAILQTY']].merge(part[['P_NAME', 'MFGR', 'P_PARTKEY', 'BRAND']].merge(partsupp[['PS_SUPPKEY', 'PS_PARTKEY', 'P_COMMENT', 'AVAILQTY']].merge(lineitem[(lineitem['RECEIPTDATE'] >= '1998-11-06')], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[['L_ORDERKEY', 'SHIPINSTRUCT', 'LINENUMBER', 'EXTENDEDPRICE', 'TAX']].merge(orders[['ORDERSTATUS']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY')

supplier.merge(partsupp[(partsupp['SUPPLYCOST'] <= 665.54246512566) & (partsupp['PS_SUPPKEY'] == 6901)][['PS_SUPPKEY', 'PS_PARTKEY', 'SUPPLYCOST', 'AVAILQTY']].merge(supplier[(supplier['S_COMMENT'] == 'j') & (supplier['S_SUPPKEY'] < 14)], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_REGIONKEY'] >= 2) | (nation['N_REGIONKEY'] > 3) | (nation['N_NATIONKEY'] < 16)], left_on='S_NATIONKEY', right_on='N_NATIONKEY')

nation.merge(customer[(customer['C_NATIONKEY'] < 19)], left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_NATIONKEY']).agg('count')

nation[(nation['N_COMMENT'].str.startswith('o')) | (nation['N_NAME'].str.startswith('E')) & (nation['N_NAME'] != 'K') & (nation['N_REGIONKEY'] >= 1)][['N_NAME', 'N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY']].merge(customer[(customer['C_CUSTKEY'] == 40)], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_REGIONKEY'] != 2)].merge(nation.merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_REGIONKEY', 'N_NAME']].merge(region[(region['R_COMMENT'].str.startswith('l')) & (region['R_NAME'] == 'E') & (region['R_COMMENT'] != 'l') & (region['R_REGIONKEY'] >= 3)][['R_COMMENT', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY')

orders[(orders['ORDERDATE'] < '1992-01-13') & (orders['CLERK'] != 'C') | (orders['CLERK'] == 'C')][['TOTALPRICE', 'ORDERSTATUS', 'O_ORDERKEY']].groupby(by=['TOTALPRICE']).agg('max', numeric_only=True)

region[(region['R_REGIONKEY'] >= 2) | (region['R_COMMENT'] == 'u') & (region['R_REGIONKEY'] >= 1) & (region['R_REGIONKEY'] == 2)][['R_NAME', 'R_REGIONKEY']].merge(nation[['N_NAME', 'N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] == 0) | (nation['N_NAME'] != 'C') | (nation['N_NATIONKEY'] < 12)].merge(customer[['C_ACCTBAL', 'C_PHONE', 'C_NAME', 'C_ADDRESS']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

supplier.groupby(by=['S_ACCTBAL', 'S_NATIONKEY']).agg('max', numeric_only=True)

customer[(customer['MKTSEGMENT'] != 'MACHINERY')][['C_ACCTBAL', 'C_ADDRESS', 'MKTSEGMENT']]

nation.merge(customer[(customer['C_CUSTKEY'] <= 38) & (customer['C_COMMENT'].str.startswith(' '))], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[['S_SUPPKEY', 'S_ADDRESS', 'S_NAME', 'S_COMMENT', 'S_NATIONKEY']].merge(partsupp[(partsupp['PS_PARTKEY'] < 37) | (partsupp['PS_SUPPKEY'] <= 7182) & (partsupp['PS_SUPPKEY'] != 4766)][['PS_PARTKEY', 'PS_SUPPKEY', 'P_COMMENT', 'AVAILQTY']].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_REGIONKEY'] <= 1) | (nation['N_NATIONKEY'] >= 6) | (nation['N_NATIONKEY'] >= 15) & (nation['N_NAME'].str.startswith('U'))].merge(customer[['C_NATIONKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region.merge(nation[(nation['N_REGIONKEY'] < 2) | (nation['N_NAME'].str.startswith('E')) & (nation['N_REGIONKEY'] != 0) | (nation['N_NAME'].str.startswith('C'))][['N_COMMENT', 'N_NAME', 'N_REGIONKEY']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] != 'B') | (nation['N_REGIONKEY'] < 2)].merge(region[(region['R_COMMENT'] == 'u')][['R_REGIONKEY', 'R_COMMENT', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_NATIONKEY', 'N_REGIONKEY']).agg('count')

supplier[['S_ACCTBAL', 'S_NATIONKEY', 'S_NAME', 'S_SUPPKEY']].merge(partsupp[['PS_PARTKEY', 'P_COMMENT', 'AVAILQTY', 'SUPPLYCOST']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_NATIONKEY'] != 13) & (nation['N_COMMENT'] != 'l') & (nation['N_NAME'] == 'M') | (nation['N_COMMENT'].str.startswith('o'))][['N_NAME', 'N_NATIONKEY', 'N_COMMENT']].merge(customer[(customer['C_ACCTBAL'] >= 45.14732275392009) & (customer['C_CUSTKEY'] <= 60)], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[['MKTSEGMENT', 'C_COMMENT', 'C_ACCTBAL', 'C_NATIONKEY', 'C_ADDRESS']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY')

supplier[(supplier['S_SUPPKEY'] != 23)].merge(nation[(nation['N_NAME'] == 'P') & (nation['N_NAME'] == 'J') | (nation['N_NAME'].str.startswith('R'))], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['AVAILQTY'] < 8349) | (partsupp['PS_PARTKEY'] > 18) & (partsupp['P_COMMENT'] != 'c') | (partsupp['AVAILQTY'] != 6877)][['P_COMMENT', 'SUPPLYCOST']].merge(nation[(nation['N_NATIONKEY'] >= 21) & (nation['N_NATIONKEY'] == 4) & (nation['N_REGIONKEY'] < 0)], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

orders.merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[(lineitem['LINENUMBER'] >= 4) & (lineitem['TAX'] <= 0.009296533569010315) | (lineitem['SHIPDATE'] != '1998-10-30') & (lineitem['SHIPINSTRUCT'] != 'NONE')].merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['L_SUPPKEY'] <= 564) | (lineitem['L_COMMENT'] == 'c') & (lineitem['LINESTATUS'] != 'F')].merge(orders[['SHIPPRIORITY', 'ORDERDATE', 'O_ORDERKEY']].merge(lineitem[(lineitem['COMMITDATE'] == '1992-05-15') | (lineitem['EXTENDEDPRICE'] <= 21623.809725717794)][['COMMITDATE', 'SHIPINSTRUCT', 'L_ORDERKEY', 'L_PARTKEY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['CLERK', 'O_ORDERKEY']).agg('sum', numeric_only=True)

customer[(customer['C_ACCTBAL'] != -204.4169983169577) & (customer['C_COMMENT'] != 'l') & (customer['C_NATIONKEY'] != 6) & (customer['C_PHONE'] != '1')].merge(orders[['ORDERPRIORITY']].merge(customer[['C_COMMENT', 'C_NAME']].merge(supplier, left_on='C_CUSTKEY', right_on='S_SUPPKEY'), left_on='O_ORDERKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['O_CUSTKEY', 'ORDERSTATUS', 'SHIPPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['CLERK'] == 'C') | (orders['SHIPPRIORITY'] <= 0)], left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['MKTSEGMENT', 'C_PHONE']).agg('mean', numeric_only=True)

customer[['MKTSEGMENT', 'C_NATIONKEY', 'C_COMMENT', 'C_ADDRESS', 'C_PHONE']].merge(nation[(nation['N_NAME'] == 'A') | (nation['N_COMMENT'].str.startswith('i')) & (nation['N_REGIONKEY'] >= 3)][['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME', 'N_COMMENT']].merge(customer[(customer['MKTSEGMENT'] == 'HOUSEHOLD') & (customer['C_NAME'].str.startswith('C')) | (customer['C_ADDRESS'] != 'j')][['C_NATIONKEY', 'MKTSEGMENT', 'C_NAME', 'C_ADDRESS']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[(customer['C_NAME'] == 'C') & (customer['MKTSEGMENT'] == 'BUILDING')], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(region.merge(nation[['N_COMMENT', 'N_NAME', 'N_REGIONKEY', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_ADDRESS', 'C_PHONE']).agg('count')

part[(part['P_PARTKEY'] < 130)][['MFGR', 'TYPE', 'BRAND', 'SIZE']].merge(nation[(nation['N_REGIONKEY'] >= 2)][['N_COMMENT', 'N_REGIONKEY']].merge(region[(region['R_COMMENT'].str.startswith('g')) & (region['R_REGIONKEY'] == 1) & (region['R_REGIONKEY'] <= 1) & (region['R_REGIONKEY'] > 0)].merge(nation[(nation['N_NAME'] != 'R') & (nation['N_NATIONKEY'] >= 12)], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_REGIONKEY'] > 2) & (region['R_NAME'] != 'M')].merge(nation[(nation['N_NAME'] == 'J') & (nation['N_REGIONKEY'] >= 0) | (nation['N_REGIONKEY'] != 1)][['N_COMMENT', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='P_PARTKEY', right_on='N_NATIONKEY').merge(region, left_on='P_PARTKEY', right_on='R_REGIONKEY').groupby(by=['BRAND', 'TYPE']).agg('min', numeric_only=True)

orders[['CLERK', 'O_CUSTKEY']].merge(customer[(customer['MKTSEGMENT'] == 'AUTOMOBILE')][['C_NAME', 'C_ACCTBAL']], left_on='O_CUSTKEY', right_on='C_CUSTKEY')

part[['MFGR', 'CONTAINER', 'TYPE', 'RETAILPRICE']].groupby(by=['TYPE']).agg('min', numeric_only=True)

orders.merge(lineitem[(lineitem['EXTENDEDPRICE'] == 32384.682421408233) & (lineitem['SHIPDATE'] > '1998-10-30') | (lineitem['L_COMMENT'] != ',') & (lineitem['RETURNFLAG'] == 'A')], left_on='O_ORDERKEY', right_on='L_ORDERKEY')

supplier.merge(nation[(nation['N_NAME'].str.startswith('B'))].merge(supplier[(supplier['S_NAME'] != 'S') | (supplier['S_SUPPKEY'] == 166)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp.merge(supplier[['S_PHONE']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[(supplier['S_COMMENT'] != 'c') & (supplier['S_ADDRESS'] != 'N') & (supplier['S_SUPPKEY'] <= 67) | (supplier['S_PHONE'] != '26-')][['S_PHONE', 'S_COMMENT', 'S_SUPPKEY']].merge(partsupp[['PS_PARTKEY', 'AVAILQTY', 'SUPPLYCOST', 'P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

nation[['N_NAME', 'N_NATIONKEY']].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[(customer['C_ADDRESS'] == 'l') | (customer['C_PHONE'] == '22-') | (customer['C_ADDRESS'].str.startswith('Y'))][['MKTSEGMENT', 'C_CUSTKEY', 'C_ADDRESS', 'C_PHONE']], left_on='N_NATIONKEY', right_on='C_NATIONKEY')

supplier.merge(nation[(nation['N_REGIONKEY'] >= 2) | (nation['N_REGIONKEY'] == 2) | (nation['N_COMMENT'].str.startswith('n')) & (nation['N_COMMENT'] == 'l')].merge(region[(region['R_REGIONKEY'] != 2) | (region['R_NAME'].str.startswith('ASI'))], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_ADDRESS']).agg('min', numeric_only=True)

nation[(nation['N_NAME'] == 'R') | (nation['N_REGIONKEY'] != 2)][['N_COMMENT']].merge(orders[(orders['ORDERSTATUS'] != 'F') & (orders['ORDERPRIORITY'].isin(['3-MEDIUM'])) | (orders['ORDERPRIORITY'] != '2-HIGH')][['CLERK']].merge(nation[(nation['N_NATIONKEY'] != 2)][['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT']].merge(customer[(customer['C_ADDRESS'].str.startswith('F')) & (customer['C_ADDRESS'].str.startswith('p')) & (customer['MKTSEGMENT'] == 'FURNITURE') | (customer['C_NATIONKEY'] >= 9)][['C_CUSTKEY', 'C_NATIONKEY', 'C_ADDRESS']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='O_ORDERKEY', right_on='N_NATIONKEY').merge(region[['R_REGIONKEY', 'R_COMMENT', 'R_NAME']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='O_ORDERKEY', right_on='R_REGIONKEY'), left_on='N_NATIONKEY', right_on='O_ORDERKEY')

customer[(customer['C_NATIONKEY'] == 5)].merge(nation[(nation['N_REGIONKEY'] >= 2) | (nation['N_REGIONKEY'] <= 0) | (nation['N_NATIONKEY'] <= 2)][['N_NAME', 'N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(customer[['C_PHONE', 'C_NAME', 'C_NATIONKEY', 'C_ADDRESS', 'C_ACCTBAL']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[(customer['C_COMMENT'] != 'n') & (customer['MKTSEGMENT'] == 'HOUSEHOLD') | (customer['C_NATIONKEY'] <= 11) & (customer['C_NATIONKEY'] < 16)][['C_ACCTBAL']].merge(nation[(nation['N_REGIONKEY'] == 3) & (nation['N_NAME'] == 'V')][['N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY']], left_on='C_CUSTKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NAME'] == 'P')], left_on='C_NATIONKEY', right_on='N_NATIONKEY')

lineitem[['LINESTATUS']].merge(partsupp[(partsupp['PS_SUPPKEY'] < 227) | (partsupp['AVAILQTY'] <= 3039) | (partsupp['P_COMMENT'] == 'q') | (partsupp['PS_PARTKEY'] != 11)].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(nation.merge(region[['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].merge(nation[(nation['N_COMMENT'] == 'v')], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY')

region[(region['R_NAME'].str.startswith('A')) | (region['R_NAME'] != 'ASI') | (region['R_COMMENT'].str.startswith('g'))][['R_NAME', 'R_COMMENT']].merge(partsupp[(partsupp['PS_SUPPKEY'] > 3125) & (partsupp['PS_PARTKEY'] != 44) | (partsupp['PS_SUPPKEY'] != 5088)][['PS_PARTKEY', 'PS_SUPPKEY', 'SUPPLYCOST', 'AVAILQTY']], left_on='R_REGIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(customer[(customer['C_NATIONKEY'] != 19) & (customer['C_COMMENT'].str.startswith('.')) & (customer['C_NATIONKEY'] >= 21) & (customer['C_COMMENT'] == 'w')].merge(orders[(orders['O_CUSTKEY'] >= 140155) | (orders['ORDERSTATUS'] == 'P') & (orders['TOTALPRICE'] >= 82447.22526871835)].merge(customer[['C_ACCTBAL', 'C_CUSTKEY', 'C_PHONE', 'C_ADDRESS', 'C_NATIONKEY']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='R_REGIONKEY', right_on='C_CUSTKEY')

region[['R_REGIONKEY', 'R_COMMENT']].merge(nation[['N_REGIONKEY', 'N_COMMENT']].merge(region[(region['R_REGIONKEY'] == 2) | (region['R_NAME'].str.startswith('AME'))][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].merge(nation[(nation['N_NATIONKEY'] >= 12) & (nation['N_NAME'] == 'R') | (nation['N_COMMENT'] != 'o')], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_COMMENT'] != 'h') | (region['R_REGIONKEY'] > 1)], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

orders.merge(lineitem[(lineitem['RECEIPTDATE'] >= '1992-05-02')], left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['ORDERSTATUS']).agg('max', numeric_only=True)

customer[(customer['C_NATIONKEY'] <= 12) | (customer['C_NATIONKEY'] < 4) | (customer['MKTSEGMENT'] != 'MACHINERY') & (customer['C_ACCTBAL'] != 1769.4086523305964)][['MKTSEGMENT', 'C_PHONE', 'C_ADDRESS', 'C_CUSTKEY', 'C_NATIONKEY']].merge(nation[['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT']].merge(customer[(customer['C_NATIONKEY'] > 14) & (customer['C_ACCTBAL'] != 9197.8401633621)].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_CUSTKEY', 'C_ADDRESS']).agg('min', numeric_only=True)

nation

orders

region[['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY')

region[['R_REGIONKEY', 'R_COMMENT', 'R_NAME']].merge(nation[['N_COMMENT', 'N_NAME', 'N_REGIONKEY', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY', 'R_NAME']).agg('sum', numeric_only=True)

lineitem[(lineitem['SHIPMODE'].isin(['AIR', 'FOB', 'RAIL', 'MAIL'])) | (lineitem['RECEIPTDATE'] >= '1992-05-02') | (lineitem['LINESTATUS'].isin(['F']))][['L_PARTKEY', 'RETURNFLAG', 'COMMITDATE', 'SHIPMODE']].merge(partsupp[(partsupp['PS_SUPPKEY'] >= 5144) & (partsupp['SUPPLYCOST'] == 273.80150533415394) | (partsupp['PS_PARTKEY'] > 41) & (partsupp['PS_SUPPKEY'] == 6187)], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(lineitem[(lineitem['SHIPMODE'].isin(['RAIL', 'TRUCK'])) | (lineitem['EXTENDEDPRICE'] <= 31411.141407467054)].merge(orders[(orders['O_COMMENT'].str.startswith('egu')) & (orders['O_CUSTKEY'] > 55597) | (orders['ORDERSTATUS'].isin(['O', 'F'])) & (orders['ORDERPRIORITY'] == '2-HIGH')], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY')

part[(part['CONTAINER'].str.startswith('JUMBO')) | (part['P_PARTKEY'] < 17) & (part['RETAILPRICE'] <= 985.0142127961698)][['RETAILPRICE', 'P_NAME', 'MFGR', 'CONTAINER']]

orders.merge(lineitem[(lineitem['SHIPINSTRUCT'] == 'NONE') | (lineitem['L_PARTKEY'] > 127013) | (lineitem['RETURNFLAG'].isin(['N']))].merge(orders[['O_ORDERKEY', 'ORDERDATE']].merge(lineitem[(lineitem['L_PARTKEY'] <= 192783)][['SHIPDATE', 'TAX', 'LINENUMBER']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['TOTALPRICE'] < 249088.07925592616)][['SHIPPRIORITY', 'O_CUSTKEY', 'O_ORDERKEY', 'TOTALPRICE', 'ORDERDATE']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[['C_CUSTKEY', 'C_PHONE', 'MKTSEGMENT', 'C_ADDRESS', 'C_ACCTBAL']], left_on='O_CUSTKEY', right_on='C_CUSTKEY')

region.merge(nation.merge(customer[['C_NATIONKEY', 'C_PHONE', 'C_ACCTBAL', 'C_COMMENT']].merge(nation[(nation['N_COMMENT'].str.startswith('p')) | (nation['N_COMMENT'] == 'o')][['N_REGIONKEY', 'N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

nation[['N_NAME']]

nation.groupby(by=['N_COMMENT']).agg('max', numeric_only=True)

lineitem[(lineitem['COMMITDATE'] > '1992-05-15') | (lineitem['TAX'] == 0.022469928674968997) | (lineitem['LINESTATUS'] != 'F') | (lineitem['RETURNFLAG'].isin(['A']))].groupby(by=['L_PARTKEY', 'RECEIPTDATE']).agg('sum', numeric_only=True)

nation.groupby(by=['N_NATIONKEY', 'N_NAME']).agg('mean', numeric_only=True)

region[(region['R_REGIONKEY'] != 3)][['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].merge(nation[['N_REGIONKEY', 'N_NAME', 'N_COMMENT', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(customer.merge(nation[['N_NATIONKEY', 'N_COMMENT', 'N_NAME', 'N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[['S_COMMENT', 'S_NATIONKEY', 'S_NAME', 'S_SUPPKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME', 'R_REGIONKEY']).agg('max', numeric_only=True)

customer[['MKTSEGMENT']].merge(part[(part['RETAILPRICE'] > 1096.6784368053002) & (part['CONTAINER'] == 'LG') | (part['TYPE'] == 'M')][['SIZE', 'BRAND']].merge(partsupp[['SUPPLYCOST', 'PS_PARTKEY', 'PS_SUPPKEY', 'P_COMMENT']].merge(supplier[['S_NAME', 'S_ACCTBAL', 'S_COMMENT']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(supplier[['S_NATIONKEY', 'S_COMMENT', 'S_PHONE', 'S_SUPPKEY', 'S_ADDRESS']].merge(partsupp[(partsupp['PS_SUPPKEY'] <= 4005) | (partsupp['P_COMMENT'] != 'h') | (partsupp['SUPPLYCOST'] != 462.7426826097964)][['PS_PARTKEY', 'P_COMMENT', 'AVAILQTY', 'PS_SUPPKEY', 'SUPPLYCOST']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='P_PARTKEY', right_on='S_SUPPKEY'), left_on='C_CUSTKEY', right_on='P_PARTKEY').groupby(by=['MKTSEGMENT']).agg('max', numeric_only=True)

customer[(customer['C_ADDRESS'] == 'o')][['C_ACCTBAL']].merge(supplier[(supplier['S_COMMENT'] != 'g') | (supplier['S_ACCTBAL'] >= 5838.470585354633) | (supplier['S_SUPPKEY'] <= 192) | (supplier['S_NAME'].str.startswith('S'))][['S_ACCTBAL', 'S_PHONE', 'S_ADDRESS', 'S_NATIONKEY']].merge(nation[(nation['N_NAME'] != 'R') & (nation['N_NATIONKEY'] < 7)][['N_REGIONKEY', 'N_COMMENT']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='C_CUSTKEY', right_on='S_SUPPKEY').merge(supplier.merge(nation[(nation['N_NAME'] != 'K') | (nation['N_COMMENT'].str.startswith('i')) | (nation['N_COMMENT'] != 'v') & (nation['N_COMMENT'] == 'o')][['N_NAME', 'N_COMMENT', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['P_COMMENT'] == 'bli')][['PS_SUPPKEY', 'SUPPLYCOST', 'AVAILQTY']].merge(lineitem[['RETURNFLAG', 'QUANTITY', 'TAX']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='C_CUSTKEY', right_on='S_SUPPKEY').groupby(by=['C_ACCTBAL']).agg('sum', numeric_only=True)

partsupp[(partsupp['PS_SUPPKEY'] != 2236) | (partsupp['PS_SUPPKEY'] > 209)][['PS_PARTKEY']].merge(lineitem[(lineitem['L_ORDERKEY'] >= 35) & (lineitem['LINESTATUS'] != 'O')].merge(orders[(orders['ORDERDATE'] > '1992-01-13') | (orders['TOTALPRICE'] >= 212163.96748207088) & (orders['O_CUSTKEY'] == 67659)], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[['PS_SUPPKEY', 'PS_PARTKEY', 'P_COMMENT', 'AVAILQTY', 'SUPPLYCOST']].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[(part['MFGR'] == 'Manufacturer#2') & (part['SIZE'] > 24)][['BRAND', 'PT_COMMENT', 'RETAILPRICE', 'P_NAME']].merge(supplier, left_on='P_PARTKEY', right_on='S_SUPPKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY')

lineitem[(lineitem['EXTENDEDPRICE'] == 43134.00013594473) | (lineitem['TAX'] != 0.02471680650894351) | (lineitem['L_SUPPKEY'] != 6200)][['SHIPINSTRUCT']].groupby(by=['SHIPINSTRUCT']).agg('sum', numeric_only=True)

part[['P_NAME']].merge(nation[(nation['N_REGIONKEY'] <= 1)][['N_NATIONKEY', 'N_COMMENT']].merge(supplier[['S_COMMENT', 'S_ADDRESS']].merge(orders[['SHIPPRIORITY', 'O_COMMENT']], left_on='S_SUPPKEY', right_on='O_ORDERKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[['S_SUPPKEY', 'S_ADDRESS']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='P_PARTKEY', right_on='N_NATIONKEY').groupby(by=['P_NAME']).agg('min', numeric_only=True)

customer[['C_CUSTKEY', 'C_ACCTBAL', 'C_NATIONKEY', 'C_PHONE', 'C_NAME']].merge(nation.merge(customer[(customer['C_PHONE'].str.startswith('2')) & (customer['C_PHONE'] == '25-') | (customer['C_CUSTKEY'] > 77) | (customer['C_PHONE'] != '18-')], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_PHONE', 'C_ACCTBAL']).agg('sum', numeric_only=True)

lineitem[(lineitem['L_COMMENT'] != 'g') | (lineitem['RETURNFLAG'] != 'N') & (lineitem['SHIPMODE'] == 'REG AIR')][['DISCOUNT', 'L_ORDERKEY', 'RECEIPTDATE', 'SHIPINSTRUCT', 'EXTENDEDPRICE']].merge(orders[(orders['O_CUSTKEY'] <= 36352) | (orders['TOTALPRICE'] > 329373.02069127193)][['ORDERDATE']].merge(partsupp[['PS_PARTKEY']].merge(part[(part['P_NAME'].str.startswith('m')) | (part['BRAND'] == 'Brand#44') | (part['RETAILPRICE'] != 905.2040999717514) | (part['PT_COMMENT'].str.startswith('t'))][['BRAND', 'RETAILPRICE', 'PT_COMMENT']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[['ORDERSTATUS']].merge(part[(part['P_NAME'] != 'y')], left_on='O_ORDERKEY', right_on='P_PARTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['O_COMMENT'] == 'egu')][['O_CUSTKEY', 'CLERK', 'O_COMMENT', 'ORDERSTATUS', 'O_ORDERKEY']].merge(customer[['C_NATIONKEY', 'C_ADDRESS']].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY')

region[(region['R_COMMENT'] != 'g') & (region['R_NAME'] != 'AFR') & (region['R_REGIONKEY'] >= 1)].merge(nation[['N_NATIONKEY', 'N_NAME']].merge(supplier[(supplier['S_ACCTBAL'] < 3829.761307174789) & (supplier['S_ADDRESS'] != 'O') | (supplier['S_SUPPKEY'] > 146)][['S_PHONE']].merge(customer[['C_CUSTKEY', 'C_COMMENT', 'C_ACCTBAL', 'MKTSEGMENT', 'C_ADDRESS']], left_on='S_SUPPKEY', right_on='C_CUSTKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[(supplier['S_NAME'].str.startswith('S')) | (supplier['S_PHONE'] == '32-') | (supplier['S_ACCTBAL'] == 6710.170985890853)][['S_SUPPKEY']].merge(partsupp[['PS_SUPPKEY', 'AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME', 'R_REGIONKEY']).agg('mean', numeric_only=True)

partsupp[(partsupp['PS_SUPPKEY'] > 7317) & (partsupp['PS_PARTKEY'] < 10) & (partsupp['PS_SUPPKEY'] != 7124) & (partsupp['P_COMMENT'] != 'k')][['AVAILQTY', 'PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY']]

nation.merge(supplier[['S_ACCTBAL', 'S_PHONE']].merge(orders.merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='S_SUPPKEY', right_on='O_ORDERKEY').merge(region[(region['R_NAME'].str.startswith('E')) & (region['R_REGIONKEY'] >= 2) | (region['R_NAME'] == 'AME') | (region['R_REGIONKEY'] > 0)][['R_COMMENT', 'R_REGIONKEY']].merge(nation[(nation['N_COMMENT'] == 'p') & (nation['N_NATIONKEY'] < 16) | (nation['N_NATIONKEY'] == 2) | (nation['N_REGIONKEY'] >= 3)], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='S_SUPPKEY', right_on='R_REGIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY')

supplier[(supplier['S_SUPPKEY'] <= 39) | (supplier['S_SUPPKEY'] > 99) | (supplier['S_COMMENT'].str.startswith('al '))].merge(partsupp[(partsupp['PS_SUPPKEY'] > 6940) & (partsupp['P_COMMENT'] == 'a') | (partsupp['P_COMMENT'] == ';') & (partsupp['PS_SUPPKEY'] > 2300)][['PS_PARTKEY', 'SUPPLYCOST', 'P_COMMENT', 'AVAILQTY', 'PS_SUPPKEY']].merge(part[(part['TYPE'] != 'P') | (part['TYPE'] != 'SMA') | (part['MFGR'].isin(['Manufacturer#5', 'Manufacturer#3'])) | (part['P_PARTKEY'] >= 165)][['MFGR', 'P_PARTKEY', 'TYPE']].merge(partsupp[['PS_SUPPKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_PARTKEY'] <= 7) | (partsupp['PS_PARTKEY'] >= 9)][['PS_SUPPKEY', 'AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

supplier.merge(partsupp[['P_COMMENT', 'SUPPLYCOST', 'AVAILQTY', 'PS_PARTKEY']].merge(part.merge(partsupp[(partsupp['P_COMMENT'].str.startswith('k')) & (partsupp['AVAILQTY'] > 602) & (partsupp['AVAILQTY'] != 6982) | (partsupp['SUPPLYCOST'] != 236.0563955940346)][['AVAILQTY', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[['N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY')

customer[(customer['C_NATIONKEY'] < 1) | (customer['C_NATIONKEY'] < 8) & (customer['C_ADDRESS'].str.startswith('f'))][['C_ADDRESS', 'C_PHONE', 'C_NAME', 'C_CUSTKEY', 'C_ACCTBAL']].merge(orders[['O_ORDERKEY', 'CLERK', 'SHIPPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['ORDERSTATUS'] != 'O') & (orders['ORDERSTATUS'] != 'F')].merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['MKTSEGMENT'].isin(['MACHINERY', 'AUTOMOBILE'])) | (customer['C_CUSTKEY'] < 32) & (customer['C_CUSTKEY'] < 44)][['C_PHONE']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders.merge(customer[(customer['MKTSEGMENT'] == 'AUTOMOBILE') | (customer['MKTSEGMENT'] == 'HOUSEHOLD') | (customer['C_CUSTKEY'] == 80)][['C_CUSTKEY']].merge(orders[(orders['CLERK'].str.startswith('C')) | (orders['ORDERSTATUS'].isin(['F'])) | (orders['SHIPPRIORITY'] < 0)][['ORDERPRIORITY', 'ORDERDATE', 'TOTALPRICE', 'CLERK']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

supplier[['S_ADDRESS']].merge(lineitem[(lineitem['SHIPDATE'] != '1992-04-27') | (lineitem['RECEIPTDATE'] == '1998-11-06')][['TAX', 'SHIPDATE', 'DISCOUNT', 'L_SUPPKEY', 'L_PARTKEY']].merge(partsupp[(partsupp['AVAILQTY'] < 1346) | (partsupp['P_COMMENT'] != 'i')].merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'])

supplier.merge(partsupp[['PS_SUPPKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation.merge(region[['R_COMMENT', 'R_REGIONKEY', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_ACCTBAL', 'S_COMMENT']).agg('mean', numeric_only=True)

part[['PT_COMMENT', 'TYPE', 'SIZE', 'P_PARTKEY', 'CONTAINER']].merge(partsupp[['SUPPLYCOST', 'P_COMMENT']].merge(part.merge(partsupp[(partsupp['PS_SUPPKEY'] == 4069)][['SUPPLYCOST', 'AVAILQTY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='P_PARTKEY').merge(region, left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='R_REGIONKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['AVAILQTY'] == 8730)][['PS_SUPPKEY', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['TYPE', 'PT_COMMENT']).agg('mean', numeric_only=True)

partsupp

nation[(nation['N_NATIONKEY'] == 6) & (nation['N_NATIONKEY'] < 21) & (nation['N_NAME'] != 'J') | (nation['N_NATIONKEY'] <= 12)][['N_NATIONKEY', 'N_NAME', 'N_COMMENT', 'N_REGIONKEY']].merge(supplier[['S_ADDRESS', 'S_PHONE']].merge(orders[(orders['ORDERSTATUS'] == 'P') & (orders['SHIPPRIORITY'] != 0) & (orders['O_COMMENT'] == '.')].merge(customer[(customer['MKTSEGMENT'] == 'FURNITURE') | (customer['C_CUSTKEY'] > 29) & (customer['C_PHONE'] != '25-') | (customer['C_ACCTBAL'] == 4139.250117891109)], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='S_SUPPKEY', right_on='O_ORDERKEY').merge(lineitem[['LINENUMBER', 'TAX', 'L_PARTKEY']], left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[(region['R_REGIONKEY'] >= 2)][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation[['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT', 'N_NAME']].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[['R_COMMENT']].merge(partsupp[(partsupp['SUPPLYCOST'] >= 558.4223146685357) & (partsupp['PS_PARTKEY'] > 34)][['P_COMMENT', 'SUPPLYCOST']], left_on='R_REGIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(part[['MFGR', 'CONTAINER']], left_on='R_REGIONKEY', right_on='P_PARTKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_REGIONKEY', 'N_NAME']).agg('min', numeric_only=True)

orders[['ORDERPRIORITY', 'TOTALPRICE', 'O_CUSTKEY']].merge(customer.merge(nation[['N_REGIONKEY', 'N_NAME', 'N_NATIONKEY', 'N_COMMENT']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders.merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_ADDRESS'].str.startswith('v')) & (customer['C_PHONE'].str.startswith('13-'))].merge(orders[(orders['O_CUSTKEY'] != 79825) | (orders['CLERK'] == 'C') & (orders['CLERK'] != 'C')], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['ORDERSTATUS'].isin(['O', 'P'])) & (orders['ORDERSTATUS'] == 'P') | (orders['TOTALPRICE'] >= 331339.78384264815)][['SHIPPRIORITY', 'ORDERPRIORITY', 'O_COMMENT', 'O_ORDERKEY']].merge(lineitem[['EXTENDEDPRICE', 'QUANTITY', 'L_ORDERKEY', 'LINESTATUS']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer.merge(orders[(orders['ORDERSTATUS'] == 'P') & (orders['ORDERDATE'] != '1998-07-21')][['ORDERDATE']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_NATIONKEY'] < 23)][['N_COMMENT']].merge(partsupp[['PS_PARTKEY', 'SUPPLYCOST', 'AVAILQTY']], left_on='N_NATIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

partsupp[(partsupp['SUPPLYCOST'] != 861.8517761161539) & (partsupp['PS_SUPPKEY'] > 3017)].merge(part[(part['RETAILPRICE'] != 967.13087749382) | (part['SIZE'] != 35) | (part['TYPE'].str.startswith('M'))].merge(partsupp.merge(supplier[(supplier['S_ADDRESS'].str.startswith('O')) & (supplier['S_NAME'] != 'S') | (supplier['S_NATIONKEY'] >= 19) | (supplier['S_PHONE'] == '26-')][['S_NAME', 'S_ACCTBAL']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['SUPPLYCOST']).agg('count')

orders[(orders['ORDERDATE'] != '1998-07-21') & (orders['TOTALPRICE'] != 255900.06764800477)][['CLERK', 'O_COMMENT']].groupby(by=['O_COMMENT', 'CLERK']).agg('min', numeric_only=True)

orders[['ORDERDATE', 'ORDERPRIORITY', 'O_ORDERKEY']]

part[(part['P_NAME'].str.startswith('c'))][['P_PARTKEY']].merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(lineitem[['LINESTATUS']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem.merge(orders[['O_COMMENT', 'SHIPPRIORITY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

partsupp[(partsupp['PS_SUPPKEY'] >= 3039) & (partsupp['PS_SUPPKEY'] >= 2239) & (partsupp['AVAILQTY'] <= 876) | (partsupp['PS_SUPPKEY'] != 870)].groupby(by=['SUPPLYCOST', 'PS_SUPPKEY']).agg('max', numeric_only=True)

region[['R_NAME', 'R_COMMENT']].groupby(by=['R_COMMENT', 'R_NAME']).agg('sum', numeric_only=True)

region[['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].merge(nation[(nation['N_REGIONKEY'] > 0) & (nation['N_COMMENT'].str.startswith('o')) & (nation['N_COMMENT'].str.startswith('h'))], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

customer.groupby(by=['MKTSEGMENT']).agg('sum', numeric_only=True)

supplier[['S_COMMENT']].merge(partsupp[(partsupp['P_COMMENT'] == 'g') & (partsupp['P_COMMENT'].str.startswith('f'))][['PS_SUPPKEY', 'P_COMMENT']].merge(lineitem[['L_COMMENT', 'LINESTATUS', 'LINENUMBER', 'EXTENDEDPRICE']].merge(region, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY'])

part[(part['TYPE'] != 'L') | (part['MFGR'].isin(['Manufacturer#2', 'Manufacturer#3', 'Manufacturer#5', 'Manufacturer#4'])) & (part['TYPE'] != 'M')].merge(partsupp[(partsupp['PS_SUPPKEY'] <= 7069) & (partsupp['SUPPLYCOST'] == 843.9827561077296) & (partsupp['PS_SUPPKEY'] < 1225)], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'] == '.')][['SUPPLYCOST', 'P_COMMENT']].merge(supplier[(supplier['S_COMMENT'] != 'l')].merge(nation[(nation['N_COMMENT'] == 'c') | (nation['N_REGIONKEY'] >= 3) | (nation['N_NATIONKEY'] == 21)][['N_NAME', 'N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='S_SUPPKEY').merge(orders[['ORDERPRIORITY']].merge(region[(region['R_NAME'] != 'E') & (region['R_NAME'] == 'AME')], left_on='O_ORDERKEY', right_on='R_REGIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='O_ORDERKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['P_COMMENT', 'SUPPLYCOST']], left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['SIZE']).agg('count')

region[(region['R_COMMENT'] == 'l') & (region['R_REGIONKEY'] >= 2) | (region['R_REGIONKEY'] == 1) & (region['R_COMMENT'] == 'l')].merge(nation[(nation['N_REGIONKEY'] > 2) | (nation['N_REGIONKEY'] == 3) & (nation['N_NAME'].str.startswith('P'))].merge(supplier[(supplier['S_PHONE'].str.startswith('32-')) | (supplier['S_COMMENT'] == ',') | (supplier['S_COMMENT'] == 'e') | (supplier['S_ADDRESS'] != 'p')], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[['C_ACCTBAL', 'MKTSEGMENT', 'C_ADDRESS', 'C_NAME', 'C_PHONE']].merge(partsupp[(partsupp['P_COMMENT'] != 'x') & (partsupp['P_COMMENT'].str.startswith('the'))][['PS_SUPPKEY', 'SUPPLYCOST', 'AVAILQTY', 'P_COMMENT', 'PS_PARTKEY']], left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] != 'u') & (nation['N_REGIONKEY'] > 2)][['N_COMMENT', 'N_REGIONKEY']].merge(region[['R_COMMENT', 'R_REGIONKEY']].merge(nation[(nation['N_COMMENT'] == 'l') | (nation['N_COMMENT'].str.startswith('o')) & (nation['N_REGIONKEY'] >= 0)][['N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_COMMENT'].str.startswith('u'))][['R_REGIONKEY', 'R_COMMENT', 'R_NAME']].merge(nation[['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'].str.startswith('J')) | (nation['N_COMMENT'].str.startswith('y'))][['N_REGIONKEY', 'N_NATIONKEY']].merge(customer[(customer['C_PHONE'].str.startswith('1'))].merge(nation[(nation['N_COMMENT'] != ' ') & (nation['N_NATIONKEY'] > 5) & (nation['N_COMMENT'].str.startswith(' ')) & (nation['N_COMMENT'] == 'u')], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('min', numeric_only=True)

partsupp[(partsupp['SUPPLYCOST'] <= 576.4199674090486) & (partsupp['SUPPLYCOST'] <= 445.0342977546373) | (partsupp['P_COMMENT'] != 'l')][['P_COMMENT', 'SUPPLYCOST']].merge(lineitem[(lineitem['L_SUPPKEY'] == 6873) & (lineitem['EXTENDEDPRICE'] != 28891.81553073447)], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).groupby(by=['P_COMMENT']).agg('min', numeric_only=True)

supplier.merge(partsupp[(partsupp['P_COMMENT'] != 'q') & (partsupp['AVAILQTY'] > 4047) & (partsupp['PS_PARTKEY'] < 21)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_ADDRESS', 'S_NATIONKEY']).agg('max', numeric_only=True)

orders.merge(customer[['C_ACCTBAL', 'C_NAME']], left_on='O_CUSTKEY', right_on='C_CUSTKEY')

partsupp[(partsupp['PS_PARTKEY'] != 31) | (partsupp['PS_SUPPKEY'] <= 5382) | (partsupp['PS_PARTKEY'] >= 47)][['PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT', 'AVAILQTY']].merge(supplier[['S_COMMENT', 'S_NATIONKEY', 'S_ACCTBAL', 'S_SUPPKEY']].merge(partsupp[['AVAILQTY', 'P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[(lineitem['LINENUMBER'] >= 2) & (lineitem['RETURNFLAG'] == 'A') | (lineitem['TAX'] >= 0.06995316877857953) | (lineitem['L_SUPPKEY'] >= 6901)][['DISCOUNT']].merge(partsupp.merge(part[(part['RETAILPRICE'] <= 934.7841143831284)], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(supplier[(supplier['S_NATIONKEY'] >= 12)].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(part[['TYPE', 'SIZE', 'RETAILPRICE']], left_on='PS_PARTKEY', right_on='P_PARTKEY')

supplier[(supplier['S_COMMENT'] != 'f') & (supplier['S_COMMENT'].str.startswith('w')) & (supplier['S_NATIONKEY'] < 19) | (supplier['S_SUPPKEY'] > 72)][['S_ACCTBAL', 'S_COMMENT', 'S_SUPPKEY', 'S_NAME']].merge(partsupp.merge(lineitem[(lineitem['SHIPDATE'] >= '1992-04-27') & (lineitem['L_COMMENT'].str.startswith('n')) & (lineitem['COMMITDATE'] == '1998-10-16')], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier[(supplier['S_NAME'] == 'S') & (supplier['S_ADDRESS'] != 'I') & (supplier['S_PHONE'].str.startswith('2')) | (supplier['S_COMMENT'].str.startswith(' '))][['S_NAME', 'S_SUPPKEY', 'S_ADDRESS']].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_PARTKEY'] > 25) | (partsupp['PS_PARTKEY'] == 35)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_NAME', 'S_COMMENT']).agg('min', numeric_only=True)

lineitem.merge(orders[['O_COMMENT', 'ORDERPRIORITY', 'O_CUSTKEY', 'ORDERSTATUS']].merge(customer[(customer['C_PHONE'].str.startswith('13-')) | (customer['C_NAME'].str.startswith('C'))][['C_ADDRESS']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').groupby(by=['TAX']).agg('mean', numeric_only=True)

orders.merge(lineitem[['L_ORDERKEY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['L_SUPPKEY'] < 8407)][['EXTENDEDPRICE', 'RECEIPTDATE', 'L_COMMENT', 'L_PARTKEY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_ACCTBAL'] < 7551.018843755584)].merge(nation[['N_COMMENT', 'N_REGIONKEY', 'N_NAME']].merge(region[(region['R_REGIONKEY'] < 3) & (region['R_COMMENT'] == 'l') & (region['R_REGIONKEY'] >= 3) | (region['R_NAME'].str.startswith('ASI'))][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['CLERK', 'ORDERPRIORITY']).agg('count')

lineitem[['TAX', 'LINENUMBER']].merge(orders[['O_CUSTKEY']].merge(customer[(customer['C_ACCTBAL'] != -827.2461113948398) | (customer['C_ADDRESS'] != 'o')].merge(nation[(nation['N_NATIONKEY'] == 8) | (nation['N_NATIONKEY'] <= 5)][['N_NATIONKEY', 'N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY').groupby(by=['LINENUMBER']).agg('sum', numeric_only=True)

partsupp.merge(part[(part['PT_COMMENT'] == 'f')][['TYPE', 'P_NAME', 'SIZE', 'BRAND', 'P_PARTKEY']].merge(partsupp[(partsupp['PS_SUPPKEY'] <= 266) & (partsupp['PS_SUPPKEY'] > 2396) | (partsupp['PS_PARTKEY'] >= 25)][['SUPPLYCOST']].merge(part[['P_PARTKEY', 'SIZE', 'BRAND', 'RETAILPRICE']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_SUPPKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[['L_ORDERKEY']].merge(orders[['ORDERSTATUS', 'O_ORDERKEY', 'CLERK', 'O_CUSTKEY', 'ORDERPRIORITY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['O_COMMENT'].str.startswith('u')) & (orders['ORDERPRIORITY'] == '4-NOT SPECIFIED') | (orders['CLERK'].str.startswith('C'))][['ORDERPRIORITY']].merge(supplier, left_on='O_ORDERKEY', right_on='S_SUPPKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier[['S_NATIONKEY', 'S_COMMENT', 'S_SUPPKEY', 'S_NAME']].merge(partsupp[(partsupp['P_COMMENT'] == 's') | (partsupp['PS_PARTKEY'] > 2)][['PS_PARTKEY', 'SUPPLYCOST', 'AVAILQTY', 'PS_SUPPKEY', 'P_COMMENT']].merge(lineitem[(lineitem['SHIPMODE'].isin(['SHIP', 'RAIL', 'FOB', 'MAIL']))][['L_ORDERKEY', 'L_COMMENT', 'LINESTATUS']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['PS_PARTKEY']).agg('count')

nation[['N_NAME']].groupby(by=['N_NAME']).agg('count')

lineitem.merge(partsupp[(partsupp['SUPPLYCOST'] == 104.40577553521369) & (partsupp['PS_PARTKEY'] <= 2) & (partsupp['PS_PARTKEY'] < 28) & (partsupp['P_COMMENT'].str.startswith('the'))].merge(part[(part['SIZE'] != 22)][['P_PARTKEY']].merge(partsupp[(partsupp['PS_SUPPKEY'] < 4961) | (partsupp['PS_SUPPKEY'] != 6422) | (partsupp['SUPPLYCOST'] < 409.1860361619064)][['SUPPLYCOST', 'AVAILQTY', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(supplier.merge(partsupp[(partsupp['P_COMMENT'] != '.') | (partsupp['AVAILQTY'] == 5516)][['PS_PARTKEY', 'AVAILQTY', 'P_COMMENT', 'SUPPLYCOST', 'PS_SUPPKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(part[(part['P_PARTKEY'] == 196) & (part['BRAND'].isin(['Brand#51', 'Brand#34', 'Brand#22', 'Brand#41', 'Brand#44', 'Brand#35', 'Brand#25', 'Brand#11', 'Brand#52'])) | (part['RETAILPRICE'] > 918.2356361267861) & (part['MFGR'] != 'Manufacturer#2')][['P_PARTKEY', 'SIZE', 'BRAND', 'MFGR']].merge(partsupp[(partsupp['PS_PARTKEY'] != 30) | (partsupp['PS_PARTKEY'] <= 35)], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['RECEIPTDATE', 'DISCOUNT']).agg('max', numeric_only=True)

customer[(customer['C_ACCTBAL'] != 8347.413329945364) | (customer['C_COMMENT'].str.startswith('g')) & (customer['C_NAME'].str.startswith('C')) | (customer['C_NAME'].str.startswith('C'))]

orders[(orders['O_CUSTKEY'] <= 20240) & (orders['TOTALPRICE'] == 284690.4214776633)].merge(customer[(customer['C_CUSTKEY'] > 98) & (customer['MKTSEGMENT'] == 'AUTOMOBILE') | (customer['C_PHONE'].str.startswith('27-'))].merge(orders[(orders['ORDERPRIORITY'] == '2-HIGH') & (orders['SHIPPRIORITY'] == 0)][['ORDERSTATUS', 'O_ORDERKEY', 'CLERK', 'SHIPPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['ORDERPRIORITY', 'ORDERDATE', 'SHIPPRIORITY', 'O_CUSTKEY', 'TOTALPRICE']].merge(customer[['C_PHONE']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer.merge(orders[(orders['O_ORDERKEY'] > 28) | (orders['SHIPPRIORITY'] < 0) & (orders['O_CUSTKEY'] > 118486)][['TOTALPRICE', 'CLERK', 'O_ORDERKEY', 'O_COMMENT', 'ORDERDATE']].merge(lineitem[(lineitem['L_COMMENT'] != 'f')][['L_COMMENT']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[(lineitem['TAX'] == 0.07947296964780198) | (lineitem['L_SUPPKEY'] >= 467) & (lineitem['QUANTITY'] >= 10)].merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['SUPPLYCOST'] == 110.71814376773567)].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY')

region[(region['R_NAME'] != 'ASI')][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].groupby(by=['R_REGIONKEY', 'R_NAME']).agg('mean', numeric_only=True)

partsupp[(partsupp['SUPPLYCOST'] == 899.1326106026493) | (partsupp['AVAILQTY'] <= 5982)][['PS_PARTKEY', 'P_COMMENT', 'SUPPLYCOST']].merge(part[(part['PT_COMMENT'].str.startswith('u')) | (part['MFGR'] != 'Manufacturer#1') | (part['P_PARTKEY'] == 9)][['MFGR', 'CONTAINER', 'PT_COMMENT', 'SIZE', 'RETAILPRICE']].merge(orders[['ORDERPRIORITY', 'O_CUSTKEY', 'CLERK', 'ORDERDATE', 'TOTALPRICE']], left_on='P_PARTKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY')

region[(region['R_COMMENT'].str.startswith('u'))].groupby(by=['R_REGIONKEY']).agg('sum', numeric_only=True)

orders[['SHIPPRIORITY', 'O_COMMENT', 'ORDERDATE', 'O_CUSTKEY']].merge(customer[(customer['MKTSEGMENT'] != 'MACHINERY') | (customer['C_NATIONKEY'] != 10) | (customer['C_NATIONKEY'] != 8) & (customer['C_CUSTKEY'] == 17)][['MKTSEGMENT']].merge(supplier[(supplier['S_PHONE'].str.startswith('26-')) & (supplier['S_NATIONKEY'] <= 8) & (supplier['S_PHONE'].str.startswith('28-'))].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='C_CUSTKEY', right_on='S_SUPPKEY').merge(supplier, left_on='C_CUSTKEY', right_on='S_SUPPKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

region[(region['R_COMMENT'] != 'u')].merge(nation.merge(customer[(customer['C_ACCTBAL'] >= -390.5228213966169)][['C_ACCTBAL', 'C_CUSTKEY', 'C_PHONE']].merge(orders[['ORDERDATE']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] != 'P') | (nation['N_NAME'] == 'G') | (nation['N_COMMENT'] == 'y') & (nation['N_REGIONKEY'] <= 3)], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY')

partsupp[(partsupp['PS_PARTKEY'] <= 38) | (partsupp['AVAILQTY'] < 6837) & (partsupp['P_COMMENT'].str.startswith('g')) | (partsupp['AVAILQTY'] >= 2958)].groupby(by=['SUPPLYCOST', 'PS_SUPPKEY']).agg('sum', numeric_only=True)

lineitem.merge(partsupp[(partsupp['AVAILQTY'] != 2987) | (partsupp['PS_SUPPKEY'] > 833) & (partsupp['PS_SUPPKEY'] >= 4589)][['SUPPLYCOST']].merge(nation.merge(supplier[(supplier['S_NAME'] == 'S') & (supplier['S_PHONE'] != '17-')][['S_NAME', 'S_NATIONKEY', 'S_SUPPKEY', 'S_COMMENT']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(orders.merge(customer[['C_NATIONKEY', 'C_ACCTBAL']], left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_ACCTBAL'] >= 8295.182977248744) | (customer['C_CUSTKEY'] > 14) | (customer['C_NAME'] != 'C') & (customer['C_NAME'] == 'C')].merge(orders[['ORDERPRIORITY', 'O_COMMENT', 'O_CUSTKEY', 'CLERK']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY')

customer[['C_ACCTBAL', 'MKTSEGMENT', 'C_CUSTKEY', 'C_PHONE']].merge(orders[(orders['ORDERSTATUS'] != 'O') | (orders['O_COMMENT'] != 'q')].merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['ORDERDATE'] >= '1998-07-21') | (orders['O_CUSTKEY'] < 100504) & (orders['O_COMMENT'] == 'o')][['ORDERSTATUS', 'ORDERDATE', 'O_CUSTKEY', 'SHIPPRIORITY', 'O_COMMENT']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_PHONE', 'C_ACCTBAL']).agg('max', numeric_only=True)

lineitem[['L_PARTKEY', 'L_COMMENT', 'QUANTITY', 'DISCOUNT']]

lineitem.merge(partsupp[(partsupp['P_COMMENT'] == 'y') | (partsupp['PS_SUPPKEY'] < 3679)][['SUPPLYCOST', 'P_COMMENT', 'PS_SUPPKEY', 'AVAILQTY', 'PS_PARTKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(orders[['O_ORDERKEY', 'O_COMMENT', 'TOTALPRICE']].merge(lineitem.merge(partsupp[['SUPPLYCOST', 'P_COMMENT', 'AVAILQTY', 'PS_SUPPKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['QUANTITY'] == 31)].merge(orders[(orders['ORDERPRIORITY'] == '1-URGENT')][['ORDERDATE', 'TOTALPRICE', 'ORDERPRIORITY', 'SHIPPRIORITY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp.merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY')

nation[(nation['N_NATIONKEY'] == 2) & (nation['N_COMMENT'].str.startswith('s'))].merge(customer[(customer['C_ACCTBAL'] != 866.5491243684846) & (customer['C_NAME'] != 'C') & (customer['C_COMMENT'] != 'q') | (customer['C_NATIONKEY'] > 5)].merge(orders[(orders['O_CUSTKEY'] < 4418) & (orders['CLERK'] == 'C') & (orders['CLERK'] != 'C') | (orders['O_COMMENT'] != 'z')][['SHIPPRIORITY']].merge(part[(part['P_NAME'].str.startswith('a')) | (part['CONTAINER'] == 'MED') | (part['TYPE'] != 'STA')][['BRAND', 'MFGR', 'TYPE']], left_on='O_ORDERKEY', right_on='P_PARTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_REGIONKEY']).agg('count')

supplier[(supplier['S_NAME'] == 'S') & (supplier['S_SUPPKEY'] > 8) & (supplier['S_NAME'] == 'S')].merge(partsupp[['P_COMMENT', 'AVAILQTY', 'PS_SUPPKEY', 'PS_PARTKEY']].merge(supplier.merge(partsupp[(partsupp['PS_SUPPKEY'] > 7202) & (partsupp['P_COMMENT'] == 'j') & (partsupp['AVAILQTY'] < 7609)][['PS_PARTKEY', 'AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['PS_PARTKEY', 'AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation.merge(customer[(customer['C_NATIONKEY'] <= 14) & (customer['C_PHONE'].str.startswith('3'))].merge(nation[(nation['N_COMMENT'].str.startswith('v')) | (nation['N_REGIONKEY'] < 0) & (nation['N_COMMENT'].str.startswith('u')) | (nation['N_REGIONKEY'] > 3)], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_NATIONKEY'] <= 23)][['S_NATIONKEY', 'S_COMMENT']].merge(nation[['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME', 'N_COMMENT']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_ACCTBAL']).agg('count')

region[['R_NAME', 'R_COMMENT', 'R_REGIONKEY']]

customer[(customer['C_ACCTBAL'] < 495.51167706394745) | (customer['C_ACCTBAL'] != 8190.57755386015)].merge(orders[['ORDERPRIORITY', 'O_COMMENT', 'O_ORDERKEY', 'ORDERSTATUS', 'TOTALPRICE']].merge(lineitem[['SHIPMODE', 'DISCOUNT']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[['QUANTITY', 'LINESTATUS', 'L_COMMENT']].merge(customer[(customer['C_ACCTBAL'] < 4446.663191157432) & (customer['C_PHONE'].str.startswith('2'))][['C_NATIONKEY', 'C_COMMENT', 'C_PHONE', 'C_NAME', 'MKTSEGMENT']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_CUSTKEY', 'C_COMMENT']).agg('sum', numeric_only=True)

customer[(customer['C_PHONE'] != '13-') & (customer['C_COMMENT'] == 'y') & (customer['MKTSEGMENT'] != 'AUTOMOBILE') | (customer['C_PHONE'].str.startswith('25-'))].groupby(by=['C_NAME']).agg('min', numeric_only=True)

nation.merge(customer[(customer['C_CUSTKEY'] < 93) | (customer['C_ACCTBAL'] == 3392.846063083466) & (customer['C_NATIONKEY'] > 7)], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer.merge(orders[(orders['ORDERSTATUS'].isin(['F', 'P'])) & (orders['TOTALPRICE'] < 248717.45951168326) | (orders['TOTALPRICE'] < 204551.631711683)][['ORDERPRIORITY', 'O_ORDERKEY']].merge(lineitem[(lineitem['DISCOUNT'] == 0.057595440607004944)], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

partsupp[(partsupp['SUPPLYCOST'] >= 579.7108846108736) | (partsupp['PS_SUPPKEY'] > 3229)][['PS_SUPPKEY', 'AVAILQTY']].merge(supplier[(supplier['S_SUPPKEY'] < 55) | (supplier['S_ACCTBAL'] > 2187.7303162996377) | (supplier['S_PHONE'] == '3') & (supplier['S_ACCTBAL'] <= 1149.4394344446312)], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['COMMITDATE'] != '1992-05-15') | (lineitem['SHIPINSTRUCT'] == 'NONE')][['L_SUPPKEY', 'SHIPINSTRUCT']].merge(partsupp[(partsupp['PS_PARTKEY'] <= 17) | (partsupp['PS_PARTKEY'] > 31) & (partsupp['P_COMMENT'].str.startswith('l'))][['PS_SUPPKEY', 'P_COMMENT', 'PS_PARTKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').groupby(by=['PS_SUPPKEY']).agg('min', numeric_only=True)

part[['TYPE', 'MFGR']].merge(supplier.merge(nation[['N_NATIONKEY', 'N_NAME', 'N_COMMENT']].merge(customer[(customer['MKTSEGMENT'] == 'BUILDING') & (customer['C_NATIONKEY'] != 5)][['C_COMMENT', 'C_NAME', 'C_CUSTKEY', 'C_ADDRESS']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_REGIONKEY'] <= 3)].merge(region[(region['R_NAME'] == 'AME') | (region['R_COMMENT'] != 'l') | (region['R_COMMENT'] != 'h') & (region['R_REGIONKEY'] <= 0)][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='P_PARTKEY', right_on='S_SUPPKEY')

customer

orders

partsupp[(partsupp['AVAILQTY'] >= 4869)][['SUPPLYCOST', 'AVAILQTY']].groupby(by=['AVAILQTY', 'SUPPLYCOST']).agg('mean', numeric_only=True)

orders.merge(customer.merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

region[(region['R_NAME'] == 'M') & (region['R_REGIONKEY'] < 0)].merge(nation[(nation['N_NATIONKEY'] > 17) & (nation['N_REGIONKEY'] > 3) & (nation['N_REGIONKEY'] <= 3) & (nation['N_REGIONKEY'] == 0)].merge(supplier[['S_NAME', 'S_COMMENT', 'S_ACCTBAL']].merge(orders[(orders['O_COMMENT'] == 'ly ')], left_on='S_SUPPKEY', right_on='O_ORDERKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] <= 2)], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] == ' ') & (nation['N_COMMENT'].str.startswith('p')) & (nation['N_REGIONKEY'] < 3) | (nation['N_COMMENT'] != 'l')][['N_NAME', 'N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY', 'R_NAME']).agg('mean', numeric_only=True)

lineitem.merge(orders[(orders['ORDERPRIORITY'] != '5-LOW') | (orders['TOTALPRICE'] <= 210247.3127446317) & (orders['O_ORDERKEY'] < 644) & (orders['O_CUSTKEY'] != 7765)][['O_CUSTKEY', 'TOTALPRICE', 'ORDERPRIORITY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY')

lineitem[(lineitem['TAX'] > 0.003159956857947375) & (lineitem['SHIPMODE'] != 'RAIL') | (lineitem['TAX'] == 0.07896774574875419) | (lineitem['L_PARTKEY'] < 183749)].merge(partsupp[['PS_SUPPKEY', 'PS_PARTKEY', 'SUPPLYCOST', 'P_COMMENT', 'AVAILQTY']].merge(supplier[['S_COMMENT', 'S_ADDRESS', 'S_PHONE']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['L_COMMENT', 'LINENUMBER']).agg('min', numeric_only=True)

nation[(nation['N_COMMENT'].str.startswith('p')) & (nation['N_COMMENT'] != 'a') & (nation['N_REGIONKEY'] >= 1) & (nation['N_REGIONKEY'] >= 2)][['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']]

part[(part['RETAILPRICE'] <= 931.7500358582832)][['TYPE', 'SIZE', 'CONTAINER']].merge(lineitem[(lineitem['L_PARTKEY'] != 149655)][['L_SUPPKEY']].merge(partsupp[(partsupp['P_COMMENT'] != ',')].merge(lineitem[(lineitem['TAX'] <= 0.031390767459021765) | (lineitem['RECEIPTDATE'] != '1992-05-02') & (lineitem['COMMITDATE'] != '1992-05-15')][['SHIPDATE', 'RECEIPTDATE']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp.merge(part[['PT_COMMENT', 'P_NAME']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).groupby(by=['SIZE', 'TYPE']).agg('mean', numeric_only=True)

customer[(customer['C_CUSTKEY'] < 68)].groupby(by=['C_CUSTKEY', 'C_ADDRESS']).agg('max', numeric_only=True)

customer[(customer['C_ACCTBAL'] >= 1228.074587957417) | (customer['MKTSEGMENT'] == 'FURNITURE')].merge(nation[(nation['N_COMMENT'] != 'l') | (nation['N_COMMENT'] == 'p') | (nation['N_COMMENT'] == 's')].merge(supplier[(supplier['S_ACCTBAL'] <= 3484.274449058431) | (supplier['S_ADDRESS'] == '9') & (supplier['S_ADDRESS'] != '4') & (supplier['S_NAME'].str.startswith('S'))][['S_PHONE', 'S_ADDRESS', 'S_COMMENT', 'S_NAME']].merge(region[(region['R_NAME'] != 'AFR') & (region['R_COMMENT'] != 'l') | (region['R_REGIONKEY'] < 0) | (region['R_NAME'] != 'ASI')], left_on='S_SUPPKEY', right_on='R_REGIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[(region['R_COMMENT'] == 'u') & (region['R_COMMENT'] == 'g') | (region['R_REGIONKEY'] != 0)][['R_REGIONKEY', 'R_COMMENT', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_COMMENT'].str.startswith('n')) | (nation['N_NATIONKEY'] == 6)].merge(customer[(customer['C_PHONE'] != '3')].merge(nation[['N_NAME', 'N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_NAME'] != 'AFR')], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_NATIONKEY', 'MKTSEGMENT']).agg('min', numeric_only=True)

nation[(nation['N_NAME'] == 'V') & (nation['N_REGIONKEY'] != 3) | (nation['N_NAME'] != 'M') | (nation['N_REGIONKEY'] != 2)].merge(customer[['C_ADDRESS', 'C_COMMENT', 'C_CUSTKEY']].merge(orders[(orders['ORDERPRIORITY'] != '4-NOT SPECIFIED') & (orders['TOTALPRICE'] != 106744.13186133893) & (orders['O_CUSTKEY'] < 145054)][['SHIPPRIORITY', 'ORDERPRIORITY', 'O_CUSTKEY']].merge(customer[(customer['C_ADDRESS'].str.startswith('T'))], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_REGIONKEY', 'N_COMMENT']).agg('sum', numeric_only=True)

orders[(orders['SHIPPRIORITY'] >= 0) & (orders['CLERK'] != 'C')].merge(customer[(customer['C_ADDRESS'] == 'f') | (customer['MKTSEGMENT'] != 'HOUSEHOLD')].merge(nation[['N_REGIONKEY', 'N_NAME', 'N_COMMENT']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_ACCTBAL'] == 7406.351606250375) | (customer['C_CUSTKEY'] <= 57) & (customer['C_ADDRESS'].str.startswith('E'))][['C_NAME', 'C_CUSTKEY', 'MKTSEGMENT']].merge(orders[['TOTALPRICE', 'SHIPPRIORITY', 'O_COMMENT', 'O_CUSTKEY', 'ORDERSTATUS']].merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

orders.groupby(by=['ORDERSTATUS']).agg('min', numeric_only=True)

part[['SIZE']].merge(lineitem[(lineitem['SHIPMODE'] == 'TRUCK') | (lineitem['DISCOUNT'] == 0.07909642579146879) | (lineitem['DISCOUNT'] != 0.023135838237601028)][['L_SUPPKEY', 'DISCOUNT', 'LINESTATUS', 'L_ORDERKEY', 'TAX']].merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['AVAILQTY'] < 2452) & (partsupp['PS_SUPPKEY'] > 1517) & (partsupp['SUPPLYCOST'] != 225.49769125654308)][['P_COMMENT', 'PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY']].merge(lineitem[(lineitem['RECEIPTDATE'] <= '1998-11-06') & (lineitem['LINENUMBER'] > 3) | (lineitem['QUANTITY'] >= 13)][['L_PARTKEY']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(nation.merge(customer[(customer['C_ADDRESS'].str.startswith('U')) & (customer['C_ACCTBAL'] >= 7900.842094496387) & (customer['C_ADDRESS'].str.startswith('B'))].merge(orders[(orders['O_CUSTKEY'] >= 24630) | (orders['O_CUSTKEY'] >= 68281) | (orders['CLERK'] != 'C')], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='P_PARTKEY', right_on='N_NATIONKEY').merge(orders.merge(lineitem.merge(partsupp[(partsupp['P_COMMENT'] != 'v')], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='P_PARTKEY', right_on='O_ORDERKEY')

supplier[['S_SUPPKEY', 'S_ADDRESS', 'S_COMMENT']].merge(partsupp[(partsupp['PS_PARTKEY'] >= 23)].merge(supplier[(supplier['S_NAME'].str.startswith('S')) & (supplier['S_ACCTBAL'] >= 9736.695818600201) & (supplier['S_NATIONKEY'] < 11) & (supplier['S_ADDRESS'] != 'L')][['S_ACCTBAL', 'S_ADDRESS', 'S_SUPPKEY', 'S_NAME']].merge(partsupp[(partsupp['AVAILQTY'] != 3764) | (partsupp['PS_SUPPKEY'] > 5168) | (partsupp['AVAILQTY'] > 2642) | (partsupp['SUPPLYCOST'] == 275.0537493146891)][['AVAILQTY', 'P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['SUPPLYCOST', 'P_COMMENT', 'PS_SUPPKEY', 'PS_PARTKEY', 'AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

partsupp[(partsupp['PS_SUPPKEY'] >= 3345) & (partsupp['PS_SUPPKEY'] <= 3975) & (partsupp['AVAILQTY'] == 9406)].merge(lineitem.merge(partsupp[['PS_SUPPKEY', 'PS_PARTKEY', 'AVAILQTY', 'P_COMMENT']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY')

orders.merge(lineitem.merge(partsupp.merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(orders[(orders['O_CUSTKEY'] >= 47559) & (orders['ORDERDATE'] != '1992-01-13') & (orders['CLERK'] == 'C')], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[['COMMITDATE', 'EXTENDEDPRICE', 'L_COMMENT', 'L_PARTKEY', 'RECEIPTDATE']].merge(partsupp[['AVAILQTY', 'P_COMMENT', 'PS_PARTKEY', 'SUPPLYCOST']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_NAME'].str.startswith('C')) & (customer['C_CUSTKEY'] >= 40) & (customer['C_ACCTBAL'] > 4734.092719284941)][['C_PHONE', 'C_CUSTKEY', 'MKTSEGMENT']].merge(orders[(orders['SHIPPRIORITY'] != 0) | (orders['ORDERPRIORITY'].isin(['5-LOW', '2-HIGH', '1-URGENT', '3-MEDIUM']))][['ORDERDATE', 'TOTALPRICE']].merge(part[['PT_COMMENT', 'P_NAME']], left_on='O_ORDERKEY', right_on='P_PARTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

nation[(nation['N_COMMENT'] != 'u') | (nation['N_NATIONKEY'] != 20) | (nation['N_NATIONKEY'] <= 1)].merge(region[(region['R_NAME'].str.startswith('E'))][['R_REGIONKEY', 'R_COMMENT', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY')

region[(region['R_COMMENT'] == 'l') | (region['R_NAME'] != 'AFR') | (region['R_REGIONKEY'] > 2) | (region['R_COMMENT'] != 'g')][['R_REGIONKEY', 'R_NAME']]

nation[['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']].merge(region[(region['R_NAME'].str.startswith('AME')) | (region['R_COMMENT'] == 'u') | (region['R_COMMENT'] != 'l') | (region['R_NAME'] != 'M')][['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation.merge(region[['R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier.merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_NATIONKEY', 'N_REGIONKEY']).agg('mean', numeric_only=True)

supplier[(supplier['S_COMMENT'] != 's')][['S_SUPPKEY', 'S_PHONE', 'S_NAME', 'S_NATIONKEY']].merge(partsupp[(partsupp['PS_SUPPKEY'] == 2489) & (partsupp['PS_PARTKEY'] <= 25) | (partsupp['PS_PARTKEY'] == 44) & (partsupp['P_COMMENT'] == ' ')][['AVAILQTY', 'SUPPLYCOST', 'PS_SUPPKEY', 'PS_PARTKEY', 'P_COMMENT']].merge(lineitem[['QUANTITY', 'L_ORDERKEY']].merge(orders[(orders['O_COMMENT'] == 'ly ') & (orders['TOTALPRICE'] >= 316005.8390272354) & (orders['TOTALPRICE'] == 289530.6510341265)][['TOTALPRICE', 'ORDERPRIORITY', 'O_ORDERKEY', 'ORDERSTATUS']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

lineitem[(lineitem['LINESTATUS'].isin(['F', 'O'])) | (lineitem['DISCOUNT'] == 0.009648749729982942) & (lineitem['LINESTATUS'] != 'O') & (lineitem['SHIPINSTRUCT'] != 'COLLECT COD')][['LINESTATUS', 'EXTENDEDPRICE', 'L_COMMENT', 'SHIPDATE']].merge(partsupp.merge(supplier[['S_SUPPKEY', 'S_PHONE', 'S_NAME', 'S_NATIONKEY', 'S_COMMENT']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(partsupp[(partsupp['AVAILQTY'] != 1302) & (partsupp['PS_PARTKEY'] != 14) | (partsupp['AVAILQTY'] == 2142)].merge(lineitem[['TAX', 'LINESTATUS', 'L_ORDERKEY', 'COMMITDATE']].merge(orders[(orders['TOTALPRICE'] > 67244.1094396684) | (orders['O_ORDERKEY'] < 81)], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(region, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY').groupby(by=['LINESTATUS']).agg('max', numeric_only=True)

lineitem.groupby(by=['TAX', 'RETURNFLAG']).agg('min', numeric_only=True)

part[(part['RETAILPRICE'] == 910.377817141605) & (part['P_PARTKEY'] == 93)]

customer.merge(orders[(orders['O_COMMENT'].str.startswith('k')) | (orders['CLERK'] == 'C') & (orders['O_CUSTKEY'] <= 39431) & (orders['CLERK'] == 'C')][['ORDERDATE', 'ORDERSTATUS', 'CLERK']].merge(partsupp.merge(supplier[(supplier['S_ACCTBAL'] > 1647.0359077626365)][['S_NATIONKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(customer[(customer['C_PHONE'] != '18-') | (customer['C_COMMENT'] != 'c') & (customer['C_ADDRESS'] == 'n') | (customer['C_COMMENT'] != 't')][['C_NATIONKEY', 'C_ACCTBAL', 'C_ADDRESS', 'C_CUSTKEY']], left_on='O_ORDERKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_NAME']).agg('mean', numeric_only=True)

supplier[['S_SUPPKEY', 'S_ADDRESS', 'S_ACCTBAL', 'S_PHONE']].merge(partsupp[(partsupp['PS_SUPPKEY'] < 2075) & (partsupp['PS_SUPPKEY'] >= 3618) | (partsupp['SUPPLYCOST'] > 655.7191416025017) | (partsupp['PS_PARTKEY'] == 30)][['SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT', 'PS_PARTKEY', 'AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['AVAILQTY'] == 9636) & (partsupp['P_COMMENT'] == 'r') & (partsupp['SUPPLYCOST'] != 643.1806631072768)].merge(lineitem[['LINENUMBER', 'SHIPMODE', 'EXTENDEDPRICE', 'RETURNFLAG', 'QUANTITY']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_ACCTBAL', 'S_SUPPKEY']).agg('sum', numeric_only=True)

orders.merge(customer[['C_PHONE']].merge(nation[['N_NATIONKEY']].merge(customer[(customer['C_ADDRESS'] != 'h') & (customer['C_COMMENT'].str.startswith('f')) | (customer['MKTSEGMENT'] != 'FURNITURE')][['C_ACCTBAL', 'C_NAME']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_CUSTKEY', right_on='N_NATIONKEY').merge(part.merge(partsupp[(partsupp['AVAILQTY'] < 7916) | (partsupp['PS_SUPPKEY'] != 3679)], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='C_CUSTKEY', right_on='P_PARTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['ORDERDATE', 'ORDERPRIORITY']).agg('count')

partsupp[['AVAILQTY', 'SUPPLYCOST', 'PS_PARTKEY', 'PS_SUPPKEY']].groupby(by=['PS_PARTKEY', 'SUPPLYCOST']).agg('min', numeric_only=True)

region[(region['R_COMMENT'] != 'g') | (region['R_REGIONKEY'] < 3) | (region['R_REGIONKEY'] >= 0) & (region['R_REGIONKEY'] < 3)]

region.merge(nation[(nation['N_COMMENT'] != 'v')].merge(customer[['MKTSEGMENT', 'C_ACCTBAL', 'C_NAME']].merge(partsupp[(partsupp['P_COMMENT'] == 'y') | (partsupp['AVAILQTY'] == 7034) | (partsupp['AVAILQTY'] == 1176)], left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_NAME'] != 'S') | (supplier['S_PHONE'] != '26-') & (supplier['S_ACCTBAL'] > 7005.134022888545) | (supplier['S_NATIONKEY'] > 21)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] != 'B') & (nation['N_COMMENT'] != 'a') | (nation['N_NAME'] == 'B')][['N_COMMENT', 'N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']].merge(customer[['C_CUSTKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_REGIONKEY'] <= 2)][['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation[['N_NAME', 'N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] == 's')][['N_NATIONKEY']].merge(supplier[['S_SUPPKEY', 'S_PHONE', 'S_ACCTBAL', 'S_NAME']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY', 'R_NAME']).agg('min', numeric_only=True)

customer[['C_NATIONKEY', 'C_COMMENT', 'C_ADDRESS']].merge(nation[(nation['N_NAME'] == 'U') | (nation['N_NATIONKEY'] < 10) | (nation['N_COMMENT'] == 'o') | (nation['N_REGIONKEY'] > 1)][['N_NAME', 'N_COMMENT', 'N_REGIONKEY']].merge(region.merge(nation[(nation['N_NATIONKEY'] > 11) | (nation['N_NATIONKEY'] != 3) & (nation['N_NAME'] == 'U')], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_REGIONKEY'] > 3) | (region['R_REGIONKEY'] < 2) | (region['R_COMMENT'] == 'l') & (region['R_COMMENT'] == 'u')][['R_REGIONKEY', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

customer[(customer['C_NATIONKEY'] != 5) & (customer['MKTSEGMENT'].isin(['HOUSEHOLD', 'AUTOMOBILE', 'FURNITURE', 'MACHINERY', 'BUILDING'])) | (customer['MKTSEGMENT'] != 'BUILDING')]

supplier[['S_ADDRESS', 'S_NAME', 'S_SUPPKEY', 'S_COMMENT', 'S_PHONE']].merge(partsupp[(partsupp['AVAILQTY'] != 3822) & (partsupp['PS_SUPPKEY'] != 3560)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['P_COMMENT'].str.startswith('ly ')) | (partsupp['SUPPLYCOST'] != 785.757049102006) | (partsupp['PS_PARTKEY'] != 30)].merge(part[['P_NAME', 'MFGR', 'CONTAINER']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] <= 932) & (partsupp['PS_SUPPKEY'] > 4237) & (partsupp['AVAILQTY'] == 4774) & (partsupp['PS_PARTKEY'] < 21)].merge(lineitem[(lineitem['L_ORDERKEY'] < 114) & (lineitem['SHIPDATE'] > '1992-04-27') & (lineitem['SHIPMODE'] != 'SHIP') | (lineitem['LINESTATUS'] != 'O')].merge(partsupp[(partsupp['PS_PARTKEY'] == 36)][['PS_SUPPKEY', 'SUPPLYCOST', 'AVAILQTY', 'P_COMMENT']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_SUPPKEY', 'S_COMMENT']).agg('max', numeric_only=True)

supplier[(supplier['S_ADDRESS'] != 'v') | (supplier['S_ADDRESS'].str.startswith('o'))].merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] <= 5470) | (partsupp['AVAILQTY'] < 8784)].merge(lineitem[['COMMITDATE', 'LINENUMBER', 'L_SUPPKEY']].merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_REGIONKEY'] >= 2) | (nation['N_REGIONKEY'] < 1) | (nation['N_REGIONKEY'] < 2)].merge(supplier[(supplier['S_ACCTBAL'] != -707.686527158942) & (supplier['S_COMMENT'] != 'f') | (supplier['S_NAME'] == 'S') & (supplier['S_SUPPKEY'] == 186)].merge(nation[(nation['N_NATIONKEY'] != 6) | (nation['N_REGIONKEY'] >= 3)], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY')

region[(region['R_REGIONKEY'] <= 0) & (region['R_NAME'].str.startswith('ASI'))].merge(nation[(nation['N_NATIONKEY'] >= 14) | (nation['N_NAME'] == 'J') | (nation['N_NATIONKEY'] < 2) | (nation['N_NAME'].str.startswith('E'))][['N_COMMENT', 'N_NAME']].merge(lineitem[['SHIPINSTRUCT', 'L_COMMENT']].merge(region[['R_REGIONKEY', 'R_NAME', 'R_COMMENT']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='N_NATIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] <= 23) | (nation['N_COMMENT'].str.startswith('u'))][['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NAME', 'N_REGIONKEY', 'N_COMMENT']].merge(region[(region['R_REGIONKEY'] <= 0) & (region['R_REGIONKEY'] != 0) & (region['R_COMMENT'].str.startswith('g'))].merge(nation[['N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[['R_NAME']].merge(supplier[['S_SUPPKEY']], left_on='R_REGIONKEY', right_on='S_SUPPKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

region[['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation[(nation['N_NATIONKEY'] != 19) & (nation['N_NAME'] == 'R')], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

nation.groupby(by=['N_REGIONKEY', 'N_COMMENT']).agg('mean', numeric_only=True)

supplier[(supplier['S_ADDRESS'].str.startswith('e')) & (supplier['S_NAME'] == 'S') & (supplier['S_COMMENT'] != 'x') | (supplier['S_SUPPKEY'] > 126)].merge(partsupp.merge(lineitem[(lineitem['SHIPINSTRUCT'].isin(['NONE', 'DELIVER IN PERSON', 'COLLECT COD'])) & (lineitem['LINENUMBER'] != 2) & (lineitem['L_PARTKEY'] <= 146823)][['LINENUMBER']].merge(supplier[(supplier['S_ADDRESS'] != 'G') & (supplier['S_PHONE'] == '1')][['S_ACCTBAL', 'S_NATIONKEY', 'S_PHONE', 'S_SUPPKEY', 'S_NAME']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_NAME'].str.startswith('K'))][['N_COMMENT']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_COMMENT'].str.startswith('l'))][['N_NATIONKEY', 'N_COMMENT', 'N_NAME', 'N_REGIONKEY']].merge(supplier[['S_SUPPKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_SUPPKEY']).agg('max', numeric_only=True)

orders[['TOTALPRICE', 'O_ORDERKEY', 'CLERK', 'ORDERPRIORITY', 'O_COMMENT']]

nation[(nation['N_NATIONKEY'] > 11)][['N_COMMENT', 'N_NATIONKEY']].merge(supplier[(supplier['S_COMMENT'].str.startswith('i')) & (supplier['S_ACCTBAL'] != 2335.41298016732) & (supplier['S_NATIONKEY'] == 22)], left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_NATIONKEY', 'N_COMMENT']).agg('min', numeric_only=True)

nation[(nation['N_COMMENT'] != 'u')].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[['R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_REGIONKEY'] >= 3)].merge(region[(region['R_COMMENT'] != 'h') | (region['R_COMMENT'].str.startswith('l')) & (region['R_COMMENT'] != 'l')], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[(customer['C_ACCTBAL'] < 6689.315545403879) | (customer['C_PHONE'] == '13-') | (customer['C_ACCTBAL'] <= 3698.76412002713)].merge(nation[(nation['N_NAME'] == 'V') & (nation['N_NATIONKEY'] > 18) & (nation['N_NAME'] == 'G')], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

lineitem[(lineitem['L_PARTKEY'] == 153106) & (lineitem['L_ORDERKEY'] < 68) & (lineitem['L_SUPPKEY'] > 3888) | (lineitem['SHIPDATE'] >= '1998-10-30')][['L_COMMENT', 'RECEIPTDATE']].merge(customer[['C_COMMENT', 'C_NATIONKEY', 'C_ADDRESS', 'MKTSEGMENT', 'C_ACCTBAL']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY').merge(partsupp[(partsupp['PS_PARTKEY'] >= 22) | (partsupp['SUPPLYCOST'] == 189.07562309861714)], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(partsupp[(partsupp['PS_SUPPKEY'] >= 5433) | (partsupp['P_COMMENT'] == ',')], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']).groupby(by=['RECEIPTDATE', 'L_COMMENT']).agg('mean', numeric_only=True)

nation[(nation['N_COMMENT'] != 'e')].merge(region.merge(nation[(nation['N_COMMENT'] != 'n') | (nation['N_COMMENT'].str.startswith('s'))][['N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY', 'N_NAME']].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY')

customer[['C_ADDRESS', 'C_CUSTKEY', 'C_COMMENT', 'C_NAME', 'C_PHONE']].groupby(by=['C_ADDRESS', 'C_CUSTKEY']).agg('max', numeric_only=True)

region[['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation[['N_NAME', 'N_NATIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] > 16) & (nation['N_REGIONKEY'] < 2) & (nation['N_NATIONKEY'] == 13) | (nation['N_COMMENT'] == ' ')][['N_NAME', 'N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

orders.merge(lineitem[(lineitem['DISCOUNT'] > 0.05378200762706467) & (lineitem['LINENUMBER'] > 2) | (lineitem['LINESTATUS'] == 'F')].merge(orders[(orders['O_ORDERKEY'] != 160) | (orders['ORDERPRIORITY'].isin(['5-LOW', '2-HIGH', '3-MEDIUM', '4-NOT SPECIFIED'])) & (orders['ORDERPRIORITY'] != '2-HIGH') | (orders['SHIPPRIORITY'] > 0)][['O_CUSTKEY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[['COMMITDATE', 'DISCOUNT', 'RETURNFLAG', 'L_COMMENT']].merge(orders[(orders['O_COMMENT'] == '.') & (orders['SHIPPRIORITY'] < 0)].merge(lineitem[(lineitem['COMMITDATE'] < '1992-05-15')], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['MKTSEGMENT'].isin(['HOUSEHOLD', 'BUILDING'])) | (customer['C_ADDRESS'] != '8') & (customer['C_ACCTBAL'] < -508.72681820075195) | (customer['C_ACCTBAL'] <= 9136.783220475669)].merge(nation[(nation['N_COMMENT'].str.startswith('o')) | (nation['N_NAME'].str.startswith('S'))], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['ORDERDATE', 'ORDERSTATUS']).agg('mean', numeric_only=True)

orders[['SHIPPRIORITY', 'ORDERDATE']].merge(region[(region['R_NAME'] == 'M') | (region['R_REGIONKEY'] == 2)][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_COMMENT'].str.startswith('p')) & (nation['N_REGIONKEY'] >= 3) | (nation['N_COMMENT'] != 'r') & (nation['N_REGIONKEY'] >= 3)].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(supplier[(supplier['S_PHONE'] != '32-') | (supplier['S_SUPPKEY'] <= 134) | (supplier['S_PHONE'].str.startswith('26-'))][['S_NATIONKEY', 'S_ACCTBAL', 'S_NAME', 'S_PHONE', 'S_ADDRESS']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='O_ORDERKEY', right_on='R_REGIONKEY').merge(partsupp.merge(part[['P_PARTKEY', 'PT_COMMENT', 'SIZE', 'RETAILPRICE']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY'])

part[(part['CONTAINER'] != 'MED')][['P_PARTKEY', 'PT_COMMENT', 'RETAILPRICE']].merge(partsupp[(partsupp['PS_PARTKEY'] > 43) & (partsupp['AVAILQTY'] == 957) & (partsupp['P_COMMENT'].str.startswith('f'))][['SUPPLYCOST']].merge(supplier[['S_NATIONKEY', 'S_COMMENT']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='S_SUPPKEY').merge(supplier[['S_SUPPKEY']].merge(partsupp[(partsupp['SUPPLYCOST'] < 114.7267942899314) | (partsupp['P_COMMENT'].str.startswith('l')) & (partsupp['SUPPLYCOST'] < 230.05918356067878)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['SUPPLYCOST'] == 687.2561933459866)].merge(lineitem[(lineitem['DISCOUNT'] == 0.09490233268667607)][['SHIPINSTRUCT', 'TAX', 'DISCOUNT', 'SHIPMODE', 'SHIPDATE']].merge(partsupp[['PS_PARTKEY', 'AVAILQTY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['AVAILQTY']].merge(nation[['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']].merge(supplier[(supplier['S_SUPPKEY'] < 65) & (supplier['S_PHONE'] == '32-')][['S_SUPPKEY', 'S_NATIONKEY', 'S_ADDRESS', 'S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY').merge(supplier[(supplier['S_ACCTBAL'] >= 1786.7558496067334) | (supplier['S_COMMENT'].str.startswith('i')) & (supplier['S_SUPPKEY'] <= 106)][['S_PHONE', 'S_ACCTBAL', 'S_COMMENT', 'S_SUPPKEY', 'S_NAME']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['RETAILPRICE', 'P_PARTKEY']).agg('max', numeric_only=True)

region.groupby(by=['R_NAME']).agg('count')

nation[(nation['N_NAME'] != 'U')][['N_COMMENT', 'N_NAME', 'N_REGIONKEY', 'N_NATIONKEY']].merge(region[(region['R_REGIONKEY'] < 0) | (region['R_NAME'] == 'AME')][['R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_COMMENT'] == 'o') & (nation['N_NATIONKEY'] <= 19) | (nation['N_NATIONKEY'] < 15) & (nation['N_REGIONKEY'] > 1)], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(supplier[(supplier['S_COMMENT'].str.startswith('g')) & (supplier['S_NAME'] != 'S') & (supplier['S_ACCTBAL'] <= 5880.238444967893)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY')

lineitem[['LINESTATUS', 'DISCOUNT', 'EXTENDEDPRICE', 'TAX', 'RECEIPTDATE']].merge(partsupp[(partsupp['AVAILQTY'] > 8679) | (partsupp['P_COMMENT'] != 'n') | (partsupp['PS_SUPPKEY'] <= 6842)][['PS_PARTKEY', 'AVAILQTY']].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[(part['RETAILPRICE'] == 1092.2478849371264)][['RETAILPRICE', 'P_NAME', 'BRAND', 'TYPE', 'SIZE']].merge(nation[(nation['N_REGIONKEY'] > 0) | (nation['N_NATIONKEY'] != 7)], left_on='P_PARTKEY', right_on='N_NATIONKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(nation[(nation['N_REGIONKEY'] <= 1) & (nation['N_REGIONKEY'] >= 0) | (nation['N_REGIONKEY'] >= 1)][['N_COMMENT', 'N_NAME']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY').groupby(by=['TAX', 'RECEIPTDATE']).agg('count')

customer[(customer['C_NAME'] != 'C') & (customer['C_NATIONKEY'] == 13) & (customer['MKTSEGMENT'] != 'HOUSEHOLD')].merge(nation.merge(customer[(customer['C_NAME'].str.startswith('C')) | (customer['C_PHONE'].str.startswith('13-'))].merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[['S_NATIONKEY', 'S_NAME', 'S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

lineitem[(lineitem['TAX'] >= 0.009899642149292153)][['RETURNFLAG', 'L_ORDERKEY', 'L_COMMENT', 'RECEIPTDATE', 'TAX']].merge(orders[['O_CUSTKEY', 'O_COMMENT', 'O_ORDERKEY', 'ORDERDATE', 'CLERK']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['ORDERSTATUS'] == 'F') & (orders['ORDERDATE'] >= '1992-01-13')], left_on='L_ORDERKEY', right_on='O_ORDERKEY')

lineitem

supplier.merge(partsupp[(partsupp['SUPPLYCOST'] >= 27.913266702367324) & (partsupp['P_COMMENT'] == ',') & (partsupp['PS_PARTKEY'] < 49) & (partsupp['AVAILQTY'] >= 7044)][['P_COMMENT', 'AVAILQTY', 'PS_PARTKEY', 'PS_SUPPKEY']].merge(lineitem[(lineitem['LINESTATUS'].isin(['F'])) | (lineitem['COMMITDATE'] < '1998-10-16') & (lineitem['RETURNFLAG'].isin(['A', 'N'])) | (lineitem['L_SUPPKEY'] != 502)][['L_ORDERKEY', 'L_SUPPKEY', 'L_PARTKEY', 'LINENUMBER']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_COMMENT', 'S_SUPPKEY']).agg('count')

customer[(customer['C_ACCTBAL'] <= 4898.480930694041) & (customer['C_NATIONKEY'] <= 0) & (customer['C_ADDRESS'].str.startswith('M')) | (customer['C_COMMENT'] == 'r')][['C_NATIONKEY', 'C_ADDRESS', 'C_PHONE', 'C_COMMENT', 'MKTSEGMENT']].merge(nation[(nation['N_REGIONKEY'] >= 0) | (nation['N_NATIONKEY'] > 5)][['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_REGIONKEY', 'N_COMMENT']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_NATIONKEY']).agg('min', numeric_only=True)

nation

supplier[['S_ADDRESS', 'S_SUPPKEY']]

nation[(nation['N_REGIONKEY'] == 0) | (nation['N_NAME'] == 'C')].merge(region[(region['R_REGIONKEY'] != 0) | (region['R_REGIONKEY'] != 0) & (region['R_NAME'].str.startswith('E'))][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']].merge(region[['R_NAME', 'R_REGIONKEY', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] != 'V') & (nation['N_REGIONKEY'] == 3) & (nation['N_COMMENT'].str.startswith('p'))][['N_COMMENT', 'N_NATIONKEY', 'N_NAME', 'N_REGIONKEY']].merge(region[(region['R_REGIONKEY'] != 3) | (region['R_COMMENT'] == 'g') | (region['R_NAME'] == 'ASI') | (region['R_COMMENT'] != 'h')][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[(customer['C_NATIONKEY'] == 21) | (customer['C_PHONE'] == '3') & (customer['C_NATIONKEY'] <= 7) & (customer['C_ADDRESS'] != 'm')].merge(nation[['N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY', 'N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_NAME'].str.startswith('AFR')) | (region['R_COMMENT'].str.startswith('g'))][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_NATIONKEY'] == 1) & (nation['N_COMMENT'] != 'n') | (nation['N_COMMENT'] != 'v')][['N_REGIONKEY', 'N_NAME', 'N_NATIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] == 'h') & (nation['N_COMMENT'] != 'u') | (nation['N_REGIONKEY'] != 1)][['N_REGIONKEY', 'N_NATIONKEY']].merge(supplier[['S_SUPPKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY')

nation[(nation['N_REGIONKEY'] != 2)][['N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY']].merge(region[['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].merge(nation[(nation['N_NATIONKEY'] != 18)].merge(region[(region['R_NAME'] == 'E')][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_COMMENT'] == 'l') & (region['R_NAME'] == 'M') | (region['R_REGIONKEY'] == 2) | (region['R_COMMENT'] == 'g')].merge(nation[['N_REGIONKEY', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[['MKTSEGMENT', 'C_CUSTKEY', 'C_ADDRESS', 'C_PHONE', 'C_NAME']], left_on='N_NATIONKEY', right_on='C_NATIONKEY')

nation[(nation['N_COMMENT'] != 'a') & (nation['N_NATIONKEY'] == 8) & (nation['N_NATIONKEY'] <= 15) | (nation['N_REGIONKEY'] != 1)].groupby(by=['N_NATIONKEY']).agg('min', numeric_only=True)

lineitem.merge(partsupp.merge(lineitem[(lineitem['L_COMMENT'] != 'r')].merge(orders[['O_ORDERKEY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY')

partsupp[['SUPPLYCOST', 'PS_PARTKEY', 'PS_SUPPKEY']].merge(lineitem[(lineitem['LINESTATUS'] == 'F')], left_on='PS_SUPPKEY', right_on='L_SUPPKEY')

region[(region['R_NAME'] != 'AME')].merge(nation[(nation['N_NAME'] == 'K') | (nation['N_NATIONKEY'] >= 20) & (nation['N_COMMENT'] != 'a')].merge(customer[(customer['C_NATIONKEY'] >= 8) & (customer['C_ACCTBAL'] != 5220.4913485175075)][['C_NAME']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME', 'R_REGIONKEY']).agg('count')

customer.merge(nation[(nation['N_NAME'] == 'G') & (nation['N_NATIONKEY'] >= 0) & (nation['N_COMMENT'] == ' ')][['N_COMMENT', 'N_NATIONKEY', 'N_NAME', 'N_REGIONKEY']].merge(supplier[['S_NAME', 'S_ACCTBAL', 'S_PHONE', 'S_ADDRESS']].merge(customer[['C_ACCTBAL']], left_on='S_SUPPKEY', right_on='C_CUSTKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[(customer['MKTSEGMENT'] == 'MACHINERY') | (customer['C_NAME'].str.startswith('C'))].merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_COMMENT', 'N_NAME']].merge(region, left_on='N_NATIONKEY', right_on='R_REGIONKEY').merge(supplier[['S_NATIONKEY', 'S_ADDRESS', 'S_NAME']], left_on='N_NATIONKEY', right_on='S_SUPPKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

region[(region['R_REGIONKEY'] < 1) & (region['R_REGIONKEY'] >= 2)].merge(nation[(nation['N_NATIONKEY'] <= 9) | (nation['N_NATIONKEY'] != 8) | (nation['N_COMMENT'] == 'u') | (nation['N_NATIONKEY'] != 9)][['N_NAME', 'N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY']].merge(supplier[['S_ADDRESS', 'S_COMMENT', 'S_SUPPKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[(supplier['S_NAME'] == 'S') | (supplier['S_NATIONKEY'] > 16)][['S_NAME', 'S_ADDRESS', 'S_ACCTBAL', 'S_NATIONKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] <= 3) | (nation['N_REGIONKEY'] >= 0) | (nation['N_NAME'].str.startswith('S')) & (nation['N_REGIONKEY'] == 1)], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT']).agg('max', numeric_only=True)

partsupp[(partsupp['SUPPLYCOST'] == 205.75666279377705) | (partsupp['PS_PARTKEY'] >= 30) | (partsupp['SUPPLYCOST'] >= 567.0303500026737) & (partsupp['PS_SUPPKEY'] != 6739)][['PS_PARTKEY', 'P_COMMENT', 'SUPPLYCOST', 'AVAILQTY']].merge(lineitem[(lineitem['L_PARTKEY'] != 179467) & (lineitem['EXTENDEDPRICE'] == 54920.81965945724) | (lineitem['LINESTATUS'].isin(['O', 'F'])) | (lineitem['L_PARTKEY'] > 137173)].merge(partsupp[(partsupp['P_COMMENT'] != 'a') & (partsupp['PS_PARTKEY'] < 20) | (partsupp['PS_SUPPKEY'] > 6428)][['PS_SUPPKEY', 'PS_PARTKEY', 'SUPPLYCOST']].merge(lineitem[(lineitem['DISCOUNT'] < 0.021414968801980218) & (lineitem['RETURNFLAG'] == 'R') | (lineitem['L_SUPPKEY'] <= 4277) | (lineitem['SHIPDATE'] == '1992-04-27')][['L_COMMENT', 'EXTENDEDPRICE', 'SHIPINSTRUCT']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] <= 638)][['PS_SUPPKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[(part['PT_COMMENT'] != 'g') & (part['MFGR'].isin(['Manufacturer#1', 'Manufacturer#4', 'Manufacturer#5', 'Manufacturer#3'])) & (part['TYPE'] == 'E') & (part['P_PARTKEY'] < 45)].merge(partsupp[(partsupp['SUPPLYCOST'] != 109.21531751532864) | (partsupp['SUPPLYCOST'] == 489.1426361469781) | (partsupp['SUPPLYCOST'] != 966.235334219583)], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['P_COMMENT', 'AVAILQTY']).agg('min', numeric_only=True)

customer[['C_ACCTBAL', 'C_PHONE', 'C_COMMENT']].merge(part[(part['BRAND'] != 'Brand#44') & (part['SIZE'] > 37)].merge(partsupp.merge(part[(part['BRAND'] != 'Brand#52') | (part['TYPE'] != 'L') | (part['P_PARTKEY'] <= 9) & (part['TYPE'] != 'STA')], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] >= 4481) | (partsupp['SUPPLYCOST'] > 283.1927516290713) | (partsupp['SUPPLYCOST'] != 640.6068878226624) & (partsupp['SUPPLYCOST'] != 188.4558812133131)][['PS_PARTKEY']].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='C_CUSTKEY', right_on='P_PARTKEY').groupby(by=['C_PHONE']).agg('mean', numeric_only=True)

lineitem.merge(partsupp[(partsupp['P_COMMENT'] != '.') | (partsupp['PS_SUPPKEY'] == 6661) & (partsupp['PS_PARTKEY'] < 34)][['SUPPLYCOST']].merge(part.merge(partsupp[['AVAILQTY', 'PS_SUPPKEY', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='P_PARTKEY').merge(lineitem[(lineitem['L_ORDERKEY'] <= 176) | (lineitem['L_ORDERKEY'] < 13)], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(orders[(orders['SHIPPRIORITY'] > 0)][['TOTALPRICE', 'O_ORDERKEY', 'CLERK', 'SHIPPRIORITY']].merge(lineitem[['SHIPDATE', 'SHIPMODE', 'EXTENDEDPRICE', 'RECEIPTDATE', 'LINENUMBER']].merge(orders[['O_ORDERKEY', 'ORDERSTATUS', 'SHIPPRIORITY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['COMMITDATE'] >= '1992-05-15') | (lineitem['L_ORDERKEY'] != 65) | (lineitem['L_ORDERKEY'] > 157) | (lineitem['EXTENDEDPRICE'] < 53810.09046469559)][['LINESTATUS', 'SHIPDATE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['P_COMMENT'] != 't')][['PS_SUPPKEY', 'P_COMMENT']], left_on='L_PARTKEY', right_on='PS_PARTKEY')

region[(region['R_COMMENT'] == 'l') | (region['R_COMMENT'] != 'g') & (region['R_REGIONKEY'] > 1) & (region['R_REGIONKEY'] >= 2)].merge(nation[(nation['N_NATIONKEY'] > 4) | (nation['N_REGIONKEY'] < 0) & (nation['N_NAME'].str.startswith('A')) & (nation['N_NAME'] == 'R')].merge(customer[(customer['C_CUSTKEY'] != 65) & (customer['MKTSEGMENT'].isin(['MACHINERY', 'FURNITURE'])) | (customer['C_NATIONKEY'] <= 12) & (customer['C_COMMENT'] == 'k')][['C_ADDRESS', 'C_NAME', 'C_ACCTBAL', 'C_COMMENT']].merge(part, left_on='C_CUSTKEY', right_on='P_PARTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] < 19) & (nation['N_COMMENT'] == 'r')][['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT', 'N_NAME']].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[(customer['C_ADDRESS'] == 'R') | (customer['C_PHONE'].str.startswith('27-'))].merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] > 2)].merge(region[['R_REGIONKEY', 'R_COMMENT', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('mean', numeric_only=True)

orders

partsupp[['SUPPLYCOST', 'PS_PARTKEY', 'PS_SUPPKEY', 'AVAILQTY']].merge(part.merge(partsupp[(partsupp['SUPPLYCOST'] != 242.60521067952126) & (partsupp['PS_PARTKEY'] == 42)][['P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[(part['PT_COMMENT'] == 'r') & (part['MFGR'] == 'Manufacturer#2') & (part['BRAND'].isin(['Brand#43', 'Brand#33', 'Brand#23', 'Brand#54', 'Brand#32', 'Brand#25', 'Brand#22', 'Brand#45']))][['P_NAME', 'TYPE', 'PT_COMMENT', 'MFGR']].merge(orders[(orders['TOTALPRICE'] == 168969.4100993655)][['CLERK']], left_on='P_PARTKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['SUPPLYCOST'] < 31.038354941221833) | (partsupp['SUPPLYCOST'] == 277.6310725471193) | (partsupp['SUPPLYCOST'] == 601.9801600772321)], left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['QUANTITY'] > 36) & (lineitem['COMMITDATE'] <= '1998-10-16')][['L_COMMENT', 'RECEIPTDATE']].merge(customer.merge(orders[(orders['ORDERDATE'] == '1998-07-21') & (orders['ORDERPRIORITY'] != '1-URGENT') & (orders['CLERK'] != 'C')], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY').merge(customer, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').groupby(by=['AVAILQTY']).agg('max', numeric_only=True)

customer[['C_CUSTKEY', 'C_NATIONKEY']].merge(orders[(orders['TOTALPRICE'] != 71912.86104006776) | (orders['O_ORDERKEY'] <= 680)].merge(customer[['C_COMMENT', 'MKTSEGMENT', 'C_CUSTKEY', 'C_ADDRESS']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_NAME'] != 'G')][['N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NATIONKEY'] < 15)][['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME', 'N_COMMENT']].merge(region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region.merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_NATIONKEY', 'C_CUSTKEY']).agg('min', numeric_only=True)

orders[(orders['O_CUSTKEY'] >= 119284)][['ORDERSTATUS', 'ORDERDATE', 'CLERK', 'O_ORDERKEY']].merge(lineitem[(lineitem['COMMITDATE'] == '1998-10-16') | (lineitem['SHIPINSTRUCT'] == 'NONE') | (lineitem['COMMITDATE'] == '1992-05-15') | (lineitem['SHIPMODE'] != 'RAIL')].merge(partsupp[(partsupp['PS_PARTKEY'] >= 32) | (partsupp['P_COMMENT'] != 'f') & (partsupp['PS_SUPPKEY'] == 6775)].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[['LINENUMBER', 'SHIPMODE']].merge(customer, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY').merge(region.merge(nation[(nation['N_NATIONKEY'] == 22)][['N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['ORDERSTATUS', 'CLERK']).agg('max', numeric_only=True)

nation.merge(customer[(customer['C_NAME'].str.startswith('C')) & (customer['C_ACCTBAL'] == 1713.9127094253395) | (customer['C_CUSTKEY'] >= 10)].merge(orders[(orders['ORDERSTATUS'] != 'P') | (orders['SHIPPRIORITY'] > 0) | (orders['O_CUSTKEY'] <= 9886) & (orders['ORDERDATE'] <= '1998-07-21')].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_NATIONKEY'] != 21) | (nation['N_COMMENT'] != 'h')][['N_NAME', 'N_COMMENT']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[['R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY')

partsupp.merge(part[(part['PT_COMMENT'].str.startswith('u'))], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[(part['BRAND'] != 'Brand#35') | (part['SIZE'] != 21) & (part['PT_COMMENT'].str.startswith('i')) | (part['CONTAINER'] != 'WRAP')][['PT_COMMENT', 'CONTAINER', 'MFGR', 'TYPE']], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem.merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY')

partsupp[['PS_SUPPKEY']]

orders[['SHIPPRIORITY', 'TOTALPRICE', 'O_COMMENT']].merge(supplier[(supplier['S_SUPPKEY'] >= 91) & (supplier['S_SUPPKEY'] >= 126) & (supplier['S_ACCTBAL'] < 3191.2619129464183) & (supplier['S_SUPPKEY'] != 127)].merge(partsupp[['PS_PARTKEY', 'P_COMMENT', 'AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='S_SUPPKEY')

partsupp[['SUPPLYCOST', 'P_COMMENT', 'PS_SUPPKEY']].merge(supplier[(supplier['S_ADDRESS'].str.startswith('o')) | (supplier['S_ADDRESS'] != 'r') | (supplier['S_COMMENT'] != 's')][['S_SUPPKEY', 'S_ACCTBAL']].merge(partsupp[['SUPPLYCOST', 'P_COMMENT', 'PS_SUPPKEY', 'AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_PARTKEY'] < 25)][['AVAILQTY', 'PS_PARTKEY', 'P_COMMENT', 'PS_SUPPKEY', 'SUPPLYCOST']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[(supplier['S_PHONE'].str.startswith('1')) | (supplier['S_SUPPKEY'] >= 52)][['S_ADDRESS', 'S_SUPPKEY', 'S_COMMENT']].merge(partsupp[(partsupp['SUPPLYCOST'] == 842.0410117214718) | (partsupp['PS_SUPPKEY'] > 1451) | (partsupp['SUPPLYCOST'] >= 99.4290020075535)][['PS_PARTKEY', 'PS_SUPPKEY', 'P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_PARTKEY'] > 27)][['PS_PARTKEY', 'PS_SUPPKEY', 'AVAILQTY', 'P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[(supplier['S_ACCTBAL'] > 968.1767555500794) | (supplier['S_COMMENT'].str.startswith('the')) & (supplier['S_PHONE'] != '3') | (supplier['S_NAME'] == 'S')], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['SUPPLYCOST', 'P_COMMENT']).agg('max', numeric_only=True)

lineitem

nation.merge(region.merge(nation.merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_COMMENT'] == 'l') | (region['R_REGIONKEY'] <= 0)][['R_COMMENT', 'R_REGIONKEY', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_NAME']).agg('max', numeric_only=True)

customer.merge(orders[(orders['ORDERDATE'] < '1992-01-13')].merge(customer[['C_NAME']].merge(supplier[(supplier['S_SUPPKEY'] < 65) & (supplier['S_COMMENT'].str.startswith(' sl'))][['S_PHONE', 'S_COMMENT']], left_on='C_CUSTKEY', right_on='S_SUPPKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[['EXTENDEDPRICE', 'SHIPDATE', 'QUANTITY']].merge(nation[['N_REGIONKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['O_ORDERKEY', 'ORDERSTATUS', 'ORDERPRIORITY', 'TOTALPRICE', 'CLERK']].merge(lineitem[(lineitem['RETURNFLAG'].isin(['N', 'R', 'A'])) | (lineitem['SHIPMODE'] != 'FOB') | (lineitem['RECEIPTDATE'] != '1998-11-06') & (lineitem['L_COMMENT'].str.startswith('c'))][['TAX', 'L_ORDERKEY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_NAME'] == 'V')][['N_NAME', 'N_COMMENT']].merge(lineitem[['LINENUMBER', 'TAX', 'L_COMMENT', 'SHIPINSTRUCT', 'SHIPDATE']].merge(orders[(orders['ORDERPRIORITY'].isin(['3-MEDIUM', '1-URGENT', '5-LOW'])) & (orders['CLERK'] == 'C') & (orders['ORDERPRIORITY'] == '1-URGENT')][['ORDERSTATUS', 'O_CUSTKEY', 'TOTALPRICE', 'O_ORDERKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='N_NATIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_COMMENT']).agg('mean', numeric_only=True)

customer[(customer['C_ADDRESS'] != 'D') | (customer['C_ADDRESS'] != 'i') | (customer['C_ADDRESS'].str.startswith('q')) | (customer['C_COMMENT'] == 'd')][['C_PHONE', 'MKTSEGMENT', 'C_ACCTBAL', 'C_NATIONKEY', 'C_COMMENT']]

part[(part['TYPE'].str.startswith('P'))][['TYPE', 'RETAILPRICE', 'P_NAME', 'MFGR']].merge(region.merge(nation[['N_NAME', 'N_COMMENT', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='P_PARTKEY', right_on='R_REGIONKEY').merge(partsupp[(partsupp['PS_PARTKEY'] >= 45) & (partsupp['PS_PARTKEY'] == 35)][['PS_SUPPKEY', 'PS_PARTKEY', 'SUPPLYCOST', 'P_COMMENT']].merge(lineitem[['RETURNFLAG', 'LINENUMBER', 'DISCOUNT']].merge(orders[(orders['O_COMMENT'] != ' re') | (orders['CLERK'] != 'C') | (orders['O_COMMENT'] != ' re') & (orders['ORDERDATE'] < '1998-07-21')][['O_ORDERKEY', 'O_CUSTKEY', 'ORDERPRIORITY', 'TOTALPRICE', 'O_COMMENT']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(region.merge(nation[(nation['N_NAME'].str.startswith('E')) & (nation['N_REGIONKEY'] > 2)].merge(customer[['C_PHONE', 'C_NAME']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='P_PARTKEY', right_on='R_REGIONKEY').groupby(by=['TYPE']).agg('mean', numeric_only=True)

lineitem.merge(partsupp[['PS_SUPPKEY', 'AVAILQTY', 'SUPPLYCOST']].merge(supplier[(supplier['S_PHONE'].str.startswith('32-')) & (supplier['S_NAME'].str.startswith('S'))][['S_NAME', 'S_COMMENT']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'] != ',') & (partsupp['SUPPLYCOST'] >= 109.3621568208139)].merge(lineitem.merge(orders[['ORDERDATE']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['SHIPDATE']).agg('min', numeric_only=True)

orders[(orders['CLERK'] != 'C')].merge(customer.merge(orders[(orders['ORDERPRIORITY'] != '3-MEDIUM') & (orders['O_COMMENT'] == ' re')].merge(lineitem[['LINENUMBER']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[(lineitem['RETURNFLAG'].isin(['R', 'A', 'N'])) & (lineitem['L_COMMENT'] != 'l')][['RETURNFLAG', 'LINENUMBER', 'EXTENDEDPRICE', 'L_COMMENT']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY')

supplier[['S_ACCTBAL', 'S_NATIONKEY', 'S_COMMENT', 'S_PHONE']].merge(nation.merge(customer[(customer['C_NAME'] != 'C') & (customer['C_NAME'] == 'C') | (customer['C_NAME'].str.startswith('C')) | (customer['C_PHONE'].str.startswith('1'))][['C_PHONE', 'C_NATIONKEY', 'C_NAME']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY')

partsupp[['PS_SUPPKEY', 'PS_PARTKEY']]

nation[['N_REGIONKEY', 'N_COMMENT', 'N_NAME', 'N_NATIONKEY']].merge(supplier[(supplier['S_SUPPKEY'] < 4) & (supplier['S_ACCTBAL'] == 9472.772849801122)].merge(partsupp[(partsupp['PS_SUPPKEY'] <= 2687) | (partsupp['PS_PARTKEY'] != 3)][['P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['PS_PARTKEY', 'SUPPLYCOST']].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_NATIONKEY']).agg('max', numeric_only=True)

supplier.merge(partsupp[(partsupp['PS_PARTKEY'] <= 12)].merge(part[(part['MFGR'] != 'Manufacturer#5') & (part['MFGR'] != 'Manufacturer#2') & (part['BRAND'] != 'Brand#15')][['SIZE', 'PT_COMMENT', 'CONTAINER', 'P_NAME', 'RETAILPRICE']], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_PHONE', 'S_ADDRESS']).agg('min', numeric_only=True)

part[(part['PT_COMMENT'] == 'n') & (part['RETAILPRICE'] == 960.061965779961) | (part['CONTAINER'] == 'WRAP') | (part['PT_COMMENT'] != 'a')][['P_PARTKEY']]

lineitem[(lineitem['L_PARTKEY'] <= 144165)]

part[['P_PARTKEY']].merge(partsupp[(partsupp['PS_PARTKEY'] > 28) & (partsupp['P_COMMENT'] == 'l')][['PS_PARTKEY', 'PS_SUPPKEY', 'SUPPLYCOST']].merge(lineitem.merge(partsupp[(partsupp['P_COMMENT'].str.startswith('y'))][['SUPPLYCOST', 'PS_SUPPKEY', 'PS_PARTKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['P_PARTKEY']).agg('sum', numeric_only=True)

supplier[(supplier['S_NAME'] != 'S') & (supplier['S_SUPPKEY'] == 173)].merge(nation[(nation['N_NATIONKEY'] != 13) & (nation['N_NATIONKEY'] <= 14) & (nation['N_NATIONKEY'] == 17)].merge(region[(region['R_COMMENT'] == 'g')].merge(nation[(nation['N_NAME'].str.startswith('P')) | (nation['N_NATIONKEY'] == 7) | (nation['N_NATIONKEY'] > 18)][['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[['C_ACCTBAL', 'MKTSEGMENT', 'C_ADDRESS', 'C_CUSTKEY']].merge(orders[['O_COMMENT', 'SHIPPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['AVAILQTY'] == 4814) & (partsupp['P_COMMENT'] != 'y') & (partsupp['AVAILQTY'] >= 1714) & (partsupp['AVAILQTY'] != 4270)][['PS_PARTKEY', 'PS_SUPPKEY', 'P_COMMENT', 'AVAILQTY']].merge(lineitem[['EXTENDEDPRICE', 'SHIPDATE', 'DISCOUNT', 'QUANTITY']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(part.merge(partsupp[(partsupp['AVAILQTY'] > 8409) & (partsupp['P_COMMENT'].str.startswith(','))][['PS_SUPPKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

region[['R_NAME', 'R_REGIONKEY', 'R_COMMENT']]

nation[(nation['N_REGIONKEY'] != 3) & (nation['N_REGIONKEY'] > 3) | (nation['N_NATIONKEY'] < 18) & (nation['N_REGIONKEY'] != 3)][['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY']].merge(region[['R_NAME', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer.merge(nation[(nation['N_NAME'] == 'S') | (nation['N_NATIONKEY'] == 15) & (nation['N_NAME'] == 'M') | (nation['N_REGIONKEY'] >= 3)][['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME', 'N_COMMENT']].merge(customer[['C_CUSTKEY', 'C_ACCTBAL', 'C_ADDRESS', 'C_PHONE']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_SUPPKEY'] != 93) | (supplier['S_ADDRESS'].str.startswith('M')) & (supplier['S_NAME'].str.startswith('S'))].merge(partsupp[['AVAILQTY', 'PS_PARTKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_COMMENT'] == 'n') | (nation['N_COMMENT'] == 's') | (nation['N_COMMENT'] != 'i') & (nation['N_NAME'] == 'M')], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_NATIONKEY', 'N_NAME']).agg('mean', numeric_only=True)

orders[(orders['SHIPPRIORITY'] > 0)][['CLERK', 'SHIPPRIORITY', 'ORDERPRIORITY']].merge(customer[(customer['C_COMMENT'] == 'f') & (customer['C_CUSTKEY'] > 26) | (customer['C_PHONE'].str.startswith('2')) & (customer['MKTSEGMENT'].isin(['FURNITURE', 'BUILDING']))].merge(nation[(nation['N_NATIONKEY'] < 7) | (nation['N_REGIONKEY'] == 0)].merge(region[(region['R_NAME'].str.startswith('A')) | (region['R_COMMENT'].str.startswith('h')) | (region['R_NAME'].str.startswith('M'))], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='C_CUSTKEY').groupby(by=['CLERK']).agg('min', numeric_only=True)

nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']]

lineitem[['DISCOUNT', 'SHIPDATE']].merge(part[(part['TYPE'].str.startswith('P')) | (part['PT_COMMENT'].str.startswith('p'))].merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY')

customer[['C_CUSTKEY', 'C_NAME']].merge(orders[(orders['SHIPPRIORITY'] <= 0) & (orders['ORDERSTATUS'].isin(['F'])) & (orders['ORDERDATE'] < '1998-07-21') & (orders['SHIPPRIORITY'] <= 0)][['O_ORDERKEY', 'O_CUSTKEY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_CUSTKEY']).agg('sum', numeric_only=True)

partsupp[(partsupp['AVAILQTY'] > 9643) | (partsupp['AVAILQTY'] > 4976) | (partsupp['PS_SUPPKEY'] != 4153) & (partsupp['P_COMMENT'].str.startswith('bli'))].merge(supplier.merge(partsupp.merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['PS_PARTKEY', 'P_COMMENT', 'PS_SUPPKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY')

lineitem[(lineitem['L_SUPPKEY'] <= 678) & (lineitem['SHIPINSTRUCT'].isin(['DELIVER IN PERSON', 'COLLECT COD', 'TAKE BACK RETURN']))][['QUANTITY', 'L_PARTKEY']].merge(partsupp[(partsupp['PS_SUPPKEY'] > 4108) & (partsupp['PS_PARTKEY'] == 24) | (partsupp['SUPPLYCOST'] > 511.4500839163572) & (partsupp['SUPPLYCOST'] <= 699.2084108953663)].merge(supplier[['S_ADDRESS', 'S_PHONE', 'S_NAME']].merge(orders[['ORDERSTATUS']], left_on='S_SUPPKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem.merge(partsupp[(partsupp['PS_SUPPKEY'] > 2063)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(lineitem[(lineitem['COMMITDATE'] > '1998-10-16') | (lineitem['L_SUPPKEY'] > 342) | (lineitem['COMMITDATE'] <= '1992-05-15')].merge(orders[(orders['ORDERPRIORITY'] != '3-MEDIUM') | (orders['TOTALPRICE'] < 341708.98127413116) | (orders['ORDERDATE'] == '1998-07-21') & (orders['SHIPPRIORITY'] > 0)], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY')

nation[['N_REGIONKEY', 'N_NAME']].merge(region[(region['R_COMMENT'] != 'g') & (region['R_COMMENT'] == 'g') & (region['R_COMMENT'] == 'h')].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(region[(region['R_REGIONKEY'] == 2) | (region['R_REGIONKEY'] == 2)], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region.merge(nation[(nation['N_REGIONKEY'] != 0) & (nation['N_COMMENT'] != 's')], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] != 22) | (nation['N_NATIONKEY'] != 21)], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_COMMENT'] != 'g') & (region['R_COMMENT'] == 'g') & (region['R_COMMENT'].str.startswith('u')) & (region['R_NAME'] != 'A')], left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_NAME', 'N_REGIONKEY']).agg('max', numeric_only=True)

region.merge(nation[(nation['N_NAME'] == 'P')][['N_COMMENT']].merge(orders[(orders['CLERK'] == 'C') | (orders['ORDERSTATUS'] != 'F') | (orders['ORDERPRIORITY'] != '5-LOW') & (orders['SHIPPRIORITY'] <= 0)], left_on='N_NATIONKEY', right_on='O_ORDERKEY').merge(region[(region['R_REGIONKEY'] > 3)][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']], left_on='N_NATIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

part[(part['MFGR'].isin(['Manufacturer#1', 'Manufacturer#5'])) & (part['SIZE'] >= 4) & (part['SIZE'] >= 12) | (part['BRAND'] != 'Brand#22')][['SIZE', 'TYPE', 'PT_COMMENT', 'P_PARTKEY']]

partsupp.merge(lineitem[(lineitem['QUANTITY'] < 7) | (lineitem['RECEIPTDATE'] > '1998-11-06') | (lineitem['RETURNFLAG'] != 'A')][['LINESTATUS']].merge(customer[(customer['C_ADDRESS'] == '9') & (customer['C_PHONE'] == '3')].merge(nation[(nation['N_COMMENT'] == 'y') & (nation['N_NAME'].str.startswith('P')) & (nation['N_COMMENT'].str.startswith('a')) | (nation['N_NAME'] != 'F')], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['SHIPMODE'].isin(['MAIL', 'REG AIR', 'FOB', 'AIR', 'SHIP', 'RAIL'])) | (lineitem['L_PARTKEY'] <= 35542)][['SHIPDATE', 'L_COMMENT', 'SHIPINSTRUCT', 'SHIPMODE', 'LINENUMBER']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY')

lineitem[(lineitem['RETURNFLAG'] != 'R')][['L_SUPPKEY', 'SHIPDATE', 'TAX']].merge(partsupp[(partsupp['PS_PARTKEY'] >= 2)][['PS_SUPPKEY']].merge(lineitem[(lineitem['EXTENDEDPRICE'] >= 52754.73081017147)], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier[(supplier['S_ADDRESS'] == '4') | (supplier['S_COMMENT'].str.startswith('l')) | (supplier['S_ACCTBAL'] <= 5462.466993654259) & (supplier['S_NATIONKEY'] != 18)][['S_NATIONKEY', 'S_ADDRESS', 'S_SUPPKEY', 'S_COMMENT']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['L_SUPPKEY']).agg('count')

orders[['ORDERSTATUS', 'CLERK', 'O_COMMENT']].merge(nation[(nation['N_NAME'] != 'U') & (nation['N_REGIONKEY'] != 0) | (nation['N_REGIONKEY'] > 0) | (nation['N_NATIONKEY'] > 22)][['N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY']], left_on='O_ORDERKEY', right_on='N_NATIONKEY')

part[['SIZE', 'P_NAME']].merge(customer[(customer['C_ACCTBAL'] <= 6676.703276016325) | (customer['C_NATIONKEY'] != 21) & (customer['C_ACCTBAL'] == -375.9108352554442)], left_on='P_PARTKEY', right_on='C_CUSTKEY').merge(nation[(nation['N_NAME'] != 'M') & (nation['N_COMMENT'].str.startswith('o')) & (nation['N_REGIONKEY'] != 1) | (nation['N_NATIONKEY'] == 1)].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='P_PARTKEY', right_on='N_NATIONKEY').groupby(by=['SIZE', 'P_NAME']).agg('sum', numeric_only=True)

lineitem.merge(orders.merge(customer[(customer['C_NAME'] != 'C') & (customer['MKTSEGMENT'] == 'MACHINERY') | (customer['C_NATIONKEY'] <= 19)].merge(nation[(nation['N_NATIONKEY'] <= 3) | (nation['N_NAME'] != 'R') | (nation['N_COMMENT'] == 'e') | (nation['N_NATIONKEY'] < 7)][['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[['P_COMMENT', 'AVAILQTY', 'SUPPLYCOST', 'PS_SUPPKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY')

orders[(orders['ORDERPRIORITY'] == '3-MEDIUM') | (orders['O_ORDERKEY'] >= 262)].merge(lineitem[(lineitem['QUANTITY'] > 32) & (lineitem['LINENUMBER'] > 1) & (lineitem['LINENUMBER'] == 2) | (lineitem['EXTENDEDPRICE'] < 62728.94483160702)].merge(partsupp[['SUPPLYCOST']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['ORDERPRIORITY', 'O_CUSTKEY']).agg('max', numeric_only=True)

part[(part['SIZE'] < 44) | (part['MFGR'] != 'Manufacturer#4') & (part['SIZE'] > 45)][['CONTAINER', 'RETAILPRICE']].merge(supplier[(supplier['S_COMMENT'] == 'g') & (supplier['S_COMMENT'].str.startswith('w')) & (supplier['S_NATIONKEY'] >= 17)][['S_ADDRESS']].merge(orders[(orders['ORDERPRIORITY'] != '1-URGENT') & (orders['ORDERPRIORITY'] == '4-NOT SPECIFIED') | (orders['CLERK'] != 'C')], left_on='S_SUPPKEY', right_on='O_ORDERKEY').merge(customer[(customer['C_PHONE'].str.startswith('1')) & (customer['C_ADDRESS'] != 'g') | (customer['C_NATIONKEY'] != 5)], left_on='S_SUPPKEY', right_on='C_CUSTKEY'), left_on='P_PARTKEY', right_on='S_SUPPKEY').merge(nation[(nation['N_NAME'] == 'A') & (nation['N_NAME'].str.startswith('S')) | (nation['N_NAME'] == 'P') | (nation['N_NAME'] != 'C')].merge(customer[(customer['C_PHONE'] != '2') & (customer['C_PHONE'] != '22-') & (customer['C_PHONE'] == '25-')][['C_COMMENT']].merge(partsupp[(partsupp['PS_SUPPKEY'] < 5573)][['PS_PARTKEY', 'AVAILQTY', 'P_COMMENT', 'SUPPLYCOST', 'PS_SUPPKEY']], left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='P_PARTKEY', right_on='N_NATIONKEY')

supplier.merge(nation[(nation['N_NAME'] == 'S')][['N_COMMENT', 'N_NAME', 'N_NATIONKEY']].merge(customer[(customer['C_ACCTBAL'] > 3451.1638431814117) & (customer['C_CUSTKEY'] <= 16) & (customer['C_ADDRESS'].str.startswith('g')) & (customer['C_ADDRESS'] != 'o')][['C_CUSTKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[['AVAILQTY', 'SUPPLYCOST', 'PS_SUPPKEY']].merge(supplier[(supplier['S_SUPPKEY'] < 115)][['S_PHONE', 'S_NAME']].merge(customer[['C_ACCTBAL']], left_on='S_SUPPKEY', right_on='C_CUSTKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[['S_NAME', 'S_COMMENT', 'S_PHONE', 'S_SUPPKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['AVAILQTY'] > 6533) & (partsupp['AVAILQTY'] <= 2764) & (partsupp['P_COMMENT'] == 'k')][['P_COMMENT']].merge(customer, left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='C_CUSTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_ADDRESS', 'S_ACCTBAL']).agg('sum', numeric_only=True)

partsupp[(partsupp['PS_PARTKEY'] != 6) & (partsupp['PS_PARTKEY'] <= 29)].merge(lineitem[(lineitem['TAX'] >= 0.05366456907676907) & (lineitem['L_PARTKEY'] >= 140912) | (lineitem['L_ORDERKEY'] < 73) & (lineitem['DISCOUNT'] == 0.08166328105797355)].merge(orders[['O_COMMENT', 'O_CUSTKEY', 'CLERK']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['O_ORDERKEY'] <= 557) & (orders['ORDERDATE'] < '1992-01-13') | (orders['ORDERDATE'] > '1992-01-13') | (orders['O_ORDERKEY'] < 262)].merge(customer[['C_COMMENT']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[(lineitem['RETURNFLAG'].isin(['A'])) | (lineitem['RECEIPTDATE'] == '1992-05-02') | (lineitem['LINENUMBER'] <= 5) | (lineitem['COMMITDATE'] <= '1998-10-16')].merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(orders[(orders['CLERK'] != 'C')][['O_ORDERKEY', 'ORDERSTATUS']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY')

partsupp.merge(supplier[['S_ADDRESS', 'S_ACCTBAL', 'S_NATIONKEY', 'S_PHONE']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[(lineitem['SHIPMODE'].isin(['MAIL', 'RAIL', 'REG AIR', 'AIR'])) & (lineitem['LINESTATUS'].isin(['O', 'F'])) | (lineitem['L_ORDERKEY'] == 193)].merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').groupby(by=['P_COMMENT']).agg('max', numeric_only=True)

customer[['C_PHONE']].merge(partsupp[['PS_SUPPKEY', 'SUPPLYCOST']], left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(region[(region['R_COMMENT'] == 'u') | (region['R_REGIONKEY'] > 3)][['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].merge(nation.merge(customer[(customer['C_ACCTBAL'] != 8585.16302370426) | (customer['C_NAME'] == 'C')][['C_ACCTBAL', 'C_NATIONKEY', 'C_COMMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] == 'P')][['N_NATIONKEY']].merge(supplier[['S_COMMENT', 'S_SUPPKEY', 'S_NATIONKEY', 'S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='C_CUSTKEY', right_on='R_REGIONKEY').merge(partsupp[(partsupp['PS_PARTKEY'] == 19) | (partsupp['AVAILQTY'] != 941)][['P_COMMENT', 'PS_SUPPKEY', 'SUPPLYCOST', 'PS_PARTKEY', 'AVAILQTY']].merge(lineitem[['SHIPINSTRUCT']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY'])

supplier[(supplier['S_NATIONKEY'] == 19) | (supplier['S_COMMENT'] == '.') | (supplier['S_ACCTBAL'] == 7286.960465889734) & (supplier['S_ADDRESS'] != 'K')].merge(nation[(nation['N_NAME'] != 'U') | (nation['N_NAME'] != 'E') | (nation['N_NAME'] == 'V') | (nation['N_NATIONKEY'] <= 3)].merge(customer[['C_CUSTKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_COMMENT', 'N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NAME'] == 'K') & (nation['N_NATIONKEY'] > 14) | (nation['N_REGIONKEY'] != 2)].merge(customer[(customer['MKTSEGMENT'] != 'MACHINERY') | (customer['C_CUSTKEY'] > 79) | (customer['C_ACCTBAL'] >= 9418.049632802518) | (customer['C_NAME'] == 'C')].merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region.merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_NAME']).agg('max', numeric_only=True)

supplier

partsupp[(partsupp['AVAILQTY'] <= 733)][['P_COMMENT', 'SUPPLYCOST', 'AVAILQTY', 'PS_SUPPKEY']].merge(supplier[(supplier['S_COMMENT'] != 'bli') & (supplier['S_ADDRESS'] != 'N')].merge(nation[(nation['N_NAME'].str.startswith('B')) | (nation['N_NAME'] != 'B') | (nation['N_NAME'].str.startswith('A'))][['N_NATIONKEY', 'N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[(lineitem['COMMITDATE'] >= '1992-05-15') & (lineitem['LINESTATUS'] == 'O') & (lineitem['L_SUPPKEY'] >= 7450) | (lineitem['SHIPINSTRUCT'].isin(['DELIVER IN PERSON', 'COLLECT COD', 'NONE']))].merge(orders[(orders['ORDERPRIORITY'] == '3-MEDIUM')], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['SUPPLYCOST'] > 799.3250328997024) | (partsupp['PS_SUPPKEY'] == 4362) | (partsupp['PS_SUPPKEY'] > 6506) & (partsupp['PS_PARTKEY'] != 42)][['PS_SUPPKEY', 'SUPPLYCOST', 'P_COMMENT', 'PS_PARTKEY', 'AVAILQTY']].merge(supplier[(supplier['S_COMMENT'].str.startswith('e'))][['S_SUPPKEY', 'S_NATIONKEY', 'S_NAME']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier[['S_PHONE', 'S_SUPPKEY', 'S_COMMENT']].merge(partsupp[(partsupp['SUPPLYCOST'] >= 211.95441390243326) & (partsupp['SUPPLYCOST'] >= 261.8456754497997) | (partsupp['P_COMMENT'].str.startswith('bli'))][['AVAILQTY']].merge(part[(part['SIZE'] == 8) | (part['RETAILPRICE'] == 991.3377171008099) | (part['MFGR'] != 'Manufacturer#4') | (part['P_PARTKEY'] <= 134)][['PT_COMMENT', 'P_NAME', 'P_PARTKEY', 'BRAND']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY')

supplier[(supplier['S_ADDRESS'] != '9') | (supplier['S_COMMENT'] != 'b')][['S_ACCTBAL']].merge(lineitem.merge(partsupp[(partsupp['PS_PARTKEY'] == 9) | (partsupp['AVAILQTY'] != 2300)][['PS_PARTKEY', 'P_COMMENT']].merge(lineitem[(lineitem['QUANTITY'] != 19) | (lineitem['TAX'] == 0.02779322842085029) & (lineitem['DISCOUNT'] > 0.04273158924738063) | (lineitem['RETURNFLAG'].isin(['R']))], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(region[(region['R_NAME'] != 'AFR')].merge(nation[(nation['N_COMMENT'] != 'l') & (nation['N_COMMENT'].str.startswith('y')) & (nation['N_NAME'].str.startswith('F')) & (nation['N_NATIONKEY'] <= 22)].merge(customer[(customer['C_PHONE'] != '1')], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'].str.startswith('F'))][['N_COMMENT', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='S_SUPPKEY', right_on='R_REGIONKEY').groupby(by=['S_ACCTBAL']).agg('mean', numeric_only=True)

region[(region['R_COMMENT'] != 'g') & (region['R_REGIONKEY'] == 1)][['R_COMMENT', 'R_REGIONKEY']].merge(nation[(nation['N_NAME'].str.startswith('R')) | (nation['N_REGIONKEY'] < 0) | (nation['N_COMMENT'].str.startswith('r')) & (nation['N_NAME'].str.startswith('M'))][['N_REGIONKEY', 'N_COMMENT', 'N_NAME', 'N_NATIONKEY']].merge(region[['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(customer[(customer['MKTSEGMENT'] != 'MACHINERY')], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_NATIONKEY'] != 11) | (supplier['S_ADDRESS'].str.startswith(',')) & (supplier['S_SUPPKEY'] > 31) & (supplier['S_ACCTBAL'] > 4008.7885453292547)][['S_SUPPKEY']].merge(partsupp[(partsupp['PS_SUPPKEY'] == 2798)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('max', numeric_only=True)

orders[(orders['ORDERDATE'] != '1998-07-21') & (orders['ORDERSTATUS'] != 'F') & (orders['O_ORDERKEY'] < 787)][['O_CUSTKEY']].merge(customer[(customer['C_PHONE'] != '2') & (customer['C_CUSTKEY'] > 13) | (customer['C_CUSTKEY'] >= 91) & (customer['C_CUSTKEY'] < 69)][['C_ADDRESS', 'C_PHONE']].merge(nation[(nation['N_REGIONKEY'] < 3) & (nation['N_REGIONKEY'] >= 0) & (nation['N_NATIONKEY'] > 16) & (nation['N_REGIONKEY'] < 3)][['N_REGIONKEY', 'N_NATIONKEY']], left_on='C_CUSTKEY', right_on='N_NATIONKEY').merge(lineitem.merge(partsupp[(partsupp['PS_PARTKEY'] >= 25) | (partsupp['AVAILQTY'] <= 8880)][['PS_SUPPKEY', 'AVAILQTY']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['MKTSEGMENT'].isin(['BUILDING', 'HOUSEHOLD', 'FURNITURE'])) | (customer['C_CUSTKEY'] == 62) | (customer['C_PHONE'] == '18-')], left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_CUSTKEY'] >= 28)].merge(orders.merge(lineitem[(lineitem['QUANTITY'] >= 7)][['TAX']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[['N_NATIONKEY', 'N_COMMENT', 'N_NAME', 'N_REGIONKEY']].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

customer[(customer['MKTSEGMENT'] == 'MACHINERY') | (customer['C_NATIONKEY'] == 2)]

region.groupby(by=['R_COMMENT']).agg('mean', numeric_only=True)

customer[(customer['C_ACCTBAL'] > -799.5610237430802) | (customer['C_ADDRESS'] == 'B') | (customer['C_ADDRESS'].str.startswith('o')) & (customer['C_ACCTBAL'] <= 2357.108199317952)].merge(nation.merge(region[(region['R_COMMENT'].str.startswith('h')) & (region['R_NAME'] != 'ASI')], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[['S_SUPPKEY', 'S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

partsupp[['AVAILQTY']].merge(orders.merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='O_ORDERKEY').merge(nation[['N_NAME', 'N_NATIONKEY']].merge(customer.merge(nation[(nation['N_NATIONKEY'] >= 4) & (nation['N_COMMENT'] == 'h') & (nation['N_NATIONKEY'] == 15)][['N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY').merge(nation[['N_REGIONKEY', 'N_COMMENT']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY')

part[['TYPE', 'P_PARTKEY']].merge(partsupp[(partsupp['P_COMMENT'] == ',')], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] == 281) & (partsupp['P_COMMENT'].str.startswith('a')) | (partsupp['AVAILQTY'] == 1242) & (partsupp['PS_PARTKEY'] == 5)].merge(lineitem[(lineitem['TAX'] <= 0.037090563786432405)][['SHIPINSTRUCT', 'SHIPMODE']].merge(region, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(lineitem[(lineitem['SHIPMODE'] == 'AIR')][['COMMITDATE']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['L_COMMENT'] == 'ly ') & (lineitem['COMMITDATE'] <= '1992-05-15') & (lineitem['LINESTATUS'] == 'O') & (lineitem['SHIPINSTRUCT'] != 'TAKE BACK RETURN')], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

supplier[(supplier['S_ACCTBAL'] <= 7539.204795642768)][['S_COMMENT', 'S_SUPPKEY']].merge(partsupp[['SUPPLYCOST', 'AVAILQTY', 'P_COMMENT']].merge(region[(region['R_REGIONKEY'] > 2)][['R_NAME', 'R_REGIONKEY']].merge(nation[['N_COMMENT', 'N_NATIONKEY', 'N_NAME', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='R_REGIONKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['P_COMMENT', 'SUPPLYCOST']].merge(orders[(orders['ORDERSTATUS'].isin(['F']))], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='O_ORDERKEY').merge(orders[(orders['ORDERDATE'] == '1998-07-21') | (orders['CLERK'].str.startswith('C')) | (orders['TOTALPRICE'] >= 348159.96817756415) | (orders['O_COMMENT'] != 'o')][['ORDERPRIORITY']].merge(region[['R_NAME', 'R_REGIONKEY']], left_on='O_ORDERKEY', right_on='R_REGIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='O_ORDERKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['SUPPLYCOST'] != 268.66811224057045) & (partsupp['PS_PARTKEY'] > 37) & (partsupp['PS_PARTKEY'] >= 46)][['SUPPLYCOST', 'PS_PARTKEY', 'PS_SUPPKEY', 'AVAILQTY', 'P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_COMMENT']).agg('max', numeric_only=True)

partsupp[(partsupp['PS_SUPPKEY'] == 6510) & (partsupp['SUPPLYCOST'] <= 500.3900129756794) | (partsupp['AVAILQTY'] <= 8761) | (partsupp['SUPPLYCOST'] != 364.85711440839685)].groupby(by=['PS_PARTKEY', 'SUPPLYCOST']).agg('max', numeric_only=True)

nation[['N_NATIONKEY', 'N_COMMENT']].merge(customer[(customer['C_ADDRESS'].str.startswith('h')) & (customer['C_ADDRESS'] == 'T') | (customer['C_ACCTBAL'] <= 3477.928816364927) | (customer['C_ACCTBAL'] != 6288.7519555474555)].merge(orders[(orders['ORDERDATE'] < '1992-01-13') & (orders['TOTALPRICE'] == 284458.7816353903) | (orders['O_ORDERKEY'] >= 48) | (orders['ORDERSTATUS'].isin(['F', 'P']))].merge(customer[['C_COMMENT', 'C_NAME', 'C_ACCTBAL', 'C_PHONE']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_COMMENT']).agg('min', numeric_only=True)

region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation.merge(region[['R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] == 'e') & (nation['N_NAME'] != 'U') & (nation['N_NATIONKEY'] > 16) & (nation['N_COMMENT'] == 'y')].merge(supplier[(supplier['S_COMMENT'].str.startswith('v')) & (supplier['S_ADDRESS'] != 'N') & (supplier['S_COMMENT'] != '.')][['S_SUPPKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT']).agg('mean', numeric_only=True)

orders[(orders['O_CUSTKEY'] >= 93038)][['TOTALPRICE']].merge(part.merge(partsupp[(partsupp['SUPPLYCOST'] >= 276.1414221405107)][['PS_SUPPKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(supplier[(supplier['S_SUPPKEY'] != 110) & (supplier['S_ACCTBAL'] != 4840.242944710821) & (supplier['S_NAME'].str.startswith('S')) & (supplier['S_SUPPKEY'] == 183)][['S_COMMENT', 'S_SUPPKEY', 'S_PHONE', 'S_ADDRESS']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='P_PARTKEY')

lineitem[['L_SUPPKEY', 'L_COMMENT', 'QUANTITY']].merge(partsupp[['PS_PARTKEY']].merge(part.merge(partsupp[(partsupp['PS_SUPPKEY'] != 2220) | (partsupp['AVAILQTY'] == 3818) & (partsupp['P_COMMENT'].str.startswith('e'))], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[(part['RETAILPRICE'] == 1075.2594422708985) | (part['CONTAINER'] != 'MED') | (part['P_NAME'].str.startswith('g')) | (part['P_PARTKEY'] < 7)], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_PARTKEY'] >= 23) | (partsupp['PS_SUPPKEY'] < 520) & (partsupp['SUPPLYCOST'] > 200.37962310315808)][['SUPPLYCOST', 'PS_SUPPKEY', 'AVAILQTY', 'PS_PARTKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['AVAILQTY', 'P_COMMENT']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY')

customer[(customer['MKTSEGMENT'] != 'BUILDING') & (customer['C_ADDRESS'].str.startswith('D')) & (customer['MKTSEGMENT'] != 'FURNITURE') & (customer['C_ADDRESS'].str.startswith('U'))].merge(nation[(nation['N_NATIONKEY'] > 23)][['N_REGIONKEY', 'N_NAME', 'N_NATIONKEY']].merge(supplier[['S_ADDRESS', 'S_NAME', 'S_COMMENT', 'S_ACCTBAL', 'S_PHONE']].merge(partsupp[(partsupp['PS_PARTKEY'] != 17) | (partsupp['P_COMMENT'].str.startswith('the')) | (partsupp['PS_SUPPKEY'] != 6159) | (partsupp['AVAILQTY'] != 8803)][['AVAILQTY']], left_on='S_SUPPKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_NATIONKEY', 'C_ACCTBAL']).agg('min', numeric_only=True)

supplier[(supplier['S_ADDRESS'] != 'U')][['S_SUPPKEY', 'S_COMMENT', 'S_ADDRESS', 'S_NAME']].merge(partsupp[(partsupp['SUPPLYCOST'] < 184.80661413802943) | (partsupp['PS_PARTKEY'] > 39)][['P_COMMENT', 'PS_PARTKEY']].merge(part[(part['SIZE'] > 14) & (part['P_PARTKEY'] < 13)][['CONTAINER', 'P_NAME', 'P_PARTKEY', 'BRAND', 'RETAILPRICE']].merge(partsupp[(partsupp['P_COMMENT'] == ' ')][['AVAILQTY', 'SUPPLYCOST', 'PS_PARTKEY', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

customer.groupby(by=['C_NAME']).agg('max', numeric_only=True)

partsupp.groupby(by=['P_COMMENT', 'PS_PARTKEY']).agg('sum', numeric_only=True)

lineitem[(lineitem['L_ORDERKEY'] != 139) | (lineitem['COMMITDATE'] > '1992-05-15')].merge(partsupp[(partsupp['PS_PARTKEY'] == 19) | (partsupp['P_COMMENT'] == 'y')], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_SUPPKEY']].merge(supplier[['S_COMMENT', 'S_SUPPKEY', 'S_NATIONKEY', 'S_ADDRESS', 'S_PHONE']].merge(partsupp[['PS_PARTKEY', 'PS_SUPPKEY', 'AVAILQTY', 'SUPPLYCOST', 'P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['SHIPINSTRUCT']).agg('min', numeric_only=True)

lineitem[(lineitem['L_ORDERKEY'] > 17)].merge(orders[(orders['CLERK'] == 'C') | (orders['SHIPPRIORITY'] <= 0) | (orders['TOTALPRICE'] != 82369.33271484239)][['ORDERDATE', 'O_CUSTKEY', 'TOTALPRICE', 'O_COMMENT']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp.merge(lineitem.merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(orders[(orders['O_CUSTKEY'] != 9547) & (orders['O_ORDERKEY'] < 695) | (orders['CLERK'] == 'C') & (orders['CLERK'] != 'C')][['ORDERDATE', 'ORDERSTATUS', 'TOTALPRICE']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').groupby(by=['L_COMMENT', 'EXTENDEDPRICE']).agg('sum', numeric_only=True)

part[['BRAND', 'P_PARTKEY', 'CONTAINER', 'MFGR']].merge(partsupp.merge(part[(part['MFGR'] == 'Manufacturer#5') & (part['TYPE'] == 'M') & (part['PT_COMMENT'].str.startswith('ss ')) | (part['SIZE'] > 23)][['TYPE', 'PT_COMMENT', 'RETAILPRICE']].merge(supplier[['S_NAME']], left_on='P_PARTKEY', right_on='S_SUPPKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['SHIPMODE'].isin(['MAIL', 'FOB', 'TRUCK'])) & (lineitem['DISCOUNT'] >= 0.09096037295922994)][['COMMITDATE', 'EXTENDEDPRICE', 'L_SUPPKEY', 'SHIPDATE', 'SHIPMODE']].merge(partsupp[(partsupp['PS_PARTKEY'] < 37) & (partsupp['P_COMMENT'].str.startswith('h'))], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'] != ' ') & (partsupp['AVAILQTY'] != 6995) | (partsupp['AVAILQTY'] > 1828)][['SUPPLYCOST']].merge(supplier[(supplier['S_PHONE'].str.startswith('28-'))][['S_ADDRESS']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='S_SUPPKEY').merge(customer[(customer['C_COMMENT'] != 'k') | (customer['C_PHONE'] == '13-') | (customer['MKTSEGMENT'].isin(['BUILDING', 'HOUSEHOLD'])) & (customer['C_NAME'].str.startswith('C'))], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='C_CUSTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(supplier[['S_COMMENT']].merge(customer[(customer['C_COMMENT'] == 'n') & (customer['C_CUSTKEY'] >= 15) & (customer['C_ACCTBAL'] != 6258.774997998794) | (customer['C_CUSTKEY'] != 25)][['C_NAME', 'C_NATIONKEY', 'C_COMMENT', 'MKTSEGMENT', 'C_ACCTBAL']], left_on='S_SUPPKEY', right_on='C_CUSTKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

lineitem[(lineitem['EXTENDEDPRICE'] == 66827.29938220905)][['SHIPMODE', 'LINESTATUS']]

orders[(orders['TOTALPRICE'] <= 269524.2272184462) | (orders['CLERK'].str.startswith('C'))][['TOTALPRICE', 'ORDERDATE', 'O_COMMENT', 'CLERK']].merge(region[(region['R_NAME'].str.startswith('A')) | (region['R_REGIONKEY'] <= 0) | (region['R_NAME'].str.startswith('E'))][['R_NAME', 'R_COMMENT']].merge(lineitem[(lineitem['DISCOUNT'] < 0.038420977822765545) & (lineitem['DISCOUNT'] <= 0.008744458947932122) & (lineitem['EXTENDEDPRICE'] < 17343.796809467738)][['SHIPINSTRUCT', 'L_COMMENT', 'RETURNFLAG', 'EXTENDEDPRICE']].merge(part[['BRAND', 'PT_COMMENT', 'P_PARTKEY', 'CONTAINER', 'P_NAME']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='R_REGIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='O_ORDERKEY', right_on='R_REGIONKEY').merge(part[(part['PT_COMMENT'] == 'c') | (part['P_NAME'] != 'g') | (part['RETAILPRICE'] <= 1082.454406483447)].merge(partsupp[(partsupp['AVAILQTY'] < 2044) | (partsupp['AVAILQTY'] < 3321) & (partsupp['AVAILQTY'] != 8295) & (partsupp['SUPPLYCOST'] <= 259.12329707454927)][['PS_PARTKEY', 'PS_SUPPKEY', 'AVAILQTY']].merge(lineitem[['TAX', 'L_SUPPKEY', 'LINENUMBER', 'RECEIPTDATE']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'] != ',')][['AVAILQTY', 'PS_SUPPKEY', 'SUPPLYCOST', 'P_COMMENT', 'PS_PARTKEY']].merge(lineitem[(lineitem['L_ORDERKEY'] != 159)], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='P_PARTKEY')

lineitem[(lineitem['TAX'] <= 0.007240474627533162) & (lineitem['SHIPINSTRUCT'] == 'DELIVER IN PERSON')]

nation[(nation['N_REGIONKEY'] <= 2) & (nation['N_NATIONKEY'] == 19)][['N_REGIONKEY']].merge(region[(region['R_COMMENT'] != 'u') & (region['R_REGIONKEY'] <= 2) | (region['R_NAME'] != 'AFR')][['R_COMMENT']].merge(part[(part['CONTAINER'] != 'WRAP') | (part['PT_COMMENT'] != 'q')].merge(partsupp[(partsupp['PS_SUPPKEY'] > 1780) & (partsupp['P_COMMENT'].str.startswith('the'))][['SUPPLYCOST', 'P_COMMENT', 'PS_SUPPKEY', 'PS_PARTKEY', 'AVAILQTY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='R_REGIONKEY', right_on='P_PARTKEY').merge(customer[(customer['C_NAME'] != 'C')][['C_ACCTBAL', 'C_COMMENT', 'C_NATIONKEY']], left_on='R_REGIONKEY', right_on='C_CUSTKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY')

partsupp

region.merge(nation[['N_NAME']].merge(supplier, left_on='N_NATIONKEY', right_on='S_SUPPKEY').merge(lineitem[(lineitem['COMMITDATE'] < '1998-10-16') | (lineitem['TAX'] >= 0.05929158038155064) & (lineitem['EXTENDEDPRICE'] >= 81842.13884769566) | (lineitem['RECEIPTDATE'] > '1998-11-06')][['LINESTATUS', 'RETURNFLAG', 'DISCOUNT', 'L_PARTKEY', 'LINENUMBER']], left_on='N_NATIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] == 3) & (nation['N_NAME'] == 'A') | (nation['N_NAME'].str.startswith('F'))].merge(region[(region['R_REGIONKEY'] > 0) & (region['R_REGIONKEY'] <= 2) & (region['R_NAME'].str.startswith('A')) | (region['R_NAME'] != 'ASI')][['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[(customer['C_NAME'] == 'C') | (customer['C_NAME'] == 'C') | (customer['C_NAME'] != 'C') | (customer['C_ADDRESS'] == 'P')].merge(orders[(orders['SHIPPRIORITY'] <= 0) | (orders['SHIPPRIORITY'] == 0) & (orders['O_CUSTKEY'] != 76714)][['ORDERPRIORITY', 'ORDERSTATUS']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY')

region.merge(nation[(nation['N_REGIONKEY'] <= 0)], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT', 'N_NAME']].merge(region[['R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME', 'R_COMMENT']).agg('count')

supplier[(supplier['S_ADDRESS'] != 'e') & (supplier['S_NATIONKEY'] > 7) & (supplier['S_SUPPKEY'] <= 95) | (supplier['S_PHONE'] == '26-')][['S_NAME']]

part[['MFGR', 'BRAND']].merge(nation[(nation['N_NAME'] == 'A')].merge(region[(region['R_COMMENT'] != 'g')], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[(customer['MKTSEGMENT'].isin(['HOUSEHOLD', 'AUTOMOBILE', 'MACHINERY', 'FURNITURE', 'BUILDING']))][['MKTSEGMENT', 'C_CUSTKEY', 'C_ADDRESS']].merge(orders[(orders['O_COMMENT'] != 'b') | (orders['O_COMMENT'] != 'i')][['O_ORDERKEY', 'TOTALPRICE']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='P_PARTKEY', right_on='N_NATIONKEY').groupby(by=['MFGR', 'BRAND']).agg('mean', numeric_only=True)

region.groupby(by=['R_REGIONKEY', 'R_NAME']).agg('mean', numeric_only=True)

partsupp[['P_COMMENT', 'PS_SUPPKEY', 'AVAILQTY', 'PS_PARTKEY', 'SUPPLYCOST']].merge(supplier[['S_COMMENT', 'S_PHONE', 'S_ADDRESS']].merge(customer[['C_ADDRESS']], left_on='S_SUPPKEY', right_on='C_CUSTKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['AVAILQTY']).agg('sum', numeric_only=True)

part[(part['CONTAINER'] != 'MED') | (part['SIZE'] > 34)][['PT_COMMENT', 'TYPE', 'CONTAINER', 'P_PARTKEY', 'BRAND']]

supplier[['S_PHONE']].merge(customer[['C_ACCTBAL', 'C_NAME', 'C_CUSTKEY']].merge(orders[(orders['O_COMMENT'] != 't') | (orders['ORDERDATE'] == '1998-07-21') & (orders['CLERK'] != 'C') | (orders['O_CUSTKEY'] <= 105644)].merge(customer[(customer['C_ADDRESS'].str.startswith('F')) | (customer['C_ADDRESS'] == 'w') & (customer['C_COMMENT'] != 'r') & (customer['C_COMMENT'] == 'k')][['MKTSEGMENT', 'C_NATIONKEY']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders.merge(lineitem[(lineitem['DISCOUNT'] > 0.019581870791940605) & (lineitem['DISCOUNT'] < 0.028922196365579547) & (lineitem['COMMITDATE'] == '1992-05-15') | (lineitem['COMMITDATE'] > '1998-10-16')][['SHIPDATE', 'LINESTATUS', 'TAX']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='S_SUPPKEY', right_on='C_CUSTKEY')

partsupp[['PS_SUPPKEY', 'P_COMMENT', 'SUPPLYCOST', 'PS_PARTKEY']].merge(supplier.merge(partsupp[(partsupp['SUPPLYCOST'] > 518.8640673183133) | (partsupp['PS_SUPPKEY'] > 6778) | (partsupp['SUPPLYCOST'] <= 272.46460581265904) | (partsupp['PS_SUPPKEY'] == 5240)].merge(lineitem[['L_PARTKEY', 'EXTENDEDPRICE', 'RETURNFLAG']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['SUPPLYCOST'] > 652.8530151496176)].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY')

customer.merge(orders[['O_COMMENT', 'CLERK', 'TOTALPRICE', 'ORDERPRIORITY', 'ORDERSTATUS']].merge(customer[(customer['C_NAME'] == 'C') & (customer['MKTSEGMENT'] != 'HOUSEHOLD')][['MKTSEGMENT', 'C_CUSTKEY', 'C_NAME', 'C_ADDRESS']], left_on='O_ORDERKEY', right_on='C_CUSTKEY').merge(supplier[(supplier['S_COMMENT'].str.startswith('o')) | (supplier['S_ACCTBAL'] != 4362.542206826766)], left_on='O_ORDERKEY', right_on='S_SUPPKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_COMMENT'] != 'a') | (nation['N_NAME'].str.startswith('B')) & (nation['N_REGIONKEY'] <= 3)][['N_REGIONKEY', 'N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY')

lineitem[['RECEIPTDATE', 'EXTENDEDPRICE', 'LINENUMBER']]

lineitem.merge(partsupp[['AVAILQTY', 'P_COMMENT', 'PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_SUPPKEY', 'P_COMMENT', 'SUPPLYCOST']].merge(lineitem[['EXTENDEDPRICE', 'TAX', 'SHIPDATE', 'QUANTITY', 'L_ORDERKEY']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(orders[(orders['O_ORDERKEY'] <= 403) & (orders['SHIPPRIORITY'] < 0)][['O_CUSTKEY', 'O_COMMENT', 'ORDERPRIORITY', 'SHIPPRIORITY', 'CLERK']].merge(customer[['C_PHONE', 'C_ACCTBAL']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY')

orders[(orders['ORDERSTATUS'] == 'F')][['TOTALPRICE', 'O_CUSTKEY', 'ORDERPRIORITY']].groupby(by=['ORDERPRIORITY', 'O_CUSTKEY']).agg('mean', numeric_only=True)

orders.merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['ORDERSTATUS']).agg('min', numeric_only=True)

part.merge(partsupp[(partsupp['SUPPLYCOST'] <= 33.9671502245226)].merge(supplier[(supplier['S_NATIONKEY'] == 21) & (supplier['S_COMMENT'] != ' sl') & (supplier['S_COMMENT'] == ' ') | (supplier['S_COMMENT'] == 'n')][['S_ACCTBAL', 'S_PHONE', 'S_ADDRESS', 'S_NATIONKEY', 'S_COMMENT']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] < 422) & (partsupp['SUPPLYCOST'] == 467.9245155930064) | (partsupp['PS_PARTKEY'] > 26)][['AVAILQTY', 'PS_PARTKEY']].merge(lineitem[(lineitem['TAX'] > 0.07195682699669502) | (lineitem['SHIPMODE'].isin(['TRUCK', 'AIR', 'FOB', 'REG AIR'])) & (lineitem['SHIPINSTRUCT'].isin(['TAKE BACK RETURN', 'DELIVER IN PERSON', 'NONE']))], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(supplier[['S_NATIONKEY', 'S_ACCTBAL', 'S_PHONE', 'S_SUPPKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

orders.merge(customer[['C_ACCTBAL', 'C_NATIONKEY']], left_on='O_CUSTKEY', right_on='C_CUSTKEY')

part

partsupp[(partsupp['P_COMMENT'] == 'r')][['PS_PARTKEY']].merge(part.merge(partsupp[(partsupp['AVAILQTY'] > 6024) & (partsupp['PS_PARTKEY'] != 21)][['P_COMMENT']].merge(orders[(orders['O_CUSTKEY'] > 44170)], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='O_ORDERKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['LINENUMBER'] != 5) & (lineitem['L_ORDERKEY'] >= 171) & (lineitem['SHIPINSTRUCT'] == 'COLLECT COD') & (lineitem['RECEIPTDATE'] >= '1992-05-02')][['QUANTITY', 'L_COMMENT']].merge(supplier[(supplier['S_NATIONKEY'] < 12)][['S_NAME', 'S_ADDRESS']].merge(nation, left_on='S_SUPPKEY', right_on='N_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY')

lineitem[(lineitem['L_SUPPKEY'] < 2701) & (lineitem['QUANTITY'] > 19) | (lineitem['L_SUPPKEY'] <= 9785)][['L_COMMENT']].merge(customer[(customer['MKTSEGMENT'].isin(['BUILDING', 'FURNITURE', 'HOUSEHOLD', 'AUTOMOBILE', 'MACHINERY']))], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY')

partsupp.merge(lineitem[(lineitem['EXTENDEDPRICE'] > 15653.120555360518)][['L_SUPPKEY']].merge(partsupp[(partsupp['PS_SUPPKEY'] < 4242) | (partsupp['AVAILQTY'] != 7677) | (partsupp['PS_SUPPKEY'] <= 228) | (partsupp['PS_SUPPKEY'] > 3493)][['PS_PARTKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['PS_SUPPKEY', 'AVAILQTY', 'P_COMMENT', 'PS_PARTKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').groupby(by=['AVAILQTY', 'P_COMMENT']).agg('min', numeric_only=True)

region.merge(nation[['N_REGIONKEY', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'].str.startswith('y')) & (nation['N_REGIONKEY'] <= 2) | (nation['N_NAME'] != 'J') & (nation['N_REGIONKEY'] < 2)].merge(customer[(customer['C_ACCTBAL'] <= 8104.675659785142) & (customer['C_ACCTBAL'] <= 4448.73251434816) | (customer['C_CUSTKEY'] == 10) & (customer['C_CUSTKEY'] == 17)], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

nation[(nation['N_REGIONKEY'] < 2)].merge(region[(region['R_REGIONKEY'] >= 1) | (region['R_REGIONKEY'] != 2) & (region['R_REGIONKEY'] >= 3) | (region['R_COMMENT'].str.startswith('u'))][['R_NAME', 'R_COMMENT', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer.merge(orders[(orders['SHIPPRIORITY'] < 0) & (orders['CLERK'] == 'C') | (orders['O_ORDERKEY'] <= 798)][['ORDERDATE', 'O_ORDERKEY', 'CLERK']].merge(lineitem[(lineitem['TAX'] != 0.0706285127289123) | (lineitem['DISCOUNT'] < 0.0214641531141513) | (lineitem['SHIPDATE'] == '1998-10-30')][['DISCOUNT', 'LINENUMBER', 'SHIPDATE', 'COMMITDATE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_REGIONKEY', 'N_NATIONKEY']).agg('max', numeric_only=True)

customer.merge(nation.merge(region[(region['R_COMMENT'] == 'h') | (region['R_REGIONKEY'] <= 3)][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[(supplier['S_NAME'] == 'S') | (supplier['S_ACCTBAL'] > 9800.407469645044) | (supplier['S_COMMENT'] != 's')], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_NATIONKEY', 'N_NAME', 'N_COMMENT', 'N_REGIONKEY']].merge(region[(region['R_REGIONKEY'] < 1) & (region['R_COMMENT'].str.startswith('l')) | (region['R_COMMENT'].str.startswith('h'))][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_COMMENT'] == 'e') & (nation['N_REGIONKEY'] != 3) & (nation['N_REGIONKEY'] <= 0)][['N_REGIONKEY', 'N_NAME', 'N_NATIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY')

partsupp[(partsupp['AVAILQTY'] > 6734) | (partsupp['AVAILQTY'] > 8808) & (partsupp['AVAILQTY'] > 7632) & (partsupp['P_COMMENT'] == ' th')]

customer.groupby(by=['C_PHONE', 'C_NAME']).agg('max', numeric_only=True)

nation[(nation['N_COMMENT'].str.startswith('h')) | (nation['N_COMMENT'] != 'y')][['N_REGIONKEY']].merge(region[['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].merge(nation[(nation['N_COMMENT'] == 't')][['N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_REGIONKEY']).agg('mean', numeric_only=True)

part[['TYPE', 'PT_COMMENT', 'P_PARTKEY', 'P_NAME']].merge(partsupp.merge(lineitem[['RETURNFLAG', 'SHIPINSTRUCT', 'LINENUMBER', 'L_PARTKEY']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['COMMITDATE'] >= '1992-05-15') | (lineitem['RETURNFLAG'] == 'N') | (lineitem['SHIPINSTRUCT'] != 'COLLECT COD') | (lineitem['L_COMMENT'] != 'q')][['LINENUMBER', 'L_COMMENT', 'COMMITDATE']].merge(nation[(nation['N_NAME'].str.startswith('C')) & (nation['N_COMMENT'] == 'c') | (nation['N_COMMENT'].str.startswith('a'))][['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

region[(region['R_COMMENT'].str.startswith('h'))].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] != 'p') & (nation['N_NATIONKEY'] <= 19) & (nation['N_REGIONKEY'] <= 3) & (nation['N_NAME'] != 'U')].merge(supplier[['S_ACCTBAL']], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[(customer['C_ACCTBAL'] >= -359.19888506849566) | (customer['C_NAME'].str.startswith('C')) & (customer['MKTSEGMENT'] != 'MACHINERY')].merge(nation[['N_COMMENT', 'N_NAME', 'N_NATIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

customer.merge(orders[['ORDERDATE']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_COMMENT'].str.startswith('y')) & (nation['N_NAME'].str.startswith('V')) & (nation['N_REGIONKEY'] >= 2)][['N_REGIONKEY', 'N_NAME']].merge(region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

region[(region['R_REGIONKEY'] == 3) & (region['R_NAME'] == 'A') & (region['R_REGIONKEY'] >= 3) | (region['R_REGIONKEY'] >= 1)].groupby(by=['R_COMMENT']).agg('max', numeric_only=True)

partsupp[(partsupp['PS_PARTKEY'] >= 28) | (partsupp['SUPPLYCOST'] == 770.2768245336346)][['PS_SUPPKEY']].merge(lineitem.merge(partsupp[(partsupp['AVAILQTY'] != 7728)][['PS_PARTKEY', 'SUPPLYCOST']].merge(part[['BRAND', 'CONTAINER', 'MFGR']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').groupby(by=['PS_SUPPKEY']).agg('mean', numeric_only=True)

part.groupby(by=['SIZE', 'BRAND']).agg('mean', numeric_only=True)

region[(region['R_COMMENT'].str.startswith('h')) | (region['R_REGIONKEY'] < 0) | (region['R_COMMENT'] == 'l') | (region['R_COMMENT'].str.startswith('g'))][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_COMMENT'] != 'u')][['N_NAME', 'N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[['C_CUSTKEY', 'C_NAME']].merge(orders[(orders['ORDERDATE'] == '1992-01-13') | (orders['ORDERPRIORITY'].isin(['5-LOW', '2-HIGH', '1-URGENT'])) & (orders['O_COMMENT'].str.startswith('o')) & (orders['ORDERSTATUS'] != 'P')], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'].str.startswith('F')) & (nation['N_NATIONKEY'] < 8) & (nation['N_COMMENT'].str.startswith('t')) | (nation['N_COMMENT'].str.startswith('p'))][['N_NATIONKEY', 'N_NAME']].merge(customer[(customer['C_ADDRESS'] != 'I')][['C_ACCTBAL']].merge(lineitem, left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'].str.startswith('t')) & (nation['N_REGIONKEY'] >= 1)].merge(region[(region['R_REGIONKEY'] == 1) & (region['R_REGIONKEY'] != 2) | (region['R_COMMENT'] == 'u') | (region['R_NAME'] == 'AFR')], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

region[(region['R_REGIONKEY'] != 0)].merge(nation[['N_COMMENT', 'N_NAME']].merge(region[['R_NAME', 'R_COMMENT']], left_on='N_NATIONKEY', right_on='R_REGIONKEY').merge(part.merge(partsupp[(partsupp['PS_SUPPKEY'] <= 264)][['SUPPLYCOST', 'P_COMMENT', 'AVAILQTY', 'PS_SUPPKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='N_NATIONKEY', right_on='P_PARTKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] >= 13) | (nation['N_COMMENT'].str.startswith('c'))][['N_NATIONKEY', 'N_NAME']].merge(customer[(customer['C_NAME'] == 'C') & (customer['C_ADDRESS'] == 'q')][['C_ADDRESS', 'MKTSEGMENT', 'C_NAME']].merge(orders[(orders['O_CUSTKEY'] >= 149114) | (orders['O_ORDERKEY'] >= 675) | (orders['ORDERSTATUS'].isin(['P', 'O', 'F']))], left_on='C_CUSTKEY', right_on='O_ORDERKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME', 'R_REGIONKEY']).agg('sum', numeric_only=True)

lineitem[(lineitem['COMMITDATE'] >= '1992-05-15') | (lineitem['RETURNFLAG'] != 'N') | (lineitem['QUANTITY'] < 2) & (lineitem['L_COMMENT'].str.startswith('l'))][['L_SUPPKEY']].merge(partsupp[['AVAILQTY', 'PS_PARTKEY', 'PS_SUPPKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['P_COMMENT'].str.startswith(';')) & (partsupp['P_COMMENT'].str.startswith('are')) | (partsupp['PS_PARTKEY'] > 46)][['SUPPLYCOST', 'P_COMMENT']].merge(nation, left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY').merge(orders[(orders['CLERK'] != 'C') | (orders['ORDERDATE'] >= '1992-01-13') | (orders['O_ORDERKEY'] < 220) | (orders['O_CUSTKEY'] != 99847)][['O_COMMENT', 'ORDERSTATUS']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='O_ORDERKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['SUPPLYCOST', 'P_COMMENT', 'AVAILQTY']].merge(supplier[(supplier['S_NAME'] == 'S') | (supplier['S_ACCTBAL'] >= 1211.4808804377342)].merge(nation[(nation['N_REGIONKEY'] < 0)], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['L_SUPPKEY']).agg('min', numeric_only=True)

customer[(customer['C_COMMENT'] != 'p')][['MKTSEGMENT', 'C_ACCTBAL', 'C_ADDRESS']].merge(part.merge(partsupp[['AVAILQTY', 'SUPPLYCOST', 'P_COMMENT', 'PS_PARTKEY', 'PS_SUPPKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='C_CUSTKEY', right_on='P_PARTKEY').groupby(by=['C_ACCTBAL']).agg('min', numeric_only=True)

supplier[['S_PHONE']].groupby(by=['S_PHONE']).agg('sum', numeric_only=True)

lineitem[['LINENUMBER', 'L_COMMENT', 'DISCOUNT', 'SHIPDATE']].merge(partsupp, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY'])

lineitem[(lineitem['LINENUMBER'] > 3) & (lineitem['RETURNFLAG'] != 'R') & (lineitem['DISCOUNT'] > 0.038371044173532626) | (lineitem['LINENUMBER'] != 1)][['L_ORDERKEY']].merge(orders[(orders['TOTALPRICE'] >= 348609.7960427631) | (orders['O_ORDERKEY'] > 292) & (orders['ORDERSTATUS'].isin(['F', 'O', 'P']))][['O_ORDERKEY', 'ORDERSTATUS', 'SHIPPRIORITY', 'TOTALPRICE']], left_on='L_ORDERKEY', right_on='O_ORDERKEY')

part[['CONTAINER', 'PT_COMMENT', 'RETAILPRICE', 'MFGR', 'BRAND']].merge(customer.merge(orders[(orders['O_COMMENT'].str.startswith('.')) & (orders['ORDERSTATUS'].isin(['O']))].merge(lineitem[['L_ORDERKEY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['ORDERDATE'] >= '1998-07-21') & (orders['O_COMMENT'].str.startswith('x')) & (orders['SHIPPRIORITY'] < 0) | (orders['ORDERDATE'] <= '1998-07-21')].merge(customer[(customer['C_CUSTKEY'] > 61) | (customer['C_COMMENT'] == 's') & (customer['C_NAME'].str.startswith('C')) | (customer['C_ADDRESS'] != 'B')], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='P_PARTKEY', right_on='C_CUSTKEY').merge(nation, left_on='P_PARTKEY', right_on='N_NATIONKEY').merge(region[(region['R_COMMENT'].str.startswith('g'))][['R_COMMENT', 'R_REGIONKEY']].merge(nation.merge(supplier[(supplier['S_NATIONKEY'] < 7) & (supplier['S_ACCTBAL'] == 4902.299951931198)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='P_PARTKEY', right_on='R_REGIONKEY').groupby(by=['BRAND', 'RETAILPRICE']).agg('count')

supplier[(supplier['S_PHONE'] != '28-') | (supplier['S_ADDRESS'].str.startswith('w')) | (supplier['S_ADDRESS'].str.startswith('f'))].merge(nation[['N_NATIONKEY', 'N_NAME', 'N_COMMENT', 'N_REGIONKEY']].merge(customer[(customer['C_ACCTBAL'] == 5762.644021053347) | (customer['C_PHONE'] == '2')][['MKTSEGMENT', 'C_ACCTBAL', 'C_NAME', 'C_COMMENT', 'C_NATIONKEY']].merge(nation[['N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_NAME'] != 'A')][['R_REGIONKEY']].merge(nation[['N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_SUPPKEY']).agg('max', numeric_only=True)

orders.merge(lineitem[(lineitem['RETURNFLAG'] != 'A')][['L_SUPPKEY', 'COMMITDATE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_NATIONKEY'] <= 18)].merge(orders[['CLERK', 'O_COMMENT', 'ORDERSTATUS']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['SHIPPRIORITY'] <= 0)].merge(lineitem[(lineitem['RECEIPTDATE'] >= '1998-11-06') | (lineitem['L_SUPPKEY'] >= 8880)][['L_ORDERKEY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

partsupp.merge(part[(part['P_PARTKEY'] >= 107) | (part['P_NAME'] != 'b') | (part['MFGR'].isin(['Manufacturer#4', 'Manufacturer#5'])) & (part['PT_COMMENT'] != 'c')].merge(partsupp[['AVAILQTY', 'PS_PARTKEY', 'P_COMMENT']].merge(part[(part['TYPE'] == 'E') & (part['RETAILPRICE'] != 990.1480661909715)], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[['P_NAME', 'PT_COMMENT', 'TYPE', 'P_PARTKEY']].merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_PARTKEY', 'PS_SUPPKEY', 'SUPPLYCOST', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['SUPPLYCOST']).agg('min', numeric_only=True)

lineitem[(lineitem['L_SUPPKEY'] >= 4846) & (lineitem['LINENUMBER'] <= 5) & (lineitem['L_PARTKEY'] != 147774) | (lineitem['RETURNFLAG'].isin(['R']))][['RECEIPTDATE']].merge(orders[['ORDERSTATUS', 'ORDERPRIORITY']].merge(supplier[(supplier['S_SUPPKEY'] < 16) | (supplier['S_ADDRESS'].str.startswith(',')) & (supplier['S_SUPPKEY'] == 165)].merge(partsupp[['SUPPLYCOST', 'P_COMMENT', 'PS_SUPPKEY', 'AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='S_SUPPKEY').merge(part[['BRAND', 'CONTAINER']], left_on='O_ORDERKEY', right_on='P_PARTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY').groupby(by=['RECEIPTDATE']).agg('mean', numeric_only=True)

region[(region['R_NAME'].str.startswith('AFR')) | (region['R_REGIONKEY'] <= 1)].merge(nation[(nation['N_NATIONKEY'] != 22) | (nation['N_COMMENT'] == 'n') | (nation['N_COMMENT'] != 'a') | (nation['N_NATIONKEY'] <= 23)].merge(region[(region['R_COMMENT'] != 'l') & (region['R_NAME'].str.startswith('AFR')) | (region['R_NAME'].str.startswith('AFR')) & (region['R_NAME'] == 'M')].merge(nation[['N_REGIONKEY', 'N_NAME', 'N_NATIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[['S_ADDRESS', 'S_SUPPKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] != 'K')], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('sum', numeric_only=True)

region.merge(nation[['N_REGIONKEY', 'N_NAME', 'N_COMMENT', 'N_NATIONKEY']].merge(region[(region['R_REGIONKEY'] == 1) | (region['R_COMMENT'] != 'l')].merge(nation[(nation['N_NAME'] == 'I')], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_COMMENT'].str.startswith('u')) & (region['R_REGIONKEY'] < 0) & (region['R_COMMENT'].str.startswith('u')) & (region['R_REGIONKEY'] >= 3)].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(customer[(customer['MKTSEGMENT'] != 'HOUSEHOLD') | (customer['C_ADDRESS'].str.startswith('7'))][['C_ADDRESS', 'MKTSEGMENT', 'C_ACCTBAL']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME']).agg('count')

customer[(customer['MKTSEGMENT'] != 'HOUSEHOLD') | (customer['C_NATIONKEY'] < 18)].merge(orders[['O_COMMENT', 'ORDERSTATUS', 'ORDERPRIORITY', 'CLERK', 'SHIPPRIORITY']].merge(part[['TYPE', 'CONTAINER']].merge(lineitem[(lineitem['L_PARTKEY'] != 112543)][['LINENUMBER', 'L_COMMENT', 'SHIPDATE', 'COMMITDATE', 'L_PARTKEY']], left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='O_ORDERKEY', right_on='P_PARTKEY').merge(customer.merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_NATIONKEY'] <= 18)][['N_NATIONKEY', 'N_NAME', 'N_REGIONKEY', 'N_COMMENT']].merge(customer[['C_COMMENT']].merge(lineitem[(lineitem['DISCOUNT'] <= 0.028741939766158655)][['LINENUMBER', 'SHIPDATE']], left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(region[['R_NAME', 'R_COMMENT', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_CUSTKEY', 'C_NATIONKEY']).agg('min', numeric_only=True)

orders[['TOTALPRICE', 'CLERK']].merge(nation[['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT', 'N_NAME']], left_on='O_ORDERKEY', right_on='N_NATIONKEY').merge(customer[(customer['MKTSEGMENT'] == 'HOUSEHOLD') & (customer['C_PHONE'] == '3')].merge(orders[(orders['ORDERSTATUS'] == 'O') | (orders['CLERK'].str.startswith('C'))].merge(customer[(customer['C_PHONE'].str.startswith('2')) & (customer['C_COMMENT'] != 'q')][['MKTSEGMENT', 'C_ADDRESS', 'C_NATIONKEY', 'C_CUSTKEY']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[['N_NATIONKEY', 'N_COMMENT', 'N_NAME', 'N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='C_CUSTKEY').groupby(by=['CLERK', 'TOTALPRICE']).agg('max', numeric_only=True)

supplier[(supplier['S_COMMENT'].str.startswith(',')) | (supplier['S_SUPPKEY'] != 81) & (supplier['S_NAME'].str.startswith('S'))][['S_ACCTBAL', 'S_ADDRESS']].merge(customer[(customer['C_COMMENT'].str.startswith(' ')) | (customer['MKTSEGMENT'] == 'HOUSEHOLD') & (customer['MKTSEGMENT'].isin(['HOUSEHOLD', 'BUILDING', 'MACHINERY', 'AUTOMOBILE', 'FURNITURE']))], left_on='S_SUPPKEY', right_on='C_CUSTKEY').merge(lineitem[(lineitem['L_COMMENT'] != 's. ') & (lineitem['QUANTITY'] != 46) | (lineitem['RECEIPTDATE'] == '1992-05-02') & (lineitem['L_COMMENT'] != 'h')].merge(partsupp.merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(partsupp[(partsupp['P_COMMENT'] == 'are') | (partsupp['AVAILQTY'] >= 6854) & (partsupp['SUPPLYCOST'] == 103.53716489569359)][['SUPPLYCOST', 'PS_SUPPKEY', 'AVAILQTY', 'PS_PARTKEY', 'P_COMMENT']], left_on='S_SUPPKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).groupby(by=['S_ADDRESS', 'S_ACCTBAL']).agg('min', numeric_only=True)

supplier[(supplier['S_SUPPKEY'] == 107) & (supplier['S_SUPPKEY'] == 22) & (supplier['S_ACCTBAL'] <= -912.4852996977731)][['S_SUPPKEY', 'S_ADDRESS']].merge(partsupp.merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem.merge(partsupp[(partsupp['AVAILQTY'] != 1440) & (partsupp['SUPPLYCOST'] == 395.22497163345906) & (partsupp['AVAILQTY'] < 8039)][['PS_SUPPKEY', 'P_COMMENT', 'PS_PARTKEY', 'SUPPLYCOST']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_PARTKEY'] <= 38) | (partsupp['PS_PARTKEY'] <= 46) & (partsupp['AVAILQTY'] != 5889) | (partsupp['SUPPLYCOST'] != 876.0757512325328)][['PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['SUPPLYCOST', 'AVAILQTY']].merge(lineitem[['TAX']].merge(supplier[(supplier['S_SUPPKEY'] >= 172) & (supplier['S_COMMENT'].str.startswith('al ')) | (supplier['S_COMMENT'] != 'g')][['S_NAME']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(part, left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

supplier[(supplier['S_NAME'] != 'S') | (supplier['S_NATIONKEY'] > 15) & (supplier['S_NAME'] != 'S')].groupby(by=['S_COMMENT']).agg('mean', numeric_only=True)

lineitem[(lineitem['LINESTATUS'].isin(['F', 'O'])) & (lineitem['QUANTITY'] >= 3) & (lineitem['SHIPINSTRUCT'] != 'COLLECT COD') & (lineitem['COMMITDATE'] != '1998-10-16')].groupby(by=['DISCOUNT']).agg('mean', numeric_only=True)

lineitem.merge(partsupp[(partsupp['SUPPLYCOST'] >= 277.53575674482346)][['P_COMMENT', 'SUPPLYCOST', 'PS_PARTKEY', 'AVAILQTY']].merge(lineitem[(lineitem['L_COMMENT'] != 'y') | (lineitem['EXTENDEDPRICE'] != 87817.19137093134) & (lineitem['SHIPDATE'] == '1992-04-27')][['L_ORDERKEY', 'COMMITDATE', 'SHIPDATE', 'RECEIPTDATE', 'SHIPMODE']].merge(orders[['ORDERPRIORITY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['AVAILQTY'] > 3697)][['AVAILQTY', 'PS_PARTKEY']].merge(part[(part['CONTAINER'] != 'LG') & (part['TYPE'] != 'STA') | (part['CONTAINER'] == 'WRAP') | (part['SIZE'] == 23)], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY')

lineitem[(lineitem['L_PARTKEY'] < 193824) | (lineitem['RECEIPTDATE'] == '1992-05-02') & (lineitem['LINESTATUS'].isin(['F'])) | (lineitem['L_SUPPKEY'] > 3773)].merge(partsupp[['PS_PARTKEY']].merge(lineitem[(lineitem['COMMITDATE'] > '1998-10-16') | (lineitem['RECEIPTDATE'] <= '1998-11-06') | (lineitem['LINESTATUS'] != 'O') | (lineitem['QUANTITY'] > 15)], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY')

region[(region['R_REGIONKEY'] != 0) | (region['R_NAME'].str.startswith('M')) & (region['R_NAME'].str.startswith('ASI'))][['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].groupby(by=['R_REGIONKEY']).agg('min', numeric_only=True)

nation[['N_REGIONKEY', 'N_COMMENT']]

partsupp.merge(supplier[(supplier['S_COMMENT'].str.startswith('v')) | (supplier['S_NATIONKEY'] < 0) & (supplier['S_ADDRESS'] != 'N')][['S_ACCTBAL']].merge(part, left_on='S_SUPPKEY', right_on='P_PARTKEY').merge(nation.merge(customer[(customer['C_COMMENT'] != 'p') & (customer['C_NATIONKEY'] > 0)], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_SUPPKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[['QUANTITY', 'L_PARTKEY']].merge(partsupp[['P_COMMENT', 'PS_PARTKEY', 'SUPPLYCOST', 'AVAILQTY', 'PS_SUPPKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'] != ' th')].merge(lineitem[(lineitem['COMMITDATE'] <= '1998-10-16') | (lineitem['QUANTITY'] != 28) & (lineitem['L_COMMENT'] != 'd')], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part.merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'] == 'f') | (partsupp['SUPPLYCOST'] != 881.9366624398314)][['PS_SUPPKEY', 'PS_PARTKEY', 'AVAILQTY']].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY')

customer[['C_CUSTKEY', 'C_NAME']].merge(orders[['ORDERDATE', 'O_CUSTKEY', 'CLERK', 'O_ORDERKEY']].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['O_CUSTKEY', 'CLERK', 'O_COMMENT', 'SHIPPRIORITY', 'ORDERDATE']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['SHIPPRIORITY', 'ORDERPRIORITY', 'O_ORDERKEY', 'ORDERDATE', 'O_CUSTKEY']].merge(customer[(customer['C_NATIONKEY'] >= 12) & (customer['C_NATIONKEY'] == 8) | (customer['C_ACCTBAL'] == 8741.998379619668) & (customer['MKTSEGMENT'] == 'HOUSEHOLD')][['C_NATIONKEY', 'C_ACCTBAL', 'C_COMMENT', 'C_ADDRESS', 'C_NAME']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

lineitem.merge(partsupp[(partsupp['P_COMMENT'] != 'h') | (partsupp['P_COMMENT'].str.startswith('c'))][['P_COMMENT', 'SUPPLYCOST', 'AVAILQTY', 'PS_SUPPKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(orders[(orders['SHIPPRIORITY'] < 0)][['CLERK', 'SHIPPRIORITY', 'O_COMMENT', 'TOTALPRICE']].merge(customer[(customer['C_NAME'] != 'C') | (customer['C_ADDRESS'] == 'E') | (customer['C_COMMENT'] != 'y')].merge(orders[(orders['ORDERSTATUS'].isin(['F', 'O'])) | (orders['ORDERPRIORITY'] != '2-HIGH')], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_ORDERKEY', right_on='C_CUSTKEY').merge(supplier[['S_ADDRESS', 'S_COMMENT', 'S_NAME', 'S_ACCTBAL']].merge(nation[(nation['N_COMMENT'] != ' ')], left_on='S_SUPPKEY', right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='S_SUPPKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').groupby(by=['L_ORDERKEY', 'SHIPMODE']).agg('sum', numeric_only=True)

region[(region['R_COMMENT'].str.startswith('h')) | (region['R_NAME'] != 'A') | (region['R_NAME'].str.startswith('A'))].merge(nation[['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY']].merge(region[(region['R_COMMENT'] != 'l') | (region['R_NAME'] != 'A') & (region['R_NAME'].str.startswith('E')) & (region['R_REGIONKEY'] <= 1)][['R_REGIONKEY', 'R_NAME']].merge(nation[(nation['N_NATIONKEY'] < 15)][['N_REGIONKEY', 'N_NATIONKEY', 'N_NAME', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[['R_REGIONKEY', 'R_COMMENT', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

supplier[(supplier['S_NATIONKEY'] != 21) | (supplier['S_ADDRESS'] != 'W') & (supplier['S_NATIONKEY'] < 21)].merge(partsupp[['P_COMMENT']].merge(nation[['N_NAME']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY').merge(lineitem[(lineitem['TAX'] <= 0.02985674444791708) & (lineitem['LINESTATUS'] == 'F') | (lineitem['SHIPMODE'] != 'TRUCK') | (lineitem['COMMITDATE'] != '1992-05-15')].merge(partsupp[['PS_SUPPKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['SUPPLYCOST'] >= 562.1071415932555)].merge(part.merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

nation[(nation['N_NAME'] == 'K')].merge(customer.merge(orders.merge(lineitem[(lineitem['COMMITDATE'] > '1992-05-15')], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

nation[['N_NATIONKEY', 'N_NAME', 'N_REGIONKEY']].groupby(by=['N_NATIONKEY']).agg('max', numeric_only=True)

supplier[(supplier['S_NATIONKEY'] > 12) | (supplier['S_ADDRESS'] != 'n')][['S_SUPPKEY', 'S_COMMENT']].merge(partsupp[(partsupp['P_COMMENT'].str.startswith('bli')) & (partsupp['SUPPLYCOST'] != 425.2783389143299) | (partsupp['PS_SUPPKEY'] >= 4963)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp.merge(lineitem[['LINESTATUS', 'L_SUPPKEY']].merge(partsupp[['P_COMMENT', 'PS_SUPPKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['RETURNFLAG'] != 'R')].merge(partsupp[(partsupp['AVAILQTY'] == 4997) | (partsupp['PS_SUPPKEY'] > 1874)][['SUPPLYCOST']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_COMMENT']).agg('count')

partsupp[(partsupp['SUPPLYCOST'] > 119.19178315133357) & (partsupp['AVAILQTY'] < 7323) | (partsupp['SUPPLYCOST'] != 528.3997851242003)][['PS_SUPPKEY', 'AVAILQTY', 'SUPPLYCOST', 'PS_PARTKEY', 'P_COMMENT']].groupby(by=['AVAILQTY', 'PS_SUPPKEY']).agg('count')

nation[['N_REGIONKEY', 'N_COMMENT', 'N_NAME']].merge(region[(region['R_REGIONKEY'] < 2) & (region['R_NAME'] != 'AME')].merge(nation[(nation['N_NAME'].str.startswith('F')) | (nation['N_COMMENT'] == 'e')].merge(supplier[(supplier['S_SUPPKEY'] <= 55) & (supplier['S_NATIONKEY'] != 17) | (supplier['S_ACCTBAL'] >= 2969.532217219442)][['S_SUPPKEY', 'S_NATIONKEY', 'S_NAME', 'S_COMMENT', 'S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] == 'c') & (nation['N_NATIONKEY'] < 4) | (nation['N_COMMENT'].str.startswith('p')) & (nation['N_NAME'].str.startswith('S'))][['N_NAME', 'N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY']].merge(supplier[['S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_NAME']).agg('max', numeric_only=True)

partsupp[(partsupp['PS_SUPPKEY'] >= 596) | (partsupp['PS_PARTKEY'] != 32)][['AVAILQTY', 'PS_PARTKEY', 'PS_SUPPKEY']].merge(part[['P_NAME', 'CONTAINER']], left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['AVAILQTY', 'PS_PARTKEY']).agg('count')

lineitem[(lineitem['SHIPMODE'] == 'REG AIR') & (lineitem['L_PARTKEY'] > 107510) & (lineitem['L_SUPPKEY'] <= 232) | (lineitem['LINENUMBER'] > 1)].groupby(by=['LINENUMBER']).agg('count')

supplier[(supplier['S_COMMENT'].str.startswith('d')) & (supplier['S_PHONE'] != '3') | (supplier['S_ADDRESS'] == 'Z') | (supplier['S_NAME'] == 'S')]

customer

nation.groupby(by=['N_NAME', 'N_COMMENT']).agg('sum', numeric_only=True)

nation[['N_NATIONKEY', 'N_NAME', 'N_COMMENT']].groupby(by=['N_NATIONKEY', 'N_NAME']).agg('count')

region.merge(nation[(nation['N_REGIONKEY'] >= 2) | (nation['N_REGIONKEY'] < 2) & (nation['N_NATIONKEY'] <= 22) | (nation['N_NATIONKEY'] < 14)].merge(region[(region['R_COMMENT'] != 'g') | (region['R_REGIONKEY'] > 0)][['R_COMMENT', 'R_REGIONKEY', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(customer[(customer['C_COMMENT'].str.startswith('f')) & (customer['C_ACCTBAL'] >= 9351.019416422092) & (customer['C_NATIONKEY'] > 0)][['C_ADDRESS', 'C_PHONE']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

partsupp[['P_COMMENT']].merge(part[(part['RETAILPRICE'] != 916.0074711975047)].merge(partsupp[['AVAILQTY', 'SUPPLYCOST']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='P_PARTKEY')

part[(part['PT_COMMENT'] == 'g') & (part['TYPE'].str.startswith('STA')) & (part['MFGR'] == 'Manufacturer#4')][['SIZE']].merge(supplier[(supplier['S_SUPPKEY'] == 17)][['S_PHONE', 'S_ACCTBAL', 'S_SUPPKEY']], left_on='P_PARTKEY', right_on='S_SUPPKEY').merge(lineitem[(lineitem['RECEIPTDATE'] <= '1992-05-02') & (lineitem['L_COMMENT'] != 'j')].merge(partsupp.merge(lineitem[['EXTENDEDPRICE', 'RECEIPTDATE', 'SHIPDATE', 'RETURNFLAG']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(nation[(nation['N_REGIONKEY'] <= 3) & (nation['N_NATIONKEY'] <= 11) | (nation['N_NAME'] == 'A')].merge(customer[(customer['C_ADDRESS'] != '0')][['C_CUSTKEY', 'MKTSEGMENT', 'C_COMMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_ACCTBAL'] >= 8305.183051633618) & (supplier['S_NAME'].str.startswith('S')) & (supplier['S_COMMENT'] != 'a') | (supplier['S_NATIONKEY'] >= 6)][['S_NAME']].merge(part[['BRAND']], left_on='S_SUPPKEY', right_on='P_PARTKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='P_PARTKEY', right_on='N_NATIONKEY').groupby(by=['SIZE']).agg('min', numeric_only=True)

lineitem[(lineitem['DISCOUNT'] < 0.040268075464306996)].merge(partsupp.merge(lineitem.merge(orders[(orders['ORDERSTATUS'] == 'P') & (orders['O_ORDERKEY'] < 679) & (orders['O_CUSTKEY'] <= 104960)][['O_COMMENT']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[(part['PT_COMMENT'] != 't') & (part['BRAND'].isin(['Brand#24', 'Brand#13', 'Brand#33', 'Brand#51', 'Brand#31', 'Brand#15', 'Brand#42', 'Brand#23', 'Brand#25', 'Brand#54', 'Brand#41', 'Brand#14', 'Brand#44', 'Brand#12', 'Brand#34'])) | (part['P_NAME'] == 'blu')][['BRAND', 'CONTAINER', 'PT_COMMENT']].merge(partsupp[(partsupp['AVAILQTY'] > 6338)][['P_COMMENT', 'PS_PARTKEY', 'PS_SUPPKEY', 'AVAILQTY']], left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_PARTKEY'] >= 45) & (partsupp['AVAILQTY'] <= 497) & (partsupp['AVAILQTY'] >= 2751) & (partsupp['AVAILQTY'] >= 108)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['QUANTITY', 'COMMITDATE']).agg('min', numeric_only=True)

part[(part['SIZE'] == 30)][['RETAILPRICE']].merge(region[['R_REGIONKEY', 'R_NAME', 'R_COMMENT']], left_on='P_PARTKEY', right_on='R_REGIONKEY').merge(region[(region['R_NAME'].str.startswith('E')) & (region['R_COMMENT'] == 'g') | (region['R_REGIONKEY'] < 1)], left_on='P_PARTKEY', right_on='R_REGIONKEY').merge(region[['R_REGIONKEY', 'R_COMMENT', 'R_NAME']], left_on='P_PARTKEY', right_on='R_REGIONKEY')

lineitem[(lineitem['RECEIPTDATE'] < '1998-11-06') | (lineitem['L_COMMENT'] == 'n')].merge(partsupp[['PS_SUPPKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['LINESTATUS']).agg('mean', numeric_only=True)

partsupp[(partsupp['PS_PARTKEY'] > 19) & (partsupp['SUPPLYCOST'] <= 864.2328519092647) & (partsupp['SUPPLYCOST'] > 133.88209623290024) & (partsupp['SUPPLYCOST'] <= 924.7389021246975)]

partsupp[['SUPPLYCOST', 'AVAILQTY', 'P_COMMENT', 'PS_PARTKEY']].groupby(by=['SUPPLYCOST', 'AVAILQTY']).agg('min', numeric_only=True)

nation

supplier[(supplier['S_SUPPKEY'] != 138) | (supplier['S_ACCTBAL'] == 3440.2041199640444) | (supplier['S_NATIONKEY'] >= 0) & (supplier['S_NATIONKEY'] != 16)].merge(partsupp[['AVAILQTY', 'PS_PARTKEY', 'SUPPLYCOST', 'P_COMMENT', 'PS_SUPPKEY']].merge(lineitem[(lineitem['L_ORDERKEY'] == 125) & (lineitem['COMMITDATE'] != '1998-10-16') & (lineitem['L_ORDERKEY'] >= 29)], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

region[(region['R_REGIONKEY'] > 2) & (region['R_REGIONKEY'] > 3) | (region['R_COMMENT'] != 'u') & (region['R_REGIONKEY'] != 0)].merge(nation[(nation['N_COMMENT'] == 'o')], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME', 'R_COMMENT']).agg('min', numeric_only=True)

customer[(customer['C_ADDRESS'] == 'c') & (customer['C_CUSTKEY'] != 96)][['MKTSEGMENT', 'C_COMMENT']].merge(lineitem.merge(orders[['SHIPPRIORITY', 'CLERK']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'])

nation[['N_COMMENT', 'N_NATIONKEY', 'N_NAME', 'N_REGIONKEY']].merge(customer[(customer['C_COMMENT'] != 'c')].merge(orders.merge(customer[['C_ACCTBAL', 'C_ADDRESS', 'C_PHONE', 'C_CUSTKEY']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[['C_NAME']].merge(nation[['N_REGIONKEY', 'N_NAME']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_CUSTKEY', right_on='N_NATIONKEY').merge(supplier, left_on='C_CUSTKEY', right_on='S_SUPPKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

orders[['ORDERDATE']].merge(partsupp[(partsupp['SUPPLYCOST'] > 25.22819489997512) & (partsupp['PS_SUPPKEY'] > 5520)].merge(supplier[(supplier['S_SUPPKEY'] < 42) | (supplier['S_NATIONKEY'] != 23) & (supplier['S_PHONE'].str.startswith('32-'))].merge(partsupp[(partsupp['SUPPLYCOST'] == 630.9057922122577) & (partsupp['SUPPLYCOST'] != 807.2541146632195) | (partsupp['P_COMMENT'].str.startswith(',')) & (partsupp['P_COMMENT'] != ';')][['PS_PARTKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[(supplier['S_NAME'] == 'S')][['S_SUPPKEY', 'S_COMMENT', 'S_ADDRESS']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']].merge(customer[(customer['C_ACCTBAL'] < -416.3891982736391) & (customer['C_PHONE'] != '22-') | (customer['C_CUSTKEY'] <= 84) | (customer['MKTSEGMENT'] != 'BUILDING')].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='O_ORDERKEY', right_on='N_NATIONKEY').groupby(by=['ORDERDATE']).agg('min', numeric_only=True)

orders.merge(customer[(customer['C_PHONE'] != '13-') & (customer['C_ACCTBAL'] < 5866.930756143075)][['C_CUSTKEY', 'C_NATIONKEY', 'MKTSEGMENT']], left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_COMMENT'] == '.') | (customer['C_NATIONKEY'] <= 7)][['C_CUSTKEY', 'C_NAME', 'C_ACCTBAL', 'C_ADDRESS', 'C_PHONE']].merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[(lineitem['RETURNFLAG'] == 'N') | (lineitem['QUANTITY'] < 32) | (lineitem['COMMITDATE'] >= '1998-10-16') & (lineitem['QUANTITY'] > 11)].merge(orders[(orders['ORDERSTATUS'] != 'P')][['TOTALPRICE', 'CLERK', 'O_CUSTKEY']].merge(customer[['C_NAME']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY')

nation[(nation['N_REGIONKEY'] != 1) & (nation['N_COMMENT'].str.startswith(' ')) | (nation['N_REGIONKEY'] != 1)][['N_REGIONKEY', 'N_NATIONKEY']].merge(supplier[(supplier['S_COMMENT'] != 'b') & (supplier['S_SUPPKEY'] == 27) & (supplier['S_ACCTBAL'] != 2609.2618628547816)], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[['R_COMMENT']].merge(customer, left_on='R_REGIONKEY', right_on='C_CUSTKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region.merge(nation[(nation['N_NATIONKEY'] <= 11) | (nation['N_REGIONKEY'] == 2)].merge(supplier[['S_NATIONKEY', 'S_SUPPKEY', 'S_COMMENT', 'S_PHONE', 'S_ACCTBAL']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] == 21) | (nation['N_COMMENT'] != 'y')], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY')

orders[(orders['O_ORDERKEY'] == 446)].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_NAME'].str.startswith('C')) & (customer['C_CUSTKEY'] >= 52) | (customer['C_ACCTBAL'] > 5554.084504940331)], left_on='O_CUSTKEY', right_on='C_CUSTKEY')

supplier[['S_PHONE', 'S_NATIONKEY', 'S_NAME']].merge(nation[(nation['N_NAME'] == 'K') & (nation['N_COMMENT'] == 'e') & (nation['N_NAME'] != 'F') | (nation['N_NATIONKEY'] <= 17)][['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NAME'].str.startswith('M'))], left_on='S_NATIONKEY', right_on='N_NATIONKEY')

orders[(orders['ORDERPRIORITY'].isin(['4-NOT SPECIFIED', '3-MEDIUM', '2-HIGH', '1-URGENT'])) & (orders['SHIPPRIORITY'] != 0) & (orders['TOTALPRICE'] != 266593.26396898396)].merge(lineitem[(lineitem['EXTENDEDPRICE'] >= 71537.85775923434) & (lineitem['EXTENDEDPRICE'] != 22431.690273716078) | (lineitem['L_COMMENT'].str.startswith('a')) & (lineitem['LINENUMBER'] < 5)][['COMMITDATE', 'SHIPMODE', 'LINESTATUS', 'L_COMMENT', 'DISCOUNT']].merge(nation[(nation['N_NATIONKEY'] >= 3)][['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY').merge(part[(part['P_NAME'].str.startswith('s'))][['RETAILPRICE', 'BRAND', 'P_NAME', 'CONTAINER']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['TOTALPRICE']).agg('max', numeric_only=True)

orders[(orders['O_CUSTKEY'] > 126321) & (orders['CLERK'].str.startswith('C'))][['SHIPPRIORITY', 'ORDERDATE', 'ORDERSTATUS', 'CLERK']].merge(customer[['C_CUSTKEY', 'MKTSEGMENT']].merge(orders[(orders['TOTALPRICE'] > 334731.4921830095) & (orders['ORDERPRIORITY'] != '4-NOT SPECIFIED')], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['SHIPPRIORITY'] < 0)].merge(customer[(customer['C_NATIONKEY'] <= 16)][['MKTSEGMENT', 'C_NAME', 'C_COMMENT']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_ORDERKEY', right_on='C_CUSTKEY').merge(customer[['C_PHONE', 'C_NATIONKEY', 'C_ACCTBAL']].merge(nation[(nation['N_REGIONKEY'] < 2) & (nation['N_NAME'] != 'K') | (nation['N_NAME'] == 'I')][['N_NATIONKEY', 'N_NAME', 'N_REGIONKEY', 'N_COMMENT']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='C_CUSTKEY').groupby(by=['ORDERDATE', 'SHIPPRIORITY']).agg('count')

lineitem[(lineitem['L_SUPPKEY'] >= 8489)].merge(partsupp[['PS_SUPPKEY', 'AVAILQTY', 'P_COMMENT', 'SUPPLYCOST']], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(orders[['ORDERDATE', 'O_ORDERKEY', 'O_CUSTKEY', 'ORDERSTATUS', 'ORDERPRIORITY']].merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['P_COMMENT'] == 't')], left_on='L_PARTKEY', right_on='PS_PARTKEY')

nation[['N_COMMENT']].merge(customer, left_on='N_NATIONKEY', right_on='C_CUSTKEY').merge(region[(region['R_COMMENT'].str.startswith('h'))][['R_NAME', 'R_COMMENT']], left_on='N_NATIONKEY', right_on='R_REGIONKEY')

part[['PT_COMMENT', 'TYPE']].groupby(by=['TYPE']).agg('sum', numeric_only=True)

nation[(nation['N_NAME'].str.startswith('S'))].merge(customer[(customer['MKTSEGMENT'] == 'AUTOMOBILE')], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region.merge(nation[(nation['N_REGIONKEY'] == 2) & (nation['N_COMMENT'] != 'u') | (nation['N_NAME'] != 'U')], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[(supplier['S_PHONE'] != '1') | (supplier['S_ACCTBAL'] > 1075.805811490459) & (supplier['S_PHONE'] != '2')][['S_COMMENT', 'S_PHONE', 'S_NAME', 'S_ADDRESS', 'S_SUPPKEY']].merge(partsupp[(partsupp['PS_PARTKEY'] >= 25) & (partsupp['P_COMMENT'] != 's') | (partsupp['PS_PARTKEY'] != 18)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_COMMENT']).agg('count')

partsupp[['SUPPLYCOST', 'PS_PARTKEY', 'PS_SUPPKEY', 'P_COMMENT']].merge(part.merge(partsupp[['P_COMMENT', 'PS_SUPPKEY', 'PS_PARTKEY', 'AVAILQTY', 'SUPPLYCOST']].merge(part[(part['CONTAINER'] != 'SM') & (part['PT_COMMENT'] != 'm') | (part['MFGR'] != 'Manufacturer#4') & (part['RETAILPRICE'] != 1029.1513389468885)], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY')

partsupp[['SUPPLYCOST', 'PS_SUPPKEY', 'AVAILQTY', 'P_COMMENT', 'PS_PARTKEY']].merge(lineitem.merge(partsupp.merge(part[(part['SIZE'] < 17) & (part['BRAND'] != 'Brand#43')][['CONTAINER', 'SIZE', 'BRAND', 'TYPE', 'P_PARTKEY']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(orders[['O_COMMENT']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY')

nation.merge(customer[['C_ADDRESS']], left_on='N_NATIONKEY', right_on='C_NATIONKEY')

partsupp[['P_COMMENT']].merge(region[(region['R_COMMENT'] != 'h') | (region['R_NAME'].str.startswith('ASI')) | (region['R_COMMENT'] != 'l')][['R_REGIONKEY', 'R_COMMENT']].merge(nation[['N_REGIONKEY', 'N_COMMENT', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(customer[(customer['MKTSEGMENT'].isin(['MACHINERY'])) | (customer['C_ACCTBAL'] < 9380.162487566904) | (customer['C_PHONE'] != '18-') | (customer['C_CUSTKEY'] < 27)], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='R_REGIONKEY').groupby(by=['P_COMMENT']).agg('max', numeric_only=True)

nation[['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY']].merge(customer[(customer['C_NATIONKEY'] >= 3) | (customer['C_CUSTKEY'] >= 25) | (customer['MKTSEGMENT'] != 'HOUSEHOLD') & (customer['C_ADDRESS'] != 'v')].merge(orders[(orders['SHIPPRIORITY'] != 0)].merge(customer[['C_NATIONKEY', 'C_COMMENT']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY')

customer[(customer['C_NATIONKEY'] <= 19) | (customer['C_PHONE'].str.startswith('25-'))][['C_CUSTKEY', 'C_NAME', 'C_PHONE', 'C_ADDRESS', 'C_COMMENT']].merge(orders[['TOTALPRICE', 'CLERK']].merge(customer[(customer['C_CUSTKEY'] < 92) | (customer['C_CUSTKEY'] > 10) | (customer['C_ADDRESS'] == 'D')].merge(orders[['TOTALPRICE', 'SHIPPRIORITY', 'CLERK', 'O_COMMENT']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_ORDERKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders.merge(customer[['MKTSEGMENT']].merge(nation, left_on='C_CUSTKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_NAME']).agg('mean', numeric_only=True)

lineitem[['QUANTITY', 'SHIPINSTRUCT', 'SHIPDATE', 'L_SUPPKEY']].merge(partsupp[['SUPPLYCOST', 'PS_SUPPKEY']].merge(supplier[['S_SUPPKEY', 'S_ADDRESS', 'S_PHONE', 'S_ACCTBAL', 'S_NAME']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem.merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['SHIPINSTRUCT']).agg('sum', numeric_only=True)

nation[(nation['N_REGIONKEY'] <= 1) & (nation['N_NATIONKEY'] != 3) & (nation['N_NAME'] != 'J')].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_REGIONKEY']).agg('min', numeric_only=True)

customer.merge(nation[['N_NATIONKEY']].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

lineitem[(lineitem['QUANTITY'] == 16) & (lineitem['L_COMMENT'] != 'ly ') & (lineitem['COMMITDATE'] < '1998-10-16') | (lineitem['RETURNFLAG'] == 'A')][['RECEIPTDATE', 'QUANTITY']].merge(part.merge(partsupp[(partsupp['PS_SUPPKEY'] != 5067) & (partsupp['PS_PARTKEY'] < 38)].merge(part[(part['SIZE'] == 37) | (part['P_PARTKEY'] < 21) & (part['TYPE'] == 'P') | (part['BRAND'] != 'Brand#22')][['SIZE', 'P_NAME', 'MFGR', 'P_PARTKEY', 'TYPE']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY').merge(orders[(orders['O_ORDERKEY'] > 484) | (orders['ORDERPRIORITY'] != '1-URGENT') | (orders['ORDERPRIORITY'] == '2-HIGH') | (orders['O_ORDERKEY'] >= 709)][['O_COMMENT', 'CLERK', 'ORDERDATE', 'O_ORDERKEY', 'TOTALPRICE']].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY')

partsupp.merge(lineitem[['RECEIPTDATE', 'LINESTATUS', 'LINENUMBER', 'SHIPDATE', 'L_COMMENT']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier[['S_SUPPKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem.merge(partsupp[(partsupp['PS_SUPPKEY'] == 1115) | (partsupp['AVAILQTY'] > 434) | (partsupp['PS_SUPPKEY'] <= 3879)][['AVAILQTY', 'P_COMMENT', 'PS_PARTKEY', 'PS_SUPPKEY', 'SUPPLYCOST']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY')

customer[(customer['C_PHONE'] == '1') | (customer['C_ACCTBAL'] <= 2680.799996209181) | (customer['C_NAME'].str.startswith('C'))][['C_PHONE', 'C_COMMENT']]

partsupp.merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY').groupby(by=['AVAILQTY', 'SUPPLYCOST']).agg('mean', numeric_only=True)

part.merge(partsupp[['PS_PARTKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY')

lineitem[(lineitem['COMMITDATE'] == '1998-10-16') & (lineitem['EXTENDEDPRICE'] >= 14781.224535640767) | (lineitem['SHIPDATE'] != '1998-10-30') & (lineitem['L_COMMENT'].str.startswith('ly '))].merge(partsupp.merge(part[(part['P_PARTKEY'] > 169) | (part['P_PARTKEY'] != 192) | (part['RETAILPRICE'] >= 1015.0483628637228)].merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['TAX']).agg('sum', numeric_only=True)

lineitem.groupby(by=['RETURNFLAG']).agg('sum', numeric_only=True)

region[(region['R_COMMENT'].str.startswith('g')) | (region['R_NAME'] == 'E') & (region['R_REGIONKEY'] <= 0)][['R_COMMENT', 'R_NAME']].merge(partsupp[(partsupp['P_COMMENT'] == 'j')][['AVAILQTY', 'PS_SUPPKEY', 'SUPPLYCOST']].merge(supplier.merge(partsupp[(partsupp['PS_SUPPKEY'] < 6526) & (partsupp['PS_SUPPKEY'] > 2402) & (partsupp['PS_PARTKEY'] >= 34) | (partsupp['PS_PARTKEY'] > 29)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='R_REGIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY'])

lineitem[(lineitem['LINESTATUS'].isin(['F']))].merge(orders[(orders['ORDERPRIORITY'] != '4-NOT SPECIFIED') | (orders['SHIPPRIORITY'] <= 0) & (orders['TOTALPRICE'] <= 254038.08397388164)][['ORDERDATE', 'O_ORDERKEY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['SUPPLYCOST'] != 260.46095704778713) & (partsupp['AVAILQTY'] < 7731) | (partsupp['AVAILQTY'] < 9772)][['PS_SUPPKEY', 'AVAILQTY', 'SUPPLYCOST', 'PS_PARTKEY']].merge(lineitem[(lineitem['L_COMMENT'] == '-') | (lineitem['EXTENDEDPRICE'] <= 78098.92334938653) & (lineitem['SHIPDATE'] > '1992-04-27') & (lineitem['L_ORDERKEY'] == 92)].merge(partsupp[['AVAILQTY', 'P_COMMENT', 'PS_PARTKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY')

nation.merge(region[['R_COMMENT', 'R_REGIONKEY', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[['C_ADDRESS', 'C_CUSTKEY']].merge(orders[(orders['TOTALPRICE'] == 47635.292964293614) | (orders['CLERK'] == 'C') & (orders['TOTALPRICE'] <= 300564.357535507) | (orders['O_COMMENT'].str.startswith('.'))].merge(customer[(customer['C_PHONE'].str.startswith('22-'))][['C_CUSTKEY', 'C_NATIONKEY', 'C_NAME', 'MKTSEGMENT', 'C_COMMENT']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['O_COMMENT'] == 'i') | (orders['O_COMMENT'] != '.') | (orders['TOTALPRICE'] <= 296351.8989427295) & (orders['O_ORDERKEY'] < 544)][['CLERK', 'SHIPPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

orders[['ORDERSTATUS', 'ORDERPRIORITY', 'O_COMMENT']].merge(part[['MFGR', 'CONTAINER']].merge(customer[(customer['C_COMMENT'].str.startswith('n')) | (customer['C_COMMENT'] == 'r')][['C_CUSTKEY', 'C_COMMENT', 'C_ADDRESS', 'C_ACCTBAL']].merge(orders[['SHIPPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='P_PARTKEY', right_on='C_CUSTKEY'), left_on='O_ORDERKEY', right_on='P_PARTKEY').merge(customer[(customer['C_CUSTKEY'] <= 27) & (customer['C_CUSTKEY'] >= 13) & (customer['MKTSEGMENT'].isin(['HOUSEHOLD', 'MACHINERY'])) & (customer['C_ADDRESS'] == 'T')][['C_COMMENT', 'C_CUSTKEY', 'C_ADDRESS']], left_on='O_ORDERKEY', right_on='C_CUSTKEY').groupby(by=['ORDERPRIORITY']).agg('sum', numeric_only=True)

part[['SIZE', 'RETAILPRICE', 'TYPE', 'BRAND']].merge(nation[(nation['N_NATIONKEY'] >= 2) & (nation['N_NAME'].str.startswith('K'))][['N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']].merge(supplier[(supplier['S_COMMENT'].str.startswith('s')) & (supplier['S_NAME'] != 'S')][['S_ACCTBAL', 'S_PHONE', 'S_NAME']].merge(orders[['SHIPPRIORITY', 'CLERK', 'ORDERDATE', 'ORDERSTATUS']], left_on='S_SUPPKEY', right_on='O_ORDERKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='P_PARTKEY', right_on='N_NATIONKEY').merge(supplier[['S_COMMENT', 'S_PHONE', 'S_ADDRESS', 'S_ACCTBAL']], left_on='P_PARTKEY', right_on='S_SUPPKEY')

partsupp[(partsupp['P_COMMENT'] != 'ly ') & (partsupp['AVAILQTY'] < 368) & (partsupp['AVAILQTY'] >= 7865) & (partsupp['PS_SUPPKEY'] > 6609)].groupby(by=['SUPPLYCOST', 'PS_SUPPKEY']).agg('min', numeric_only=True)

customer[['C_PHONE']].merge(partsupp[(partsupp['PS_PARTKEY'] == 32) & (partsupp['PS_PARTKEY'] != 47) & (partsupp['P_COMMENT'].str.startswith('i')) & (partsupp['AVAILQTY'] < 3331)].merge(supplier[(supplier['S_NAME'].str.startswith('S'))].merge(nation[(nation['N_COMMENT'] == 'h') & (nation['N_NATIONKEY'] == 1) & (nation['N_NAME'].str.startswith('M')) | (nation['N_COMMENT'] != 'c')][['N_NAME', 'N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).groupby(by=['C_PHONE']).agg('sum', numeric_only=True)

region.merge(nation[['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

lineitem.merge(orders[['ORDERPRIORITY', 'SHIPPRIORITY', 'O_ORDERKEY']].merge(lineitem[(lineitem['SHIPDATE'] < '1998-10-30') & (lineitem['SHIPMODE'] != 'TRUCK') & (lineitem['RECEIPTDATE'] == '1998-11-06') | (lineitem['L_ORDERKEY'] != 184)].merge(orders[['SHIPPRIORITY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp.merge(part[['RETAILPRICE']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY')

orders[(orders['O_ORDERKEY'] < 236) & (orders['ORDERSTATUS'] == 'P') | (orders['ORDERDATE'] == '1998-07-21') | (orders['O_CUSTKEY'] < 40430)].groupby(by=['ORDERPRIORITY', 'ORDERDATE']).agg('sum', numeric_only=True)

part[['TYPE', 'PT_COMMENT', 'BRAND', 'P_NAME']].merge(customer[(customer['C_ADDRESS'].str.startswith('D')) & (customer['C_NAME'] != 'C') | (customer['C_COMMENT'] == 'u') | (customer['MKTSEGMENT'] == 'HOUSEHOLD')].merge(orders[['CLERK']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['ORDERSTATUS'].isin(['O'])) & (orders['O_COMMENT'] == 'the') | (orders['CLERK'].str.startswith('C')) & (orders['O_COMMENT'].str.startswith('s'))][['ORDERPRIORITY']].merge(region, left_on='O_ORDERKEY', right_on='R_REGIONKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='P_PARTKEY', right_on='C_CUSTKEY').groupby(by=['PT_COMMENT']).agg('count')

region.merge(nation[['N_COMMENT', 'N_REGIONKEY', 'N_NAME', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] != 's') | (nation['N_NAME'].str.startswith('A')) & (nation['N_REGIONKEY'] <= 2)].merge(supplier[(supplier['S_SUPPKEY'] < 195) & (supplier['S_PHONE'] != '1') & (supplier['S_PHONE'] == '28-') | (supplier['S_COMMENT'] == 'the')], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[['R_NAME']].merge(partsupp[(partsupp['SUPPLYCOST'] <= 259.9908348109857) & (partsupp['AVAILQTY'] <= 8448) & (partsupp['PS_SUPPKEY'] == 2909)], left_on='R_REGIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NAME', 'N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY']].merge(supplier[(supplier['S_ADDRESS'] == 'f') | (supplier['S_COMMENT'] != 'j') & (supplier['S_ADDRESS'] != '4')][['S_COMMENT', 'S_SUPPKEY', 'S_NATIONKEY', 'S_NAME', 'S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

part[['P_PARTKEY', 'P_NAME', 'MFGR', 'SIZE', 'RETAILPRICE']].groupby(by=['RETAILPRICE', 'MFGR']).agg('count')

region[['R_REGIONKEY', 'R_NAME']].merge(nation[(nation['N_NATIONKEY'] < 0)][['N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_REGIONKEY', 'N_NATIONKEY']].merge(region[(region['R_NAME'].str.startswith('ASI'))].merge(nation[['N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME']).agg('mean', numeric_only=True)

lineitem.merge(partsupp[(partsupp['AVAILQTY'] == 7475) | (partsupp['SUPPLYCOST'] > 121.13594135491971) | (partsupp['PS_PARTKEY'] < 7)].merge(lineitem[(lineitem['RETURNFLAG'].isin(['N', 'R'])) | (lineitem['EXTENDEDPRICE'] <= 58421.480559848336) & (lineitem['SHIPDATE'] >= '1992-04-27') & (lineitem['QUANTITY'] > 23)].merge(partsupp[(partsupp['PS_SUPPKEY'] < 5802) | (partsupp['AVAILQTY'] >= 7892)], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem.merge(orders[['CLERK', 'ORDERSTATUS']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['PS_PARTKEY']].merge(part[(part['P_PARTKEY'] <= 181)][['SIZE', 'P_NAME', 'CONTAINER']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['SHIPMODE']).agg('max', numeric_only=True)

region[(region['R_COMMENT'] != 'l') & (region['R_REGIONKEY'] >= 1) | (region['R_NAME'] != 'ASI')][['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation[['N_COMMENT', 'N_NATIONKEY']].merge(supplier[['S_ACCTBAL']], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[(customer['C_ACCTBAL'] <= 203.09389694714196)].merge(nation[['N_REGIONKEY', 'N_COMMENT', 'N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME']).agg('count')

part[['RETAILPRICE', 'BRAND', 'PT_COMMENT', 'SIZE']].merge(orders[(orders['CLERK'].str.startswith('C')) | (orders['SHIPPRIORITY'] > 0) & (orders['ORDERDATE'] == '1992-01-13')].merge(customer.merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[['DISCOUNT', 'L_PARTKEY', 'COMMITDATE', 'SHIPDATE', 'QUANTITY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='P_PARTKEY', right_on='O_ORDERKEY')

lineitem[['TAX']].merge(region, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY').merge(customer[['MKTSEGMENT', 'C_COMMENT', 'C_ACCTBAL', 'C_NATIONKEY', 'C_CUSTKEY']].merge(orders[(orders['SHIPPRIORITY'] < 0)][['ORDERDATE', 'SHIPPRIORITY', 'ORDERPRIORITY', 'ORDERSTATUS']].merge(region, left_on='O_ORDERKEY', right_on='R_REGIONKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY').groupby(by=['TAX']).agg('min', numeric_only=True)

lineitem[(lineitem['RETURNFLAG'] == 'N') & (lineitem['LINESTATUS'] != 'O') | (lineitem['L_COMMENT'] != 'v')].merge(partsupp.merge(part[(part['RETAILPRICE'] > 1003.7734131542054) | (part['BRAND'].isin(['Brand#15', 'Brand#43', 'Brand#23', 'Brand#45', 'Brand#52', 'Brand#12', 'Brand#25', 'Brand#13', 'Brand#44', 'Brand#53', 'Brand#24', 'Brand#42', 'Brand#22', 'Brand#31', 'Brand#54'])) & (part['TYPE'] != 'M') & (part['P_PARTKEY'] >= 165)][['SIZE', 'TYPE']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY')

lineitem[(lineitem['RETURNFLAG'] != 'R') & (lineitem['L_ORDERKEY'] > 97) & (lineitem['EXTENDEDPRICE'] > 86274.29626919697) & (lineitem['RETURNFLAG'].isin(['R']))][['L_SUPPKEY', 'RETURNFLAG', 'EXTENDEDPRICE', 'COMMITDATE', 'L_COMMENT']].merge(partsupp[['SUPPLYCOST', 'PS_PARTKEY', 'AVAILQTY', 'P_COMMENT']].merge(part[['RETAILPRICE', 'PT_COMMENT', 'P_NAME']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['L_COMMENT']).agg('mean', numeric_only=True)

orders[(orders['ORDERPRIORITY'] == '3-MEDIUM')].merge(lineitem[(lineitem['RECEIPTDATE'] >= '1998-11-06') & (lineitem['SHIPINSTRUCT'] == 'DELIVER IN PERSON')][['EXTENDEDPRICE', 'SHIPINSTRUCT']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer.merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['ORDERDATE'] == '1998-07-21') & (orders['O_CUSTKEY'] < 78207) & (orders['O_CUSTKEY'] >= 132057) & (orders['ORDERDATE'] <= '1998-07-21')].merge(customer[(customer['C_COMMENT'].str.startswith('u')) | (customer['C_COMMENT'] == 'a')][['C_CUSTKEY', 'C_NAME', 'C_ADDRESS', 'C_COMMENT']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY')

orders[(orders['ORDERSTATUS'].isin(['F', 'P', 'O'])) & (orders['ORDERPRIORITY'].isin(['3-MEDIUM', '5-LOW', '2-HIGH'])) & (orders['O_CUSTKEY'] < 126431)][['O_COMMENT']].groupby(by=['O_COMMENT']).agg('mean', numeric_only=True)

nation.merge(region[(region['R_COMMENT'] != 'u')], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region.merge(nation[(nation['N_COMMENT'] == 'r') | (nation['N_COMMENT'].str.startswith('r')) & (nation['N_REGIONKEY'] > 2) & (nation['N_REGIONKEY'] > 0)].merge(region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_NAME'] != 'E') | (region['R_NAME'].str.startswith('AME'))][['R_NAME', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY')

part[(part['P_NAME'] != 's') | (part['CONTAINER'] == 'LG') & (part['RETAILPRICE'] < 1038.5804362169495) & (part['SIZE'] == 5)].merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(supplier[(supplier['S_SUPPKEY'] < 58) | (supplier['S_NAME'] != 'S')][['S_PHONE', 'S_NATIONKEY', 'S_ADDRESS', 'S_NAME']].merge(nation[(nation['N_COMMENT'] != 'l') & (nation['N_REGIONKEY'] != 1)][['N_NAME', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[(supplier['S_ADDRESS'] == 'W') | (supplier['S_NAME'] == 'S') & (supplier['S_SUPPKEY'] <= 140)].merge(partsupp[(partsupp['AVAILQTY'] > 9051) | (partsupp['P_COMMENT'] == 'f')][['SUPPLYCOST', 'PS_PARTKEY', 'AVAILQTY', 'P_COMMENT', 'PS_SUPPKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['P_COMMENT', 'SUPPLYCOST', 'AVAILQTY', 'PS_PARTKEY', 'PS_SUPPKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['RETAILPRICE']).agg('count')

customer[(customer['C_NAME'] == 'C') & (customer['C_ADDRESS'] != 'Y')][['C_CUSTKEY']].merge(orders[(orders['ORDERPRIORITY'].isin(['4-NOT SPECIFIED', '5-LOW', '3-MEDIUM', '1-URGENT', '2-HIGH'])) & (orders['ORDERPRIORITY'].isin(['4-NOT SPECIFIED'])) & (orders['ORDERSTATUS'] == 'O')].merge(lineitem[['DISCOUNT', 'L_COMMENT', 'QUANTITY', 'RETURNFLAG', 'SHIPINSTRUCT']].merge(orders, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['ORDERDATE'] == '1998-07-21')].merge(lineitem[['SHIPINSTRUCT', 'RETURNFLAG']].merge(customer[(customer['C_NATIONKEY'] == 8) & (customer['C_CUSTKEY'] == 5) & (customer['C_PHONE'] != '22-') & (customer['C_CUSTKEY'] > 50)][['C_PHONE', 'C_CUSTKEY', 'C_ACCTBAL', 'C_ADDRESS']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem.merge(partsupp[(partsupp['SUPPLYCOST'] < 294.0394363184747) | (partsupp['P_COMMENT'] == 'o')], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['O_COMMENT', 'CLERK', 'SHIPPRIORITY']].merge(region[(region['R_NAME'].str.startswith('ASI')) & (region['R_REGIONKEY'] < 3)], left_on='O_ORDERKEY', right_on='R_REGIONKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_CUSTKEY']).agg('count')

lineitem[(lineitem['SHIPINSTRUCT'] == 'DELIVER IN PERSON') & (lineitem['DISCOUNT'] <= 0.06718345621226512) | (lineitem['SHIPMODE'].isin(['TRUCK', 'RAIL', 'SHIP', 'AIR']))].merge(partsupp[(partsupp['P_COMMENT'].str.startswith('t')) | (partsupp['PS_SUPPKEY'] > 4836) | (partsupp['AVAILQTY'] > 7934) | (partsupp['SUPPLYCOST'] != 942.5041323556742)].merge(lineitem[(lineitem['COMMITDATE'] >= '1992-05-15') | (lineitem['RECEIPTDATE'] == '1992-05-02') | (lineitem['L_PARTKEY'] <= 197447)].merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['DISCOUNT', 'EXTENDEDPRICE']).agg('mean', numeric_only=True)

partsupp.merge(lineitem[(lineitem['RETURNFLAG'] != 'A')][['SHIPINSTRUCT']].merge(region[['R_NAME', 'R_COMMENT', 'R_REGIONKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY').merge(region[(region['R_COMMENT'] != 'g') | (region['R_NAME'] != 'AME')][['R_NAME', 'R_COMMENT']].merge(orders, left_on='R_REGIONKEY', right_on='O_ORDERKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY')

part[(part['RETAILPRICE'] >= 1015.7540218262819)][['SIZE', 'P_NAME', 'BRAND', 'RETAILPRICE', 'PT_COMMENT']].merge(customer[['C_NAME', 'C_ACCTBAL', 'C_PHONE', 'C_NATIONKEY', 'MKTSEGMENT']].merge(nation.merge(supplier[(supplier['S_ACCTBAL'] == 3401.887950455378) & (supplier['S_PHONE'] == '17-') | (supplier['S_SUPPKEY'] < 32) & (supplier['S_ACCTBAL'] >= 8059.433364923182)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NATIONKEY'] > 21) & (nation['N_COMMENT'] == 'l') & (nation['N_COMMENT'].str.startswith('c'))].merge(customer[['MKTSEGMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='P_PARTKEY', right_on='C_CUSTKEY')

partsupp.merge(supplier.merge(nation[(nation['N_COMMENT'] == 'v') | (nation['N_NAME'] != 'F') | (nation['N_NAME'] != 'U') & (nation['N_REGIONKEY'] <= 3)].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_COMMENT', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['PS_PARTKEY', 'PS_SUPPKEY']).agg('min', numeric_only=True)

region[['R_NAME']].groupby(by=['R_NAME']).agg('max', numeric_only=True)

orders[(orders['SHIPPRIORITY'] < 0) | (orders['TOTALPRICE'] > 170196.59748166834) & (orders['O_COMMENT'].str.startswith('q')) | (orders['O_COMMENT'].str.startswith('c'))][['O_CUSTKEY']]

orders[(orders['TOTALPRICE'] != 188323.0714584076) | (orders['ORDERPRIORITY'] == '1-URGENT') | (orders['O_CUSTKEY'] > 129224)].merge(lineitem[(lineitem['LINESTATUS'].isin(['F']))][['L_COMMENT']].merge(customer[['MKTSEGMENT', 'C_CUSTKEY', 'C_ADDRESS']].merge(orders[(orders['O_CUSTKEY'] == 114274) | (orders['TOTALPRICE'] == 155617.58480697917) | (orders['ORDERDATE'] != '1992-01-13') & (orders['CLERK'] == 'C')][['CLERK', 'ORDERDATE', 'ORDERSTATUS']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY').merge(nation[(nation['N_COMMENT'] == 'n')][['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT', 'N_NAME']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[['MKTSEGMENT', 'C_NATIONKEY', 'C_COMMENT', 'C_NAME']].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(supplier[['S_PHONE', 'S_NAME', 'S_COMMENT', 'S_ACCTBAL', 'S_NATIONKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['O_COMMENT']).agg('mean', numeric_only=True)

nation[(nation['N_COMMENT'] != 's') | (nation['N_NATIONKEY'] != 13)].merge(customer[(customer['C_COMMENT'] == 'i') & (customer['C_NATIONKEY'] <= 5)][['C_NATIONKEY', 'MKTSEGMENT', 'C_COMMENT', 'C_CUSTKEY', 'C_ADDRESS']].merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']].merge(customer[(customer['C_NAME'] != 'C') | (customer['MKTSEGMENT'] == 'HOUSEHOLD')][['C_COMMENT', 'C_ACCTBAL']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[(orders['O_COMMENT'].str.startswith('u')) & (orders['ORDERPRIORITY'] != '5-LOW') & (orders['CLERK'].str.startswith('C')) | (orders['CLERK'] == 'C')][['CLERK', 'ORDERDATE', 'O_CUSTKEY', 'TOTALPRICE', 'ORDERSTATUS']].merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_NAME', 'N_COMMENT']).agg('min', numeric_only=True)

orders[['ORDERPRIORITY']].merge(nation[['N_NATIONKEY', 'N_NAME', 'N_REGIONKEY', 'N_COMMENT']].merge(supplier[(supplier['S_SUPPKEY'] <= 26) & (supplier['S_NATIONKEY'] < 19)][['S_NATIONKEY', 'S_COMMENT', 'S_ACCTBAL']].merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='O_ORDERKEY', right_on='N_NATIONKEY').merge(region.merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'].str.startswith('B'))], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='O_ORDERKEY', right_on='R_REGIONKEY').merge(lineitem, left_on='O_ORDERKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'])

lineitem[['LINESTATUS', 'EXTENDEDPRICE', 'SHIPINSTRUCT']]

customer.merge(nation[['N_COMMENT', 'N_NATIONKEY', 'N_NAME', 'N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['ORDERPRIORITY', 'O_ORDERKEY']].merge(lineitem.merge(partsupp[(partsupp['PS_PARTKEY'] != 8)][['PS_SUPPKEY', 'AVAILQTY', 'PS_PARTKEY', 'P_COMMENT', 'SUPPLYCOST']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['SHIPMODE'] == 'REG AIR') & (lineitem['TAX'] < 0.028772919133808143) | (lineitem['EXTENDEDPRICE'] >= 7220.826231558189) | (lineitem['SHIPINSTRUCT'] != 'TAKE BACK RETURN')][['DISCOUNT', 'SHIPINSTRUCT', 'EXTENDEDPRICE']].merge(orders[['CLERK', 'O_CUSTKEY', 'ORDERDATE']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_NAME', 'C_ADDRESS']).agg('max', numeric_only=True)

partsupp.merge(lineitem[(lineitem['RECEIPTDATE'] <= '1992-05-02')][['COMMITDATE']].merge(region[(region['R_NAME'] == 'AFR') & (region['R_COMMENT'].str.startswith('u'))], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').groupby(by=['PS_SUPPKEY', 'PS_PARTKEY']).agg('min', numeric_only=True)

orders[['O_ORDERKEY', 'TOTALPRICE', 'ORDERDATE', 'CLERK', 'SHIPPRIORITY']]

nation.merge(customer[['C_PHONE', 'C_COMMENT', 'MKTSEGMENT', 'C_ADDRESS', 'C_NAME']].merge(part, left_on='C_CUSTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['SHIPINSTRUCT'] == 'NONE') | (lineitem['TAX'] > 0.02214726713251916) & (lineitem['LINENUMBER'] <= 6) | (lineitem['SHIPDATE'] != '1992-04-27')], left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

partsupp[['PS_SUPPKEY', 'P_COMMENT', 'SUPPLYCOST', 'PS_PARTKEY', 'AVAILQTY']].merge(supplier.merge(nation[(nation['N_REGIONKEY'] == 0) | (nation['N_NAME'] == 'F') | (nation['N_REGIONKEY'] > 0)], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[['S_NATIONKEY']].merge(nation[(nation['N_REGIONKEY'] >= 1) & (nation['N_NATIONKEY'] != 8)][['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['PS_SUPPKEY', 'P_COMMENT']).agg('sum', numeric_only=True)

customer[(customer['MKTSEGMENT'] == 'MACHINERY') | (customer['C_CUSTKEY'] > 41)]

customer[['C_NAME', 'C_PHONE', 'C_ACCTBAL', 'C_NATIONKEY', 'MKTSEGMENT']].groupby(by=['C_NATIONKEY']).agg('min', numeric_only=True)

orders[(orders['O_COMMENT'] == '-') | (orders['TOTALPRICE'] == 210165.19724090907)][['ORDERPRIORITY', 'O_ORDERKEY', 'TOTALPRICE', 'ORDERSTATUS', 'SHIPPRIORITY']]

nation[(nation['N_COMMENT'].str.startswith('i'))].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_REGIONKEY'] != 1)][['R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_COMMENT', 'N_NAME']).agg('count')

supplier[['S_PHONE', 'S_NATIONKEY', 'S_SUPPKEY', 'S_ADDRESS']].merge(partsupp[(partsupp['P_COMMENT'].str.startswith('p')) | (partsupp['P_COMMENT'] != 'n') & (partsupp['P_COMMENT'] != 'd')], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation.merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_ADDRESS', 'S_SUPPKEY']).agg('max', numeric_only=True)

supplier[(supplier['S_NATIONKEY'] < 2) | (supplier['S_ACCTBAL'] < -649.8193384507244) & (supplier['S_SUPPKEY'] > 179)][['S_NAME', 'S_SUPPKEY', 'S_COMMENT', 'S_PHONE']]

partsupp[['SUPPLYCOST', 'PS_PARTKEY', 'P_COMMENT', 'AVAILQTY', 'PS_SUPPKEY']].merge(lineitem.merge(partsupp[(partsupp['AVAILQTY'] <= 1418) | (partsupp['PS_SUPPKEY'] == 2151) & (partsupp['PS_SUPPKEY'] >= 4901) & (partsupp['PS_SUPPKEY'] != 2834)], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['SUPPLYCOST', 'PS_SUPPKEY', 'AVAILQTY', 'PS_PARTKEY', 'P_COMMENT']].merge(lineitem[(lineitem['RECEIPTDATE'] < '1992-05-02')][['L_COMMENT', 'SHIPDATE', 'SHIPINSTRUCT']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['DISCOUNT'] >= 0.002744420760280353) & (lineitem['SHIPINSTRUCT'].isin(['DELIVER IN PERSON', 'TAKE BACK RETURN', 'COLLECT COD', 'NONE'])) | (lineitem['L_PARTKEY'] >= 104611)][['L_SUPPKEY']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier[['S_SUPPKEY', 'S_COMMENT', 'S_PHONE']].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['SUPPLYCOST'] == 708.3409080385402) | (partsupp['P_COMMENT'] == '.') & (partsupp['P_COMMENT'] != ';') | (partsupp['P_COMMENT'] != 'v')], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY')

region[(region['R_NAME'].str.startswith('E'))][['R_COMMENT']]

nation.groupby(by=['N_NAME']).agg('max', numeric_only=True)

orders[['O_COMMENT']].merge(part[(part['TYPE'].str.startswith('S')) | (part['BRAND'].isin(['Brand#34', 'Brand#31', 'Brand#23', 'Brand#12']))].merge(partsupp[['PS_SUPPKEY', 'SUPPLYCOST', 'P_COMMENT', 'PS_PARTKEY']].merge(supplier[(supplier['S_COMMENT'] == '!') & (supplier['S_COMMENT'].str.startswith('i')) | (supplier['S_COMMENT'] != 'v')][['S_NAME', 'S_COMMENT', 'S_NATIONKEY', 'S_PHONE', 'S_ADDRESS']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='P_PARTKEY').merge(nation, left_on='O_ORDERKEY', right_on='N_NATIONKEY').merge(lineitem.merge(partsupp.merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'])

nation

partsupp[['PS_SUPPKEY']]

customer.merge(orders[(orders['SHIPPRIORITY'] >= 0)], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[['N_NAME', 'N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_ADDRESS', 'C_PHONE']).agg('sum', numeric_only=True)

region[(region['R_REGIONKEY'] >= 1) & (region['R_COMMENT'] != 'g') & (region['R_REGIONKEY'] <= 3)].merge(nation[['N_NATIONKEY', 'N_COMMENT']].merge(supplier.merge(partsupp[['SUPPLYCOST', 'AVAILQTY', 'PS_PARTKEY', 'PS_SUPPKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[(customer['MKTSEGMENT'] != 'FURNITURE') | (customer['C_COMMENT'] != 'c')].merge(orders[(orders['O_CUSTKEY'] != 37945) | (orders['ORDERSTATUS'] == 'P')], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NATIONKEY', 'N_COMMENT']].merge(supplier.merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[(supplier['S_ACCTBAL'] >= 8697.069791274667) | (supplier['S_NATIONKEY'] != 9) & (supplier['S_ACCTBAL'] <= 5475.517532300966)][['S_NAME']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] == 0) & (nation['N_COMMENT'].str.startswith('u')) & (nation['N_COMMENT'] == 'y')], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

supplier[(supplier['S_COMMENT'] == 'r') | (supplier['S_SUPPKEY'] == 160)][['S_PHONE', 'S_ADDRESS']].merge(orders[(orders['SHIPPRIORITY'] < 0) | (orders['CLERK'] != 'C') | (orders['ORDERPRIORITY'] == '4-NOT SPECIFIED')].merge(customer[(customer['MKTSEGMENT'].isin(['HOUSEHOLD', 'MACHINERY', 'FURNITURE'])) & (customer['C_ACCTBAL'] <= 6986.40243350965)], left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='S_SUPPKEY', right_on='O_ORDERKEY').merge(lineitem[['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY', 'SHIPMODE', 'L_COMMENT']].merge(partsupp[(partsupp['SUPPLYCOST'] <= 142.72221241153167) | (partsupp['P_COMMENT'].str.startswith('t'))], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] > 5649) & (partsupp['SUPPLYCOST'] != 747.8809966454843) | (partsupp['P_COMMENT'] != 'o') | (partsupp['SUPPLYCOST'] < 347.37821434888383)].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(nation[(nation['N_REGIONKEY'] == 0)].merge(supplier[(supplier['S_PHONE'] == '26-') | (supplier['S_ADDRESS'] == '4') | (supplier['S_NATIONKEY'] <= 8) | (supplier['S_SUPPKEY'] != 85)].merge(nation[(nation['N_NAME'].str.startswith('P'))], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[['MKTSEGMENT', 'C_ACCTBAL']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_SUPPKEY', right_on='N_NATIONKEY')

region.merge(nation[(nation['N_NAME'] == 'I') & (nation['N_COMMENT'] == 'y')].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'].str.startswith('p'))].merge(region.merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

partsupp[(partsupp['PS_PARTKEY'] == 17)].groupby(by=['P_COMMENT', 'AVAILQTY']).agg('max', numeric_only=True)

customer[(customer['C_ACCTBAL'] > 1124.1153387213376) | (customer['MKTSEGMENT'] != 'HOUSEHOLD')].merge(nation[(nation['N_COMMENT'].str.startswith('v')) & (nation['N_NATIONKEY'] == 21) | (nation['N_NATIONKEY'] >= 14)], left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_CUSTKEY', 'C_ADDRESS']).agg('sum', numeric_only=True)

region[(region['R_NAME'] != 'M') & (region['R_REGIONKEY'] != 2) & (region['R_REGIONKEY'] != 3)].groupby(by=['R_NAME', 'R_COMMENT']).agg('sum', numeric_only=True)

lineitem[['L_COMMENT']].merge(nation.merge(supplier.merge(nation[(nation['N_COMMENT'] == 'r') | (nation['N_COMMENT'].str.startswith('c')) & (nation['N_REGIONKEY'] == 2) & (nation['N_NAME'] != 'V')], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY').groupby(by=['L_COMMENT']).agg('min', numeric_only=True)

supplier[(supplier['S_ADDRESS'] == 'h') | (supplier['S_NATIONKEY'] > 23) & (supplier['S_ADDRESS'] != 'L') & (supplier['S_ADDRESS'] != 'B')][['S_COMMENT', 'S_NATIONKEY', 'S_SUPPKEY', 'S_ACCTBAL', 'S_ADDRESS']]

partsupp[(partsupp['AVAILQTY'] <= 9287) & (partsupp['PS_PARTKEY'] > 5) | (partsupp['P_COMMENT'].str.startswith('o'))].merge(lineitem[['SHIPMODE', 'SHIPDATE', 'RECEIPTDATE', 'EXTENDEDPRICE', 'QUANTITY']].merge(region[(region['R_COMMENT'].str.startswith('l')) & (region['R_COMMENT'].str.startswith('l'))][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[['RETAILPRICE', 'P_NAME', 'SIZE', 'PT_COMMENT', 'TYPE']].merge(orders[['SHIPPRIORITY', 'ORDERPRIORITY']].merge(nation[(nation['N_NATIONKEY'] <= 18) | (nation['N_NATIONKEY'] < 22) | (nation['N_NAME'] != 'K')], left_on='O_ORDERKEY', right_on='N_NATIONKEY'), left_on='P_PARTKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['RECEIPTDATE'] <= '1998-11-06') | (lineitem['LINESTATUS'] != 'F') | (lineitem['LINESTATUS'].isin(['O', 'F'])) & (lineitem['RECEIPTDATE'] < '1998-11-06')][['SHIPMODE']].merge(partsupp.merge(supplier[['S_ACCTBAL', 'S_NATIONKEY', 'S_ADDRESS', 'S_COMMENT', 'S_PHONE']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(customer[(customer['C_CUSTKEY'] != 14)], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').groupby(by=['P_COMMENT', 'PS_SUPPKEY']).agg('sum', numeric_only=True)

partsupp[['SUPPLYCOST']].merge(supplier[['S_ADDRESS', 'S_PHONE']].merge(lineitem[(lineitem['RECEIPTDATE'] >= '1998-11-06') & (lineitem['RETURNFLAG'] != 'R') | (lineitem['QUANTITY'] <= 33) & (lineitem['SHIPINSTRUCT'] != 'TAKE BACK RETURN')].merge(partsupp[['P_COMMENT', 'PS_PARTKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='S_SUPPKEY')

nation[['N_NATIONKEY']].groupby(by=['N_NATIONKEY']).agg('mean', numeric_only=True)

lineitem[(lineitem['L_SUPPKEY'] != 237) | (lineitem['L_COMMENT'] != ' re') & (lineitem['SHIPDATE'] != '1992-04-27') | (lineitem['L_ORDERKEY'] < 151)][['LINENUMBER', 'L_PARTKEY', 'DISCOUNT', 'COMMITDATE']].groupby(by=['DISCOUNT', 'LINENUMBER']).agg('sum', numeric_only=True)

nation[(nation['N_NAME'].str.startswith('C')) & (nation['N_NATIONKEY'] >= 23) & (nation['N_COMMENT'].str.startswith('n'))][['N_NATIONKEY', 'N_COMMENT', 'N_NAME', 'N_REGIONKEY']].merge(supplier[(supplier['S_SUPPKEY'] == 191)], left_on='N_NATIONKEY', right_on='S_NATIONKEY')

partsupp.groupby(by=['P_COMMENT']).agg('sum', numeric_only=True)

orders[(orders['CLERK'] == 'C')][['TOTALPRICE', 'O_ORDERKEY', 'SHIPPRIORITY', 'ORDERSTATUS']].merge(lineitem[(lineitem['L_COMMENT'] == 'i') & (lineitem['L_PARTKEY'] >= 187442) & (lineitem['L_COMMENT'] == 's. ') | (lineitem['QUANTITY'] < 27)][['SHIPINSTRUCT']].merge(partsupp[['AVAILQTY', 'PS_SUPPKEY', 'SUPPLYCOST', 'PS_PARTKEY', 'P_COMMENT']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(region[['R_NAME', 'R_REGIONKEY', 'R_COMMENT']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[['L_COMMENT', 'L_ORDERKEY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[['SHIPMODE', 'SHIPDATE', 'RECEIPTDATE', 'RETURNFLAG']].merge(partsupp[['SUPPLYCOST', 'PS_PARTKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(part[['CONTAINER', 'P_PARTKEY', 'PT_COMMENT', 'MFGR']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['O_ORDERKEY', 'SHIPPRIORITY']).agg('count')

partsupp[(partsupp['PS_SUPPKEY'] < 5590) & (partsupp['PS_SUPPKEY'] >= 1685)].merge(lineitem[(lineitem['SHIPMODE'] == 'AIR') & (lineitem['EXTENDEDPRICE'] != 7266.711388298558)][['LINESTATUS', 'LINENUMBER']].merge(nation[(nation['N_COMMENT'].str.startswith('v')) | (nation['N_COMMENT'].str.startswith('p')) | (nation['N_NATIONKEY'] >= 17)][['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']].merge(supplier[['S_ACCTBAL', 'S_SUPPKEY', 'S_NAME']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[['EXTENDEDPRICE', 'LINESTATUS', 'L_PARTKEY']].merge(partsupp[(partsupp['P_COMMENT'] == 't') | (partsupp['AVAILQTY'] == 625) & (partsupp['SUPPLYCOST'] != 741.7873640355542)][['AVAILQTY', 'PS_SUPPKEY', 'SUPPLYCOST']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(part[(part['CONTAINER'] == 'WRAP') & (part['MFGR'] != 'Manufacturer#4') | (part['BRAND'] != 'Brand#53') | (part['TYPE'] == 'SMA')].merge(partsupp[['SUPPLYCOST', 'PS_SUPPKEY', 'PS_PARTKEY']].merge(lineitem[(lineitem['TAX'] >= 0.008483437600804073)][['RECEIPTDATE', 'TAX', 'SHIPMODE']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_SUPPKEY', 'SUPPLYCOST', 'AVAILQTY', 'P_COMMENT']].merge(supplier[(supplier['S_NATIONKEY'] <= 7) & (supplier['S_NATIONKEY'] > 16)][['S_SUPPKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY')

partsupp

part[(part['P_NAME'] == 'lin') & (part['P_PARTKEY'] < 9) | (part['TYPE'] != 'P') & (part['RETAILPRICE'] != 992.0197199223466)].merge(partsupp[(partsupp['PS_PARTKEY'] > 33)].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

customer[['MKTSEGMENT', 'C_NATIONKEY']].merge(nation[['N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY', 'N_NAME']].merge(supplier[['S_NATIONKEY', 'S_PHONE', 'S_COMMENT', 'S_ADDRESS', 'S_NAME']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

customer[(customer['C_CUSTKEY'] != 82) | (customer['C_ACCTBAL'] <= 2519.7519910677743) | (customer['C_NATIONKEY'] != 3) & (customer['C_ADDRESS'] != 'K')].merge(nation[(nation['N_NATIONKEY'] < 22) | (nation['N_NAME'] == 'V') | (nation['N_COMMENT'].str.startswith('o'))], left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_NAME']).agg('mean', numeric_only=True)

nation[(nation['N_NATIONKEY'] > 17) & (nation['N_NATIONKEY'] == 21) | (nation['N_COMMENT'] != 'i')][['N_NAME']].merge(region[['R_NAME']].merge(part[(part['PT_COMMENT'] == 'n') | (part['BRAND'].isin(['Brand#13', 'Brand#53', 'Brand#52', 'Brand#23', 'Brand#11', 'Brand#54', 'Brand#31', 'Brand#21', 'Brand#14', 'Brand#55', 'Brand#51', 'Brand#25', 'Brand#45', 'Brand#42', 'Brand#41', 'Brand#32', 'Brand#44', 'Brand#12', 'Brand#34'])) & (part['RETAILPRICE'] != 983.6021039440307) | (part['TYPE'] == 'SMA')].merge(partsupp[(partsupp['SUPPLYCOST'] == 551.3764555183287)][['SUPPLYCOST', 'PS_PARTKEY', 'PS_SUPPKEY', 'AVAILQTY', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='R_REGIONKEY', right_on='P_PARTKEY').merge(customer[['C_ADDRESS', 'C_NATIONKEY']].merge(nation[(nation['N_REGIONKEY'] > 0) | (nation['N_NAME'].str.startswith('U')) | (nation['N_REGIONKEY'] != 0) | (nation['N_NAME'].str.startswith('K'))][['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='R_REGIONKEY', right_on='C_CUSTKEY'), left_on='N_NATIONKEY', right_on='R_REGIONKEY').merge(lineitem[['RECEIPTDATE', 'LINENUMBER', 'EXTENDEDPRICE', 'SHIPINSTRUCT', 'QUANTITY']], left_on='N_NATIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'])

lineitem[(lineitem['LINENUMBER'] >= 5) & (lineitem['DISCOUNT'] == 0.08393851104738864) & (lineitem['L_SUPPKEY'] >= 9653)].merge(partsupp.merge(part.merge(partsupp[(partsupp['PS_PARTKEY'] == 19)], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(supplier[['S_SUPPKEY', 'S_NATIONKEY', 'S_COMMENT', 'S_PHONE']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['COMMITDATE']).agg('min', numeric_only=True)

nation[(nation['N_NAME'] == 'G') & (nation['N_REGIONKEY'] <= 1) | (nation['N_REGIONKEY'] <= 2) & (nation['N_REGIONKEY'] == 2)].merge(region[(region['R_COMMENT'].str.startswith('u'))][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation[['N_REGIONKEY']].merge(region[(region['R_REGIONKEY'] <= 0) & (region['R_COMMENT'] == 'h') & (region['R_REGIONKEY'] >= 1) | (region['R_NAME'].str.startswith('A'))][['R_COMMENT', 'R_REGIONKEY', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[['C_NAME']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_REGIONKEY', 'N_COMMENT']).agg('min', numeric_only=True)

lineitem[(lineitem['RETURNFLAG'].isin(['A', 'R'])) | (lineitem['LINENUMBER'] > 6)].merge(orders[['CLERK', 'O_ORDERKEY', 'ORDERDATE']].merge(lineitem[(lineitem['EXTENDEDPRICE'] == 59780.836393703794) & (lineitem['QUANTITY'] == 16)], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] != 5491) & (partsupp['PS_PARTKEY'] > 31) | (partsupp['SUPPLYCOST'] < 232.37101182355664) | (partsupp['SUPPLYCOST'] != 698.5663491451477)][['SUPPLYCOST']].merge(part[(part['RETAILPRICE'] < 968.7807471922576)][['P_NAME']].merge(lineitem[(lineitem['SHIPDATE'] > '1992-04-27') | (lineitem['L_PARTKEY'] < 141676) & (lineitem['TAX'] >= 0.027389877638011272)], left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['SHIPMODE', 'SHIPINSTRUCT']).agg('max', numeric_only=True)

supplier[['S_ACCTBAL']].merge(nation[(nation['N_NATIONKEY'] < 22) & (nation['N_REGIONKEY'] < 0) & (nation['N_NATIONKEY'] == 19)][['N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY', 'N_NAME']].merge(region[(region['R_COMMENT'] != 'g') & (region['R_NAME'].str.startswith('ASI')) | (region['R_COMMENT'].str.startswith('u')) | (region['R_REGIONKEY'] >= 3)], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_SUPPKEY', right_on='N_NATIONKEY').merge(lineitem.merge(partsupp.merge(lineitem[['QUANTITY']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['AVAILQTY'] > 2466)][['AVAILQTY', 'PS_PARTKEY']].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).groupby(by=['S_ACCTBAL']).agg('mean', numeric_only=True)

supplier

partsupp.merge(supplier[['S_COMMENT', 'S_ADDRESS', 'S_ACCTBAL']].merge(region[(region['R_NAME'] != 'AFR') & (region['R_COMMENT'] == 'l') | (region['R_NAME'] == 'AFR')].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='S_SUPPKEY', right_on='R_REGIONKEY').merge(lineitem[['SHIPDATE']], left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='PS_SUPPKEY', right_on='S_SUPPKEY')

partsupp.merge(part[['RETAILPRICE', 'PT_COMMENT', 'BRAND']], left_on='PS_PARTKEY', right_on='P_PARTKEY')

orders[(orders['O_CUSTKEY'] >= 117484)][['O_CUSTKEY', 'ORDERSTATUS']].merge(customer[['C_PHONE', 'C_CUSTKEY', 'C_NATIONKEY', 'MKTSEGMENT']], left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['O_CUSTKEY', 'ORDERSTATUS']).agg('sum', numeric_only=True)

lineitem[(lineitem['COMMITDATE'] > '1998-10-16') & (lineitem['LINESTATUS'] != 'F') & (lineitem['L_SUPPKEY'] == 8430) | (lineitem['DISCOUNT'] != 0.017054559758803555)][['L_PARTKEY', 'RECEIPTDATE', 'COMMITDATE', 'LINESTATUS', 'L_SUPPKEY']].groupby(by=['LINESTATUS', 'RECEIPTDATE']).agg('mean', numeric_only=True)

nation[(nation['N_NATIONKEY'] < 19) & (nation['N_REGIONKEY'] >= 1)][['N_NAME']].merge(partsupp[['PS_SUPPKEY']].merge(supplier[(supplier['S_NATIONKEY'] >= 1) | (supplier['S_NAME'].str.startswith('S')) & (supplier['S_NAME'] == 'S')].merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='N_NATIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(customer[['C_NAME']].merge(nation, left_on='C_CUSTKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_CUSTKEY')

orders[(orders['SHIPPRIORITY'] == 0) | (orders['ORDERSTATUS'] != 'P') | (orders['SHIPPRIORITY'] != 0)].merge(customer[(customer['C_NATIONKEY'] <= 19) | (customer['C_NATIONKEY'] > 8)].merge(orders[['O_CUSTKEY', 'CLERK']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['SHIPPRIORITY', 'CLERK', 'O_COMMENT', 'ORDERSTATUS']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['O_ORDERKEY']).agg('sum', numeric_only=True)

supplier[(supplier['S_PHONE'] != '17-')][['S_NATIONKEY', 'S_ACCTBAL']].merge(nation[(nation['N_REGIONKEY'] >= 1) | (nation['N_NAME'] != 'U') | (nation['N_NAME'] != 'B') & (nation['N_COMMENT'] == ' ')][['N_NAME', 'N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_COMMENT'].str.startswith('r'))][['N_COMMENT']].merge(region[(region['R_NAME'] == 'ASI') & (region['R_REGIONKEY'] <= 0)][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']], left_on='N_NATIONKEY', right_on='R_REGIONKEY').merge(region.merge(nation[(nation['N_COMMENT'] == ' ') & (nation['N_REGIONKEY'] == 2) | (nation['N_COMMENT'] != 'p') & (nation['N_NATIONKEY'] != 20)][['N_NATIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_NATIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_ACCTBAL']).agg('count')

region[(region['R_COMMENT'] == 'g') | (region['R_COMMENT'] == 'u') | (region['R_REGIONKEY'] != 1)][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].groupby(by=['R_COMMENT']).agg('count')

customer.merge(orders[(orders['ORDERSTATUS'].isin(['P'])) & (orders['CLERK'] == 'C')].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[['DISCOUNT', 'SHIPINSTRUCT', 'L_COMMENT', 'SHIPDATE', 'L_SUPPKEY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['TOTALPRICE'] > 244662.53648709337) | (orders['ORDERSTATUS'] == 'F')][['ORDERPRIORITY']].merge(customer[(customer['C_PHONE'] == '1') | (customer['C_COMMENT'] == 'w') & (customer['C_NAME'].str.startswith('C'))], left_on='O_ORDERKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['O_CUSTKEY'] <= 104880)][['ORDERPRIORITY']].merge(lineitem[['TAX', 'LINENUMBER', 'L_COMMENT', 'DISCOUNT', 'RECEIPTDATE']], left_on='O_ORDERKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

customer[(customer['C_NATIONKEY'] < 12)]

region[(region['R_REGIONKEY'] > 1)]

lineitem[['SHIPINSTRUCT', 'QUANTITY', 'RECEIPTDATE', 'TAX']].merge(partsupp[(partsupp['P_COMMENT'] == 'are') | (partsupp['PS_SUPPKEY'] <= 958)].merge(lineitem[(lineitem['COMMITDATE'] >= '1998-10-16')].merge(orders[(orders['ORDERDATE'] >= '1998-07-21') | (orders['O_ORDERKEY'] >= 434) | (orders['CLERK'] != 'C') & (orders['ORDERSTATUS'] == 'O')][['O_CUSTKEY', 'CLERK', 'TOTALPRICE', 'SHIPPRIORITY', 'ORDERDATE']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(part[['MFGR', 'P_NAME']].merge(supplier[['S_ACCTBAL', 'S_SUPPKEY']], left_on='P_PARTKEY', right_on='S_SUPPKEY').merge(region[(region['R_REGIONKEY'] == 2) & (region['R_COMMENT'] == 'u')][['R_NAME']], left_on='P_PARTKEY', right_on='R_REGIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY')

lineitem[(lineitem['SHIPMODE'] != 'AIR') & (lineitem['SHIPMODE'].isin(['FOB', 'AIR', 'REG AIR', 'RAIL', 'MAIL', 'TRUCK'])) | (lineitem['EXTENDEDPRICE'] >= 38382.55184080368)][['L_PARTKEY', 'SHIPINSTRUCT', 'EXTENDEDPRICE', 'RETURNFLAG', 'LINENUMBER']].merge(partsupp[['PS_SUPPKEY', 'AVAILQTY', 'SUPPLYCOST', 'PS_PARTKEY', 'P_COMMENT']].merge(lineitem[(lineitem['SHIPDATE'] < '1992-04-27') & (lineitem['EXTENDEDPRICE'] >= 54152.28287316176) | (lineitem['SHIPDATE'] < '1998-10-30') | (lineitem['RETURNFLAG'].isin(['N', 'R']))].merge(orders[(orders['SHIPPRIORITY'] > 0) | (orders['CLERK'] != 'C')], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier[(supplier['S_ACCTBAL'] < 5969.660904557947) & (supplier['S_ACCTBAL'] <= 7127.718062276694)][['S_ACCTBAL', 'S_PHONE']].merge(part[(part['MFGR'] == 'Manufacturer#5')][['PT_COMMENT', 'RETAILPRICE', 'SIZE']], left_on='S_SUPPKEY', right_on='P_PARTKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY')

nation[(nation['N_NATIONKEY'] == 11) & (nation['N_NAME'] != 'S')].merge(supplier[(supplier['S_COMMENT'].str.startswith('s')) & (supplier['S_PHONE'] != '2')].merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_COMMENT']).agg('mean', numeric_only=True)

nation[(nation['N_NAME'].str.startswith('V'))].merge(customer[(customer['C_CUSTKEY'] == 49) & (customer['MKTSEGMENT'].isin(['FURNITURE', 'AUTOMOBILE', 'HOUSEHOLD', 'MACHINERY', 'BUILDING']))][['MKTSEGMENT', 'C_ADDRESS']].merge(part.merge(partsupp[(partsupp['PS_PARTKEY'] > 21) & (partsupp['SUPPLYCOST'] <= 995.2171878659502)], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='C_CUSTKEY', right_on='P_PARTKEY').merge(lineitem.merge(partsupp[(partsupp['P_COMMENT'] != 'b') | (partsupp['P_COMMENT'] == ';')], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_REGIONKEY']).agg('min', numeric_only=True)

part[(part['BRAND'].isin(['Brand#44', 'Brand#25', 'Brand#52', 'Brand#34']))].merge(partsupp[['SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT', 'PS_PARTKEY', 'AVAILQTY']], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['SUPPLYCOST', 'PS_PARTKEY', 'P_COMMENT', 'PS_SUPPKEY']].merge(part[['TYPE', 'MFGR']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_PARTKEY', 'AVAILQTY', 'SUPPLYCOST', 'PS_SUPPKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['TYPE', 'PT_COMMENT']).agg('count')

region[(region['R_REGIONKEY'] == 1) | (region['R_COMMENT'].str.startswith('h')) & (region['R_REGIONKEY'] <= 2)][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_NATIONKEY'] >= 3) & (nation['N_REGIONKEY'] >= 2)][['N_REGIONKEY', 'N_NAME', 'N_NATIONKEY', 'N_COMMENT']].merge(supplier[['S_NATIONKEY', 'S_PHONE', 'S_SUPPKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] >= 22) & (nation['N_COMMENT'] != 'c') | (nation['N_NATIONKEY'] <= 3)][['N_NAME', 'N_NATIONKEY']].merge(customer[['C_CUSTKEY', 'MKTSEGMENT', 'C_COMMENT', 'C_NAME']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[(customer['C_NATIONKEY'] > 16) & (customer['C_NATIONKEY'] == 18) | (customer['C_PHONE'] != '25-') | (customer['C_PHONE'].str.startswith('1'))], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME', 'R_COMMENT']).agg('count')

nation[(nation['N_NATIONKEY'] <= 0)]

nation[(nation['N_REGIONKEY'] > 2) | (nation['N_COMMENT'] != 'p') & (nation['N_REGIONKEY'] <= 1)].merge(customer[['C_PHONE', 'C_ACCTBAL']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier.merge(nation[(nation['N_COMMENT'] != 'y') | (nation['N_COMMENT'] == 'h')][['N_REGIONKEY', 'N_NAME', 'N_COMMENT', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_REGIONKEY']).agg('min', numeric_only=True)

nation[(nation['N_COMMENT'].str.startswith('e')) | (nation['N_COMMENT'].str.startswith('e')) | (nation['N_NATIONKEY'] != 12) | (nation['N_REGIONKEY'] == 2)][['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME', 'N_COMMENT']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[(customer['C_CUSTKEY'] >= 3)].merge(nation[(nation['N_NAME'] != 'B') | (nation['N_REGIONKEY'] != 3) | (nation['N_NATIONKEY'] > 16) | (nation['N_REGIONKEY'] > 0)].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_NAME'].str.startswith('S')) & (supplier['S_PHONE'] == '32-')].merge(nation[(nation['N_NATIONKEY'] >= 15)].merge(customer[['C_COMMENT', 'C_NATIONKEY', 'C_PHONE']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_COMMENT', 'N_NAME']).agg('count')

nation[(nation['N_NAME'] != 'R') & (nation['N_REGIONKEY'] < 3) | (nation['N_NATIONKEY'] >= 17) & (nation['N_REGIONKEY'] > 3)][['N_NAME', 'N_NATIONKEY', 'N_COMMENT']].merge(supplier[['S_ACCTBAL', 'S_PHONE']].merge(part[(part['BRAND'] != 'Brand#35')][['MFGR', 'P_PARTKEY', 'CONTAINER', 'RETAILPRICE']], left_on='S_SUPPKEY', right_on='P_PARTKEY').merge(lineitem[['L_PARTKEY', 'COMMITDATE']].merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[(customer['C_NAME'] == 'C') & (customer['C_ACCTBAL'] > 7977.741378796842) | (customer['C_CUSTKEY'] != 28)].merge(nation.merge(customer[(customer['C_ADDRESS'].str.startswith('E')) & (customer['MKTSEGMENT'] == 'MACHINERY')], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(customer[(customer['C_NATIONKEY'] > 17) & (customer['C_PHONE'].str.startswith('2')) & (customer['C_NAME'] != 'C') & (customer['C_ADDRESS'] != 'h')], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

customer[(customer['MKTSEGMENT'].isin(['FURNITURE', 'HOUSEHOLD', 'BUILDING'])) & (customer['MKTSEGMENT'].isin(['BUILDING'])) & (customer['C_NATIONKEY'] > 10) | (customer['C_CUSTKEY'] == 86)][['C_CUSTKEY', 'C_NATIONKEY']].merge(nation[(nation['N_NAME'] == 'G') | (nation['N_REGIONKEY'] < 3) | (nation['N_COMMENT'].str.startswith('o')) & (nation['N_COMMENT'].str.startswith('i'))].merge(supplier.merge(nation[['N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[(orders['ORDERSTATUS'] != 'P') | (orders['O_ORDERKEY'] == 746) | (orders['O_CUSTKEY'] != 25584)], left_on='C_CUSTKEY', right_on='O_CUSTKEY')

part[(part['P_PARTKEY'] == 166) & (part['SIZE'] != 3)]

orders[['ORDERSTATUS', 'ORDERPRIORITY', 'SHIPPRIORITY', 'O_COMMENT', 'O_ORDERKEY']].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['TAX'] == 0.03836353641417674) | (lineitem['SHIPMODE'] == 'RAIL')][['LINENUMBER', 'L_ORDERKEY', 'COMMITDATE', 'EXTENDEDPRICE']].merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['O_ORDERKEY'] >= 20) | (orders['TOTALPRICE'] > 17382.3392111879)].merge(customer[(customer['C_CUSTKEY'] > 91)], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['EXTENDEDPRICE'] <= 30249.26748425935)].merge(partsupp[(partsupp['P_COMMENT'] != ' ') | (partsupp['AVAILQTY'] == 9529) & (partsupp['P_COMMENT'].str.startswith('h'))][['P_COMMENT', 'AVAILQTY']].merge(part[(part['P_PARTKEY'] > 48)], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY')

supplier.merge(nation[(nation['N_REGIONKEY'] <= 2) & (nation['N_REGIONKEY'] != 0) | (nation['N_REGIONKEY'] != 2)].merge(region[(region['R_COMMENT'].str.startswith('h')) & (region['R_COMMENT'] != 'l') & (region['R_COMMENT'] != 'h') & (region['R_REGIONKEY'] > 0)][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(supplier.merge(partsupp[(partsupp['SUPPLYCOST'] > 807.0050629633536) | (partsupp['PS_SUPPKEY'] == 7297) & (partsupp['PS_SUPPKEY'] < 1961) & (partsupp['PS_SUPPKEY'] != 2897)][['PS_SUPPKEY', 'PS_PARTKEY', 'P_COMMENT', 'SUPPLYCOST']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_REGIONKEY'] <= 1) | (nation['N_NAME'].str.startswith('K')) | (nation['N_NAME'].str.startswith('I')) | (nation['N_NATIONKEY'] >= 8)].merge(region[(region['R_NAME'] == 'M') & (region['R_COMMENT'] == 'h') & (region['R_COMMENT'].str.startswith('h')) & (region['R_REGIONKEY'] < 0)][['R_NAME', 'R_COMMENT', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_NATIONKEY']).agg('mean', numeric_only=True)

nation[(nation['N_COMMENT'].str.startswith('s')) & (nation['N_COMMENT'] == 'h')].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[(supplier['S_COMMENT'].str.startswith('y')) & (supplier['S_ADDRESS'] == 'D')], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[(supplier['S_NAME'] != 'S') & (supplier['S_PHONE'].str.startswith('17-'))].merge(partsupp[(partsupp['PS_SUPPKEY'] >= 7456) & (partsupp['P_COMMENT'] == 'e') & (partsupp['PS_PARTKEY'] == 30)][['PS_SUPPKEY', 'AVAILQTY', 'P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_NATIONKEY'] < 1) & (nation['N_REGIONKEY'] <= 2)].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY')

region[(region['R_COMMENT'] != 'g') | (region['R_REGIONKEY'] > 0) | (region['R_REGIONKEY'] >= 2)].merge(nation.merge(supplier[(supplier['S_PHONE'].str.startswith('26-')) & (supplier['S_COMMENT'] != 'h')].merge(nation[(nation['N_NAME'].str.startswith('C'))][['N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

nation[['N_NATIONKEY']]

nation.merge(customer[['C_PHONE', 'C_COMMENT', 'C_NATIONKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_NATIONKEY']).agg('mean', numeric_only=True)

supplier[['S_COMMENT', 'S_ADDRESS']].merge(customer[(customer['C_ADDRESS'] != 'u') | (customer['C_ACCTBAL'] >= 4421.6924207677075)][['C_COMMENT', 'C_NATIONKEY', 'MKTSEGMENT', 'C_ADDRESS', 'C_CUSTKEY']].merge(nation[(nation['N_NATIONKEY'] < 18) | (nation['N_NAME'] == 'U') & (nation['N_NATIONKEY'] >= 19) & (nation['N_NATIONKEY'] != 10)][['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='S_SUPPKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_NAME'] != 'C')], left_on='S_SUPPKEY', right_on='C_CUSTKEY').merge(partsupp[(partsupp['AVAILQTY'] <= 7437) | (partsupp['SUPPLYCOST'] < 869.0762599587496)].merge(lineitem[(lineitem['LINENUMBER'] != 1) | (lineitem['L_SUPPKEY'] != 334) | (lineitem['RECEIPTDATE'] <= '1998-11-06')][['LINENUMBER']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY'])

orders.merge(lineitem[['LINENUMBER', 'SHIPINSTRUCT']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_ADDRESS'] != 'H')], left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['ORDERSTATUS']).agg('max', numeric_only=True)

part.merge(partsupp[(partsupp['P_COMMENT'].str.startswith('p')) | (partsupp['AVAILQTY'] >= 8261) | (partsupp['P_COMMENT'] != ';') | (partsupp['P_COMMENT'] != 'i')][['SUPPLYCOST', 'P_COMMENT', 'PS_SUPPKEY', 'PS_PARTKEY', 'AVAILQTY']].merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(part[(part['SIZE'] >= 29) & (part['P_NAME'] != 'cor') & (part['SIZE'] >= 20)].merge(partsupp[(partsupp['P_COMMENT'] == 'l')], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_PARTKEY'] == 3) | (partsupp['P_COMMENT'] != 'l') | (partsupp['P_COMMENT'] != 'c') | (partsupp['SUPPLYCOST'] == 871.3358268536351)], left_on='P_PARTKEY', right_on='PS_PARTKEY')

region[(region['R_REGIONKEY'] > 2) & (region['R_NAME'] == 'AME') | (region['R_REGIONKEY'] < 1) | (region['R_COMMENT'] == 'g')].merge(nation[(nation['N_COMMENT'].str.startswith('y')) | (nation['N_NATIONKEY'] != 5)].merge(region[['R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_REGIONKEY'] != 3) | (nation['N_NAME'].str.startswith('S')) & (nation['N_NATIONKEY'] >= 8) | (nation['N_COMMENT'] != 'r')][['N_REGIONKEY', 'N_NAME', 'N_NATIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT', 'R_NAME']).agg('sum', numeric_only=True)

region[(region['R_REGIONKEY'] != 0) & (region['R_COMMENT'] == 'h')][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].merge(nation[['N_NAME']].merge(orders[['ORDERDATE', 'CLERK', 'SHIPPRIORITY', 'O_ORDERKEY']].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='N_NATIONKEY', right_on='O_ORDERKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(customer[(customer['C_ADDRESS'] == 'l') & (customer['C_NAME'] == 'C') | (customer['C_NATIONKEY'] > 9) & (customer['C_NATIONKEY'] >= 8)].merge(nation[['N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] < 0)][['N_NAME', 'N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY']].merge(customer.merge(orders[['ORDERPRIORITY', 'ORDERSTATUS', 'SHIPPRIORITY', 'CLERK', 'O_COMMENT']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_COMMENT'] != 'u') & (region['R_COMMENT'] != 'g') | (region['R_REGIONKEY'] > 2)].merge(nation[['N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT']).agg('count')

supplier.groupby(by=['S_NAME']).agg('mean', numeric_only=True)

part.merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'].str.startswith('bli')) & (partsupp['PS_SUPPKEY'] != 4088) | (partsupp['P_COMMENT'] == 'bli') & (partsupp['PS_SUPPKEY'] == 5228)][['SUPPLYCOST', 'AVAILQTY', 'P_COMMENT', 'PS_SUPPKEY', 'PS_PARTKEY']].merge(supplier[(supplier['S_NAME'].str.startswith('S'))].merge(partsupp[['PS_PARTKEY', 'P_COMMENT', 'SUPPLYCOST', 'PS_SUPPKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_SUPPKEY', 'PS_PARTKEY', 'SUPPLYCOST']].merge(lineitem[(lineitem['L_COMMENT'].str.startswith('i')) | (lineitem['SHIPMODE'] != 'MAIL')][['LINESTATUS', 'LINENUMBER', 'SHIPINSTRUCT', 'SHIPMODE']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['CONTAINER']).agg('mean', numeric_only=True)

nation[(nation['N_REGIONKEY'] != 2) & (nation['N_REGIONKEY'] >= 3)][['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']]

partsupp[(partsupp['AVAILQTY'] > 8164) & (partsupp['AVAILQTY'] != 2030) & (partsupp['P_COMMENT'].str.startswith('n'))][['PS_PARTKEY']].merge(lineitem[(lineitem['LINENUMBER'] == 2) | (lineitem['LINENUMBER'] == 6) & (lineitem['SHIPDATE'] < '1992-04-27')].merge(orders[(orders['O_CUSTKEY'] != 32693)].merge(lineitem[['TAX']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[['P_COMMENT', 'PS_PARTKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').groupby(by=['PS_PARTKEY']).agg('max', numeric_only=True)

supplier[(supplier['S_ACCTBAL'] >= 1819.7235384133653) | (supplier['S_PHONE'] != '14-')].groupby(by=['S_COMMENT']).agg('min', numeric_only=True)

lineitem.groupby(by=['L_ORDERKEY']).agg('count')

partsupp[['PS_PARTKEY', 'P_COMMENT', 'PS_SUPPKEY', 'AVAILQTY']].merge(lineitem.merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').groupby(by=['AVAILQTY']).agg('count')

partsupp[(partsupp['AVAILQTY'] <= 8039) | (partsupp['P_COMMENT'] != 'are') & (partsupp['SUPPLYCOST'] >= 431.9437211902959) | (partsupp['P_COMMENT'].str.startswith('e'))].merge(lineitem[['LINESTATUS']].merge(partsupp[['SUPPLYCOST']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(part[(part['SIZE'] > 9)][['CONTAINER', 'SIZE', 'TYPE']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY')

partsupp[(partsupp['PS_SUPPKEY'] != 903) & (partsupp['AVAILQTY'] != 8667)].merge(part.merge(partsupp[(partsupp['PS_PARTKEY'] == 45) | (partsupp['PS_PARTKEY'] < 34)].merge(part[['P_PARTKEY', 'SIZE', 'PT_COMMENT', 'CONTAINER', 'BRAND']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[(part['MFGR'].isin(['Manufacturer#4', 'Manufacturer#2', 'Manufacturer#1', 'Manufacturer#3'])) | (part['BRAND'] == 'Brand#44') | (part['TYPE'].str.startswith('P'))][['BRAND', 'SIZE', 'CONTAINER']].merge(nation[(nation['N_COMMENT'].str.startswith('h')) | (nation['N_NATIONKEY'] != 7) & (nation['N_NATIONKEY'] > 17)][['N_NAME']], left_on='P_PARTKEY', right_on='N_NATIONKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['L_COMMENT'] == 'k') & (lineitem['EXTENDEDPRICE'] >= 9854.083607135302) & (lineitem['TAX'] <= 0.009783032886194044) | (lineitem['TAX'] >= 0.06908162950626456)].merge(orders.merge(customer[(customer['MKTSEGMENT'] != 'FURNITURE')], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY')

lineitem[(lineitem['SHIPINSTRUCT'] == 'DELIVER IN PERSON') | (lineitem['SHIPMODE'].isin(['REG AIR', 'TRUCK', 'FOB'])) | (lineitem['DISCOUNT'] > 0.017174010442510514) & (lineitem['DISCOUNT'] <= 0.05030087535562179)][['SHIPMODE', 'EXTENDEDPRICE']]

partsupp[['SUPPLYCOST', 'AVAILQTY', 'P_COMMENT']].merge(nation[['N_COMMENT', 'N_NAME']].merge(supplier[(supplier['S_NAME'] != 'S') & (supplier['S_COMMENT'] != 'l')][['S_COMMENT', 'S_ACCTBAL']].merge(region[(region['R_REGIONKEY'] != 2) & (region['R_NAME'] != 'ASI') & (region['R_COMMENT'] == 'g')][['R_NAME']], left_on='S_SUPPKEY', right_on='R_REGIONKEY'), left_on='N_NATIONKEY', right_on='S_SUPPKEY').merge(orders[(orders['TOTALPRICE'] <= 87319.91529481851)][['O_CUSTKEY', 'ORDERPRIORITY', 'O_COMMENT', 'TOTALPRICE']], left_on='N_NATIONKEY', right_on='O_ORDERKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY').merge(customer[(customer['C_COMMENT'].str.startswith('f')) & (customer['MKTSEGMENT'] != 'MACHINERY')][['C_CUSTKEY', 'C_PHONE', 'C_NAME', 'C_ADDRESS']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='C_CUSTKEY').merge(lineitem[(lineitem['L_SUPPKEY'] >= 5205)].merge(partsupp.merge(part[(part['PT_COMMENT'] == 'g') | (part['SIZE'] <= 44)], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(lineitem[(lineitem['L_PARTKEY'] >= 164312) & (lineitem['COMMITDATE'] == '1998-10-16') | (lineitem['QUANTITY'] < 9)][['COMMITDATE']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'])

orders[(orders['CLERK'] == 'C') | (orders['O_CUSTKEY'] == 35832) & (orders['ORDERSTATUS'].isin(['O', 'F', 'P'])) | (orders['O_ORDERKEY'] >= 349)][['TOTALPRICE', 'O_ORDERKEY', 'O_CUSTKEY']].merge(customer[['C_CUSTKEY', 'C_COMMENT', 'C_PHONE', 'C_NATIONKEY', 'MKTSEGMENT']].merge(orders.merge(customer[['C_COMMENT', 'C_NAME', 'C_CUSTKEY', 'C_ADDRESS']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[(lineitem['LINESTATUS'].isin(['O', 'F'])) | (lineitem['COMMITDATE'] != '1998-10-16') & (lineitem['QUANTITY'] <= 17)], left_on='O_ORDERKEY', right_on='L_ORDERKEY')

supplier[(supplier['S_ACCTBAL'] != 5795.55563608026)].merge(nation.merge(region.merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_REGIONKEY'] == 1)], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['SUPPLYCOST'] <= 220.4458307238036) | (partsupp['AVAILQTY'] < 246) & (partsupp['P_COMMENT'] == '.') & (partsupp['P_COMMENT'] == 'i')][['P_COMMENT', 'AVAILQTY', 'PS_PARTKEY', 'PS_SUPPKEY']].merge(supplier[['S_COMMENT', 'S_NAME']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['AVAILQTY'] > 8028) & (partsupp['SUPPLYCOST'] < 874.9030906357298) & (partsupp['SUPPLYCOST'] <= 315.5488757581982) | (partsupp['PS_SUPPKEY'] <= 6803)].merge(lineitem[(lineitem['L_SUPPKEY'] != 7084) | (lineitem['L_COMMENT'] == ' ') | (lineitem['LINENUMBER'] != 2)][['SHIPINSTRUCT', 'L_ORDERKEY']].merge(orders[(orders['ORDERSTATUS'].isin(['O', 'P', 'F'])) & (orders['ORDERPRIORITY'] == '4-NOT SPECIFIED') | (orders['O_ORDERKEY'] == 783)], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')