supplier.merge(nation[(nation['N_REGIONKEY'] != 0)].merge(customer[(customer['C_CUSTKEY'] == 88) | (customer['C_CUSTKEY'] == 95)][['MKTSEGMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_SUPPKEY', 'S_PHONE']).agg('count')

customer[(customer['C_PHONE'].str.startswith('27-')) & (customer['MKTSEGMENT'] == 'BUILDING')].merge(orders[(orders['ORDERDATE'] < '1998-07-21') & (orders['O_COMMENT'] != ',')].merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[(lineitem['COMMITDATE'] >= '1998-10-16') | (lineitem['L_PARTKEY'] >= 7317)], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['O_CUSTKEY']].merge(customer[(customer['C_NATIONKEY'] < 17) | (customer['C_ACCTBAL'] <= 65.21269379951036)][['MKTSEGMENT']].merge(region, left_on='C_CUSTKEY', right_on='R_REGIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

region[(region['R_COMMENT'] != 'g') & (region['R_COMMENT'].str.startswith('h')) & (region['R_REGIONKEY'] >= 0)].merge(nation[(nation['N_NATIONKEY'] < 14)].merge(region[['R_COMMENT', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT', 'R_NAME']).agg('count')

nation[['N_NATIONKEY', 'N_COMMENT']].merge(supplier.merge(partsupp.merge(supplier[['S_ACCTBAL', 'S_NAME']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[['S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY')

lineitem[(lineitem['RECEIPTDATE'] >= '1998-11-06') | (lineitem['LINESTATUS'] != 'F') | (lineitem['SHIPINSTRUCT'] == 'DELIVER IN PERSON')][['LINENUMBER', 'SHIPMODE', 'DISCOUNT', 'SHIPINSTRUCT']].merge(part[(part['PT_COMMENT'].str.startswith('!')) | (part['SIZE'] < 22)][['BRAND', 'RETAILPRICE', 'P_NAME', 'TYPE']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY').merge(partsupp[(partsupp['PS_PARTKEY'] <= 25) & (partsupp['PS_PARTKEY'] >= 14)][['PS_PARTKEY', 'PS_SUPPKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']).groupby(by=['LINENUMBER']).agg('mean', numeric_only=True)

supplier.merge(partsupp[['SUPPLYCOST']].merge(nation[['N_REGIONKEY']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY').merge(region[(region['R_NAME'].str.startswith('E'))][['R_COMMENT']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='R_REGIONKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_NAME'] == 'A') | (nation['N_NATIONKEY'] <= 19)][['N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY', 'N_NAME']].merge(region[(region['R_REGIONKEY'] > 0) & (region['R_COMMENT'] != 'u')], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_ADDRESS', 'S_PHONE']).agg('count')

part[(part['P_NAME'] == 'lin') & (part['RETAILPRICE'] > 1002.7814369608758) & (part['MFGR'] == 'Manufacturer#5')][['CONTAINER']]

lineitem.merge(orders[['ORDERPRIORITY', 'O_ORDERKEY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY')

orders[(orders['ORDERSTATUS'].isin(['P']))].merge(customer[(customer['MKTSEGMENT'] != 'MACHINERY')][['C_NATIONKEY']].merge(nation[(nation['N_COMMENT'].str.startswith('v')) | (nation['N_NAME'] == 'K')].merge(region[(region['R_NAME'] == 'AME')][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_COMMENT'].str.startswith('y'))][['N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[['C_CUSTKEY', 'C_ACCTBAL', 'C_COMMENT']].merge(orders[(orders['SHIPPRIORITY'] == 0) | (orders['ORDERSTATUS'] != 'F')][['ORDERSTATUS']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['CLERK'] != 'C') & (orders['ORDERPRIORITY'] != '5-LOW')], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[['LINESTATUS', 'L_SUPPKEY', 'QUANTITY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY')

lineitem.merge(partsupp[(partsupp['PS_SUPPKEY'] != 6427)][['PS_PARTKEY']].merge(lineitem[(lineitem['L_SUPPKEY'] <= 3099) & (lineitem['RECEIPTDATE'] > '1992-05-02')][['L_SUPPKEY']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[['L_PARTKEY', 'SHIPMODE']].merge(partsupp[(partsupp['PS_SUPPKEY'] <= 6275) | (partsupp['P_COMMENT'] == 'x')], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_PARTKEY'] <= 11)][['SUPPLYCOST', 'PS_SUPPKEY']].merge(lineitem[(lineitem['TAX'] >= 0.038244321319837855) & (lineitem['EXTENDEDPRICE'] > 9179.4700622688)], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['DISCOUNT'] != 0.08691481080711094)][['LINESTATUS']].merge(supplier[(supplier['S_COMMENT'] != 'g')][['S_NATIONKEY', 'S_ADDRESS', 'S_ACCTBAL']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(orders[(orders['CLERK'].str.startswith('C')) | (orders['ORDERPRIORITY'] != '4-NOT SPECIFIED')], left_on='L_ORDERKEY', right_on='O_ORDERKEY')

part.groupby(by=['RETAILPRICE', 'BRAND']).agg('sum', numeric_only=True)

supplier[['S_NATIONKEY', 'S_NAME', 'S_ACCTBAL', 'S_COMMENT']].merge(nation[(nation['N_REGIONKEY'] < 3)].merge(region[['R_REGIONKEY', 'R_COMMENT', 'R_NAME']].merge(nation[['N_REGIONKEY', 'N_NAME', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_REGIONKEY', 'N_COMMENT', 'N_NAME']].merge(region[['R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_REGIONKEY'] >= 1) | (nation['N_REGIONKEY'] >= 3)][['N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY')

nation[(nation['N_NAME'].str.startswith('C')) & (nation['N_REGIONKEY'] >= 3)][['N_NATIONKEY', 'N_COMMENT']]

customer[['C_NAME', 'C_COMMENT', 'C_PHONE', 'C_ACCTBAL', 'C_ADDRESS']].merge(partsupp[['SUPPLYCOST', 'PS_SUPPKEY']].merge(supplier[['S_COMMENT', 'S_PHONE', 'S_NATIONKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(nation[(nation['N_NATIONKEY'] < 23)].merge(customer[['C_ADDRESS']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_CUSTKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['PS_PARTKEY'] >= 36) | (partsupp['P_COMMENT'].str.startswith('v'))][['PS_PARTKEY']], left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY'])

part[['RETAILPRICE']].merge(supplier, left_on='P_PARTKEY', right_on='S_SUPPKEY')

nation[(nation['N_NAME'].str.startswith('S')) & (nation['N_REGIONKEY'] < 2) & (nation['N_COMMENT'] != 'l') | (nation['N_COMMENT'] != 'o')][['N_REGIONKEY']].merge(region[['R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region.merge(nation[['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY']].merge(supplier[(supplier['S_COMMENT'] != 'a') & (supplier['S_NAME'].str.startswith('S'))][['S_PHONE', 'S_SUPPKEY', 'S_COMMENT']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_REGIONKEY']).agg('max', numeric_only=True)

customer.merge(orders[(orders['SHIPPRIORITY'] == 0) | (orders['O_ORDERKEY'] == 153)], left_on='C_CUSTKEY', right_on='O_CUSTKEY')

lineitem[(lineitem['L_PARTKEY'] == 113321) | (lineitem['LINESTATUS'].isin(['F'])) & (lineitem['LINESTATUS'].isin(['F'])) & (lineitem['RECEIPTDATE'] != '1992-05-02')][['TAX', 'RECEIPTDATE', 'LINENUMBER']].merge(part.merge(partsupp[(partsupp['PS_PARTKEY'] <= 7) | (partsupp['AVAILQTY'] <= 1296)][['PS_SUPPKEY', 'P_COMMENT', 'SUPPLYCOST', 'PS_PARTKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY').merge(nation, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY').groupby(by=['RECEIPTDATE', 'TAX']).agg('mean', numeric_only=True)

supplier.merge(partsupp.merge(lineitem[(lineitem['L_PARTKEY'] == 47500)].merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier.merge(nation[(nation['N_REGIONKEY'] == 0)], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT']].merge(supplier[['S_NAME', 'S_ADDRESS', 'S_ACCTBAL', 'S_PHONE']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

lineitem[['L_SUPPKEY']].merge(partsupp[(partsupp['PS_PARTKEY'] != 34) | (partsupp['PS_SUPPKEY'] > 290)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['P_COMMENT'] != 'the') & (partsupp['PS_PARTKEY'] < 45)][['AVAILQTY', 'P_COMMENT', 'PS_SUPPKEY', 'SUPPLYCOST']].merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[['L_COMMENT']].merge(part[(part['P_NAME'].str.startswith('b'))], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['PS_PARTKEY', 'PS_SUPPKEY', 'SUPPLYCOST']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['L_SUPPKEY']).agg('sum', numeric_only=True)

nation[(nation['N_NAME'] == 'K') | (nation['N_NAME'] == 'M') & (nation['N_NATIONKEY'] > 4) & (nation['N_NATIONKEY'] < 4)].groupby(by=['N_NATIONKEY', 'N_NAME']).agg('mean', numeric_only=True)

supplier.merge(partsupp[(partsupp['P_COMMENT'].str.startswith('o'))].merge(supplier[(supplier['S_NATIONKEY'] > 19)][['S_ACCTBAL', 'S_NATIONKEY', 'S_ADDRESS', 'S_COMMENT']].merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_PHONE']).agg('mean', numeric_only=True)

lineitem[['QUANTITY', 'L_SUPPKEY', 'DISCOUNT', 'SHIPDATE']].merge(partsupp.merge(lineitem[(lineitem['COMMITDATE'] >= '1992-05-15')][['LINENUMBER', 'L_PARTKEY']].merge(partsupp[(partsupp['PS_SUPPKEY'] == 4844)], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['SHIPINSTRUCT'].isin(['NONE', 'TAKE BACK RETURN', 'COLLECT COD', 'DELIVER IN PERSON']))], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['AVAILQTY'] >= 1365)].merge(supplier[['S_ADDRESS']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(part[['MFGR']].merge(partsupp[(partsupp['P_COMMENT'].str.startswith('v')) & (partsupp['PS_SUPPKEY'] > 3225)], left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] >= 1619) & (partsupp['PS_SUPPKEY'] != 5249)][['PS_PARTKEY', 'P_COMMENT', 'PS_SUPPKEY', 'SUPPLYCOST']].merge(lineitem[(lineitem['COMMITDATE'] < '1992-05-15') | (lineitem['RECEIPTDATE'] == '1992-05-02')][['SHIPINSTRUCT']].merge(customer[(customer['MKTSEGMENT'] != 'HOUSEHOLD')], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem.merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY')

supplier[['S_PHONE']].groupby(by=['S_PHONE']).agg('max', numeric_only=True)

partsupp[(partsupp['PS_SUPPKEY'] < 1823) | (partsupp['SUPPLYCOST'] >= 435.5164213767857)].groupby(by=['SUPPLYCOST', 'P_COMMENT']).agg('count')

supplier.merge(partsupp[['AVAILQTY', 'P_COMMENT', 'SUPPLYCOST', 'PS_SUPPKEY']].merge(supplier[['S_ACCTBAL']].merge(nation[['N_NAME', 'N_COMMENT', 'N_REGIONKEY']], left_on='S_SUPPKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[(supplier['S_PHONE'] == '17-') & (supplier['S_COMMENT'] != 'x')][['S_NAME']].merge(customer[['C_ACCTBAL', 'C_ADDRESS']], left_on='S_SUPPKEY', right_on='C_CUSTKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_ACCTBAL']).agg('min', numeric_only=True)

region[(region['R_COMMENT'].str.startswith('g')) & (region['R_REGIONKEY'] <= 0) & (region['R_COMMENT'] != 'u') | (region['R_NAME'].str.startswith('AME'))]

customer[['C_NAME', 'MKTSEGMENT']].groupby(by=['MKTSEGMENT', 'C_NAME']).agg('min', numeric_only=True)

supplier[(supplier['S_ADDRESS'] == 'U') & (supplier['S_ACCTBAL'] <= 6739.748906588076)].merge(nation[(nation['N_COMMENT'] == 'e')], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NAME'] != 'I')].merge(region[(region['R_COMMENT'] == 'h')][['R_REGIONKEY', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier.merge(partsupp[(partsupp['P_COMMENT'].str.startswith('c'))][['PS_SUPPKEY', 'PS_PARTKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY')

customer[['C_COMMENT', 'MKTSEGMENT']].merge(nation[(nation['N_NAME'].str.startswith('A')) | (nation['N_REGIONKEY'] >= 3)].merge(region[['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].merge(nation[(nation['N_NAME'] == 'M') & (nation['N_NAME'].str.startswith('V'))][['N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[(supplier['S_SUPPKEY'] <= 74)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_CUSTKEY', right_on='N_NATIONKEY').merge(orders[(orders['O_ORDERKEY'] <= 640) | (orders['O_CUSTKEY'] >= 132357)][['O_ORDERKEY', 'TOTALPRICE', 'ORDERDATE', 'ORDERPRIORITY']].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['L_SUPPKEY'] > 7524) & (lineitem['RECEIPTDATE'] == '1998-11-06')], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_ORDERKEY').merge(region[['R_REGIONKEY', 'R_NAME', 'R_COMMENT']], left_on='C_CUSTKEY', right_on='R_REGIONKEY')

partsupp

partsupp.merge(lineitem[['TAX', 'L_PARTKEY']].merge(partsupp[['AVAILQTY']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier[['S_NAME', 'S_PHONE', 'S_NATIONKEY', 'S_ADDRESS']].merge(nation[(nation['N_COMMENT'].str.startswith('t'))].merge(supplier[(supplier['S_PHONE'] == '1') | (supplier['S_PHONE'] == '32-')][['S_COMMENT', 'S_NATIONKEY', 'S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[(supplier['S_SUPPKEY'] != 161) & (supplier['S_COMMENT'] != ' ')], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['P_COMMENT']).agg('sum', numeric_only=True)

orders[(orders['O_ORDERKEY'] < 744) & (orders['O_CUSTKEY'] != 74831) | (orders['TOTALPRICE'] > 107652.45173900908) | (orders['O_ORDERKEY'] <= 78)][['CLERK']].merge(nation[['N_COMMENT', 'N_NAME']], left_on='O_ORDERKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_COMMENT'] != 'n') & (nation['N_NATIONKEY'] == 10)][['N_REGIONKEY', 'N_NAME']], left_on='O_ORDERKEY', right_on='N_NATIONKEY')

region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation[['N_NATIONKEY']].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] != 'S') | (nation['N_NAME'].str.startswith('G'))].merge(customer.merge(orders[['TOTALPRICE', 'O_CUSTKEY', 'ORDERDATE', 'SHIPPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

nation[['N_COMMENT']].merge(customer[(customer['C_CUSTKEY'] >= 66) | (customer['C_ADDRESS'].str.startswith('i'))][['C_COMMENT', 'MKTSEGMENT']].merge(supplier[(supplier['S_COMMENT'] == 'o')], left_on='C_CUSTKEY', right_on='S_SUPPKEY'), left_on='N_NATIONKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_NATIONKEY'] == 10)].merge(nation[(nation['N_COMMENT'] == 'u')][['N_NATIONKEY']].merge(supplier[(supplier['S_ADDRESS'] == 't')][['S_NATIONKEY', 'S_SUPPKEY', 'S_ACCTBAL']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_CUSTKEY').groupby(by=['N_COMMENT']).agg('max', numeric_only=True)

orders[['O_ORDERKEY', 'TOTALPRICE', 'ORDERSTATUS', 'O_COMMENT', 'ORDERDATE']].merge(lineitem[(lineitem['RETURNFLAG'] != 'A') | (lineitem['RECEIPTDATE'] != '1998-11-06')].merge(orders.merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] < 2564) & (partsupp['PS_SUPPKEY'] < 3040)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY')

customer.merge(orders[(orders['O_ORDERKEY'] > 717) & (orders['SHIPPRIORITY'] < 0)], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_COMMENT'].str.startswith(' ')) | (nation['N_NATIONKEY'] > 9)][['N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY')

part.merge(partsupp.merge(supplier[(supplier['S_COMMENT'] == 'c') & (supplier['S_PHONE'] == '1')], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['AVAILQTY'] > 7319)][['PS_SUPPKEY', 'AVAILQTY']].merge(supplier[(supplier['S_NATIONKEY'] == 7) | (supplier['S_SUPPKEY'] >= 48)][['S_ADDRESS', 'S_ACCTBAL']].merge(customer, left_on='S_SUPPKEY', right_on='C_CUSTKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

lineitem[(lineitem['L_COMMENT'] != 'q') | (lineitem['DISCOUNT'] <= 0.05231688296894376) | (lineitem['RECEIPTDATE'] != '1992-05-02') | (lineitem['DISCOUNT'] > 0.08330553709349647)][['L_SUPPKEY']].merge(partsupp[(partsupp['PS_PARTKEY'] != 18)].merge(part.merge(partsupp[(partsupp['AVAILQTY'] < 8148)][['SUPPLYCOST', 'P_COMMENT', 'PS_PARTKEY', 'AVAILQTY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['TAX'] != 0.07360972475734807) | (lineitem['L_PARTKEY'] <= 133924)], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY')

nation.merge(region[(region['R_REGIONKEY'] > 0) | (region['R_NAME'] == 'A')].merge(nation[(nation['N_REGIONKEY'] > 1)].merge(region[(region['R_COMMENT'] == 'l')][['R_COMMENT', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_REGIONKEY', 'N_COMMENT']).agg('min', numeric_only=True)

region[(region['R_REGIONKEY'] != 3) & (region['R_NAME'].str.startswith('ASI')) | (region['R_COMMENT'] == 'u') | (region['R_NAME'] != 'M')][['R_REGIONKEY', 'R_COMMENT', 'R_NAME']].merge(nation[['N_COMMENT', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME', 'R_REGIONKEY']).agg('min', numeric_only=True)

supplier[(supplier['S_COMMENT'].str.startswith('b')) & (supplier['S_NAME'].str.startswith('S')) | (supplier['S_SUPPKEY'] >= 91)][['S_PHONE', 'S_COMMENT']].merge(lineitem[(lineitem['SHIPINSTRUCT'].isin(['NONE', 'COLLECT COD', 'TAKE BACK RETURN', 'DELIVER IN PERSON'])) | (lineitem['SHIPDATE'] >= '1998-10-30')][['EXTENDEDPRICE', 'DISCOUNT', 'RETURNFLAG']].merge(part[(part['P_PARTKEY'] == 145) & (part['CONTAINER'] != 'MED')][['TYPE', 'SIZE']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).groupby(by=['S_PHONE', 'S_COMMENT']).agg('sum', numeric_only=True)

customer[['C_ADDRESS', 'MKTSEGMENT']].groupby(by=['MKTSEGMENT']).agg('count')

nation[(nation['N_NAME'].str.startswith('S')) | (nation['N_COMMENT'] == 'u') | (nation['N_REGIONKEY'] >= 0) | (nation['N_NAME'] == 'J')].groupby(by=['N_NAME', 'N_REGIONKEY']).agg('mean', numeric_only=True)

region[['R_COMMENT', 'R_REGIONKEY']].merge(nation[(nation['N_REGIONKEY'] != 3) & (nation['N_NAME'].str.startswith('K'))][['N_REGIONKEY', 'N_NAME', 'N_NATIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']].merge(customer[(customer['C_NATIONKEY'] != 12) & (customer['C_NATIONKEY'] != 12)][['C_NATIONKEY', 'C_ACCTBAL', 'C_PHONE', 'C_NAME']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[['S_NATIONKEY', 'S_SUPPKEY', 'S_ADDRESS', 'S_ACCTBAL']].merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

orders[(orders['O_CUSTKEY'] <= 64451) | (orders['O_COMMENT'].str.startswith('-')) & (orders['TOTALPRICE'] != 120825.20842216344) | (orders['ORDERPRIORITY'] != '5-LOW')].merge(lineitem[(lineitem['QUANTITY'] >= 7)][['SHIPINSTRUCT', 'COMMITDATE']].merge(part[(part['CONTAINER'] != 'SM') | (part['P_NAME'] == 'bis')][['P_NAME']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['COMMITDATE'] == '1998-10-16')][['COMMITDATE']].merge(customer[['C_NATIONKEY', 'C_COMMENT', 'C_CUSTKEY']].merge(nation[(nation['N_COMMENT'] != ' ') | (nation['N_NAME'] != 'J')], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['ORDERDATE']).agg('min', numeric_only=True)

lineitem[['QUANTITY', 'RETURNFLAG', 'SHIPINSTRUCT']].merge(customer[['C_NAME']].merge(lineitem[['LINENUMBER', 'DISCOUNT', 'L_COMMENT']].merge(supplier[(supplier['S_PHONE'] == '3') | (supplier['S_ACCTBAL'] < 5412.086143464466)][['S_ACCTBAL', 'S_PHONE', 'S_NATIONKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY'), left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(orders[(orders['ORDERSTATUS'] == 'P') | (orders['ORDERDATE'] < '1998-07-21')][['O_CUSTKEY']], left_on='C_CUSTKEY', right_on='O_ORDERKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY').groupby(by=['QUANTITY']).agg('sum', numeric_only=True)

orders[(orders['O_CUSTKEY'] < 113098)].merge(customer[(customer['MKTSEGMENT'] != 'HOUSEHOLD')][['MKTSEGMENT', 'C_ACCTBAL', 'C_PHONE']].merge(nation[(nation['N_REGIONKEY'] == 0) & (nation['N_REGIONKEY'] != 3)][['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']].merge(customer[['C_PHONE']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_CUSTKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer.merge(orders[(orders['CLERK'] == 'C') | (orders['ORDERDATE'] != '1998-07-21')][['ORDERPRIORITY', 'ORDERSTATUS', 'SHIPPRIORITY']].merge(nation, left_on='O_ORDERKEY', right_on='N_NATIONKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['ORDERSTATUS', 'O_CUSTKEY']).agg('count')

customer[(customer['C_ACCTBAL'] >= 1088.696418545788) & (customer['C_ADDRESS'] == 'P') | (customer['MKTSEGMENT'] == 'HOUSEHOLD') | (customer['C_ADDRESS'].str.startswith('6'))][['C_CUSTKEY', 'C_ACCTBAL', 'MKTSEGMENT', 'C_NATIONKEY']].merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_REGIONKEY'] == 2)], left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_ACCTBAL']).agg('mean', numeric_only=True)

part[(part['PT_COMMENT'] == 'a') & (part['TYPE'] == 'M') & (part['TYPE'].str.startswith('P')) & (part['CONTAINER'] != 'SM')][['BRAND', 'CONTAINER']].merge(lineitem.merge(partsupp[(partsupp['AVAILQTY'] >= 6672) | (partsupp['SUPPLYCOST'] >= 601.0410212047948)][['SUPPLYCOST']], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['P_COMMENT', 'PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(supplier.merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='P_PARTKEY', right_on='S_SUPPKEY')

lineitem.merge(orders.merge(lineitem[(lineitem['L_SUPPKEY'] <= 7407)][['L_ORDERKEY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['LINENUMBER'] >= 4) & (lineitem['L_SUPPKEY'] < 168)][['L_SUPPKEY', 'DISCOUNT', 'TAX']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').groupby(by=['L_PARTKEY', 'RETURNFLAG']).agg('max', numeric_only=True)

lineitem[['LINENUMBER', 'EXTENDEDPRICE', 'QUANTITY', 'DISCOUNT']].groupby(by=['EXTENDEDPRICE', 'LINENUMBER']).agg('sum', numeric_only=True)

lineitem.merge(orders.merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['DISCOUNT'] == 0.09107710842387429) & (lineitem['SHIPINSTRUCT'] == 'COLLECT COD')][['SHIPDATE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[['AVAILQTY']].merge(supplier[(supplier['S_ACCTBAL'] > 247.66802393097555)][['S_ADDRESS']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(orders[(orders['O_ORDERKEY'] != 303)].merge(lineitem[['RETURNFLAG', 'LINESTATUS']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['RETURNFLAG'] == 'R') | (lineitem['RETURNFLAG'] != 'N')][['LINESTATUS', 'QUANTITY', 'L_SUPPKEY']].merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY')

part[(part['RETAILPRICE'] < 1024.744554981359) & (part['CONTAINER'].str.startswith('JUMBO')) | (part['BRAND'] == 'Brand#53') & (part['P_PARTKEY'] >= 31)][['CONTAINER', 'MFGR', 'TYPE']].merge(orders[(orders['TOTALPRICE'] != 101919.77120813874)][['O_ORDERKEY', 'ORDERDATE', 'ORDERPRIORITY']].merge(lineitem[(lineitem['DISCOUNT'] != 0.0014795257707306165)].merge(orders[(orders['SHIPPRIORITY'] <= 0)], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='P_PARTKEY', right_on='O_ORDERKEY').merge(region.merge(nation[(nation['N_COMMENT'] == 'y')][['N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='P_PARTKEY', right_on='R_REGIONKEY').merge(region[(region['R_REGIONKEY'] <= 0) & (region['R_REGIONKEY'] != 3)].merge(nation[(nation['N_COMMENT'].str.startswith('p'))].merge(supplier[(supplier['S_ACCTBAL'] >= 5317.926735225368)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='P_PARTKEY', right_on='R_REGIONKEY')

supplier.merge(partsupp[(partsupp['P_COMMENT'] == ' ') | (partsupp['P_COMMENT'] != ' ')][['SUPPLYCOST', 'PS_SUPPKEY', 'PS_PARTKEY', 'AVAILQTY']].merge(lineitem[['RETURNFLAG', 'L_COMMENT', 'SHIPINSTRUCT']].merge(orders[(orders['ORDERSTATUS'] == 'P') & (orders['O_COMMENT'] != 't')], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier[(supplier['S_COMMENT'] == 'e') & (supplier['S_ACCTBAL'] != 1673.622138099882)][['S_ACCTBAL', 'S_COMMENT', 'S_NATIONKEY', 'S_PHONE']].merge(nation[['N_NAME', 'N_COMMENT', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_ADDRESS', 'S_NATIONKEY']).agg('mean', numeric_only=True)

region.merge(nation[['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY']].merge(customer[(customer['MKTSEGMENT'].isin(['MACHINERY']))], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] < 17)].merge(supplier[(supplier['S_PHONE'].str.startswith('26-')) & (supplier['S_PHONE'] != '14-')], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

supplier.groupby(by=['S_NATIONKEY', 'S_COMMENT']).agg('sum', numeric_only=True)

orders[['O_ORDERKEY', 'ORDERSTATUS', 'TOTALPRICE', 'ORDERDATE', 'ORDERPRIORITY']].merge(lineitem[(lineitem['EXTENDEDPRICE'] >= 86259.18157307002)][['DISCOUNT']].merge(region[['R_REGIONKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY').merge(customer, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[['LINENUMBER', 'RECEIPTDATE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem.merge(orders[(orders['ORDERDATE'] >= '1992-01-13') | (orders['ORDERDATE'] >= '1992-01-13')][['O_COMMENT', 'O_ORDERKEY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['ORDERSTATUS']).agg('min', numeric_only=True)

region.merge(nation[(nation['N_NATIONKEY'] < 9) | (nation['N_REGIONKEY'] > 0)].merge(customer[(customer['C_COMMENT'].str.startswith('d')) & (customer['C_COMMENT'] == 'w')].merge(orders[['SHIPPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_PHONE'].str.startswith('14-'))][['S_PHONE', 'S_ADDRESS']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(customer[['C_CUSTKEY']].merge(orders[(orders['O_ORDERKEY'] <= 633) | (orders['O_ORDERKEY'] >= 129)], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_NAME'] != 'AFR') & (region['R_NAME'] != 'AME')][['R_REGIONKEY', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY', 'R_NAME']).agg('min', numeric_only=True)

partsupp[(partsupp['P_COMMENT'].str.startswith('j')) & (partsupp['P_COMMENT'] == 'bli') | (partsupp['P_COMMENT'] == 'e') & (partsupp['AVAILQTY'] >= 4804)][['SUPPLYCOST']]

orders.merge(customer[(customer['C_NATIONKEY'] <= 4) | (customer['C_CUSTKEY'] > 17)][['C_ADDRESS']], left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['O_ORDERKEY', 'TOTALPRICE']).agg('max', numeric_only=True)

partsupp[(partsupp['PS_SUPPKEY'] != 6202) & (partsupp['PS_SUPPKEY'] == 513) & (partsupp['PS_PARTKEY'] <= 39)].merge(lineitem.merge(partsupp[['P_COMMENT']].merge(supplier[(supplier['S_ADDRESS'] != 'H')], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] >= 2241) | (partsupp['SUPPLYCOST'] != 980.7395640133575)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['LINESTATUS'] != 'O')].merge(partsupp[(partsupp['P_COMMENT'] == 'bli') | (partsupp['PS_SUPPKEY'] >= 406)].merge(lineitem[(lineitem['TAX'] <= 0.008997540478597141) | (lineitem['LINESTATUS'].isin(['F', 'O']))], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['SUPPLYCOST'] <= 655.8506670459773)].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier.merge(partsupp[['SUPPLYCOST', 'P_COMMENT', 'PS_SUPPKEY', 'PS_PARTKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation.merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['SUPPLYCOST', 'PS_SUPPKEY']).agg('mean', numeric_only=True)

nation[(nation['N_NAME'] == 'R') | (nation['N_NAME'].str.startswith('K')) & (nation['N_NAME'].str.startswith('C'))].merge(region[['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation[(nation['N_COMMENT'] != 'y') | (nation['N_COMMENT'] == 'h')][['N_REGIONKEY', 'N_NAME']].merge(region[['R_COMMENT', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY')

region[(region['R_NAME'] == 'AME') & (region['R_COMMENT'] != 'h') | (region['R_COMMENT'] != 'g')].merge(nation[['N_COMMENT', 'N_REGIONKEY', 'N_NAME']].merge(region.merge(nation[(nation['N_COMMENT'] != 'o')][['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NAME', 'N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY']].merge(region.merge(nation[(nation['N_NAME'] == 'F') & (nation['N_COMMENT'] != 'l')], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY')

part[(part['MFGR'].isin(['Manufacturer#3', 'Manufacturer#2', 'Manufacturer#1', 'Manufacturer#4', 'Manufacturer#5'])) & (part['PT_COMMENT'] == 'f') | (part['PT_COMMENT'] == 'a') | (part['RETAILPRICE'] <= 1063.964371151253)][['TYPE']].merge(lineitem.merge(partsupp[(partsupp['PS_SUPPKEY'] == 320) | (partsupp['PS_SUPPKEY'] == 1779)][['PS_SUPPKEY', 'SUPPLYCOST', 'P_COMMENT']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).groupby(by=['TYPE']).agg('sum', numeric_only=True)

part.groupby(by=['TYPE', 'SIZE']).agg('mean', numeric_only=True)

nation[['N_NATIONKEY', 'N_NAME', 'N_COMMENT', 'N_REGIONKEY']]

orders.merge(customer[(customer['C_NAME'] == 'C') & (customer['C_NAME'] != 'C')].merge(nation[(nation['N_NAME'].str.startswith('G'))].merge(supplier[(supplier['S_PHONE'] != '3') & (supplier['S_ADDRESS'] == 'I')], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders.merge(lineitem[['SHIPMODE', 'LINENUMBER']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer.merge(nation[['N_NAME', 'N_COMMENT']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

nation.groupby(by=['N_NAME', 'N_REGIONKEY']).agg('sum', numeric_only=True)

partsupp[(partsupp['P_COMMENT'] == 'c')].merge(lineitem[['L_ORDERKEY', 'EXTENDEDPRICE']].merge(orders[['SHIPPRIORITY', 'O_CUSTKEY', 'CLERK', 'O_COMMENT']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier[(supplier['S_NATIONKEY'] >= 4)][['S_COMMENT']].merge(customer[(customer['C_PHONE'] == '18-') & (customer['C_PHONE'] != '13-')], left_on='S_SUPPKEY', right_on='C_CUSTKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY')

customer[(customer['C_PHONE'].str.startswith('3')) | (customer['C_CUSTKEY'] >= 28) | (customer['C_CUSTKEY'] == 36)]

nation[['N_COMMENT', 'N_REGIONKEY']].merge(region[['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].merge(nation[['N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation[(nation['N_NATIONKEY'] > 13) & (nation['N_NATIONKEY'] > 9)], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_REGIONKEY'] >= 2) & (region['R_COMMENT'] == 'u')][['R_REGIONKEY', 'R_COMMENT', 'R_NAME']].merge(nation[['N_COMMENT', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY')

partsupp.merge(part[(part['BRAND'] == 'Brand#34')][['BRAND', 'P_NAME', 'PT_COMMENT']], left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['AVAILQTY']).agg('sum', numeric_only=True)

supplier.merge(nation[['N_REGIONKEY', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[['AVAILQTY', 'P_COMMENT', 'PS_PARTKEY', 'SUPPLYCOST']].merge(lineitem[['LINENUMBER']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_ACCTBAL']).agg('count')

customer[['C_CUSTKEY', 'C_ACCTBAL', 'C_NAME', 'C_NATIONKEY']].merge(orders[(orders['O_ORDERKEY'] < 372)], left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_CUSTKEY', 'C_ACCTBAL']).agg('mean', numeric_only=True)

supplier.merge(nation[['N_REGIONKEY', 'N_NAME', 'N_NATIONKEY']].merge(region[(region['R_REGIONKEY'] <= 0)].merge(nation[['N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY')

nation[(nation['N_NAME'] == 'E') & (nation['N_REGIONKEY'] <= 3) | (nation['N_NAME'] == 'E') & (nation['N_REGIONKEY'] == 2)][['N_NAME', 'N_REGIONKEY']].merge(region[(region['R_NAME'] != 'ASI')].merge(nation[(nation['N_NAME'] == 'K')], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] == 'S')][['N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[['R_COMMENT', 'R_NAME']].merge(part[(part['CONTAINER'].str.startswith('LG'))], left_on='R_REGIONKEY', right_on='P_PARTKEY').merge(orders[(orders['ORDERPRIORITY'] == '3-MEDIUM')][['ORDERDATE', 'ORDERPRIORITY', 'TOTALPRICE']], left_on='R_REGIONKEY', right_on='O_ORDERKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY')

orders[(orders['CLERK'] == 'C') & (orders['CLERK'] == 'C')][['O_COMMENT', 'CLERK']].merge(customer.merge(nation[(nation['N_NAME'] == 'E') | (nation['N_NATIONKEY'] < 11)].merge(supplier[(supplier['S_COMMENT'] != 'o')], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NAME'].str.startswith('B'))].merge(customer[(customer['C_ACCTBAL'] != 7628.423353506398) | (customer['C_CUSTKEY'] > 93)], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='C_CUSTKEY').merge(lineitem[['COMMITDATE']].merge(customer[(customer['C_COMMENT'] != ' ')], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='O_ORDERKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'])

part[(part['RETAILPRICE'] != 995.6867016990537) & (part['P_PARTKEY'] != 121) | (part['P_NAME'] == 'a') & (part['TYPE'].str.startswith('SMA'))].merge(partsupp[(partsupp['P_COMMENT'] == 'f') | (partsupp['SUPPLYCOST'] <= 513.6177314270875)].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['SHIPINSTRUCT'].isin(['TAKE BACK RETURN', 'COLLECT COD', 'DELIVER IN PERSON', 'NONE']))][['TAX']].merge(partsupp[(partsupp['AVAILQTY'] == 4455) & (partsupp['PS_PARTKEY'] == 31)], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['P_NAME', 'BRAND']).agg('mean', numeric_only=True)

customer[(customer['C_ACCTBAL'] <= 6897.845074044408) | (customer['C_ADDRESS'] == 'i') & (customer['C_PHONE'] != '13-')].merge(orders[['ORDERSTATUS', 'O_CUSTKEY', 'ORDERDATE', 'O_COMMENT']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['ORDERPRIORITY'] == '1-URGENT') & (orders['CLERK'] != 'C')][['ORDERDATE', 'ORDERPRIORITY']].merge(nation[['N_NATIONKEY', 'N_COMMENT']], left_on='O_ORDERKEY', right_on='N_NATIONKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

lineitem[(lineitem['QUANTITY'] != 30)].merge(orders[(orders['TOTALPRICE'] >= 74757.07293372774) | (orders['SHIPPRIORITY'] == 0)].merge(lineitem[['RETURNFLAG', 'EXTENDEDPRICE', 'L_SUPPKEY', 'LINESTATUS']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['P_COMMENT'].str.startswith('d'))].merge(supplier.merge(nation[(nation['N_NAME'].str.startswith('P')) | (nation['N_NATIONKEY'] <= 16)], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['AVAILQTY'] <= 3049) & (partsupp['AVAILQTY'] >= 8748)].merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier[(supplier['S_PHONE'].str.startswith('32-')) | (supplier['S_PHONE'] == '1')][['S_COMMENT']].merge(partsupp[(partsupp['AVAILQTY'] == 8283)][['AVAILQTY', 'P_COMMENT']], left_on='S_SUPPKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['TAX', 'SHIPDATE']).agg('max', numeric_only=True)

orders[(orders['O_ORDERKEY'] >= 33) & (orders['ORDERDATE'] == '1998-07-21')][['O_CUSTKEY', 'TOTALPRICE', 'SHIPPRIORITY', 'ORDERDATE']].merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_ACCTBAL'] >= 8918.168753553113) & (customer['C_PHONE'] != '27-')].merge(nation.merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['ORDERDATE']).agg('min', numeric_only=True)

partsupp[['PS_PARTKEY', 'SUPPLYCOST']].merge(lineitem[['SHIPDATE']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part.merge(partsupp[['SUPPLYCOST', 'PS_PARTKEY', 'P_COMMENT', 'AVAILQTY']].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_SUPPKEY', 'PS_PARTKEY', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['PS_PARTKEY']).agg('count')

partsupp.merge(lineitem[(lineitem['L_COMMENT'].str.startswith('v')) & (lineitem['L_COMMENT'] != '.')][['SHIPINSTRUCT', 'QUANTITY']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem.merge(partsupp[(partsupp['PS_SUPPKEY'] > 780) & (partsupp['AVAILQTY'] < 2141)][['PS_PARTKEY', 'P_COMMENT', 'PS_SUPPKEY', 'SUPPLYCOST']].merge(supplier[(supplier['S_NAME'].str.startswith('S')) | (supplier['S_NATIONKEY'] < 4)], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(part[(part['TYPE'] == 'M')][['P_PARTKEY', 'SIZE', 'BRAND']].merge(partsupp[['P_COMMENT']].merge(region[(region['R_REGIONKEY'] <= 2) | (region['R_COMMENT'] != 'h')], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='R_REGIONKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_PARTKEY'] != 42) | (partsupp['PS_SUPPKEY'] > 2820)][['SUPPLYCOST']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['PS_SUPPKEY']).agg('sum', numeric_only=True)

supplier[['S_SUPPKEY', 'S_PHONE', 'S_ADDRESS']].merge(partsupp[['SUPPLYCOST', 'AVAILQTY', 'PS_PARTKEY', 'PS_SUPPKEY']].merge(lineitem[(lineitem['QUANTITY'] != 10) & (lineitem['SHIPMODE'].isin(['REG AIR', 'TRUCK']))][['RETURNFLAG', 'EXTENDEDPRICE']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['SUPPLYCOST'] != 944.9881008281708)].merge(part[(part['TYPE'] != 'STA') & (part['TYPE'] != 'S')], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['LINENUMBER'] <= 4) | (lineitem['QUANTITY'] == 31)][['SHIPDATE']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_ADDRESS']).agg('count')

lineitem.merge(partsupp[['AVAILQTY', 'PS_SUPPKEY', 'PS_PARTKEY']].merge(part[(part['SIZE'] == 15) & (part['BRAND'] == 'Brand#23')].merge(partsupp[(partsupp['AVAILQTY'] <= 4456)][['SUPPLYCOST']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['SHIPMODE']).agg('min', numeric_only=True)

partsupp.merge(part[(part['SIZE'] >= 43)].merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['AVAILQTY'] >= 1570) | (partsupp['P_COMMENT'].str.startswith('u'))].merge(lineitem[(lineitem['SHIPDATE'] != '1998-10-30')][['TAX', 'SHIPMODE', 'DISCOUNT', 'RECEIPTDATE']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['P_COMMENT', 'PS_SUPPKEY']).agg('sum', numeric_only=True)

orders[(orders['CLERK'].str.startswith('C')) | (orders['O_CUSTKEY'] == 99333) & (orders['O_ORDERKEY'] == 666) | (orders['SHIPPRIORITY'] <= 0)][['CLERK', 'O_CUSTKEY']]

nation.merge(customer[(customer['C_NATIONKEY'] >= 2)].merge(nation.merge(region[(region['R_NAME'] != 'E')], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer.merge(orders[(orders['ORDERDATE'] <= '1992-01-13') & (orders['CLERK'] != 'C')][['ORDERDATE', 'O_ORDERKEY']].merge(lineitem[(lineitem['L_COMMENT'] != ' ') | (lineitem['COMMITDATE'] >= '1992-05-15')], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY')

supplier.merge(partsupp[(partsupp['P_COMMENT'] == 'k') | (partsupp['AVAILQTY'] <= 3772)][['AVAILQTY', 'SUPPLYCOST']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_PARTKEY'] <= 7) & (partsupp['AVAILQTY'] <= 5222)][['PS_PARTKEY', 'AVAILQTY', 'P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_SUPPKEY', 'S_ADDRESS']).agg('mean', numeric_only=True)

region[['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation[(nation['N_COMMENT'] != 'h') & (nation['N_REGIONKEY'] <= 0)].merge(customer[(customer['C_NAME'] == 'C') | (customer['C_ACCTBAL'] != 9816.734620998179)][['MKTSEGMENT', 'C_COMMENT']].merge(lineitem[(lineitem['COMMITDATE'] >= '1998-10-16')][['L_SUPPKEY', 'DISCOUNT', 'SHIPMODE']], left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('mean', numeric_only=True)

region[['R_NAME']].merge(lineitem[(lineitem['COMMITDATE'] != '1998-10-16')][['TAX', 'DISCOUNT', 'LINENUMBER']].merge(customer[['C_ACCTBAL', 'C_NATIONKEY']].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='R_REGIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(customer[['MKTSEGMENT', 'C_COMMENT', 'C_NAME', 'C_ACCTBAL']], left_on='R_REGIONKEY', right_on='C_CUSTKEY').merge(partsupp.merge(supplier.merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[(supplier['S_COMMENT'].str.startswith('the')) | (supplier['S_ADDRESS'].str.startswith('F'))][['S_NATIONKEY', 'S_ACCTBAL', 'S_COMMENT', 'S_PHONE']].merge(nation[['N_COMMENT', 'N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='R_REGIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).groupby(by=['R_NAME']).agg('min', numeric_only=True)

lineitem[(lineitem['COMMITDATE'] != '1998-10-16') & (lineitem['RECEIPTDATE'] > '1998-11-06') & (lineitem['L_COMMENT'] == 'd') & (lineitem['RETURNFLAG'] == 'A')][['EXTENDEDPRICE', 'QUANTITY']].merge(part[['P_PARTKEY', 'BRAND', 'PT_COMMENT', 'SIZE']].merge(partsupp[['AVAILQTY']], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['P_COMMENT']].merge(lineitem[['LINENUMBER']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY').merge(region[(region['R_NAME'] != 'AME')][['R_NAME', 'R_COMMENT']].merge(customer[(customer['C_PHONE'].str.startswith('25-')) | (customer['C_ADDRESS'] == '9')][['C_CUSTKEY']].merge(orders[(orders['ORDERDATE'] < '1998-07-21')], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='R_REGIONKEY', right_on='C_CUSTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY').merge(nation[['N_NAME', 'N_COMMENT', 'N_REGIONKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY').groupby(by=['QUANTITY']).agg('min', numeric_only=True)

lineitem[(lineitem['SHIPINSTRUCT'].isin(['NONE', 'TAKE BACK RETURN'])) | (lineitem['LINENUMBER'] >= 2) | (lineitem['DISCOUNT'] != 0.026697789706508414)].merge(orders[(orders['ORDERSTATUS'] != 'O')][['ORDERPRIORITY', 'ORDERDATE', 'TOTALPRICE']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['SUPPLYCOST'] != 576.8560871824762) & (partsupp['P_COMMENT'] != 'g')].merge(part.merge(partsupp[['AVAILQTY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['EXTENDEDPRICE', 'L_ORDERKEY']).agg('min', numeric_only=True)

partsupp[(partsupp['AVAILQTY'] == 3028) | (partsupp['P_COMMENT'] != 'o') & (partsupp['PS_PARTKEY'] <= 11)]

nation

supplier[(supplier['S_PHONE'] == '3')][['S_ADDRESS']].merge(part[(part['P_PARTKEY'] >= 38)][['PT_COMMENT', 'P_NAME', 'SIZE']].merge(nation[['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME']].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='P_PARTKEY', right_on='N_NATIONKEY'), left_on='S_SUPPKEY', right_on='P_PARTKEY')

part[(part['BRAND'] == 'Brand#45')].merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY')

part[(part['BRAND'] != 'Brand#25') & (part['SIZE'] == 44) & (part['RETAILPRICE'] <= 962.2080904090875) | (part['TYPE'].str.startswith('SMA'))][['RETAILPRICE', 'CONTAINER', 'SIZE', 'P_PARTKEY']].merge(partsupp[(partsupp['P_COMMENT'] != 'bli')].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['RETAILPRICE', 'SIZE']).agg('min', numeric_only=True)

supplier[(supplier['S_SUPPKEY'] != 107) & (supplier['S_ACCTBAL'] == 9343.096813507686) | (supplier['S_NATIONKEY'] <= 7)][['S_ACCTBAL', 'S_SUPPKEY', 'S_NATIONKEY']].merge(partsupp[['PS_PARTKEY', 'SUPPLYCOST']].merge(lineitem[['SHIPDATE', 'L_PARTKEY', 'RETURNFLAG', 'DISCOUNT']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_COMMENT'].str.startswith(' ')) & (nation['N_NAME'] == 'E')], left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_NATIONKEY', 'S_SUPPKEY']).agg('max', numeric_only=True)

supplier[(supplier['S_ACCTBAL'] != -640.4705176140742) | (supplier['S_PHONE'] == '17-')].merge(partsupp[(partsupp['AVAILQTY'] <= 8685) | (partsupp['P_COMMENT'] == 'are')][['PS_SUPPKEY', 'PS_PARTKEY']].merge(part[['MFGR', 'CONTAINER', 'P_PARTKEY']], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['L_ORDERKEY'] > 91) | (lineitem['LINENUMBER'] < 2)][['RETURNFLAG', 'SHIPMODE', 'DISCOUNT']].merge(partsupp, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

region[(region['R_COMMENT'].str.startswith('u')) & (region['R_COMMENT'].str.startswith('g')) & (region['R_COMMENT'] == 'u') | (region['R_REGIONKEY'] <= 3)].merge(nation[['N_COMMENT', 'N_REGIONKEY', 'N_NAME']].merge(region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region.merge(nation[(nation['N_NAME'].str.startswith('F')) & (nation['N_NATIONKEY'] > 2)][['N_NATIONKEY', 'N_NAME', 'N_REGIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

partsupp

nation[(nation['N_NAME'] != 'B')][['N_NAME']].merge(lineitem.merge(orders[(orders['TOTALPRICE'] > 65062.491415852535)][['ORDERSTATUS']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['PS_PARTKEY'] < 17)][['PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY', 'AVAILQTY']].merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='N_NATIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).groupby(by=['N_NAME']).agg('count')

orders[(orders['ORDERDATE'] >= '1992-01-13') | (orders['TOTALPRICE'] != 206647.0628837001)][['ORDERDATE', 'O_ORDERKEY']]

partsupp[(partsupp['P_COMMENT'] == ',') & (partsupp['SUPPLYCOST'] != 536.6238771354978)].merge(part[(part['MFGR'] == 'Manufacturer#5')][['SIZE', 'TYPE']], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[['LINESTATUS', 'RETURNFLAG']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['QUANTITY'] < 40) & (lineitem['RECEIPTDATE'] <= '1998-11-06')][['COMMITDATE', 'SHIPDATE', 'RECEIPTDATE', 'LINENUMBER']].merge(partsupp[(partsupp['PS_SUPPKEY'] <= 7349) & (partsupp['SUPPLYCOST'] != 789.7778507759076)][['PS_SUPPKEY', 'SUPPLYCOST', 'P_COMMENT']].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(part, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').groupby(by=['PS_SUPPKEY', 'P_COMMENT']).agg('min', numeric_only=True)

lineitem.merge(partsupp[['PS_PARTKEY', 'PS_SUPPKEY', 'AVAILQTY']].merge(lineitem[(lineitem['TAX'] >= 0.04206496081055416)], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[['SHIPINSTRUCT']].merge(partsupp[['PS_SUPPKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['LINENUMBER']).agg('mean', numeric_only=True)

region.groupby(by=['R_COMMENT']).agg('min', numeric_only=True)

part[(part['PT_COMMENT'] != 'ly ') | (part['P_NAME'] == 'bis') | (part['MFGR'] != 'Manufacturer#5') & (part['TYPE'] == 'SMA')][['CONTAINER', 'BRAND']].merge(orders.merge(customer[(customer['C_COMMENT'] != 'c') | (customer['C_CUSTKEY'] > 33)][['MKTSEGMENT', 'C_CUSTKEY', 'C_ADDRESS', 'C_NATIONKEY']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='P_PARTKEY', right_on='O_ORDERKEY').merge(partsupp, left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(orders[(orders['ORDERPRIORITY'].isin(['4-NOT SPECIFIED', '1-URGENT'])) & (orders['ORDERPRIORITY'] == '1-URGENT')][['TOTALPRICE', 'O_COMMENT']].merge(customer, left_on='O_ORDERKEY', right_on='C_CUSTKEY').merge(supplier.merge(nation[(nation['N_NATIONKEY'] >= 8)], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='O_ORDERKEY').groupby(by=['BRAND']).agg('sum', numeric_only=True)

region[(region['R_NAME'] != 'M')][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].groupby(by=['R_REGIONKEY']).agg('sum', numeric_only=True)

customer[(customer['C_ADDRESS'] != 'p') | (customer['C_CUSTKEY'] == 70) & (customer['MKTSEGMENT'] == 'AUTOMOBILE') & (customer['C_COMMENT'] != 'c')].merge(orders.merge(customer[(customer['MKTSEGMENT'] == 'FURNITURE') | (customer['C_ACCTBAL'] <= 5091.61566223458)][['MKTSEGMENT', 'C_COMMENT']].merge(region[(region['R_NAME'] == 'AME') | (region['R_NAME'] == 'E')], left_on='C_CUSTKEY', right_on='R_REGIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_COMMENT'] == 'y') | (nation['N_NATIONKEY'] > 5)][['N_NAME', 'N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY']].merge(customer.merge(orders[(orders['TOTALPRICE'] < 64184.948216878096) | (orders['TOTALPRICE'] > 340033.11222633906)], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NAME'] == 'I')][['N_REGIONKEY']].merge(region[['R_REGIONKEY', 'R_NAME']].merge(nation[(nation['N_COMMENT'] != 'v')][['N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

region.merge(nation[['N_REGIONKEY']].merge(region[['R_REGIONKEY', 'R_NAME', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] == 'C') | (nation['N_NATIONKEY'] <= 3)][['N_NATIONKEY', 'N_NAME']].merge(customer[(customer['C_NAME'] == 'C') | (customer['C_NATIONKEY'] < 1)][['C_NAME']].merge(lineitem[(lineitem['COMMITDATE'] >= '1992-05-15') & (lineitem['LINENUMBER'] > 2)][['QUANTITY', 'RETURNFLAG']], left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[(customer['C_PHONE'].str.startswith('2'))][['C_NATIONKEY', 'C_ADDRESS']].merge(nation[(nation['N_NATIONKEY'] <= 5) | (nation['N_COMMENT'] == 'p')], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

partsupp[(partsupp['SUPPLYCOST'] != 401.340329702951) & (partsupp['AVAILQTY'] <= 9792)].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[['QUANTITY']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').groupby(by=['P_COMMENT']).agg('count')

customer.merge(orders[(orders['SHIPPRIORITY'] > 0)][['SHIPPRIORITY', 'ORDERPRIORITY', 'TOTALPRICE', 'O_CUSTKEY']].merge(customer[(customer['MKTSEGMENT'].isin(['MACHINERY', 'FURNITURE', 'HOUSEHOLD'])) | (customer['C_ACCTBAL'] == 6187.294441774268)].merge(orders[(orders['CLERK'].str.startswith('C')) & (orders['CLERK'] == 'C')][['O_COMMENT', 'ORDERDATE']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation.merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[(region['R_NAME'] != 'ASI') | (region['R_COMMENT'] == 'h')][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

nation[['N_REGIONKEY', 'N_NAME']].merge(region[(region['R_REGIONKEY'] > 1)][['R_COMMENT']].merge(lineitem[(lineitem['SHIPMODE'] == 'FOB') & (lineitem['QUANTITY'] != 38)][['L_ORDERKEY', 'COMMITDATE']], left_on='R_REGIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_REGIONKEY'] == 0) | (region['R_COMMENT'] != 'h')][['R_REGIONKEY', 'R_COMMENT', 'R_NAME']].merge(nation[(nation['N_COMMENT'].str.startswith(' '))], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NATIONKEY', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_NAME', 'N_REGIONKEY']).agg('mean', numeric_only=True)

customer[(customer['C_ADDRESS'] == 'j') & (customer['C_PHONE'].str.startswith('13-')) & (customer['C_CUSTKEY'] != 84)].merge(nation.merge(supplier[(supplier['S_NATIONKEY'] != 8) & (supplier['S_SUPPKEY'] != 61)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_NATIONKEY', 'C_CUSTKEY']).agg('count')

lineitem.merge(orders[(orders['O_CUSTKEY'] == 87964) & (orders['CLERK'].str.startswith('C'))].merge(lineitem[(lineitem['L_SUPPKEY'] < 4415)][['DISCOUNT', 'LINESTATUS', 'RETURNFLAG']].merge(orders[(orders['TOTALPRICE'] >= 179829.09630786223)][['SHIPPRIORITY', 'CLERK', 'O_CUSTKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['PS_PARTKEY'] >= 19) & (partsupp['AVAILQTY'] == 1264)].merge(supplier[(supplier['S_NATIONKEY'] > 16) | (supplier['S_COMMENT'].str.startswith('b'))][['S_ADDRESS']].merge(lineitem[(lineitem['COMMITDATE'] <= '1992-05-15') | (lineitem['RETURNFLAG'] == 'R')][['RETURNFLAG', 'DISCOUNT']], left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['SHIPINSTRUCT']).agg('mean', numeric_only=True)

customer[(customer['C_NATIONKEY'] > 22)].merge(nation[['N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY', 'N_NAME']].merge(supplier[(supplier['S_COMMENT'].str.startswith('!')) & (supplier['S_NAME'].str.startswith('S'))], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[(region['R_NAME'].str.startswith('AFR'))], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

partsupp[(partsupp['AVAILQTY'] < 6037) | (partsupp['P_COMMENT'] != 'p') & (partsupp['PS_SUPPKEY'] == 5618) | (partsupp['PS_SUPPKEY'] > 2079)].merge(supplier.merge(partsupp[(partsupp['PS_SUPPKEY'] >= 5714)][['SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT', 'AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT', 'N_NAME']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['P_COMMENT', 'SUPPLYCOST']).agg('count')

region[(region['R_COMMENT'] != 'u') & (region['R_REGIONKEY'] < 2) & (region['R_NAME'] == 'A')].merge(nation.merge(region[['R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME']).agg('min', numeric_only=True)

part.merge(partsupp[['PS_PARTKEY', 'PS_SUPPKEY', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_PARTKEY'] < 8)][['PS_SUPPKEY', 'P_COMMENT', 'SUPPLYCOST']].merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

customer.merge(nation[(nation['N_COMMENT'] == 'i')], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[['O_CUSTKEY', 'SHIPPRIORITY', 'ORDERSTATUS']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['O_CUSTKEY', 'SHIPPRIORITY', 'ORDERSTATUS', 'CLERK']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['MKTSEGMENT']).agg('max', numeric_only=True)

part.merge(partsupp[(partsupp['PS_PARTKEY'] > 28)].merge(supplier.merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

part[['CONTAINER', 'RETAILPRICE']].groupby(by=['CONTAINER']).agg('sum', numeric_only=True)

supplier[(supplier['S_NAME'] == 'S')]

lineitem[(lineitem['DISCOUNT'] <= 0.06444048503328621) | (lineitem['L_COMMENT'] != 's. ') & (lineitem['LINENUMBER'] != 2)][['L_ORDERKEY', 'SHIPDATE']].merge(orders[(orders['SHIPPRIORITY'] >= 0) & (orders['SHIPPRIORITY'] > 0)].merge(lineitem.merge(orders[(orders['CLERK'] != 'C')], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['ORDERSTATUS'].isin(['F', 'O']))][['ORDERDATE', 'SHIPPRIORITY', 'O_COMMENT']].merge(customer, left_on='O_ORDERKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['O_CUSTKEY'] <= 116161) & (orders['ORDERDATE'] > '1998-07-21')], left_on='L_ORDERKEY', right_on='O_ORDERKEY').groupby(by=['SHIPDATE']).agg('count')

region[(region['R_COMMENT'] == 'h') | (region['R_NAME'] != 'E')].merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_NAME', 'N_COMMENT']].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier.merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NATIONKEY', 'N_NAME']].merge(supplier.merge(nation[['N_REGIONKEY', 'N_COMMENT']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] < 3)][['N_NAME', 'N_REGIONKEY', 'N_COMMENT']].merge(region[(region['R_REGIONKEY'] == 3)], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('count')

region[(region['R_COMMENT'] != 'l') | (region['R_REGIONKEY'] != 0)].merge(nation[(nation['N_REGIONKEY'] >= 0)].merge(supplier[(supplier['S_ADDRESS'].str.startswith('m')) | (supplier['S_SUPPKEY'] < 156)][['S_ACCTBAL', 'S_NATIONKEY', 'S_PHONE', 'S_COMMENT']], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[(supplier['S_COMMENT'].str.startswith('es ')) & (supplier['S_COMMENT'].str.startswith('q'))].merge(nation[(nation['N_NATIONKEY'] == 21) | (nation['N_NATIONKEY'] == 4)], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_COMMENT']].merge(partsupp[(partsupp['P_COMMENT'].str.startswith('y')) | (partsupp['P_COMMENT'] != 'x')][['PS_SUPPKEY']].merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='N_NATIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(part, left_on='N_NATIONKEY', right_on='P_PARTKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

partsupp[['PS_PARTKEY', 'SUPPLYCOST']].merge(part[(part['P_NAME'].str.startswith('bis')) | (part['P_NAME'] == 's')][['P_PARTKEY', 'MFGR']].merge(partsupp[['PS_PARTKEY', 'AVAILQTY', 'PS_SUPPKEY', 'SUPPLYCOST']].merge(part[['P_NAME', 'CONTAINER']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[['RETURNFLAG', 'LINENUMBER']].merge(orders[(orders['ORDERDATE'] >= '1992-01-13')].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY').merge(region, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['L_COMMENT'].str.startswith('e'))][['COMMITDATE']].merge(customer, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY').merge(nation[['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY')

customer[(customer['C_CUSTKEY'] <= 54) & (customer['C_NAME'].str.startswith('C'))]

region[['R_REGIONKEY']].merge(nation[(nation['N_NAME'].str.startswith('M'))][['N_NATIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(region[(region['R_COMMENT'] != 'u')][['R_NAME']].merge(orders, left_on='R_REGIONKEY', right_on='O_ORDERKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[(supplier['S_COMMENT'] != 'h')][['S_NATIONKEY', 'S_SUPPKEY', 'S_PHONE']].merge(nation[['N_NAME', 'N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] == 17)].merge(customer.merge(nation[(nation['N_NAME'] != 'C')][['N_NAME', 'N_COMMENT', 'N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_REGIONKEY'] == 0) | (region['R_NAME'] != 'AME')][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

customer[(customer['C_ACCTBAL'] == 9383.277532354012) & (customer['C_NATIONKEY'] == 7) & (customer['C_PHONE'] != '18-')][['C_NATIONKEY']].merge(nation[(nation['N_NAME'] == 'M') | (nation['N_COMMENT'] != 's')][['N_COMMENT', 'N_NATIONKEY', 'N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(customer[(customer['C_PHONE'] == '2') | (customer['MKTSEGMENT'].isin(['AUTOMOBILE', 'HOUSEHOLD', 'MACHINERY', 'BUILDING']))][['C_ACCTBAL']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(region[(region['R_REGIONKEY'] > 1)][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_REGIONKEY'] < 1) & (region['R_COMMENT'] == 'u')], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_NATIONKEY']).agg('min', numeric_only=True)

customer[(customer['MKTSEGMENT'] != 'FURNITURE') | (customer['C_COMMENT'] == '.') | (customer['C_CUSTKEY'] != 70) | (customer['C_COMMENT'] != 'k')][['C_COMMENT', 'MKTSEGMENT']].merge(lineitem[(lineitem['COMMITDATE'] <= '1998-10-16')].merge(partsupp[(partsupp['SUPPLYCOST'] >= 686.4569027168117) | (partsupp['AVAILQTY'] > 9742)][['P_COMMENT', 'PS_PARTKEY', 'AVAILQTY', 'PS_SUPPKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'])

part[(part['CONTAINER'] != 'WRAP') | (part['SIZE'] <= 31) | (part['CONTAINER'] == 'MED') | (part['RETAILPRICE'] < 1048.5032113115167)]

lineitem[(lineitem['RECEIPTDATE'] <= '1992-05-02')][['LINENUMBER', 'SHIPMODE']].merge(orders[['ORDERPRIORITY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY').merge(region[(region['R_NAME'] == 'E')][['R_NAME', 'R_REGIONKEY']].merge(nation[['N_COMMENT', 'N_NATIONKEY']].merge(customer[(customer['C_ADDRESS'] != 'o') | (customer['C_NATIONKEY'] < 14)], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY').merge(customer[['C_ACCTBAL']].merge(nation.merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_CUSTKEY', right_on='N_NATIONKEY').merge(nation[['N_COMMENT', 'N_NATIONKEY', 'N_NAME']], left_on='C_CUSTKEY', right_on='N_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY').groupby(by=['LINENUMBER', 'SHIPMODE']).agg('min', numeric_only=True)

customer[(customer['C_CUSTKEY'] > 57)].merge(nation[['N_REGIONKEY', 'N_COMMENT', 'N_NAME', 'N_NATIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_NATIONKEY', 'C_ACCTBAL']).agg('max', numeric_only=True)

supplier.merge(nation[['N_NAME', 'N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY']].merge(region[(region['R_NAME'] == 'AFR') | (region['R_NAME'] == 'AME')][['R_COMMENT', 'R_REGIONKEY', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_COMMENT'] == 'l') & (region['R_NAME'].str.startswith('M'))][['R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(supplier[(supplier['S_ADDRESS'].str.startswith('3'))].merge(nation[(nation['N_NATIONKEY'] > 3)][['N_REGIONKEY', 'N_COMMENT', 'N_NAME']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[(region['R_COMMENT'].str.startswith('g'))], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_ADDRESS']).agg('max', numeric_only=True)

customer[(customer['C_ADDRESS'].str.startswith('x')) | (customer['C_NATIONKEY'] > 18) | (customer['C_PHONE'] == '22-') | (customer['C_CUSTKEY'] != 31)][['C_ACCTBAL', 'C_PHONE']].merge(orders[(orders['O_COMMENT'].str.startswith('w')) & (orders['ORDERPRIORITY'].isin(['3-MEDIUM', '4-NOT SPECIFIED', '1-URGENT']))].merge(customer[(customer['C_CUSTKEY'] == 70)][['C_NATIONKEY']].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[['C_NATIONKEY', 'C_NAME', 'C_ACCTBAL']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_ORDERKEY').merge(orders.merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[['C_CUSTKEY', 'MKTSEGMENT']].merge(orders[(orders['O_ORDERKEY'] <= 714)][['O_COMMENT', 'ORDERDATE', 'SHIPPRIORITY', 'O_ORDERKEY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_ORDERKEY').merge(region[(region['R_NAME'].str.startswith('AME')) & (region['R_NAME'].str.startswith('A'))], left_on='C_CUSTKEY', right_on='R_REGIONKEY')

customer.merge(nation[['N_NAME', 'N_COMMENT']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NATIONKEY'] <= 23) & (nation['N_COMMENT'] == 'r')].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[(orders['O_CUSTKEY'] != 68152)][['SHIPPRIORITY']].merge(supplier[(supplier['S_COMMENT'].str.startswith('q')) | (supplier['S_SUPPKEY'] <= 182)].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='S_SUPPKEY').merge(nation[(nation['N_REGIONKEY'] > 0)], left_on='O_ORDERKEY', right_on='N_NATIONKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_NAME']).agg('mean', numeric_only=True)

orders[(orders['TOTALPRICE'] < 265066.7307151259) | (orders['O_ORDERKEY'] != 700) & (orders['O_COMMENT'].str.startswith('b'))].merge(customer[(customer['C_NAME'] != 'C')][['C_NAME', 'MKTSEGMENT']].merge(partsupp[(partsupp['AVAILQTY'] < 8252)], left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(lineitem.merge(partsupp[(partsupp['PS_PARTKEY'] != 35)][['AVAILQTY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[['QUANTITY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['SHIPMODE'] == 'SHIP')].merge(partsupp[['SUPPLYCOST', 'PS_SUPPKEY', 'AVAILQTY', 'P_COMMENT']].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(orders[(orders['ORDERPRIORITY'] != '1-URGENT') & (orders['ORDERSTATUS'].isin(['P', 'F']))][['O_CUSTKEY', 'O_ORDERKEY', 'CLERK']].merge(customer[(customer['C_PHONE'] == '18-')], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['TOTALPRICE']).agg('mean', numeric_only=True)

customer

nation[(nation['N_NAME'] == 'V')].merge(supplier[['S_ADDRESS']].merge(orders[(orders['O_CUSTKEY'] >= 40199)].merge(lineitem[['L_PARTKEY', 'L_SUPPKEY', 'L_ORDERKEY', 'LINESTATUS']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='S_SUPPKEY', right_on='O_ORDERKEY').merge(orders[['ORDERSTATUS', 'ORDERDATE']], left_on='S_SUPPKEY', right_on='O_ORDERKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[(region['R_COMMENT'] != 'h')], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_REGIONKEY'] != 2) | (region['R_REGIONKEY'] <= 1)].merge(nation[(nation['N_NATIONKEY'] < 11) | (nation['N_REGIONKEY'] >= 3)].merge(supplier[(supplier['S_PHONE'] != '28-') & (supplier['S_SUPPKEY'] != 57)][['S_NAME']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY')

lineitem[(lineitem['L_ORDERKEY'] < 141) & (lineitem['SHIPDATE'] < '1998-10-30') | (lineitem['EXTENDEDPRICE'] >= 7139.764560865591)][['L_SUPPKEY']].merge(partsupp[(partsupp['PS_PARTKEY'] == 48) | (partsupp['AVAILQTY'] != 6895)].merge(lineitem[(lineitem['SHIPDATE'] < '1998-10-30')].merge(partsupp[(partsupp['PS_SUPPKEY'] != 2671) & (partsupp['PS_PARTKEY'] != 16)][['P_COMMENT', 'PS_PARTKEY', 'SUPPLYCOST', 'AVAILQTY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['L_SUPPKEY']).agg('sum', numeric_only=True)

customer.merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(customer[(customer['C_NATIONKEY'] < 0)].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_COMMENT'] == 'x') & (supplier['S_ADDRESS'].str.startswith('3'))], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[['TOTALPRICE', 'ORDERPRIORITY', 'O_CUSTKEY']].merge(customer[(customer['C_ADDRESS'].str.startswith('D'))].merge(orders[['ORDERPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_NAME'] != 'C') | (customer['MKTSEGMENT'] == 'MACHINERY')], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['MKTSEGMENT', 'C_NAME']).agg('sum', numeric_only=True)

customer.merge(orders[(orders['ORDERDATE'] >= '1998-07-21')].merge(lineitem.merge(partsupp[(partsupp['P_COMMENT'].str.startswith('p'))][['PS_PARTKEY', 'SUPPLYCOST', 'P_COMMENT']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[['MKTSEGMENT', 'C_CUSTKEY', 'C_NATIONKEY']].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_ACCTBAL']).agg('min', numeric_only=True)

part.merge(partsupp[(partsupp['PS_SUPPKEY'] <= 3697) | (partsupp['P_COMMENT'] == ';')][['PS_PARTKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'] == ' th') | (partsupp['AVAILQTY'] >= 7388)][['PS_SUPPKEY', 'P_COMMENT', 'SUPPLYCOST']].merge(supplier[['S_ADDRESS', 'S_PHONE', 'S_NAME']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['BRAND', 'TYPE']).agg('min', numeric_only=True)

lineitem[['RECEIPTDATE', 'EXTENDEDPRICE', 'L_SUPPKEY', 'DISCOUNT']].groupby(by=['EXTENDEDPRICE']).agg('max', numeric_only=True)

orders[(orders['CLERK'] == 'C')][['O_ORDERKEY', 'ORDERSTATUS']].merge(lineitem[(lineitem['TAX'] != 0.042430415228047295) | (lineitem['DISCOUNT'] == 0.057254547267046575)][['SHIPMODE']].merge(orders[['O_COMMENT', 'CLERK', 'O_CUSTKEY', 'O_ORDERKEY']].merge(lineitem[(lineitem['LINENUMBER'] > 4) & (lineitem['TAX'] < 0.03148110108568771)], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY').merge(orders[(orders['ORDERPRIORITY'] == '4-NOT SPECIFIED')].merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['QUANTITY'] <= 8)][['RETURNFLAG', 'RECEIPTDATE']].merge(partsupp[(partsupp['SUPPLYCOST'] <= 745.2521974980219) | (partsupp['SUPPLYCOST'] <= 394.87993664712536)][['AVAILQTY', 'SUPPLYCOST', 'PS_PARTKEY', 'P_COMMENT']].merge(part[(part['TYPE'].str.startswith('P'))], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(part[['PT_COMMENT', 'SIZE', 'RETAILPRICE']].merge(nation[(nation['N_COMMENT'] != 't') | (nation['N_NAME'].str.startswith('S'))][['N_COMMENT', 'N_NATIONKEY', 'N_NAME']], left_on='P_PARTKEY', right_on='N_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['TAX'] >= 0.06322336579527185) | (lineitem['L_PARTKEY'] > 112816)], left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['O_ORDERKEY']).agg('mean', numeric_only=True)

region.merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(supplier[['S_SUPPKEY', 'S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[(supplier['S_NAME'] == 'S')], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(supplier[(supplier['S_COMMENT'].str.startswith('r'))], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY', 'R_COMMENT']).agg('max', numeric_only=True)

customer[(customer['C_PHONE'].str.startswith('13-'))][['C_NAME', 'C_ACCTBAL', 'C_CUSTKEY', 'MKTSEGMENT', 'C_COMMENT']].merge(orders[(orders['ORDERPRIORITY'].isin(['2-HIGH', '5-LOW', '3-MEDIUM', '4-NOT SPECIFIED', '1-URGENT']))][['CLERK', 'O_ORDERKEY']].merge(lineitem[(lineitem['L_SUPPKEY'] == 246)].merge(orders[(orders['TOTALPRICE'] <= 109504.67555432196)][['O_COMMENT', 'CLERK']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['ORDERPRIORITY'] == '3-MEDIUM') & (orders['ORDERDATE'] >= '1992-01-13')][['O_ORDERKEY', 'O_CUSTKEY']].merge(customer[['C_NATIONKEY']].merge(nation[['N_NAME', 'N_COMMENT', 'N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer.merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders.merge(customer[(customer['C_PHONE'] != '2') & (customer['C_COMMENT'].str.startswith('n'))], left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_NATIONKEY'] == 11)][['C_NAME']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

region.merge(nation.merge(customer[(customer['MKTSEGMENT'] != 'HOUSEHOLD') | (customer['C_COMMENT'].str.startswith('r'))][['C_NAME', 'C_ADDRESS', 'C_NATIONKEY', 'C_PHONE']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] < 17) | (nation['N_COMMENT'] != 'u')][['N_NAME']].merge(customer[['C_NATIONKEY', 'MKTSEGMENT']].merge(nation[['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_CUSTKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] != 1079)].merge(lineitem[(lineitem['EXTENDEDPRICE'] > 40369.730579555544)], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='N_NATIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

nation.groupby(by=['N_REGIONKEY', 'N_NAME']).agg('min', numeric_only=True)

lineitem[(lineitem['L_SUPPKEY'] >= 1895) | (lineitem['TAX'] < 0.05290419284219303)]

orders.merge(lineitem.merge(partsupp[['SUPPLYCOST', 'PS_PARTKEY', 'P_COMMENT']].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(orders[['ORDERDATE', 'ORDERSTATUS', 'TOTALPRICE']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['RETURNFLAG'] == 'N')][['L_SUPPKEY', 'QUANTITY']].merge(partsupp[(partsupp['P_COMMENT'] != 'e') | (partsupp['SUPPLYCOST'] != 834.2811109735529)][['PS_PARTKEY', 'P_COMMENT', 'PS_SUPPKEY', 'SUPPLYCOST']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['O_CUSTKEY', 'O_COMMENT']).agg('max', numeric_only=True)

partsupp[['AVAILQTY', 'SUPPLYCOST', 'P_COMMENT', 'PS_PARTKEY', 'PS_SUPPKEY']].merge(supplier[(supplier['S_NAME'] != 'S')][['S_ADDRESS', 'S_NATIONKEY']].merge(nation[(nation['N_COMMENT'].str.startswith('i'))], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_COMMENT', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier.merge(nation[(nation['N_NATIONKEY'] < 22) & (nation['N_NAME'] != 'F')][['N_NATIONKEY', 'N_COMMENT']].merge(customer[(customer['MKTSEGMENT'].isin(['HOUSEHOLD']))], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[['PS_PARTKEY', 'PS_SUPPKEY', 'AVAILQTY', 'P_COMMENT']].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['PS_PARTKEY', 'SUPPLYCOST']).agg('sum', numeric_only=True)

part[(part['P_PARTKEY'] >= 22) | (part['BRAND'] == 'Brand#53') & (part['TYPE'] == 'L') & (part['MFGR'].isin(['Manufacturer#4']))][['CONTAINER', 'P_PARTKEY', 'RETAILPRICE']].merge(partsupp[['SUPPLYCOST', 'PS_PARTKEY', 'PS_SUPPKEY', 'P_COMMENT']].merge(part[(part['BRAND'] != 'Brand#45')].merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

supplier[['S_NAME', 'S_COMMENT', 'S_ACCTBAL', 'S_NATIONKEY', 'S_SUPPKEY']].merge(nation[['N_NAME', 'N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_NATIONKEY']).agg('max', numeric_only=True)

customer[(customer['C_NAME'] == 'C') | (customer['C_ADDRESS'] != 'a') & (customer['C_ADDRESS'] != 'Q') & (customer['C_COMMENT'] == 'g')].merge(orders[(orders['O_COMMENT'] != 'ly ')][['CLERK', 'TOTALPRICE', 'O_ORDERKEY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['ORDERPRIORITY'].isin(['1-URGENT', '5-LOW'])) & (orders['ORDERPRIORITY'] == '3-MEDIUM')].merge(lineitem.merge(partsupp[(partsupp['P_COMMENT'].str.startswith('p')) | (partsupp['SUPPLYCOST'] == 298.06112191450336)], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_ADDRESS'] == 'x')][['C_ACCTBAL', 'C_ADDRESS']].merge(nation[(nation['N_REGIONKEY'] < 2)][['N_COMMENT', 'N_NAME']], left_on='C_CUSTKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_COMMENT']).agg('sum', numeric_only=True)

partsupp[(partsupp['AVAILQTY'] >= 2249)]

orders[(orders['SHIPPRIORITY'] > 0) & (orders['ORDERPRIORITY'].isin(['4-NOT SPECIFIED', '1-URGENT', '2-HIGH', '3-MEDIUM'])) & (orders['CLERK'].str.startswith('C')) & (orders['TOTALPRICE'] > 163823.38108779126)].merge(lineitem[(lineitem['LINENUMBER'] == 5)][['COMMITDATE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['QUANTITY'] < 44)].merge(partsupp[(partsupp['PS_PARTKEY'] <= 15)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['P_COMMENT'] != 'ly ') | (partsupp['SUPPLYCOST'] < 402.2741827171375)][['PS_SUPPKEY', 'AVAILQTY']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['L_COMMENT'] == 'h')][['TAX', 'EXTENDEDPRICE', 'L_SUPPKEY', 'RETURNFLAG']], left_on='O_ORDERKEY', right_on='L_ORDERKEY')

supplier[(supplier['S_NATIONKEY'] == 1) & (supplier['S_SUPPKEY'] == 156)].merge(nation[['N_NAME', 'N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']].merge(customer.merge(nation[(nation['N_COMMENT'] != 'a')][['N_NATIONKEY', 'N_COMMENT']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier.merge(nation[(nation['N_COMMENT'] != 'o')][['N_NAME']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_COMMENT'].str.startswith('a'))].merge(region[(region['R_REGIONKEY'] > 0)], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(customer[(customer['C_NAME'] == 'C') & (customer['C_COMMENT'].str.startswith('d'))][['C_COMMENT']].merge(lineitem[(lineitem['SHIPDATE'] == '1992-04-27') & (lineitem['SHIPINSTRUCT'].isin(['TAKE BACK RETURN', 'DELIVER IN PERSON']))][['SHIPINSTRUCT', 'L_ORDERKEY']], left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY')

lineitem[(lineitem['SHIPDATE'] > '1998-10-30') & (lineitem['QUANTITY'] >= 1) | (lineitem['LINESTATUS'] != 'F') & (lineitem['LINESTATUS'].isin(['O']))].merge(orders.merge(customer[['C_CUSTKEY']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY')

partsupp[(partsupp['SUPPLYCOST'] <= 550.8817366231413) | (partsupp['PS_SUPPKEY'] != 5835)].merge(lineitem[(lineitem['SHIPDATE'] != '1998-10-30')].merge(partsupp[(partsupp['PS_PARTKEY'] > 26) & (partsupp['P_COMMENT'] != 'x')].merge(supplier[['S_SUPPKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(orders[(orders['O_CUSTKEY'] > 126708)][['ORDERDATE']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY')

part[(part['TYPE'].str.startswith('STA')) & (part['P_PARTKEY'] < 162) | (part['CONTAINER'] != 'LG') | (part['MFGR'] == 'Manufacturer#5')].merge(partsupp[(partsupp['PS_SUPPKEY'] <= 7408) | (partsupp['PS_SUPPKEY'] > 6653)].merge(part[(part['TYPE'] != 'E') | (part['TYPE'] == 'SMA')], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem.merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['P_NAME']).agg('mean', numeric_only=True)

part[(part['RETAILPRICE'] < 975.1148820241756) & (part['MFGR'] != 'Manufacturer#1') | (part['P_PARTKEY'] == 30) & (part['BRAND'] != 'Brand#25')][['MFGR', 'CONTAINER']].merge(region.merge(nation[(nation['N_NATIONKEY'] != 16) | (nation['N_COMMENT'] != 'n')][['N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] == 'J')][['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='P_PARTKEY', right_on='R_REGIONKEY').merge(nation[(nation['N_COMMENT'].str.startswith('t'))].merge(supplier[(supplier['S_COMMENT'] == 'w') & (supplier['S_SUPPKEY'] != 24)][['S_ADDRESS']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='P_PARTKEY', right_on='N_NATIONKEY').groupby(by=['CONTAINER']).agg('min', numeric_only=True)

lineitem[(lineitem['SHIPMODE'] == 'RAIL') | (lineitem['TAX'] > 0.06523490614995885) & (lineitem['RETURNFLAG'] == 'R') | (lineitem['TAX'] == 0.06861904580691748)].merge(orders[(orders['CLERK'] != 'C')][['ORDERPRIORITY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp.merge(supplier[(supplier['S_COMMENT'] == 'h') & (supplier['S_NATIONKEY'] != 6)], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(part[['MFGR', 'CONTAINER', 'BRAND']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY')

partsupp[['SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT']]

customer[(customer['C_NATIONKEY'] > 2) | (customer['C_ADDRESS'].str.startswith('Q')) | (customer['C_NAME'] != 'C') & (customer['C_ADDRESS'].str.startswith('j'))].merge(orders[(orders['O_ORDERKEY'] == 204) | (orders['O_COMMENT'] == 'c')].merge(lineitem.merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[['SHIPMODE', 'TAX']].merge(customer[['C_NAME', 'C_PHONE', 'C_CUSTKEY', 'C_ADDRESS']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_COMMENT'] != 'e')][['N_NATIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_ACCTBAL', 'C_PHONE']).agg('max', numeric_only=True)

supplier[(supplier['S_ADDRESS'].str.startswith('O'))][['S_SUPPKEY', 'S_NAME']].merge(partsupp[(partsupp['PS_SUPPKEY'] == 4397) | (partsupp['PS_SUPPKEY'] <= 221)][['SUPPLYCOST', 'AVAILQTY']].merge(nation[(nation['N_NAME'].str.startswith('M')) | (nation['N_COMMENT'].str.startswith('n'))].merge(region[(region['R_COMMENT'] != 'g') | (region['R_COMMENT'] == 'l')][['R_NAME', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY').merge(region[(region['R_REGIONKEY'] != 3)][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='R_REGIONKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['AVAILQTY'] > 9187) | (partsupp['P_COMMENT'] == 'l')][['PS_SUPPKEY', 'PS_PARTKEY', 'AVAILQTY']].merge(part[(part['CONTAINER'] == 'MED')], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

supplier[(supplier['S_PHONE'].str.startswith('26-')) & (supplier['S_NAME'] != 'S') | (supplier['S_NAME'] == 'S')].merge(nation[(nation['N_COMMENT'] == 'y') | (nation['N_NAME'] == 'E')].merge(region.merge(nation[['N_COMMENT', 'N_NAME', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[['S_ADDRESS', 'S_ACCTBAL', 'S_COMMENT', 'S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY')

lineitem.merge(partsupp.merge(lineitem[(lineitem['SHIPDATE'] < '1998-10-30') & (lineitem['RETURNFLAG'] != 'R')], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['LINENUMBER']).agg('mean', numeric_only=True)

orders[(orders['ORDERPRIORITY'].isin(['1-URGENT', '5-LOW', '3-MEDIUM', '4-NOT SPECIFIED', '2-HIGH'])) & (orders['O_COMMENT'].str.startswith('k'))][['SHIPPRIORITY', 'O_CUSTKEY', 'O_ORDERKEY', 'ORDERSTATUS']].merge(lineitem[(lineitem['LINESTATUS'] == 'F') & (lineitem['TAX'] >= 0.007531200848291988)][['SHIPMODE', 'SHIPDATE', 'EXTENDEDPRICE', 'RECEIPTDATE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[['C_NAME', 'C_PHONE', 'C_NATIONKEY']], left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_ACCTBAL'] > 6342.874279025483)].merge(orders[(orders['O_CUSTKEY'] == 41114) | (orders['SHIPPRIORITY'] <= 0)][['O_CUSTKEY']].merge(customer[(customer['C_ADDRESS'] == 'R') & (customer['C_CUSTKEY'] != 74)][['C_COMMENT']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[['N_NAME', 'N_NATIONKEY', 'N_COMMENT']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

lineitem[(lineitem['TAX'] > 0.01662804604515151) & (lineitem['TAX'] != 0.048999967649035345) & (lineitem['SHIPDATE'] < '1998-10-30') | (lineitem['SHIPDATE'] == '1998-10-30')][['TAX', 'L_COMMENT', 'COMMITDATE', 'EXTENDEDPRICE']].merge(region[(region['R_NAME'] != 'A') & (region['R_NAME'] != 'E')][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation[(nation['N_NAME'].str.startswith('R')) | (nation['N_COMMENT'] != 'o')].merge(region[(region['R_NAME'] != 'ASI') & (region['R_COMMENT'].str.startswith('u'))][['R_NAME', 'R_COMMENT', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'].str.startswith('r'))], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY').groupby(by=['COMMITDATE', 'EXTENDEDPRICE']).agg('mean', numeric_only=True)

part.merge(partsupp[(partsupp['PS_PARTKEY'] <= 28) | (partsupp['P_COMMENT'] == 's')].merge(part[['P_NAME', 'P_PARTKEY']].merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(lineitem[(lineitem['DISCOUNT'] < 0.028222214816633142) & (lineitem['L_SUPPKEY'] >= 4253)][['SHIPINSTRUCT', 'LINESTATUS']].merge(part[(part['MFGR'] == 'Manufacturer#5')], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier[['S_NAME']].merge(region[(region['R_NAME'].str.startswith('AFR')) & (region['R_COMMENT'] != 'u')][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']], left_on='S_SUPPKEY', right_on='R_REGIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['P_PARTKEY']).agg('max', numeric_only=True)

orders.merge(lineitem[(lineitem['L_SUPPKEY'] <= 5335)][['L_COMMENT', 'L_ORDERKEY']].merge(orders[(orders['O_CUSTKEY'] > 84779) & (orders['O_ORDERKEY'] <= 589)][['CLERK', 'ORDERPRIORITY']].merge(part[(part['CONTAINER'] != 'SM') & (part['SIZE'] < 40)], left_on='O_ORDERKEY', right_on='P_PARTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[['CLERK', 'O_ORDERKEY', 'ORDERSTATUS', 'ORDERDATE']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_CUSTKEY'] <= 9)].merge(nation[(nation['N_COMMENT'] != 'u') | (nation['N_NATIONKEY'] != 20)][['N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[(orders['TOTALPRICE'] < 197069.33932435277) & (orders['O_CUSTKEY'] > 44919)][['SHIPPRIORITY', 'ORDERDATE', 'O_ORDERKEY', 'O_CUSTKEY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY')

region[(region['R_NAME'] == 'ASI') | (region['R_NAME'] == 'M') | (region['R_COMMENT'].str.startswith('l')) & (region['R_REGIONKEY'] == 3)][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].merge(nation[(nation['N_REGIONKEY'] >= 3) & (nation['N_COMMENT'] != 's')][['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']].merge(customer[(customer['C_NAME'].str.startswith('C')) | (customer['C_PHONE'].str.startswith('22-'))], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region.merge(nation[(nation['N_NATIONKEY'] > 18) | (nation['N_NATIONKEY'] <= 22)][['N_REGIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME', 'R_REGIONKEY']).agg('min', numeric_only=True)

lineitem.merge(orders[['TOTALPRICE', 'ORDERPRIORITY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp.merge(part[['MFGR']].merge(region[(region['R_REGIONKEY'] < 1) & (region['R_COMMENT'].str.startswith('g'))], left_on='P_PARTKEY', right_on='R_REGIONKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[['MFGR', 'RETAILPRICE', 'TYPE', 'P_NAME']].merge(partsupp[['P_COMMENT']], left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY')

nation[(nation['N_COMMENT'] != 't') & (nation['N_COMMENT'].str.startswith('r'))].merge(region.merge(nation[(nation['N_NATIONKEY'] <= 10)].merge(customer[['C_NATIONKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[(customer['MKTSEGMENT'] != 'MACHINERY')][['C_NAME']].merge(part.merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='C_CUSTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['RETURNFLAG'] == 'R') & (lineitem['COMMITDATE'] == '1992-05-15')][['L_ORDERKEY', 'SHIPDATE', 'RETURNFLAG']], left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_NATIONKEY', 'N_REGIONKEY']).agg('sum', numeric_only=True)

lineitem[(lineitem['RECEIPTDATE'] != '1998-11-06') | (lineitem['EXTENDEDPRICE'] < 14164.16107592058)][['L_COMMENT']].merge(orders[['ORDERSTATUS', 'ORDERPRIORITY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY').merge(nation[(nation['N_REGIONKEY'] > 0) | (nation['N_NATIONKEY'] == 7)].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[(customer['C_COMMENT'].str.startswith('s')) | (customer['C_ADDRESS'] != 'v')].merge(nation[['N_COMMENT', 'N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY').merge(region[['R_NAME', 'R_REGIONKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY').groupby(by=['L_COMMENT']).agg('count')

nation.merge(customer.merge(nation[['N_NATIONKEY', 'N_REGIONKEY']].merge(region[['R_REGIONKEY', 'R_COMMENT', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NAME'] != 'J') & (nation['N_NATIONKEY'] > 23)][['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT', 'N_NAME']].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[(customer['C_COMMENT'] == '.')][['C_NAME']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_COMMENT'] == 'g') & (region['R_COMMENT'].str.startswith('l'))], left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_COMMENT']).agg('mean', numeric_only=True)

nation[(nation['N_NAME'] != 'A') | (nation['N_NAME'].str.startswith('B'))]

supplier[['S_NATIONKEY', 'S_ACCTBAL', 'S_NAME', 'S_COMMENT']].merge(nation[(nation['N_NATIONKEY'] <= 0)][['N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY']].merge(customer[(customer['MKTSEGMENT'] != 'FURNITURE')][['C_ADDRESS', 'C_CUSTKEY', 'C_ACCTBAL', 'MKTSEGMENT']].merge(orders[['SHIPPRIORITY', 'ORDERSTATUS']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_COMMENT'].str.startswith('r')) | (nation['N_REGIONKEY'] != 0)].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY')

part[(part['SIZE'] == 14)].merge(partsupp.merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(part[(part['PT_COMMENT'] != 'a') & (part['SIZE'] >= 38)][['CONTAINER', 'PT_COMMENT', 'P_PARTKEY', 'P_NAME']].merge(partsupp[(partsupp['AVAILQTY'] >= 7411) | (partsupp['PS_SUPPKEY'] < 1700)][['PS_SUPPKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY')

lineitem[(lineitem['RETURNFLAG'] == 'N')].merge(partsupp[(partsupp['SUPPLYCOST'] >= 449.48194381516055)][['P_COMMENT', 'AVAILQTY']].merge(orders[['TOTALPRICE', 'ORDERPRIORITY', 'ORDERDATE', 'O_ORDERKEY']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='O_ORDERKEY').merge(orders[(orders['O_ORDERKEY'] >= 557) | (orders['ORDERPRIORITY'] == '2-HIGH')], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='O_ORDERKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(orders[(orders['O_ORDERKEY'] >= 260)].merge(lineitem[(lineitem['DISCOUNT'] > 0.09073412961539698)].merge(orders[(orders['ORDERDATE'] > '1998-07-21')][['ORDERPRIORITY', 'TOTALPRICE']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem.merge(orders[(orders['TOTALPRICE'] < 221849.8853486463)], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['AVAILQTY'] != 5384) & (partsupp['SUPPLYCOST'] >= 411.4937239666574)].merge(supplier[(supplier['S_SUPPKEY'] >= 185)], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['RECEIPTDATE', 'RETURNFLAG']).agg('count')

customer[(customer['C_PHONE'] != '3') | (customer['C_PHONE'].str.startswith('2'))][['C_NAME', 'C_COMMENT', 'C_CUSTKEY']].groupby(by=['C_NAME']).agg('count')

supplier.merge(nation.merge(region[['R_COMMENT']].merge(supplier[['S_NAME', 'S_ACCTBAL', 'S_ADDRESS', 'S_SUPPKEY']], left_on='R_REGIONKEY', right_on='S_SUPPKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[(customer['C_COMMENT'] == 't') & (customer['C_NATIONKEY'] > 17)][['C_NAME', 'C_NATIONKEY', 'C_PHONE', 'C_CUSTKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(customer[(customer['C_NAME'] != 'C')][['C_NATIONKEY', 'C_NAME', 'C_PHONE', 'C_ACCTBAL']].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['SUPPLYCOST'] > 195.58182618206868) & (partsupp['P_COMMENT'] != ',')][['PS_PARTKEY', 'PS_SUPPKEY', 'AVAILQTY']].merge(lineitem[['TAX', 'COMMITDATE', 'RETURNFLAG']].merge(orders[(orders['O_ORDERKEY'] <= 198) | (orders['ORDERDATE'] >= '1998-07-21')], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(part[(part['CONTAINER'] == 'SM') & (part['PT_COMMENT'].str.startswith('d'))][['P_PARTKEY', 'RETAILPRICE', 'TYPE', 'SIZE']].merge(partsupp[['AVAILQTY', 'PS_PARTKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_NAME', 'S_PHONE']).agg('min', numeric_only=True)

supplier.merge(partsupp.merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[['N_COMMENT', 'N_NAME']].merge(region.merge(nation[(nation['N_NATIONKEY'] > 12) & (nation['N_NAME'].str.startswith('E'))][['N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_NATIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NATIONKEY'] >= 20)].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY')

partsupp[(partsupp['PS_PARTKEY'] > 26) | (partsupp['P_COMMENT'] != 'u') & (partsupp['PS_PARTKEY'] <= 29) & (partsupp['PS_PARTKEY'] < 49)].merge(supplier[(supplier['S_ADDRESS'] != 'M') & (supplier['S_NAME'].str.startswith('S'))][['S_ACCTBAL', 'S_NATIONKEY', 'S_ADDRESS']].merge(nation[(nation['N_NAME'] != 'M') | (nation['N_COMMENT'] == 'p')].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_COMMENT']].merge(lineitem[(lineitem['L_PARTKEY'] > 83930)], left_on='N_NATIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(part[(part['P_PARTKEY'] < 190)][['PT_COMMENT', 'RETAILPRICE', 'BRAND', 'P_PARTKEY']].merge(partsupp[(partsupp['PS_PARTKEY'] <= 6) | (partsupp['PS_SUPPKEY'] <= 1581)].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['L_PARTKEY'] >= 105314) | (lineitem['SHIPMODE'] == 'REG AIR')][['COMMITDATE', 'SHIPMODE', 'RECEIPTDATE', 'LINESTATUS']].merge(customer[['C_COMMENT', 'C_NATIONKEY', 'C_NAME']].merge(nation[(nation['N_COMMENT'] == 't')], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY')

orders[(orders['O_CUSTKEY'] > 13436)].merge(lineitem[['L_SUPPKEY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['ORDERSTATUS', 'CLERK']).agg('min', numeric_only=True)

supplier[['S_COMMENT', 'S_ADDRESS', 'S_PHONE', 'S_SUPPKEY', 'S_ACCTBAL']]

part.merge(partsupp[(partsupp['P_COMMENT'] != '.') | (partsupp['PS_SUPPKEY'] >= 843)].merge(lineitem[(lineitem['RETURNFLAG'].isin(['A', 'N']))][['RETURNFLAG']].merge(partsupp[(partsupp['PS_PARTKEY'] > 24) | (partsupp['AVAILQTY'] != 1972)], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_PARTKEY', 'P_COMMENT']].merge(lineitem[(lineitem['SHIPDATE'] <= '1998-10-30')][['LINESTATUS', 'SHIPDATE', 'TAX']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['P_NAME', 'PT_COMMENT']).agg('min', numeric_only=True)

orders[['CLERK', 'O_ORDERKEY']].merge(lineitem.merge(partsupp[(partsupp['SUPPLYCOST'] >= 441.8313445973075)], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY')

lineitem[(lineitem['DISCOUNT'] == 0.07283375686496597) | (lineitem['TAX'] >= 0.0006043798556296221) | (lineitem['L_PARTKEY'] > 115696) & (lineitem['DISCOUNT'] <= 0.02469574119110043)]

supplier.merge(partsupp[(partsupp['SUPPLYCOST'] > 426.39641191203776) & (partsupp['P_COMMENT'].str.startswith('i'))], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_ACCTBAL']).agg('min', numeric_only=True)

lineitem[(lineitem['L_PARTKEY'] != 155021) | (lineitem['SHIPINSTRUCT'].isin(['DELIVER IN PERSON', 'COLLECT COD', 'TAKE BACK RETURN', 'NONE'])) | (lineitem['LINESTATUS'] != 'F') | (lineitem['LINESTATUS'] != 'O')].merge(partsupp[(partsupp['AVAILQTY'] >= 1756)][['SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT', 'PS_PARTKEY']].merge(lineitem[(lineitem['COMMITDATE'] <= '1998-10-16')].merge(partsupp[['PS_PARTKEY', 'PS_SUPPKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['AVAILQTY', 'PS_SUPPKEY', 'PS_PARTKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(orders[(orders['O_ORDERKEY'] >= 112)].merge(lineitem[(lineitem['SHIPDATE'] > '1992-04-27')], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY')

customer[(customer['C_PHONE'] == '3') | (customer['C_COMMENT'] == 'o') & (customer['C_ADDRESS'] != 'O') & (customer['MKTSEGMENT'] != 'HOUSEHOLD')].merge(nation.merge(supplier[['S_ACCTBAL', 'S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[['SHIPPRIORITY', 'ORDERSTATUS', 'ORDERPRIORITY', 'CLERK']].merge(partsupp[(partsupp['SUPPLYCOST'] == 248.01308527714383)].merge(lineitem[(lineitem['L_SUPPKEY'] != 723)][['L_COMMENT', 'TAX']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(region.merge(nation[(nation['N_NATIONKEY'] == 4) & (nation['N_NATIONKEY'] != 12)][['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='O_ORDERKEY', right_on='R_REGIONKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_NATIONKEY'] < 3) | (nation['N_REGIONKEY'] <= 0)][['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

lineitem[['DISCOUNT', 'TAX', 'SHIPINSTRUCT', 'L_PARTKEY', 'L_ORDERKEY']].merge(orders[(orders['O_ORDERKEY'] >= 391)][['SHIPPRIORITY', 'O_COMMENT', 'ORDERSTATUS', 'ORDERPRIORITY']].merge(region.merge(nation[(nation['N_NAME'] == 'P') & (nation['N_NAME'] != 'U')][['N_COMMENT', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='O_ORDERKEY', right_on='R_REGIONKEY').merge(partsupp, left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='L_ORDERKEY', right_on='O_ORDERKEY')

part[(part['TYPE'].str.startswith('STA')) | (part['SIZE'] <= 34) & (part['MFGR'] == 'Manufacturer#4') | (part['MFGR'].isin(['Manufacturer#5']))][['CONTAINER', 'PT_COMMENT', 'P_PARTKEY', 'P_NAME']].merge(partsupp[(partsupp['SUPPLYCOST'] < 528.9322080290121) & (partsupp['PS_PARTKEY'] > 1)][['AVAILQTY', 'PS_PARTKEY', 'PS_SUPPKEY']].merge(part.merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[['RETURNFLAG', 'L_SUPPKEY', 'QUANTITY']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['AVAILQTY'] == 8381)].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_SUPPKEY', 'P_COMMENT', 'PS_PARTKEY', 'AVAILQTY']].merge(part[['BRAND', 'TYPE', 'MFGR', 'P_NAME']], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(supplier.merge(partsupp[(partsupp['PS_PARTKEY'] != 20) | (partsupp['AVAILQTY'] < 3839)][['AVAILQTY', 'SUPPLYCOST', 'P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['P_NAME']).agg('min', numeric_only=True)

part.merge(partsupp[['AVAILQTY', 'SUPPLYCOST', 'PS_SUPPKEY']].merge(supplier[(supplier['S_ADDRESS'] != 'l') | (supplier['S_ADDRESS'].str.startswith('D'))][['S_NATIONKEY']].merge(nation[(nation['N_NATIONKEY'] > 4) & (nation['N_REGIONKEY'] != 3)], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem.merge(partsupp[['PS_PARTKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['CONTAINER', 'PT_COMMENT']).agg('sum', numeric_only=True)

supplier[['S_PHONE']].merge(nation[(nation['N_NAME'] == 'I')][['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME']].merge(supplier[(supplier['S_ADDRESS'] != ',') & (supplier['S_PHONE'] == '1')], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_SUPPKEY', right_on='N_NATIONKEY').merge(part[(part['PT_COMMENT'].str.startswith('ly '))][['PT_COMMENT', 'MFGR', 'P_PARTKEY', 'BRAND']].merge(partsupp[(partsupp['P_COMMENT'].str.startswith('a'))][['PS_PARTKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='S_SUPPKEY', right_on='P_PARTKEY').merge(part[['RETAILPRICE', 'TYPE', 'P_PARTKEY']].merge(partsupp[['PS_PARTKEY', 'AVAILQTY', 'SUPPLYCOST']], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['AVAILQTY'] == 2982)][['PS_PARTKEY', 'SUPPLYCOST', 'AVAILQTY']].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='S_SUPPKEY', right_on='P_PARTKEY')

region[(region['R_NAME'] == 'AME')][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].groupby(by=['R_COMMENT', 'R_REGIONKEY']).agg('min', numeric_only=True)

part.merge(partsupp[['AVAILQTY', 'PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY']].merge(part.merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_PARTKEY']].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

region[(region['R_COMMENT'] == 'g') | (region['R_NAME'].str.startswith('ASI'))].merge(nation[(nation['N_NAME'] != 'I') | (nation['N_NAME'].str.startswith('J'))][['N_NAME', 'N_NATIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_REGIONKEY', 'N_NAME']].merge(region[['R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[['R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME']).agg('mean', numeric_only=True)

region[(region['R_COMMENT'].str.startswith('u')) | (region['R_COMMENT'].str.startswith('l'))].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'].str.startswith('P')) | (nation['N_COMMENT'] != ' ')][['N_COMMENT', 'N_REGIONKEY']].merge(region[(region['R_REGIONKEY'] >= 3) & (region['R_REGIONKEY'] <= 2)][['R_NAME', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] > 17)][['N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']].merge(supplier[(supplier['S_NATIONKEY'] != 15) | (supplier['S_SUPPKEY'] <= 82)].merge(partsupp[['P_COMMENT', 'AVAILQTY', 'PS_PARTKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME']).agg('count')

customer[['C_CUSTKEY', 'MKTSEGMENT', 'C_PHONE']].merge(orders.merge(lineitem[(lineitem['L_PARTKEY'] >= 152238)][['TAX', 'SHIPMODE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['ORDERSTATUS'].isin(['O', 'P', 'F'])) & (orders['O_ORDERKEY'] <= 502)].merge(lineitem[['RETURNFLAG', 'LINESTATUS', 'L_SUPPKEY', 'RECEIPTDATE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['O_CUSTKEY', 'ORDERPRIORITY']].merge(customer[['C_CUSTKEY', 'C_ACCTBAL']], left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

nation[['N_COMMENT', 'N_NATIONKEY', 'N_NAME', 'N_REGIONKEY']].merge(customer[['MKTSEGMENT']].merge(orders[(orders['TOTALPRICE'] <= 71823.94856235923)][['CLERK', 'O_COMMENT', 'O_CUSTKEY', 'ORDERPRIORITY']].merge(customer[['C_NAME', 'MKTSEGMENT', 'C_COMMENT']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_ORDERKEY').merge(lineitem.merge(orders[(orders['SHIPPRIORITY'] < 0)], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_REGIONKEY']).agg('count')

region.merge(nation.merge(region[(region['R_NAME'] != 'ASI')], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[['S_NAME', 'S_PHONE']].merge(orders[(orders['ORDERDATE'] == '1992-01-13')], left_on='S_SUPPKEY', right_on='O_ORDERKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

lineitem.merge(partsupp[(partsupp['P_COMMENT'] == 's') | (partsupp['SUPPLYCOST'] > 80.95540655262941)].merge(lineitem[(lineitem['TAX'] <= 0.0030017171406336285)][['SHIPDATE', 'SHIPMODE']].merge(part[['TYPE']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['RETURNFLAG']).agg('mean', numeric_only=True)

partsupp[(partsupp['PS_PARTKEY'] > 45) & (partsupp['PS_SUPPKEY'] <= 6533)].merge(part[(part['TYPE'] == 'SMA')][['BRAND', 'P_NAME', 'TYPE']].merge(partsupp[['PS_SUPPKEY']], left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['PS_PARTKEY']).agg('count')

customer.merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['O_COMMENT', 'ORDERDATE', 'ORDERSTATUS', 'ORDERPRIORITY']].merge(part[(part['CONTAINER'].str.startswith('JUMBO'))].merge(partsupp[(partsupp['PS_SUPPKEY'] < 1659)][['PS_PARTKEY', 'PS_SUPPKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='P_PARTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders.merge(lineitem[(lineitem['TAX'] == 0.04094289920812265) | (lineitem['LINENUMBER'] >= 5)][['L_ORDERKEY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

region[['R_REGIONKEY', 'R_COMMENT', 'R_NAME']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] != 'V')], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NATIONKEY', 'N_NAME', 'N_REGIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

orders[(orders['ORDERDATE'] < '1992-01-13') & (orders['ORDERSTATUS'] != 'P')][['ORDERPRIORITY', 'SHIPPRIORITY', 'O_ORDERKEY', 'TOTALPRICE', 'ORDERSTATUS']].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['SHIPMODE'] != 'REG AIR') | (lineitem['SHIPINSTRUCT'] != 'NONE')][['L_SUPPKEY', 'SHIPMODE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[['L_ORDERKEY', 'SHIPMODE', 'TAX', 'RETURNFLAG']].merge(orders[(orders['O_COMMENT'].str.startswith('e'))][['O_ORDERKEY', 'ORDERPRIORITY', 'O_CUSTKEY']].merge(lineitem[['DISCOUNT', 'LINENUMBER']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['O_ORDERKEY', 'TOTALPRICE']).agg('mean', numeric_only=True)

supplier[(supplier['S_ADDRESS'] == 'P')][['S_COMMENT', 'S_NATIONKEY', 'S_SUPPKEY', 'S_ADDRESS']].merge(nation[['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT', 'N_NAME']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_REGIONKEY'] > 2)][['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT', 'N_NAME']].merge(region[(region['R_REGIONKEY'] == 3) & (region['R_NAME'].str.startswith('ASI'))][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].merge(nation[['N_COMMENT', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY')

region[(region['R_COMMENT'].str.startswith('l'))]

orders[(orders['ORDERPRIORITY'].isin(['2-HIGH'])) & (orders['ORDERSTATUS'].isin(['F', 'P', 'O']))][['O_CUSTKEY', 'O_ORDERKEY', 'CLERK']].merge(lineitem[(lineitem['LINESTATUS'] == 'O') | (lineitem['RETURNFLAG'].isin(['R', 'N']))], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['L_ORDERKEY'] != 170)].merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['RECEIPTDATE'] == '1992-05-02')][['SHIPMODE']].merge(part[['MFGR', 'BRAND', 'CONTAINER']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY').merge(region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_COMMENT'].str.startswith('u'))][['N_NAME', 'N_COMMENT', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['O_ORDERKEY']).agg('min', numeric_only=True)

customer

nation[(nation['N_REGIONKEY'] < 0) & (nation['N_REGIONKEY'] > 1) | (nation['N_NAME'] != 'A') | (nation['N_COMMENT'].str.startswith(' '))][['N_REGIONKEY']].groupby(by=['N_REGIONKEY']).agg('count')

orders[(orders['O_ORDERKEY'] >= 266) & (orders['O_COMMENT'] == ' re')][['CLERK', 'ORDERPRIORITY']].merge(supplier[(supplier['S_ACCTBAL'] > 5841.139808568924)].merge(partsupp[['PS_SUPPKEY', 'PS_PARTKEY', 'P_COMMENT', 'SUPPLYCOST']].merge(supplier[(supplier['S_COMMENT'].str.startswith('e'))], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='S_SUPPKEY').groupby(by=['ORDERPRIORITY', 'CLERK']).agg('max', numeric_only=True)

region[(region['R_REGIONKEY'] <= 2) | (region['R_REGIONKEY'] > 3) & (region['R_NAME'] != 'ASI')][['R_REGIONKEY']].merge(nation[(nation['N_REGIONKEY'] == 1)], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('mean', numeric_only=True)

region[(region['R_NAME'].str.startswith('A'))][['R_NAME']]

lineitem[(lineitem['L_SUPPKEY'] < 2744) | (lineitem['RETURNFLAG'] != 'A') & (lineitem['EXTENDEDPRICE'] > 22171.421489875593)][['SHIPMODE', 'RETURNFLAG', 'DISCOUNT', 'TAX']].groupby(by=['DISCOUNT', 'TAX']).agg('mean', numeric_only=True)

part[(part['CONTAINER'].str.startswith('MED')) | (part['SIZE'] > 27) & (part['P_PARTKEY'] == 170)].groupby(by=['TYPE', 'SIZE']).agg('min', numeric_only=True)

nation[['N_NATIONKEY']]

lineitem[['SHIPDATE', 'L_PARTKEY', 'RETURNFLAG']]

region[(region['R_NAME'] != 'A') | (region['R_COMMENT'] == 'l') | (region['R_NAME'].str.startswith('E')) | (region['R_REGIONKEY'] < 0)][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].merge(nation[['N_REGIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] != 'U') | (nation['N_NATIONKEY'] <= 0)][['N_REGIONKEY']].merge(region[['R_COMMENT']].merge(lineitem[['SHIPMODE', 'L_COMMENT', 'L_SUPPKEY', 'L_PARTKEY']], left_on='R_REGIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

lineitem.merge(orders[(orders['ORDERSTATUS'] == 'F')][['SHIPPRIORITY', 'CLERK', 'O_COMMENT', 'ORDERSTATUS']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['AVAILQTY'] <= 5552)].merge(supplier[['S_NATIONKEY', 'S_COMMENT', 'S_ADDRESS']].merge(nation[(nation['N_REGIONKEY'] >= 1) | (nation['N_NATIONKEY'] > 3)], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['SHIPDATE']).agg('count')

nation[(nation['N_REGIONKEY'] >= 1) | (nation['N_REGIONKEY'] > 0) | (nation['N_REGIONKEY'] == 2) | (nation['N_NAME'].str.startswith('G'))].merge(supplier[(supplier['S_PHONE'].str.startswith('3')) | (supplier['S_NATIONKEY'] < 14)][['S_PHONE', 'S_ADDRESS', 'S_SUPPKEY', 'S_NATIONKEY']].merge(nation[(nation['N_NAME'].str.startswith('C'))].merge(supplier[(supplier['S_ADDRESS'] == '5') & (supplier['S_SUPPKEY'] > 101)][['S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NATIONKEY'] == 3)], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[(supplier['S_SUPPKEY'] > 44)][['S_ADDRESS', 'S_COMMENT']].merge(nation[(nation['N_REGIONKEY'] > 1) & (nation['N_NAME'].str.startswith('P'))].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_SUPPKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[(customer['C_ACCTBAL'] <= 3011.7775425795758)][['C_ADDRESS']].merge(partsupp[['P_COMMENT', 'PS_SUPPKEY', 'AVAILQTY', 'PS_PARTKEY']].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(partsupp[(partsupp['P_COMMENT'] != 'f')].merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

part[(part['MFGR'].isin(['Manufacturer#4', 'Manufacturer#5', 'Manufacturer#3']))].merge(partsupp[(partsupp['P_COMMENT'] == 'x')][['PS_SUPPKEY', 'PS_PARTKEY']].merge(lineitem[['COMMITDATE', 'EXTENDEDPRICE', 'RECEIPTDATE']].merge(customer[['MKTSEGMENT', 'C_COMMENT', 'C_ADDRESS']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(part[(part['RETAILPRICE'] <= 988.1268985426192)].merge(partsupp[(partsupp['P_COMMENT'] == 'g')][['PS_PARTKEY', 'AVAILQTY', 'P_COMMENT', 'SUPPLYCOST']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['RETAILPRICE', 'MFGR']).agg('count')

part.merge(partsupp[(partsupp['P_COMMENT'] != ';') & (partsupp['AVAILQTY'] != 2971)].merge(lineitem[(lineitem['LINENUMBER'] != 6) | (lineitem['RETURNFLAG'].isin(['R', 'N']))][['QUANTITY', 'RETURNFLAG', 'SHIPMODE']].merge(region[(region['R_REGIONKEY'] > 2)][['R_NAME', 'R_COMMENT', 'R_REGIONKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['P_COMMENT', 'PS_SUPPKEY', 'AVAILQTY']].merge(lineitem[(lineitem['L_SUPPKEY'] >= 5311)].merge(partsupp[['P_COMMENT', 'PS_PARTKEY', 'AVAILQTY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(lineitem[(lineitem['L_ORDERKEY'] != 180) & (lineitem['SHIPDATE'] < '1992-04-27')][['RETURNFLAG']].merge(part[['P_PARTKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['LINESTATUS'] == 'O') | (lineitem['L_COMMENT'].str.startswith('d'))], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['BRAND']).agg('max', numeric_only=True)

partsupp[['PS_SUPPKEY']].merge(supplier[(supplier['S_ACCTBAL'] < 4689.996561207552) & (supplier['S_NATIONKEY'] <= 5)], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[(supplier['S_PHONE'].str.startswith('14-'))][['S_NATIONKEY', 'S_ACCTBAL', 'S_SUPPKEY', 'S_NAME']].merge(nation[(nation['N_NAME'] == 'I')].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] <= 517)][['AVAILQTY', 'PS_SUPPKEY', 'P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier.merge(nation[(nation['N_REGIONKEY'] != 1)], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['PS_SUPPKEY']).agg('min', numeric_only=True)

customer[(customer['C_NAME'] == 'C') | (customer['C_NAME'] == 'C') & (customer['C_CUSTKEY'] >= 64)].merge(nation.merge(supplier[['S_PHONE', 'S_COMMENT', 'S_ACCTBAL', 'S_NATIONKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[['R_NAME', 'R_REGIONKEY', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_COMMENT']).agg('max', numeric_only=True)

part[['SIZE', 'CONTAINER', 'RETAILPRICE', 'TYPE']].merge(region[(region['R_NAME'] != 'A') & (region['R_COMMENT'] != 'l')].merge(nation.merge(supplier[(supplier['S_ACCTBAL'] < 4411.201544430413)][['S_SUPPKEY', 'S_ADDRESS', 'S_ACCTBAL']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_COMMENT', 'N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']].merge(customer[['C_PHONE']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='P_PARTKEY', right_on='R_REGIONKEY').merge(orders.merge(customer[(customer['C_PHONE'] == '18-') | (customer['C_PHONE'] == '2')][['MKTSEGMENT']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='P_PARTKEY', right_on='O_ORDERKEY')

partsupp[['P_COMMENT', 'SUPPLYCOST']].merge(orders.merge(lineitem[['L_PARTKEY', 'SHIPMODE', 'SHIPINSTRUCT']].merge(partsupp[(partsupp['AVAILQTY'] >= 9328)][['PS_PARTKEY', 'SUPPLYCOST', 'AVAILQTY']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_PHONE'] != '3') | (customer['C_COMMENT'] != 'w')][['C_CUSTKEY', 'C_NAME', 'C_PHONE']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='O_ORDERKEY')

partsupp[(partsupp['AVAILQTY'] >= 4205) & (partsupp['SUPPLYCOST'] <= 429.11700637991305)][['P_COMMENT']].merge(nation[['N_NAME', 'N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY']].merge(customer[['C_NAME', 'C_CUSTKEY', 'C_NATIONKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[(customer['C_NATIONKEY'] < 4) & (customer['MKTSEGMENT'] != 'AUTOMOBILE')], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY').merge(nation[['N_COMMENT']].merge(partsupp, left_on='N_NATIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(orders[(orders['O_COMMENT'] != 'egu') | (orders['ORDERDATE'] >= '1998-07-21')][['ORDERDATE', 'O_CUSTKEY', 'O_COMMENT', 'O_ORDERKEY']].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='N_NATIONKEY', right_on='O_ORDERKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY').groupby(by=['P_COMMENT']).agg('sum', numeric_only=True)

customer.merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_COMMENT', 'C_NATIONKEY']).agg('max', numeric_only=True)

part

lineitem[(lineitem['EXTENDEDPRICE'] >= 51027.44632375654)].merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY').groupby(by=['COMMITDATE', 'SHIPMODE']).agg('mean', numeric_only=True)

lineitem[['L_SUPPKEY']].merge(partsupp[(partsupp['PS_PARTKEY'] < 35) | (partsupp['AVAILQTY'] > 4085)].merge(part[(part['RETAILPRICE'] == 1091.8137884161326) | (part['P_PARTKEY'] <= 72)], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['P_COMMENT'].str.startswith('r')) & (partsupp['PS_PARTKEY'] <= 21)].merge(supplier[(supplier['S_NATIONKEY'] <= 2)], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] != 6499) & (partsupp['PS_PARTKEY'] <= 14)][['PS_PARTKEY']].merge(lineitem[(lineitem['QUANTITY'] >= 30) | (lineitem['RECEIPTDATE'] <= '1992-05-02')][['SHIPINSTRUCT', 'L_ORDERKEY', 'LINESTATUS', 'SHIPDATE']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['L_SUPPKEY']).agg('max', numeric_only=True)

region[['R_REGIONKEY', 'R_COMMENT', 'R_NAME']].merge(nation[(nation['N_NAME'] != 'G') | (nation['N_REGIONKEY'] == 1)].merge(customer[(customer['MKTSEGMENT'].isin(['AUTOMOBILE', 'HOUSEHOLD', 'FURNITURE', 'MACHINERY']))][['C_PHONE', 'C_ADDRESS', 'C_CUSTKEY', 'C_ACCTBAL']].merge(orders[(orders['ORDERDATE'] > '1998-07-21')], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(customer[(customer['MKTSEGMENT'] == 'HOUSEHOLD') & (customer['C_CUSTKEY'] != 66)][['C_NATIONKEY']].merge(nation[(nation['N_COMMENT'] == 'u') | (nation['N_NATIONKEY'] > 3)], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_NAME'] != 'ASI')].merge(nation[(nation['N_COMMENT'] == ' ')], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NATIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME']).agg('count')

partsupp[['PS_PARTKEY', 'AVAILQTY', 'PS_SUPPKEY', 'SUPPLYCOST']].groupby(by=['AVAILQTY']).agg('count')

orders[['O_ORDERKEY', 'ORDERSTATUS', 'CLERK', 'ORDERPRIORITY']].merge(lineitem[(lineitem['EXTENDEDPRICE'] >= 7735.646707200127) | (lineitem['SHIPINSTRUCT'].isin(['NONE']))].merge(orders[(orders['ORDERDATE'] < '1992-01-13') & (orders['O_CUSTKEY'] == 4783)], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[['ORDERSTATUS', 'ORDERDATE', 'CLERK']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['RETURNFLAG'] == 'R') | (lineitem['L_SUPPKEY'] != 8866)], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem.merge(orders[(orders['TOTALPRICE'] == 106547.22118926121) | (orders['ORDERSTATUS'] != 'P')][['O_CUSTKEY', 'CLERK', 'O_ORDERKEY']].merge(lineitem[(lineitem['EXTENDEDPRICE'] <= 63477.9312860736) | (lineitem['L_ORDERKEY'] == 43)][['LINESTATUS', 'LINENUMBER']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY')

region.merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(supplier[(supplier['S_PHONE'] == '28-')].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] == 's')][['N_NAME', 'N_COMMENT', 'N_REGIONKEY']].merge(region[(region['R_REGIONKEY'] != 3) | (region['R_REGIONKEY'] < 1)][['R_NAME']].merge(orders[(orders['TOTALPRICE'] != 53806.1163434213) | (orders['SHIPPRIORITY'] > 0)], left_on='R_REGIONKEY', right_on='O_ORDERKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

partsupp[['SUPPLYCOST', 'PS_SUPPKEY', 'PS_PARTKEY', 'P_COMMENT', 'AVAILQTY']].merge(lineitem[(lineitem['COMMITDATE'] <= '1998-10-16')].merge(partsupp[['P_COMMENT', 'SUPPLYCOST']].merge(nation[(nation['N_COMMENT'].str.startswith('l'))], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['RECEIPTDATE'] != '1998-11-06') | (lineitem['SHIPMODE'] == 'FOB')].merge(partsupp[(partsupp['AVAILQTY'] < 453)][['PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT']].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['SHIPINSTRUCT'] == 'NONE')][['RECEIPTDATE', 'QUANTITY', 'COMMITDATE', 'RETURNFLAG']], left_on='PS_PARTKEY', right_on='L_PARTKEY')

customer.merge(nation[(nation['N_NAME'].str.startswith('M')) & (nation['N_COMMENT'] != 'l')].merge(supplier[(supplier['S_NAME'] != 'S') & (supplier['S_ADDRESS'] == 'm')].merge(nation[['N_NAME', 'N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[(region['R_NAME'].str.startswith('ASI')) | (region['R_REGIONKEY'] <= 1)], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_COMMENT'] == 'p') | (nation['N_NAME'].str.startswith('J'))].merge(supplier.merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[(orders['SHIPPRIORITY'] < 0) | (orders['O_COMMENT'] == ' ')][['TOTALPRICE', 'O_COMMENT', 'ORDERSTATUS']], left_on='C_CUSTKEY', right_on='O_CUSTKEY')

partsupp[(partsupp['PS_PARTKEY'] < 40)].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['RETURNFLAG'].isin(['R', 'N'])) & (lineitem['RECEIPTDATE'] != '1998-11-06')], left_on='PS_SUPPKEY', right_on='L_SUPPKEY')

partsupp[(partsupp['AVAILQTY'] >= 3445) | (partsupp['PS_PARTKEY'] <= 37) & (partsupp['SUPPLYCOST'] <= 433.51995551979786) & (partsupp['PS_PARTKEY'] < 9)][['PS_SUPPKEY', 'P_COMMENT', 'AVAILQTY']].merge(lineitem[(lineitem['L_SUPPKEY'] <= 753)], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem.merge(partsupp.merge(part[(part['P_NAME'].str.startswith('lem'))][['P_NAME', 'SIZE']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp.merge(supplier[(supplier['S_SUPPKEY'] == 137) | (supplier['S_NAME'] != 'S')], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier[(supplier['S_PHONE'] == '14-')], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['PS_SUPPKEY']).agg('max', numeric_only=True)

part[(part['CONTAINER'].str.startswith('WRAP'))][['TYPE', 'CONTAINER']].merge(supplier[['S_SUPPKEY', 'S_COMMENT', 'S_ACCTBAL', 'S_PHONE']].merge(partsupp[['PS_PARTKEY', 'P_COMMENT', 'PS_SUPPKEY', 'AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='P_PARTKEY', right_on='S_SUPPKEY')

region[(region['R_NAME'] == 'ASI') & (region['R_COMMENT'] != 'g')][['R_NAME', 'R_REGIONKEY']]

supplier[(supplier['S_SUPPKEY'] <= 110) & (supplier['S_ADDRESS'] == '1')][['S_COMMENT', 'S_NATIONKEY']].merge(nation[(nation['N_COMMENT'] == 'u') | (nation['N_NAME'] != 'S')][['N_REGIONKEY', 'N_COMMENT', 'N_NAME']].merge(region[(region['R_COMMENT'].str.startswith('h'))], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_NATIONKEY']).agg('max', numeric_only=True)

part[(part['MFGR'].isin(['Manufacturer#3'])) | (part['TYPE'] != 'STA')].merge(partsupp[(partsupp['PS_PARTKEY'] < 33)].merge(lineitem[['L_SUPPKEY', 'SHIPMODE', 'RECEIPTDATE', 'EXTENDEDPRICE']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['SIZE']).agg('max', numeric_only=True)

region[(region['R_NAME'].str.startswith('A')) | (region['R_COMMENT'].str.startswith('h'))].groupby(by=['R_COMMENT', 'R_REGIONKEY']).agg('mean', numeric_only=True)

region[['R_NAME', 'R_REGIONKEY']].groupby(by=['R_REGIONKEY', 'R_NAME']).agg('sum', numeric_only=True)

customer[['C_ACCTBAL', 'C_NATIONKEY', 'C_CUSTKEY', 'C_COMMENT', 'C_NAME']].merge(orders[(orders['O_ORDERKEY'] <= 164)].merge(lineitem.merge(partsupp[['PS_PARTKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[['MKTSEGMENT', 'C_ACCTBAL', 'C_CUSTKEY', 'C_NATIONKEY']].merge(orders[(orders['SHIPPRIORITY'] > 0) & (orders['ORDERDATE'] != '1992-01-13')][['ORDERSTATUS', 'ORDERDATE', 'ORDERPRIORITY', 'TOTALPRICE']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

partsupp.merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY')

lineitem

nation[(nation['N_NAME'] != 'E') & (nation['N_NATIONKEY'] >= 19) & (nation['N_COMMENT'] != 'i')][['N_NATIONKEY']]

orders[(orders['O_COMMENT'] != ' ') | (orders['O_COMMENT'] != 'l') | (orders['O_COMMENT'].str.startswith('k'))][['ORDERSTATUS', 'O_COMMENT', 'ORDERDATE', 'O_CUSTKEY', 'O_ORDERKEY']].groupby(by=['O_CUSTKEY']).agg('max', numeric_only=True)

supplier[['S_ACCTBAL', 'S_PHONE', 'S_NATIONKEY']].merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_NAME']].merge(region[(region['R_COMMENT'] == 'g')][['R_NAME', 'R_REGIONKEY']], left_on='N_NATIONKEY', right_on='R_REGIONKEY').merge(lineitem[['LINESTATUS']].merge(partsupp[(partsupp['P_COMMENT'] == 'r') | (partsupp['SUPPLYCOST'] != 424.9746120791383)][['PS_PARTKEY', 'PS_SUPPKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='N_NATIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_COMMENT', 'N_NAME']].merge(supplier[['S_COMMENT']].merge(region[(region['R_REGIONKEY'] == 3) & (region['R_NAME'].str.startswith('AME'))], left_on='S_SUPPKEY', right_on='R_REGIONKEY'), left_on='N_NATIONKEY', right_on='S_SUPPKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY')

customer[['C_ADDRESS']].merge(supplier[(supplier['S_NATIONKEY'] < 6) | (supplier['S_NAME'] == 'S')][['S_COMMENT']], left_on='C_CUSTKEY', right_on='S_SUPPKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] != 4906)][['P_COMMENT', 'AVAILQTY', 'SUPPLYCOST']].merge(orders[(orders['ORDERDATE'] < '1998-07-21')][['O_COMMENT']].merge(supplier[['S_COMMENT', 'S_SUPPKEY', 'S_NAME']], left_on='O_ORDERKEY', right_on='S_SUPPKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='O_ORDERKEY'), left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(lineitem.merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).groupby(by=['C_ADDRESS']).agg('min', numeric_only=True)

supplier[(supplier['S_PHONE'] != '1') | (supplier['S_ACCTBAL'] <= 1729.7974354441951) & (supplier['S_SUPPKEY'] == 160) | (supplier['S_PHONE'] == '28-')].merge(nation[(nation['N_REGIONKEY'] > 2)].merge(supplier[(supplier['S_ACCTBAL'] < 3626.9280826914855) | (supplier['S_ADDRESS'] == 'Q')].merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_SUPPKEY', 'S_PHONE']).agg('sum', numeric_only=True)

lineitem[(lineitem['LINENUMBER'] != 4)].merge(partsupp[(partsupp['PS_SUPPKEY'] != 1173) & (partsupp['AVAILQTY'] > 7366)][['AVAILQTY', 'SUPPLYCOST', 'PS_PARTKEY', 'PS_SUPPKEY']].merge(lineitem[(lineitem['TAX'] <= 0.06606430090173564) & (lineitem['L_ORDERKEY'] == 30)], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['AVAILQTY'] == 8539) & (partsupp['SUPPLYCOST'] != 690.6628127840174)][['PS_PARTKEY', 'PS_SUPPKEY', 'SUPPLYCOST', 'P_COMMENT']].merge(supplier.merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['EXTENDEDPRICE', 'RECEIPTDATE']).agg('count')

nation.merge(region[(region['R_REGIONKEY'] < 3)][['R_REGIONKEY', 'R_COMMENT', 'R_NAME']].merge(nation[(nation['N_NATIONKEY'] < 7) & (nation['N_REGIONKEY'] > 0)], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(customer[(customer['C_ADDRESS'] == 'E')], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[(customer['C_CUSTKEY'] != 80)].merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']].merge(customer[(customer['C_ADDRESS'] == 'f') | (customer['C_NATIONKEY'] < 15)][['C_COMMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[(orders['O_ORDERKEY'] == 354) | (orders['SHIPPRIORITY'] != 0)][['SHIPPRIORITY', 'ORDERDATE', 'ORDERPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_NAME'] != 'AFR') | (region['R_REGIONKEY'] >= 0)].merge(nation[['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_NATIONKEY']).agg('mean', numeric_only=True)

region[['R_REGIONKEY']].merge(nation[(nation['N_NAME'] == 'U') & (nation['N_NAME'] == 'F')][['N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('mean', numeric_only=True)

lineitem[(lineitem['RECEIPTDATE'] > '1998-11-06') | (lineitem['L_SUPPKEY'] == 8843)].merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(orders[(orders['SHIPPRIORITY'] <= 0)][['ORDERSTATUS', 'O_ORDERKEY']].merge(lineitem[['TAX', 'SHIPINSTRUCT', 'SHIPDATE', 'L_ORDERKEY']].merge(orders[(orders['ORDERPRIORITY'] != '3-MEDIUM')], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').groupby(by=['SHIPMODE']).agg('max', numeric_only=True)

part

region.merge(nation[(nation['N_COMMENT'] != 'l') | (nation['N_REGIONKEY'] > 3)][['N_REGIONKEY']].merge(region[(region['R_REGIONKEY'] >= 2) | (region['R_NAME'].str.startswith('M'))][['R_NAME']].merge(customer[['C_ADDRESS', 'C_PHONE', 'C_COMMENT', 'C_NATIONKEY']], left_on='R_REGIONKEY', right_on='C_CUSTKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_NAME'] == 'ASI') | (region['R_REGIONKEY'] == 3)][['R_NAME', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] != 12)][['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

partsupp[['PS_PARTKEY', 'AVAILQTY', 'P_COMMENT']].merge(lineitem.merge(orders[(orders['O_CUSTKEY'] >= 109354) | (orders['ORDERDATE'] != '1992-01-13')][['ORDERPRIORITY', 'SHIPPRIORITY']].merge(partsupp[['P_COMMENT', 'AVAILQTY', 'PS_PARTKEY']], left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['L_COMMENT'].str.startswith('b')) | (lineitem['QUANTITY'] < 18)][['L_ORDERKEY']].merge(orders[(orders['O_CUSTKEY'] < 146950)][['ORDERSTATUS']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['L_COMMENT'].str.startswith('h')) | (lineitem['DISCOUNT'] == 0.06130989253944258)][['RETURNFLAG', 'SHIPINSTRUCT']].merge(part[['P_NAME', 'TYPE', 'MFGR']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY').merge(partsupp.merge(supplier[(supplier['S_NAME'] != 'S') | (supplier['S_SUPPKEY'] != 23)], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_PARTKEY', right_on='L_PARTKEY')

nation.merge(customer[(customer['C_ADDRESS'].str.startswith('f'))], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[['C_CUSTKEY', 'C_NATIONKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY')

orders[(orders['TOTALPRICE'] == 328004.769415285) & (orders['ORDERPRIORITY'] != '1-URGENT') | (orders['SHIPPRIORITY'] != 0) | (orders['ORDERSTATUS'].isin(['P', 'O', 'F']))].merge(customer[(customer['MKTSEGMENT'] != 'HOUSEHOLD') & (customer['C_NAME'] == 'C')].merge(orders[(orders['ORDERDATE'] > '1998-07-21')].merge(lineitem[['RECEIPTDATE', 'TAX', 'RETURNFLAG']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['ORDERDATE']).agg('max', numeric_only=True)

part[['P_NAME', 'SIZE', 'RETAILPRICE', 'P_PARTKEY']].merge(partsupp[['P_COMMENT', 'SUPPLYCOST', 'AVAILQTY', 'PS_SUPPKEY']].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['RETAILPRICE', 'SIZE']).agg('count')

supplier

orders[(orders['SHIPPRIORITY'] != 0) & (orders['TOTALPRICE'] != 308119.08222954173)].merge(lineitem[(lineitem['SHIPINSTRUCT'].isin(['TAKE BACK RETURN', 'COLLECT COD'])) & (lineitem['L_COMMENT'] == 'p')][['L_SUPPKEY', 'RETURNFLAG', 'RECEIPTDATE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_NATIONKEY'] <= 1) & (customer['MKTSEGMENT'].isin(['HOUSEHOLD', 'BUILDING', 'MACHINERY']))][['C_COMMENT', 'C_ADDRESS', 'C_NATIONKEY', 'C_CUSTKEY']].merge(nation[(nation['N_COMMENT'] == 'e') & (nation['N_REGIONKEY'] < 2)][['N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[(orders['SHIPPRIORITY'] <= 0)], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem.merge(partsupp[(partsupp['PS_SUPPKEY'] == 3933) | (partsupp['PS_SUPPKEY'] != 3826)][['P_COMMENT', 'AVAILQTY', 'PS_PARTKEY']].merge(lineitem[(lineitem['L_SUPPKEY'] > 4376) | (lineitem['L_ORDERKEY'] <= 120)], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['AVAILQTY'] < 3494) | (partsupp['P_COMMENT'].str.startswith('bli'))].merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY')

part.groupby(by=['MFGR', 'P_PARTKEY']).agg('max', numeric_only=True)

region[(region['R_REGIONKEY'] > 0) | (region['R_NAME'].str.startswith('M'))].merge(nation[(nation['N_REGIONKEY'] <= 2)][['N_REGIONKEY', 'N_NAME', 'N_NATIONKEY', 'N_COMMENT']].merge(customer[(customer['C_NAME'] == 'C')][['MKTSEGMENT', 'C_PHONE']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']].merge(supplier[(supplier['S_SUPPKEY'] == 161)].merge(partsupp[(partsupp['PS_SUPPKEY'] != 3586) & (partsupp['PS_PARTKEY'] != 34)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'].str.startswith('i'))], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME']).agg('min', numeric_only=True)

part[['MFGR', 'SIZE']].merge(partsupp[(partsupp['P_COMMENT'] != 'y') | (partsupp['PS_SUPPKEY'] < 3369)][['P_COMMENT', 'PS_SUPPKEY', 'AVAILQTY']], left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY'])

region[(region['R_REGIONKEY'] <= 0) & (region['R_REGIONKEY'] == 0) | (region['R_NAME'].str.startswith('ASI')) & (region['R_NAME'] == 'A')][['R_REGIONKEY', 'R_COMMENT', 'R_NAME']].merge(nation[['N_NAME', 'N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY']].merge(customer.merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY', 'R_NAME']).agg('count')

lineitem[['SHIPMODE']].merge(customer[(customer['C_ACCTBAL'] == 4292.651021519877)][['MKTSEGMENT']].merge(orders[['O_CUSTKEY', 'ORDERSTATUS', 'ORDERDATE']].merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_ORDERKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY').groupby(by=['SHIPMODE']).agg('count')

supplier.merge(partsupp[['PS_PARTKEY']].merge(lineitem[(lineitem['SHIPMODE'] == 'REG AIR')][['RETURNFLAG', 'TAX', 'LINENUMBER', 'L_COMMENT']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem.merge(partsupp[(partsupp['PS_SUPPKEY'] <= 2701)][['P_COMMENT', 'AVAILQTY', 'SUPPLYCOST', 'PS_PARTKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_NATIONKEY', 'S_PHONE']).agg('sum', numeric_only=True)

supplier[(supplier['S_NATIONKEY'] > 1)]

orders.groupby(by=['SHIPPRIORITY', 'ORDERSTATUS']).agg('mean', numeric_only=True)

customer.merge(nation[['N_NATIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_COMMENT'] == 't') & (nation['N_NATIONKEY'] < 20)][['N_NAME', 'N_NATIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY')

part[(part['MFGR'].isin(['Manufacturer#1', 'Manufacturer#2', 'Manufacturer#3', 'Manufacturer#5']))].groupby(by=['CONTAINER']).agg('sum', numeric_only=True)

partsupp[(partsupp['PS_PARTKEY'] > 26) & (partsupp['SUPPLYCOST'] <= 307.99854855933216) | (partsupp['AVAILQTY'] != 3657) & (partsupp['SUPPLYCOST'] != 403.3697282681912)][['PS_PARTKEY', 'AVAILQTY', 'SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT']]

nation.merge(supplier[(supplier['S_ADDRESS'] != 'C')][['S_NAME', 'S_ADDRESS']].merge(region, left_on='S_SUPPKEY', right_on='R_REGIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[['R_NAME']].merge(nation[(nation['N_NAME'].str.startswith('F'))], left_on='R_REGIONKEY', right_on='N_NATIONKEY').merge(customer[(customer['C_PHONE'] == '13-') & (customer['C_ADDRESS'] != 'x')][['MKTSEGMENT', 'C_ACCTBAL', 'C_NAME', 'C_NATIONKEY']], left_on='R_REGIONKEY', right_on='C_CUSTKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_REGIONKEY'] < 0) & (region['R_REGIONKEY'] >= 2)].merge(nation[['N_REGIONKEY', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY')

nation[['N_COMMENT', 'N_NAME', 'N_REGIONKEY', 'N_NATIONKEY']].merge(supplier[(supplier['S_COMMENT'] == 'bli')].merge(nation[(nation['N_NAME'].str.startswith('P'))].merge(supplier[(supplier['S_PHONE'] == '26-') & (supplier['S_ACCTBAL'] == 2998.2594043106683)][['S_ACCTBAL', 'S_NAME', 'S_COMMENT', 'S_ADDRESS']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region.merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[(customer['C_NATIONKEY'] >= 11)].merge(orders[(orders['TOTALPRICE'] == 142033.65717819484)].merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['SHIPPRIORITY', 'CLERK', 'O_COMMENT']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

region[['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].groupby(by=['R_COMMENT', 'R_REGIONKEY']).agg('mean', numeric_only=True)

orders[['O_ORDERKEY', 'ORDERSTATUS']].merge(lineitem[['QUANTITY', 'COMMITDATE', 'EXTENDEDPRICE']].merge(partsupp[['P_COMMENT', 'SUPPLYCOST', 'AVAILQTY', 'PS_PARTKEY']].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['O_ORDERKEY', 'ORDERSTATUS']).agg('min', numeric_only=True)

supplier[(supplier['S_NAME'] == 'S')][['S_ACCTBAL', 'S_PHONE']]

part.merge(partsupp[['PS_PARTKEY', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY')

nation[['N_COMMENT']].merge(supplier[(supplier['S_NAME'] == 'S') & (supplier['S_NATIONKEY'] < 10)], left_on='N_NATIONKEY', right_on='S_SUPPKEY').merge(supplier.merge(partsupp[(partsupp['PS_PARTKEY'] != 35)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['AVAILQTY', 'PS_SUPPKEY', 'SUPPLYCOST']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_SUPPKEY').groupby(by=['N_COMMENT']).agg('count')

region[(region['R_COMMENT'].str.startswith('g')) | (region['R_COMMENT'].str.startswith('l'))].merge(nation[(nation['N_COMMENT'] != 'n')].merge(region[(region['R_COMMENT'] == 'g')], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

part.merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(part[(part['MFGR'] != 'Manufacturer#4') | (part['RETAILPRICE'] > 1094.6852444093022)].merge(partsupp[['PS_SUPPKEY', 'P_COMMENT', 'AVAILQTY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

lineitem[['TAX', 'EXTENDEDPRICE', 'L_ORDERKEY', 'L_COMMENT', 'LINENUMBER']].merge(orders[(orders['ORDERPRIORITY'].isin(['2-HIGH', '4-NOT SPECIFIED', '1-URGENT', '5-LOW']))][['O_ORDERKEY', 'CLERK', 'ORDERSTATUS', 'ORDERDATE']].merge(lineitem[(lineitem['TAX'] < 0.07438410431600213) | (lineitem['DISCOUNT'] < 0.05977122770244182)].merge(orders[(orders['ORDERPRIORITY'] == '5-LOW')][['ORDERPRIORITY', 'CLERK', 'ORDERSTATUS']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['ORDERDATE'] != '1998-07-21')].merge(lineitem[(lineitem['DISCOUNT'] == 0.08520148871992408) | (lineitem['COMMITDATE'] > '1998-10-16')], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['ORDERDATE'] != '1992-01-13') & (orders['SHIPPRIORITY'] > 0)].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_ADDRESS'].str.startswith('q')) & (customer['MKTSEGMENT'].isin(['FURNITURE', 'MACHINERY']))][['C_NAME', 'MKTSEGMENT', 'C_ACCTBAL', 'C_NATIONKEY']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY')

lineitem[(lineitem['EXTENDEDPRICE'] >= 79467.49780384815) | (lineitem['SHIPINSTRUCT'] == 'TAKE BACK RETURN')].merge(orders[(orders['ORDERSTATUS'] == 'F') & (orders['ORDERSTATUS'].isin(['F', 'O']))].merge(customer[(customer['C_COMMENT'] == 'o') | (customer['C_NATIONKEY'] > 7)], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY')

lineitem[(lineitem['DISCOUNT'] == 0.02133781591363837)][['RECEIPTDATE', 'RETURNFLAG', 'QUANTITY', 'L_SUPPKEY', 'L_ORDERKEY']].merge(partsupp[['PS_PARTKEY', 'AVAILQTY']].merge(part[['BRAND', 'P_PARTKEY']].merge(partsupp[(partsupp['PS_PARTKEY'] > 1) | (partsupp['P_COMMENT'] != ',')][['SUPPLYCOST', 'AVAILQTY', 'P_COMMENT', 'PS_PARTKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[(part['P_PARTKEY'] == 86) | (part['P_NAME'] == 't')], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(orders.merge(customer[(customer['MKTSEGMENT'].isin(['BUILDING']))][['MKTSEGMENT', 'C_NAME']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp.merge(supplier[(supplier['S_ACCTBAL'] == 4395.919823504839)][['S_PHONE', 'S_NATIONKEY', 'S_NAME']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['QUANTITY', 'RECEIPTDATE']).agg('mean', numeric_only=True)

region[(region['R_NAME'].str.startswith('M')) & (region['R_NAME'].str.startswith('AME')) & (region['R_NAME'] == 'AFR')][['R_NAME', 'R_COMMENT']].merge(nation[(nation['N_COMMENT'] == 'p') & (nation['N_REGIONKEY'] < 3)], left_on='R_REGIONKEY', right_on='N_NATIONKEY').merge(supplier[(supplier['S_NATIONKEY'] > 20) | (supplier['S_SUPPKEY'] == 52)].merge(partsupp[(partsupp['PS_SUPPKEY'] != 1546)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='R_REGIONKEY', right_on='S_SUPPKEY').groupby(by=['R_COMMENT']).agg('mean', numeric_only=True)

partsupp[['P_COMMENT', 'PS_PARTKEY', 'PS_SUPPKEY']].groupby(by=['P_COMMENT', 'PS_SUPPKEY']).agg('max', numeric_only=True)

region.merge(nation[['N_REGIONKEY', 'N_NATIONKEY']].merge(customer[(customer['C_CUSTKEY'] == 75)][['C_NATIONKEY', 'C_COMMENT']].merge(nation[['N_NATIONKEY', 'N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT', 'R_NAME']).agg('max', numeric_only=True)

supplier.merge(partsupp.merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_PARTKEY'] >= 13)].merge(lineitem[['SHIPINSTRUCT', 'SHIPMODE', 'QUANTITY']].merge(region[(region['R_COMMENT'].str.startswith('g')) | (region['R_NAME'].str.startswith('AME'))][['R_REGIONKEY', 'R_COMMENT', 'R_NAME']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

part[['P_NAME', 'P_PARTKEY', 'MFGR']].groupby(by=['P_PARTKEY']).agg('min', numeric_only=True)

orders[(orders['ORDERSTATUS'] != 'F')].groupby(by=['CLERK', 'TOTALPRICE']).agg('mean', numeric_only=True)

nation[(nation['N_NAME'] != 'P') | (nation['N_COMMENT'] != 'r') | (nation['N_NATIONKEY'] >= 15) & (nation['N_COMMENT'] != 'c')][['N_NATIONKEY', 'N_COMMENT', 'N_NAME', 'N_REGIONKEY']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[(supplier['S_NATIONKEY'] != 2) & (supplier['S_SUPPKEY'] == 46)][['S_COMMENT', 'S_SUPPKEY', 'S_ACCTBAL']].merge(partsupp[(partsupp['PS_SUPPKEY'] <= 6137) & (partsupp['AVAILQTY'] >= 6386)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier.merge(partsupp[['PS_PARTKEY', 'P_COMMENT', 'PS_SUPPKEY']].merge(lineitem[(lineitem['RETURNFLAG'].isin(['R', 'N'])) | (lineitem['RECEIPTDATE'] <= '1992-05-02')][['RETURNFLAG', 'SHIPINSTRUCT']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY')

region[['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation[(nation['N_COMMENT'] == 'l') | (nation['N_NAME'].str.startswith('P'))], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] >= 0) | (nation['N_REGIONKEY'] == 2)][['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

supplier[(supplier['S_ACCTBAL'] >= 9800.134004039539) | (supplier['S_COMMENT'] == 'bli') & (supplier['S_PHONE'].str.startswith('2')) & (supplier['S_NATIONKEY'] != 8)][['S_ACCTBAL']].merge(part.merge(partsupp.merge(supplier[['S_NAME', 'S_ACCTBAL', 'S_PHONE']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] < 4203)][['AVAILQTY']].merge(lineitem[(lineitem['L_ORDERKEY'] <= 94)], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='S_SUPPKEY', right_on='P_PARTKEY').groupby(by=['S_ACCTBAL']).agg('max', numeric_only=True)

orders[(orders['ORDERSTATUS'] != 'F') & (orders['TOTALPRICE'] != 204743.60123384843) & (orders['O_CUSTKEY'] > 109649)][['ORDERPRIORITY', 'ORDERDATE', 'O_ORDERKEY', 'CLERK', 'ORDERSTATUS']].merge(lineitem[(lineitem['L_PARTKEY'] != 92999)][['SHIPINSTRUCT', 'L_SUPPKEY', 'QUANTITY', 'L_ORDERKEY']].merge(partsupp[(partsupp['P_COMMENT'] != 'y') & (partsupp['PS_SUPPKEY'] > 193)][['SUPPLYCOST']].merge(part[['P_PARTKEY', 'RETAILPRICE']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(orders[(orders['CLERK'] == 'C') & (orders['ORDERPRIORITY'].isin(['3-MEDIUM', '4-NOT SPECIFIED', '5-LOW', '2-HIGH']))][['TOTALPRICE', 'ORDERSTATUS']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[['LINESTATUS']].merge(supplier[(supplier['S_ACCTBAL'] < 2943.458609669582) | (supplier['S_NAME'] == 'S')].merge(nation[(nation['N_NAME'] != 'C') & (nation['N_COMMENT'] != 'o')][['N_NAME', 'N_COMMENT']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY').merge(part[(part['RETAILPRICE'] <= 997.497981895722) & (part['P_PARTKEY'] >= 131)], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['O_ORDERKEY', 'ORDERSTATUS']).agg('sum', numeric_only=True)

lineitem[(lineitem['SHIPDATE'] < '1998-10-30')].merge(partsupp[(partsupp['PS_PARTKEY'] != 36) & (partsupp['PS_SUPPKEY'] > 4939)][['PS_SUPPKEY', 'PS_PARTKEY', 'P_COMMENT']].merge(lineitem.merge(partsupp[(partsupp['PS_PARTKEY'] > 14)][['PS_SUPPKEY', 'SUPPLYCOST', 'P_COMMENT']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[['AVAILQTY', 'PS_SUPPKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY')

nation[(nation['N_COMMENT'] == ' ') & (nation['N_COMMENT'] == 'a')].merge(customer[(customer['C_ADDRESS'] == 'H') & (customer['C_ACCTBAL'] >= -65.54288593672527)][['C_ACCTBAL', 'MKTSEGMENT', 'C_ADDRESS', 'C_COMMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[['S_NAME']].merge(lineitem, left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(customer.merge(orders[['TOTALPRICE', 'CLERK']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='S_SUPPKEY', right_on='C_CUSTKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[['S_COMMENT', 'S_ADDRESS']].merge(part[['P_PARTKEY', 'SIZE', 'RETAILPRICE']].merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='S_SUPPKEY', right_on='P_PARTKEY').merge(nation[['N_REGIONKEY']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_SUPPKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_NAME']).agg('count')

nation[(nation['N_NATIONKEY'] < 21) | (nation['N_COMMENT'].str.startswith('e'))][['N_REGIONKEY', 'N_COMMENT', 'N_NAME']].merge(region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_NAME'].str.startswith('K')) & (nation['N_REGIONKEY'] != 2)][['N_COMMENT', 'N_NATIONKEY']].merge(supplier[['S_ADDRESS']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] <= 3) & (nation['N_NAME'] == 'J')][['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']].merge(customer[(customer['C_CUSTKEY'] != 54) | (customer['C_CUSTKEY'] < 29)], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_COMMENT'] == 'l')][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].merge(nation[['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT']].merge(customer[(customer['MKTSEGMENT'] == 'BUILDING') | (customer['C_PHONE'] == '22-')][['C_NAME']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_NAME']).agg('min', numeric_only=True)

region.merge(nation[(nation['N_NATIONKEY'] != 6)].merge(supplier[['S_SUPPKEY']].merge(partsupp[(partsupp['AVAILQTY'] < 8534)][['P_COMMENT', 'SUPPLYCOST', 'PS_PARTKEY', 'PS_SUPPKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

partsupp[['SUPPLYCOST', 'PS_PARTKEY', 'AVAILQTY', 'PS_SUPPKEY', 'P_COMMENT']].merge(lineitem[(lineitem['TAX'] <= 0.05040362590900456) & (lineitem['EXTENDEDPRICE'] < 20781.231051864346)], left_on='PS_PARTKEY', right_on='L_PARTKEY')

customer[['C_NAME', 'MKTSEGMENT', 'C_ACCTBAL', 'C_ADDRESS']].merge(region[['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation.merge(supplier[(supplier['S_NATIONKEY'] > 9) & (supplier['S_NAME'] != 'S')][['S_NATIONKEY', 'S_SUPPKEY', 'S_ACCTBAL']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='C_CUSTKEY', right_on='R_REGIONKEY').merge(orders.merge(customer[['MKTSEGMENT']].merge(part, left_on='C_CUSTKEY', right_on='P_PARTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_ORDERKEY').merge(lineitem[['SHIPINSTRUCT', 'TAX', 'L_PARTKEY', 'L_COMMENT']], left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).groupby(by=['C_ACCTBAL', 'MKTSEGMENT']).agg('count')

partsupp[(partsupp['PS_PARTKEY'] <= 6)][['AVAILQTY', 'PS_SUPPKEY', 'PS_PARTKEY', 'SUPPLYCOST', 'P_COMMENT']].merge(supplier[(supplier['S_NAME'] != 'S') | (supplier['S_ADDRESS'].str.startswith('G'))].merge(partsupp[(partsupp['SUPPLYCOST'] == 907.5229761906419) & (partsupp['AVAILQTY'] <= 5422)].merge(lineitem[(lineitem['L_PARTKEY'] > 41175) | (lineitem['DISCOUNT'] >= 0.06398034366738235)][['L_SUPPKEY', 'SHIPMODE', 'QUANTITY', 'SHIPDATE']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['SUPPLYCOST'] > 271.4481680863925) & (partsupp['P_COMMENT'] != 'bli')].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[(lineitem['RECEIPTDATE'] != '1992-05-02') & (lineitem['LINENUMBER'] >= 1)][['L_COMMENT']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').groupby(by=['AVAILQTY', 'P_COMMENT']).agg('max', numeric_only=True)

partsupp.merge(lineitem[['L_PARTKEY', 'RECEIPTDATE']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(part[['CONTAINER', 'RETAILPRICE', 'PT_COMMENT', 'SIZE']], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[(part['P_PARTKEY'] <= 165)][['BRAND']].merge(nation, left_on='P_PARTKEY', right_on='N_NATIONKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['P_COMMENT']).agg('mean', numeric_only=True)

partsupp[['PS_PARTKEY', 'PS_SUPPKEY']].merge(supplier[(supplier['S_SUPPKEY'] <= 23)].merge(partsupp[['PS_PARTKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY')

nation[['N_NAME', 'N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY']].merge(supplier[['S_NATIONKEY', 'S_COMMENT', 'S_SUPPKEY', 'S_ACCTBAL']].merge(partsupp[(partsupp['SUPPLYCOST'] > 127.11368651177088) | (partsupp['PS_PARTKEY'] == 27)][['AVAILQTY', 'SUPPLYCOST']].merge(customer, left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='C_CUSTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_NATIONKEY']).agg('max', numeric_only=True)

partsupp.merge(lineitem.merge(partsupp[['AVAILQTY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').groupby(by=['SUPPLYCOST']).agg('mean', numeric_only=True)

orders[(orders['TOTALPRICE'] <= 108101.79547516891) | (orders['ORDERDATE'] <= '1992-01-13') | (orders['ORDERDATE'] >= '1998-07-21') & (orders['ORDERSTATUS'] != 'F')].merge(lineitem[(lineitem['DISCOUNT'] <= 0.00873968475162049) & (lineitem['QUANTITY'] == 40)][['EXTENDEDPRICE']].merge(region[(region['R_COMMENT'] != 'g')][['R_NAME', 'R_REGIONKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_NATIONKEY'] != 2)][['MKTSEGMENT', 'C_CUSTKEY', 'C_NATIONKEY', 'C_NAME']].merge(nation[['N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']].merge(customer[(customer['C_CUSTKEY'] == 9)], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[(orders['ORDERDATE'] == '1992-01-13')][['TOTALPRICE']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem.merge(partsupp[['P_COMMENT', 'PS_SUPPKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(orders[(orders['ORDERPRIORITY'].isin(['3-MEDIUM', '2-HIGH', '1-URGENT']))], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['O_COMMENT']).agg('min', numeric_only=True)

supplier[['S_PHONE', 'S_NATIONKEY', 'S_ACCTBAL', 'S_COMMENT', 'S_SUPPKEY']].merge(partsupp[(partsupp['SUPPLYCOST'] < 210.1696663097834) | (partsupp['PS_PARTKEY'] <= 25)][['P_COMMENT', 'PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY']].merge(part.merge(partsupp[['PS_SUPPKEY', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_PARTKEY'] == 30)].merge(supplier[['S_ADDRESS']].merge(partsupp[(partsupp['SUPPLYCOST'] >= 950.8839469491859) & (partsupp['PS_SUPPKEY'] < 6737)], left_on='S_SUPPKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[['DISCOUNT', 'SHIPDATE', 'L_SUPPKEY']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation.merge(supplier[(supplier['S_SUPPKEY'] == 27) & (supplier['S_COMMENT'] == 'h')][['S_PHONE', 'S_ADDRESS']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY')

lineitem.merge(orders[['SHIPPRIORITY', 'O_CUSTKEY', 'ORDERDATE', 'O_COMMENT']].merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_ACCTBAL'] <= 3394.4845647092834)][['C_PHONE', 'C_ADDRESS']].merge(partsupp[(partsupp['PS_PARTKEY'] < 18)][['PS_PARTKEY']], left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[['PS_SUPPKEY', 'P_COMMENT', 'SUPPLYCOST', 'AVAILQTY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY')

customer.merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['ORDERPRIORITY'] != '2-HIGH')][['O_ORDERKEY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_COMMENT'] != 'r') | (nation['N_NATIONKEY'] != 6)], left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['MKTSEGMENT']).agg('min', numeric_only=True)

part.merge(partsupp.merge(lineitem[['LINENUMBER', 'L_ORDERKEY', 'EXTENDEDPRICE']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier[(supplier['S_ADDRESS'] == 'R')][['S_COMMENT', 'S_PHONE', 'S_SUPPKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'] != 'are') | (partsupp['P_COMMENT'] == 'f')].merge(part[['PT_COMMENT', 'BRAND', 'P_NAME']], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem.merge(orders[(orders['ORDERPRIORITY'] != '1-URGENT') | (orders['O_ORDERKEY'] < 183)][['O_ORDERKEY', 'ORDERPRIORITY', 'O_COMMENT', 'ORDERSTATUS']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] == 7133)][['SUPPLYCOST', 'PS_PARTKEY']].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[['TAX', 'RECEIPTDATE']].merge(customer[(customer['C_COMMENT'] != 'y') & (customer['C_ADDRESS'].str.startswith('l'))][['C_ADDRESS', 'MKTSEGMENT', 'C_NAME']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

region[(region['R_COMMENT'] == 'l') & (region['R_REGIONKEY'] >= 3)].merge(nation[(nation['N_NAME'].str.startswith('F'))][['N_NATIONKEY', 'N_NAME', 'N_REGIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('count')

region[(region['R_NAME'] == 'AFR') | (region['R_REGIONKEY'] <= 2)].merge(nation[(nation['N_NATIONKEY'] > 3) | (nation['N_REGIONKEY'] != 1)].merge(region[(region['R_COMMENT'].str.startswith('l'))], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[['S_PHONE', 'S_ADDRESS']].merge(partsupp[['SUPPLYCOST', 'AVAILQTY', 'PS_SUPPKEY', 'P_COMMENT']], left_on='S_SUPPKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] < 1) | (nation['N_NATIONKEY'] >= 22)][['N_NAME']].merge(lineitem[(lineitem['RETURNFLAG'].isin(['A'])) & (lineitem['RETURNFLAG'] != 'A')], left_on='N_NATIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_COMMENT', 'N_REGIONKEY']].merge(region[(region['R_NAME'] == 'ASI')], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

supplier[(supplier['S_ADDRESS'].str.startswith('y')) & (supplier['S_COMMENT'] == 'j')].merge(partsupp[(partsupp['AVAILQTY'] != 8397) & (partsupp['AVAILQTY'] != 2809)][['PS_PARTKEY']].merge(lineitem[(lineitem['L_ORDERKEY'] < 190)], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['LINENUMBER'] > 6) | (lineitem['L_SUPPKEY'] > 1889)][['L_PARTKEY', 'L_COMMENT', 'DISCOUNT']].merge(partsupp[['PS_PARTKEY', 'SUPPLYCOST']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['SUPPLYCOST'] < 586.2258109884799)][['PS_SUPPKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

region.merge(nation[(nation['N_COMMENT'] != 'o')].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[(customer['C_PHONE'] != '25-') | (customer['C_NAME'] != 'C')].merge(nation[['N_REGIONKEY', 'N_COMMENT', 'N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] == ' ')], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] == 'P') & (nation['N_NAME'] == 'C')], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT']).agg('max', numeric_only=True)

region.merge(nation[(nation['N_NATIONKEY'] != 12) & (nation['N_NATIONKEY'] == 16)][['N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']].merge(customer[(customer['C_PHONE'] == '22-') | (customer['C_CUSTKEY'] <= 3)], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(region[['R_COMMENT', 'R_REGIONKEY', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

region[(region['R_REGIONKEY'] <= 0) & (region['R_COMMENT'] != 'u')].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] >= 22)][['N_COMMENT', 'N_REGIONKEY', 'N_NAME']].merge(region.merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[['R_REGIONKEY', 'R_COMMENT', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_NAME', 'N_COMMENT']].merge(customer[(customer['C_NAME'] == 'C') | (customer['C_PHONE'].str.startswith('1'))][['C_COMMENT', 'C_ADDRESS', 'MKTSEGMENT', 'C_NATIONKEY']].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

customer[(customer['C_PHONE'] != '13-') & (customer['C_COMMENT'] != ',') & (customer['C_PHONE'] != '18-')][['C_ADDRESS', 'MKTSEGMENT']].merge(supplier[['S_ADDRESS']].merge(region[(region['R_COMMENT'].str.startswith('h')) & (region['R_COMMENT'] == 'h')].merge(nation[['N_REGIONKEY', 'N_NAME', 'N_NATIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='S_SUPPKEY', right_on='R_REGIONKEY'), left_on='C_CUSTKEY', right_on='S_SUPPKEY').merge(lineitem, left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'])

customer.merge(orders[['O_CUSTKEY', 'ORDERDATE', 'ORDERPRIORITY', 'TOTALPRICE']].merge(customer[(customer['MKTSEGMENT'] == 'FURNITURE') & (customer['C_ACCTBAL'] < 8201.204128358748)][['C_CUSTKEY', 'C_ACCTBAL', 'C_COMMENT']].merge(orders[(orders['ORDERDATE'] == '1992-01-13') | (orders['SHIPPRIORITY'] > 0)][['ORDERSTATUS']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['TOTALPRICE'] >= 312474.0843565904)].merge(lineitem[(lineitem['RECEIPTDATE'] <= '1992-05-02') & (lineitem['L_SUPPKEY'] == 4331)].merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_ADDRESS'] == 'v')][['C_CUSTKEY', 'MKTSEGMENT', 'C_COMMENT']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_CUSTKEY']).agg('min', numeric_only=True)

partsupp[['PS_SUPPKEY']].merge(lineitem[['SHIPINSTRUCT', 'SHIPDATE', 'TAX']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY')

region.merge(nation[(nation['N_NATIONKEY'] > 17) & (nation['N_REGIONKEY'] >= 0)][['N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] >= 8) & (nation['N_REGIONKEY'] < 2)], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME']).agg('max', numeric_only=True)

orders[(orders['SHIPPRIORITY'] < 0) | (orders['O_ORDERKEY'] >= 65)][['CLERK']].merge(supplier[(supplier['S_COMMENT'] == 'e') & (supplier['S_NATIONKEY'] < 9)][['S_ADDRESS', 'S_SUPPKEY', 'S_NATIONKEY', 'S_COMMENT']], left_on='O_ORDERKEY', right_on='S_SUPPKEY').groupby(by=['CLERK']).agg('min', numeric_only=True)

customer[['C_ADDRESS']]

part[['CONTAINER', 'BRAND']].merge(lineitem[(lineitem['SHIPDATE'] < '1992-04-27') & (lineitem['SHIPMODE'] != 'SHIP')][['LINENUMBER', 'DISCOUNT', 'L_COMMENT']], left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(customer, left_on='P_PARTKEY', right_on='C_CUSTKEY').merge(supplier, left_on='P_PARTKEY', right_on='S_SUPPKEY').groupby(by=['BRAND', 'CONTAINER']).agg('sum', numeric_only=True)

orders

partsupp[(partsupp['SUPPLYCOST'] > 27.49922164918435) | (partsupp['P_COMMENT'].str.startswith('y')) | (partsupp['SUPPLYCOST'] > 15.787248711664388)][['SUPPLYCOST', 'AVAILQTY', 'PS_SUPPKEY', 'PS_PARTKEY']].merge(lineitem[['L_SUPPKEY', 'DISCOUNT']].merge(partsupp[(partsupp['SUPPLYCOST'] >= 728.411060576586)][['P_COMMENT', 'AVAILQTY', 'SUPPLYCOST', 'PS_PARTKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY')

customer.merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_NAME']).agg('sum', numeric_only=True)

nation[(nation['N_NATIONKEY'] < 7) & (nation['N_NAME'].str.startswith('I')) | (nation['N_REGIONKEY'] < 0) & (nation['N_NAME'] == 'K')].merge(supplier[['S_SUPPKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[['S_ADDRESS', 'S_ACCTBAL', 'S_NAME']], left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_NAME', 'N_REGIONKEY']).agg('min', numeric_only=True)

lineitem[['LINENUMBER']].merge(part[['TYPE', 'CONTAINER', 'P_NAME']].merge(orders[(orders['CLERK'].str.startswith('C'))][['SHIPPRIORITY']].merge(part[(part['P_NAME'] == 't') | (part['BRAND'].isin(['Brand#35', 'Brand#25', 'Brand#23', 'Brand#43', 'Brand#12', 'Brand#52', 'Brand#34', 'Brand#24', 'Brand#22', 'Brand#55', 'Brand#54']))][['CONTAINER']], left_on='O_ORDERKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='O_ORDERKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY').merge(region[['R_NAME']].merge(lineitem, left_on='R_REGIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(partsupp[(partsupp['PS_PARTKEY'] > 17) & (partsupp['SUPPLYCOST'] < 299.83201282485425)], left_on='R_REGIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY').merge(part[['BRAND', 'TYPE', 'CONTAINER', 'P_PARTKEY']].merge(partsupp[['PS_PARTKEY', 'SUPPLYCOST']], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_SUPPKEY', 'PS_PARTKEY', 'AVAILQTY']].merge(lineitem[(lineitem['L_ORDERKEY'] > 122) & (lineitem['L_SUPPKEY'] == 8395)], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY').groupby(by=['LINENUMBER']).agg('max', numeric_only=True)

customer[(customer['C_ADDRESS'] == 'J') | (customer['C_ADDRESS'] == 'R')][['C_NAME', 'C_NATIONKEY', 'C_PHONE', 'C_CUSTKEY', 'C_ADDRESS']].merge(nation.merge(supplier[(supplier['S_NATIONKEY'] > 22) & (supplier['S_ACCTBAL'] != 5330.381995859175)], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region.merge(nation[['N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[(orders['O_ORDERKEY'] == 571)][['O_ORDERKEY', 'CLERK', 'TOTALPRICE', 'O_COMMENT']].merge(lineitem.merge(partsupp[(partsupp['AVAILQTY'] <= 2584) | (partsupp['SUPPLYCOST'] > 319.209949553016)], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem.merge(partsupp[(partsupp['AVAILQTY'] >= 8745)][['PS_PARTKEY', 'PS_SUPPKEY', 'SUPPLYCOST', 'AVAILQTY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['SHIPPRIORITY', 'ORDERPRIORITY', 'ORDERDATE']].merge(lineitem[['TAX']], left_on='O_ORDERKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(part[(part['MFGR'] != 'Manufacturer#1') | (part['BRAND'] != 'Brand#15')].merge(partsupp[(partsupp['AVAILQTY'] <= 9049)][['PS_PARTKEY', 'P_COMMENT', 'AVAILQTY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='P_PARTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_ADDRESS']).agg('count')

supplier.merge(nation[(nation['N_NATIONKEY'] > 23)].merge(customer[(customer['C_CUSTKEY'] > 67)], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NAME'].str.startswith('P'))][['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['SUPPLYCOST'] < 955.912876838573)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_NAME', 'S_PHONE']).agg('mean', numeric_only=True)

nation[(nation['N_COMMENT'].str.startswith('e')) | (nation['N_NAME'] == 'J') | (nation['N_NAME'].str.startswith('E'))][['N_COMMENT', 'N_NAME']].merge(orders[['CLERK', 'O_CUSTKEY', 'TOTALPRICE', 'O_ORDERKEY']], left_on='N_NATIONKEY', right_on='O_ORDERKEY').merge(lineitem.merge(partsupp[(partsupp['P_COMMENT'].str.startswith('u')) & (partsupp['SUPPLYCOST'] >= 952.3491327789278)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).groupby(by=['N_COMMENT']).agg('min', numeric_only=True)

region[(region['R_NAME'] != 'ASI') & (region['R_COMMENT'] != 'u')].merge(nation[(nation['N_NAME'] == 'A')][['N_COMMENT', 'N_NAME', 'N_REGIONKEY']].merge(region.merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY', 'R_NAME']).agg('max', numeric_only=True)

lineitem[(lineitem['SHIPMODE'] != 'RAIL') | (lineitem['SHIPDATE'] != '1992-04-27') & (lineitem['L_COMMENT'] == ' re') & (lineitem['LINENUMBER'] > 2)][['RETURNFLAG', 'DISCOUNT', 'LINENUMBER']].merge(supplier[(supplier['S_NATIONKEY'] != 12) | (supplier['S_NATIONKEY'] == 1)].merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['P_COMMENT'].str.startswith('v')) | (partsupp['PS_PARTKEY'] <= 45)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY').merge(supplier[(supplier['S_SUPPKEY'] < 162) | (supplier['S_PHONE'] == '26-')][['S_NATIONKEY', 'S_ADDRESS', 'S_COMMENT', 'S_NAME']].merge(nation[(nation['N_REGIONKEY'] != 3)].merge(supplier[(supplier['S_PHONE'] != '14-')][['S_NAME']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_COMMENT'] == 'v') | (nation['N_COMMENT'] == 's')], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY').groupby(by=['RETURNFLAG', 'DISCOUNT']).agg('min', numeric_only=True)

customer[(customer['C_COMMENT'].str.startswith('f')) & (customer['C_ADDRESS'] == 'w')][['MKTSEGMENT', 'C_ADDRESS', 'C_COMMENT', 'C_ACCTBAL']].merge(orders[['TOTALPRICE', 'O_ORDERKEY', 'ORDERPRIORITY']].merge(lineitem[(lineitem['EXTENDEDPRICE'] < 79182.12849550237)].merge(partsupp[['PS_PARTKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_ORDERKEY').groupby(by=['C_ADDRESS']).agg('count')

supplier[['S_SUPPKEY', 'S_COMMENT', 'S_PHONE', 'S_ACCTBAL']].groupby(by=['S_ACCTBAL', 'S_SUPPKEY']).agg('count')

partsupp[(partsupp['P_COMMENT'] == 'q') & (partsupp['PS_PARTKEY'] >= 44) & (partsupp['SUPPLYCOST'] != 684.5796508728207)][['PS_PARTKEY', 'P_COMMENT', 'PS_SUPPKEY', 'SUPPLYCOST', 'AVAILQTY']].merge(supplier.merge(partsupp.merge(part[(part['P_NAME'].str.startswith('f')) | (part['PT_COMMENT'] != 'ly ')], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY')

orders[(orders['CLERK'] != 'C') | (orders['SHIPPRIORITY'] < 0)][['ORDERDATE', 'O_COMMENT', 'O_ORDERKEY']].merge(lineitem.merge(partsupp[(partsupp['SUPPLYCOST'] == 281.5895105128152) & (partsupp['SUPPLYCOST'] <= 782.0140562630111)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp.merge(part[(part['PT_COMMENT'] != 'e') & (part['P_PARTKEY'] < 102)][['PT_COMMENT', 'BRAND', 'MFGR', 'RETAILPRICE']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['L_SUPPKEY'] < 739) & (lineitem['L_SUPPKEY'] != 5793)].merge(orders[['SHIPPRIORITY', 'O_COMMENT', 'ORDERPRIORITY', 'TOTALPRICE']].merge(region[['R_NAME', 'R_REGIONKEY', 'R_COMMENT']], left_on='O_ORDERKEY', right_on='R_REGIONKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['TOTALPRICE'] >= 60679.69604908338) | (orders['O_CUSTKEY'] < 21473)][['TOTALPRICE']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[['COMMITDATE', 'L_COMMENT', 'LINENUMBER', 'SHIPDATE']].merge(nation, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY').merge(supplier[['S_ACCTBAL', 'S_COMMENT', 'S_SUPPKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['O_ORDERKEY', 'ORDERDATE']).agg('count')

region[(region['R_REGIONKEY'] >= 1) & (region['R_COMMENT'].str.startswith('u')) & (region['R_COMMENT'].str.startswith('g'))].merge(nation[['N_NATIONKEY', 'N_NAME', 'N_COMMENT']].merge(supplier[(supplier['S_PHONE'] == '32-')][['S_SUPPKEY', 'S_PHONE', 'S_ACCTBAL']].merge(partsupp[(partsupp['PS_SUPPKEY'] == 6952)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] != 2)][['N_COMMENT', 'N_NATIONKEY', 'N_NAME']].merge(customer[(customer['C_COMMENT'] != 'y')][['C_ADDRESS', 'C_COMMENT']].merge(part[['BRAND']], left_on='C_CUSTKEY', right_on='P_PARTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY', 'R_NAME']).agg('count')

orders[['O_COMMENT', 'ORDERDATE', 'O_ORDERKEY', 'CLERK']]

orders[['O_COMMENT', 'SHIPPRIORITY', 'O_CUSTKEY']].merge(customer.merge(nation[(nation['N_REGIONKEY'] <= 3)][['N_NAME', 'N_NATIONKEY']].merge(supplier[['S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[(orders['TOTALPRICE'] <= 212037.59482125615) & (orders['ORDERDATE'] > '1998-07-21')][['ORDERDATE', 'ORDERSTATUS', 'SHIPPRIORITY']].merge(nation[['N_REGIONKEY', 'N_COMMENT', 'N_NAME', 'N_NATIONKEY']], left_on='O_ORDERKEY', right_on='N_NATIONKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY')

partsupp[(partsupp['SUPPLYCOST'] > 834.7423664266544)].groupby(by=['PS_SUPPKEY']).agg('count')

lineitem[(lineitem['L_SUPPKEY'] >= 4959) | (lineitem['COMMITDATE'] > '1998-10-16')].groupby(by=['RETURNFLAG']).agg('count')

partsupp[(partsupp['AVAILQTY'] == 4094) & (partsupp['PS_SUPPKEY'] >= 613) & (partsupp['SUPPLYCOST'] != 770.3907277062561)][['P_COMMENT', 'SUPPLYCOST', 'AVAILQTY', 'PS_PARTKEY', 'PS_SUPPKEY']].merge(lineitem[(lineitem['QUANTITY'] == 12) & (lineitem['LINESTATUS'] == 'O')][['SHIPMODE', 'L_PARTKEY', 'TAX']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[['L_ORDERKEY', 'L_COMMENT', 'SHIPINSTRUCT', 'DISCOUNT']].merge(orders[(orders['CLERK'] == 'C') | (orders['ORDERDATE'] < '1992-01-13')][['TOTALPRICE']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').groupby(by=['PS_PARTKEY']).agg('mean', numeric_only=True)

partsupp[(partsupp['P_COMMENT'] != 'the') | (partsupp['PS_PARTKEY'] < 18) | (partsupp['AVAILQTY'] < 5607)].merge(part[(part['TYPE'].str.startswith('SMA')) & (part['RETAILPRICE'] < 945.7890636412695)].merge(partsupp[(partsupp['PS_PARTKEY'] < 47) | (partsupp['PS_PARTKEY'] <= 45)][['AVAILQTY', 'PS_SUPPKEY', 'P_COMMENT', 'PS_PARTKEY']].merge(supplier[(supplier['S_COMMENT'] != 'j')][['S_SUPPKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY')

lineitem[(lineitem['LINENUMBER'] != 6) | (lineitem['SHIPDATE'] > '1992-04-27') | (lineitem['TAX'] != 0.04600048392038997) & (lineitem['LINENUMBER'] != 3)][['LINESTATUS', 'COMMITDATE', 'SHIPINSTRUCT']].groupby(by=['SHIPINSTRUCT', 'COMMITDATE']).agg('max', numeric_only=True)

nation[(nation['N_NAME'] == 'F') | (nation['N_REGIONKEY'] == 3)].merge(supplier.merge(nation[(nation['N_COMMENT'] == 'r')], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_REGIONKEY', 'N_NATIONKEY']).agg('mean', numeric_only=True)

part[['P_NAME', 'TYPE', 'P_PARTKEY', 'SIZE', 'BRAND']].groupby(by=['SIZE']).agg('mean', numeric_only=True)

orders[(orders['ORDERDATE'] < '1992-01-13') & (orders['CLERK'].str.startswith('C'))].merge(customer[(customer['C_PHONE'] != '1') | (customer['C_ACCTBAL'] >= 7602.141734279097)].merge(nation[(nation['N_REGIONKEY'] >= 2) & (nation['N_COMMENT'].str.startswith('a'))][['N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[['SHIPPRIORITY', 'ORDERDATE', 'CLERK', 'ORDERSTATUS']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[(lineitem['L_COMMENT'] == 'e') & (lineitem['COMMITDATE'] > '1998-10-16')].merge(orders[['TOTALPRICE', 'O_CUSTKEY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['AVAILQTY'] >= 777)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['O_COMMENT']).agg('sum', numeric_only=True)

lineitem[['QUANTITY', 'L_ORDERKEY', 'RETURNFLAG']].merge(orders.merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_NAME'] != 'C')][['C_CUSTKEY', 'C_PHONE', 'C_NATIONKEY', 'C_ADDRESS']].merge(orders[(orders['ORDERDATE'] == '1998-07-21')], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['O_CUSTKEY'] < 76874) | (orders['TOTALPRICE'] != 346338.8359329932)][['O_CUSTKEY', 'O_ORDERKEY', 'ORDERPRIORITY', 'O_COMMENT']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders.merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_NAME'] != 'C')].merge(orders[['O_ORDERKEY', 'SHIPPRIORITY', 'ORDERSTATUS', 'CLERK']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').groupby(by=['L_ORDERKEY', 'QUANTITY']).agg('count')

orders[['TOTALPRICE', 'ORDERDATE']].merge(region[(region['R_REGIONKEY'] < 0) | (region['R_NAME'] != 'A')].merge(nation[(nation['N_NATIONKEY'] < 15) | (nation['N_REGIONKEY'] >= 0)][['N_NAME', 'N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']].merge(supplier[['S_ACCTBAL', 'S_PHONE', 'S_COMMENT', 'S_NATIONKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='O_ORDERKEY', right_on='R_REGIONKEY')

orders[(orders['ORDERPRIORITY'] != '2-HIGH') & (orders['CLERK'] != 'C') | (orders['TOTALPRICE'] >= 225814.5983774511) & (orders['TOTALPRICE'] == 217613.10918601375)].merge(lineitem[['SHIPDATE', 'LINESTATUS', 'SHIPINSTRUCT']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[['TAX', 'RETURNFLAG']].merge(partsupp.merge(supplier[(supplier['S_ACCTBAL'] > 9427.47499195188)], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(nation.merge(customer[['C_NAME', 'C_COMMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[['L_SUPPKEY', 'QUANTITY', 'L_ORDERKEY']].merge(partsupp[(partsupp['PS_SUPPKEY'] > 6921)][['PS_PARTKEY', 'PS_SUPPKEY', 'AVAILQTY', 'SUPPLYCOST']].merge(lineitem[['QUANTITY', 'RECEIPTDATE', 'LINESTATUS']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY')

part[(part['PT_COMMENT'] == ' ') | (part['P_NAME'] == 'd') | (part['SIZE'] > 19)][['CONTAINER', 'PT_COMMENT', 'RETAILPRICE', 'MFGR']].merge(orders[(orders['CLERK'] == 'C')].merge(customer[(customer['MKTSEGMENT'] != 'BUILDING')][['C_COMMENT', 'MKTSEGMENT', 'C_ADDRESS', 'C_CUSTKEY']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='P_PARTKEY', right_on='O_ORDERKEY')

lineitem[(lineitem['SHIPINSTRUCT'].isin(['COLLECT COD', 'DELIVER IN PERSON', 'NONE', 'TAKE BACK RETURN']))][['QUANTITY', 'L_PARTKEY', 'TAX']].merge(partsupp[(partsupp['P_COMMENT'] != 'h') & (partsupp['SUPPLYCOST'] == 553.7904071367893)][['SUPPLYCOST']].merge(lineitem.merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(lineitem[(lineitem['SHIPINSTRUCT'] != 'TAKE BACK RETURN')][['SHIPDATE', 'RETURNFLAG', 'QUANTITY', 'L_ORDERKEY']].merge(orders[(orders['ORDERPRIORITY'] != '2-HIGH')], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'] == 'u') & (partsupp['P_COMMENT'] != 'a')].merge(lineitem[(lineitem['L_ORDERKEY'] == 56) & (lineitem['L_SUPPKEY'] == 2340)][['SHIPMODE']].merge(supplier[(supplier['S_NAME'] == 'S') & (supplier['S_SUPPKEY'] != 127)][['S_NAME', 'S_ACCTBAL', 'S_PHONE']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['TAX']).agg('sum', numeric_only=True)

lineitem[['LINENUMBER', 'DISCOUNT']].merge(partsupp.merge(lineitem[(lineitem['LINENUMBER'] > 2)].merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['LINENUMBER'] == 2) & (lineitem['L_SUPPKEY'] < 1195)], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(partsupp[['AVAILQTY', 'PS_SUPPKEY']].merge(lineitem[(lineitem['COMMITDATE'] == '1992-05-15') | (lineitem['COMMITDATE'] < '1992-05-15')][['L_ORDERKEY', 'L_COMMENT', 'LINESTATUS']].merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']).groupby(by=['LINENUMBER']).agg('count')

lineitem[(lineitem['DISCOUNT'] != 0.06141680506698564) & (lineitem['DISCOUNT'] != 0.08298263306065636) | (lineitem['LINESTATUS'].isin(['O', 'F'])) | (lineitem['LINESTATUS'].isin(['F', 'O']))][['SHIPMODE', 'EXTENDEDPRICE', 'L_COMMENT']].merge(orders[(orders['O_CUSTKEY'] != 90104) & (orders['O_COMMENT'] == 'the')][['O_CUSTKEY', 'ORDERSTATUS']].merge(customer[(customer['MKTSEGMENT'] == 'MACHINERY')][['C_ACCTBAL', 'C_NAME']].merge(region[(region['R_NAME'].str.startswith('M'))][['R_NAME', 'R_REGIONKEY']], left_on='C_CUSTKEY', right_on='R_REGIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[['C_ADDRESS', 'C_NAME', 'C_ACCTBAL']].merge(part[(part['SIZE'] >= 16) & (part['CONTAINER'] != 'SM')][['BRAND', 'CONTAINER']], left_on='C_CUSTKEY', right_on='P_PARTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY').merge(nation[(nation['N_REGIONKEY'] != 3)].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY')

partsupp[(partsupp['PS_SUPPKEY'] >= 4636) | (partsupp['SUPPLYCOST'] != 70.3253864606539) & (partsupp['AVAILQTY'] == 4783)].merge(lineitem[(lineitem['COMMITDATE'] <= '1992-05-15') & (lineitem['L_ORDERKEY'] < 35)][['LINESTATUS']].merge(supplier[(supplier['S_PHONE'] == '2') | (supplier['S_NATIONKEY'] > 19)][['S_NAME', 'S_NATIONKEY']].merge(nation[['N_NAME', 'N_COMMENT', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY').merge(partsupp[(partsupp['SUPPLYCOST'] < 652.7634399234616) | (partsupp['AVAILQTY'] != 8404)].merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['QUANTITY'] < 37)].merge(orders[['O_ORDERKEY', 'SHIPPRIORITY', 'ORDERPRIORITY', 'ORDERDATE']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['PS_PARTKEY'] >= 28) | (partsupp['PS_SUPPKEY'] < 593)][['PS_PARTKEY', 'AVAILQTY']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY')

nation[['N_NATIONKEY', 'N_COMMENT']].merge(supplier[(supplier['S_NATIONKEY'] != 11) | (supplier['S_ACCTBAL'] < 2828.2358797534944)][['S_COMMENT', 'S_NATIONKEY', 'S_NAME']], left_on='N_NATIONKEY', right_on='S_NATIONKEY')

nation.merge(region.merge(nation.merge(customer[(customer['MKTSEGMENT'] != 'BUILDING')][['C_ACCTBAL', 'C_CUSTKEY', 'C_ADDRESS', 'C_NATIONKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(region[(region['R_REGIONKEY'] <= 1)], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[(supplier['S_PHONE'] != '3') & (supplier['S_ADDRESS'].str.startswith('j'))].merge(partsupp[(partsupp['P_COMMENT'] == 'the') | (partsupp['PS_SUPPKEY'] < 325)].merge(supplier[['S_ACCTBAL']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_COMMENT'] == 'o') | (nation['N_COMMENT'] != 'y')][['N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY')

part[(part['RETAILPRICE'] >= 1020.2626596833288)].merge(partsupp[(partsupp['P_COMMENT'].str.startswith('h')) | (partsupp['SUPPLYCOST'] < 438.8823626415191)].merge(lineitem[(lineitem['RECEIPTDATE'] < '1992-05-02')], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(lineitem[['L_ORDERKEY']].merge(orders[(orders['ORDERSTATUS'].isin(['F']))][['O_CUSTKEY', 'ORDERPRIORITY', 'SHIPPRIORITY', 'ORDERDATE']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

part[(part['SIZE'] < 21) & (part['BRAND'] != 'Brand#53') & (part['MFGR'] != 'Manufacturer#2')][['CONTAINER']].merge(partsupp[(partsupp['AVAILQTY'] <= 9008)].merge(lineitem[(lineitem['SHIPDATE'] > '1992-04-27')], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier[(supplier['S_COMMENT'].str.startswith('c')) | (supplier['S_PHONE'].str.startswith('26-'))][['S_COMMENT', 'S_NAME']].merge(partsupp[['SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT']], left_on='S_SUPPKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(region, left_on='P_PARTKEY', right_on='R_REGIONKEY').groupby(by=['CONTAINER']).agg('max', numeric_only=True)

partsupp.merge(supplier.merge(partsupp[(partsupp['AVAILQTY'] > 8447)][['P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(part[(part['CONTAINER'].str.startswith('MED')) | (part['TYPE'].str.startswith('L'))][['MFGR', 'PT_COMMENT', 'TYPE']].merge(supplier[['S_ADDRESS', 'S_COMMENT']], left_on='P_PARTKEY', right_on='S_SUPPKEY').merge(customer[(customer['C_PHONE'] == '25-')], left_on='P_PARTKEY', right_on='C_CUSTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[['P_NAME', 'SIZE', 'P_PARTKEY']].merge(partsupp[(partsupp['P_COMMENT'].str.startswith('b')) | (partsupp['P_COMMENT'] == 'u')][['PS_SUPPKEY', 'SUPPLYCOST', 'PS_PARTKEY']].merge(supplier[(supplier['S_NAME'].str.startswith('S'))], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['PS_SUPPKEY']).agg('sum', numeric_only=True)

lineitem.merge(partsupp[(partsupp['SUPPLYCOST'] <= 890.3348842642445) & (partsupp['PS_PARTKEY'] >= 28)][['PS_SUPPKEY', 'AVAILQTY']].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem.merge(orders[(orders['O_ORDERKEY'] >= 265) & (orders['ORDERSTATUS'].isin(['O', 'F', 'P']))], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY')

region.merge(nation[(nation['N_COMMENT'] != 'i')].merge(supplier[['S_COMMENT', 'S_NATIONKEY', 'S_ACCTBAL']], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[['S_ADDRESS', 'S_NAME', 'S_NATIONKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(customer[['C_CUSTKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_COMMENT'] != 'l')][['R_NAME', 'R_COMMENT', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

nation.merge(customer[['C_ADDRESS', 'MKTSEGMENT']].merge(orders[(orders['SHIPPRIORITY'] >= 0)].merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_ORDERKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[(customer['C_PHONE'] == '1') & (customer['C_COMMENT'] == '.')].merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

lineitem[['L_SUPPKEY']].merge(partsupp[['SUPPLYCOST', 'PS_SUPPKEY', 'PS_PARTKEY']].merge(part[(part['MFGR'].isin(['Manufacturer#2']))], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(supplier[['S_NATIONKEY', 'S_SUPPKEY', 'S_COMMENT', 'S_ADDRESS']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['AVAILQTY'] <= 5883) & (partsupp['AVAILQTY'] >= 2648)].merge(supplier.merge(partsupp[['P_COMMENT', 'SUPPLYCOST', 'PS_SUPPKEY', 'PS_PARTKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['L_SUPPKEY']).agg('sum', numeric_only=True)

partsupp.merge(lineitem[(lineitem['EXTENDEDPRICE'] < 17374.978384703645) | (lineitem['L_SUPPKEY'] != 865)][['LINENUMBER', 'L_ORDERKEY', 'SHIPDATE', 'RETURNFLAG']].merge(orders[(orders['O_ORDERKEY'] == 497)], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[['ORDERSTATUS']].merge(supplier[(supplier['S_COMMENT'].str.startswith('c')) & (supplier['S_ADDRESS'] != 'T')][['S_COMMENT', 'S_SUPPKEY', 'S_PHONE']], left_on='O_ORDERKEY', right_on='S_SUPPKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY')

region[['R_REGIONKEY']].merge(nation[(nation['N_REGIONKEY'] >= 2)][['N_NAME', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(supplier[['S_NAME', 'S_ACCTBAL', 'S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('min', numeric_only=True)

orders[(orders['TOTALPRICE'] >= 270777.2423290239)][['ORDERDATE', 'CLERK', 'TOTALPRICE', 'SHIPPRIORITY', 'O_COMMENT']].merge(customer[(customer['MKTSEGMENT'] == 'AUTOMOBILE') | (customer['C_ADDRESS'] != 'h')][['C_NATIONKEY', 'C_COMMENT', 'C_PHONE', 'MKTSEGMENT']].merge(nation[(nation['N_REGIONKEY'] < 0)].merge(supplier[(supplier['S_COMMENT'].str.startswith('al '))][['S_ACCTBAL']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_COMMENT'] != 'l')].merge(customer[(customer['C_ACCTBAL'] <= 2798.637424315677) | (customer['C_COMMENT'] == 'y')][['C_CUSTKEY', 'C_NAME', 'C_ADDRESS', 'C_ACCTBAL']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='C_CUSTKEY').merge(customer.merge(nation[['N_COMMENT']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[(orders['CLERK'].str.startswith('C'))][['SHIPPRIORITY']].merge(part, left_on='O_ORDERKEY', right_on='P_PARTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_ORDERKEY', right_on='C_CUSTKEY').merge(region[(region['R_COMMENT'] == 'l') & (region['R_NAME'].str.startswith('ASI'))][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']], left_on='O_ORDERKEY', right_on='R_REGIONKEY').groupby(by=['SHIPPRIORITY']).agg('count')

lineitem[['L_COMMENT']]

orders.merge(lineitem[['COMMITDATE', 'RETURNFLAG', 'QUANTITY', 'LINESTATUS']].merge(nation[(nation['N_REGIONKEY'] <= 3)][['N_REGIONKEY', 'N_NATIONKEY']].merge(supplier[(supplier['S_NATIONKEY'] != 17)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY').merge(nation[(nation['N_NATIONKEY'] >= 19)], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer.merge(nation[(nation['N_REGIONKEY'] != 3)].merge(customer[(customer['C_COMMENT'].str.startswith(',')) | (customer['C_ADDRESS'] == 'I')][['C_CUSTKEY', 'C_ACCTBAL', 'MKTSEGMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[(orders['TOTALPRICE'] >= 248371.3102575668)][['O_CUSTKEY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['O_CUSTKEY']).agg('sum', numeric_only=True)

customer[['C_ADDRESS', 'MKTSEGMENT', 'C_NATIONKEY', 'C_ACCTBAL', 'C_CUSTKEY']].merge(nation[['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME', 'N_COMMENT']].merge(region[(region['R_REGIONKEY'] >= 0)][['R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[['S_NAME']].merge(orders[(orders['ORDERPRIORITY'].isin(['1-URGENT', '2-HIGH', '3-MEDIUM', '5-LOW', '4-NOT SPECIFIED'])) | (orders['O_ORDERKEY'] >= 700)][['TOTALPRICE', 'O_CUSTKEY', 'O_COMMENT', 'SHIPPRIORITY']], left_on='S_SUPPKEY', right_on='O_ORDERKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(customer[(customer['C_ADDRESS'] != 'J') | (customer['C_ACCTBAL'] < 7477.168004254763)].merge(nation[(nation['N_NATIONKEY'] != 18)][['N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_NAME'] == 'A')][['R_NAME', 'R_COMMENT', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_NAME', 'N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY']].merge(supplier[(supplier['S_COMMENT'] == 'l')][['S_NATIONKEY', 'S_PHONE', 'S_SUPPKEY', 'S_ADDRESS']].merge(nation[['N_COMMENT', 'N_NAME']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[(customer['C_CUSTKEY'] <= 38) | (customer['C_NATIONKEY'] < 15)][['C_NATIONKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

part.merge(partsupp[['PS_SUPPKEY', 'SUPPLYCOST']].merge(supplier[(supplier['S_SUPPKEY'] != 172)][['S_PHONE', 'S_SUPPKEY', 'S_COMMENT', 'S_NAME']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier.merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['CONTAINER']).agg('min', numeric_only=True)

region[(region['R_NAME'] != 'AME') | (region['R_COMMENT'] != 'u')][['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT', 'N_NAME']].merge(customer[['C_NATIONKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME']).agg('mean', numeric_only=True)

nation[(nation['N_REGIONKEY'] <= 1) & (nation['N_NAME'].str.startswith('B')) & (nation['N_NATIONKEY'] < 18) | (nation['N_NATIONKEY'] <= 6)][['N_NATIONKEY', 'N_NAME', 'N_COMMENT', 'N_REGIONKEY']].merge(supplier[(supplier['S_PHONE'].str.startswith('32-')) | (supplier['S_ACCTBAL'] != 2030.6420843429407)].merge(partsupp[['PS_SUPPKEY', 'AVAILQTY', 'PS_PARTKEY', 'SUPPLYCOST']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_NAME'] == 'F') & (nation['N_NATIONKEY'] <= 16)][['N_COMMENT', 'N_REGIONKEY', 'N_NAME', 'N_NATIONKEY']].merge(supplier[(supplier['S_PHONE'].str.startswith('2')) & (supplier['S_COMMENT'] != 'x')][['S_NATIONKEY', 'S_NAME']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_REGIONKEY']).agg('sum', numeric_only=True)

lineitem[(lineitem['RETURNFLAG'] == 'R') | (lineitem['L_PARTKEY'] != 134546) | (lineitem['RETURNFLAG'] != 'R') | (lineitem['SHIPMODE'] != 'SHIP')].merge(partsupp[(partsupp['PS_SUPPKEY'] < 3778) & (partsupp['AVAILQTY'] <= 2560)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['AVAILQTY'] > 3371)], left_on='L_PARTKEY', right_on='PS_PARTKEY')

orders[(orders['CLERK'] == 'C') | (orders['CLERK'].str.startswith('C'))].merge(customer[['C_ACCTBAL', 'MKTSEGMENT', 'C_PHONE', 'C_CUSTKEY']].merge(orders.merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['ORDERSTATUS', 'CLERK']).agg('mean', numeric_only=True)

partsupp[(partsupp['AVAILQTY'] < 4678) | (partsupp['PS_SUPPKEY'] > 344)].merge(lineitem[['EXTENDEDPRICE', 'SHIPINSTRUCT']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['DISCOUNT'] > 0.055327587128995964)].merge(orders.merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY')

part[(part['SIZE'] > 32) | (part['BRAND'] != 'Brand#45') & (part['MFGR'] != 'Manufacturer#5') & (part['CONTAINER'] == 'LG')][['SIZE', 'TYPE', 'PT_COMMENT']].merge(orders[['ORDERSTATUS']].merge(partsupp[(partsupp['AVAILQTY'] > 7503)].merge(supplier[(supplier['S_ADDRESS'].str.startswith('o'))], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='P_PARTKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['PS_PARTKEY'] >= 39)].merge(supplier[(supplier['S_PHONE'] != '17-') | (supplier['S_COMMENT'] == ',')].merge(nation[(nation['N_NATIONKEY'] == 9)][['N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(orders.merge(customer[(customer['C_CUSTKEY'] != 98)][['MKTSEGMENT', 'C_NATIONKEY', 'C_ADDRESS']].merge(nation[['N_COMMENT', 'N_NATIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='P_PARTKEY', right_on='O_ORDERKEY').groupby(by=['TYPE', 'SIZE']).agg('count')

region[(region['R_REGIONKEY'] <= 0) | (region['R_NAME'].str.startswith('A')) | (region['R_NAME'] == 'A')][['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation[['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']].merge(region[['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].merge(nation[(nation['N_REGIONKEY'] == 3) & (nation['N_NATIONKEY'] > 15)], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NAME', 'N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY']].merge(region.merge(nation[(nation['N_NAME'] == 'U')][['N_REGIONKEY', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[['S_SUPPKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME', 'R_REGIONKEY']).agg('mean', numeric_only=True)

region[(region['R_NAME'].str.startswith('M')) & (region['R_NAME'] == 'ASI') & (region['R_NAME'].str.startswith('AFR'))].merge(nation[(nation['N_COMMENT'].str.startswith('y')) | (nation['N_REGIONKEY'] <= 1)].merge(supplier[(supplier['S_COMMENT'].str.startswith('k')) | (supplier['S_NATIONKEY'] > 4)][['S_ACCTBAL', 'S_NAME']].merge(nation[(nation['N_NATIONKEY'] < 4)][['N_NATIONKEY']], left_on='S_SUPPKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'].str.startswith('s')) | (nation['N_COMMENT'].str.startswith('e'))], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

nation[(nation['N_NAME'] == 'B') & (nation['N_NATIONKEY'] < 11)]

part[(part['SIZE'] < 8) & (part['BRAND'] != 'Brand#31') & (part['CONTAINER'] != 'MED')].merge(partsupp[(partsupp['AVAILQTY'] >= 967)][['PS_SUPPKEY']].merge(supplier[(supplier['S_PHONE'] == '14-') & (supplier['S_SUPPKEY'] <= 60)][['S_SUPPKEY', 'S_ACCTBAL', 'S_NAME']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'] == 'n')].merge(lineitem[(lineitem['SHIPINSTRUCT'] == 'TAKE BACK RETURN') & (lineitem['EXTENDEDPRICE'] >= 14698.297048721957)][['L_SUPPKEY', 'SHIPDATE', 'RETURNFLAG']].merge(partsupp[(partsupp['PS_PARTKEY'] == 43) | (partsupp['PS_SUPPKEY'] != 2402)][['P_COMMENT', 'PS_SUPPKEY', 'SUPPLYCOST', 'AVAILQTY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['SIZE', 'PT_COMMENT']).agg('max', numeric_only=True)

supplier.merge(partsupp.merge(lineitem.merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation.merge(region[(region['R_COMMENT'] != 'l') & (region['R_REGIONKEY'] <= 0)][['R_NAME', 'R_COMMENT', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[['PS_PARTKEY']].merge(lineitem[['DISCOUNT']].merge(part[(part['RETAILPRICE'] <= 926.9720855268665) | (part['TYPE'] != 'P')], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_PHONE']).agg('mean', numeric_only=True)

lineitem[(lineitem['DISCOUNT'] >= 0.06930267131855754)][['L_PARTKEY', 'EXTENDEDPRICE', 'LINENUMBER', 'SHIPINSTRUCT']].merge(partsupp[(partsupp['PS_PARTKEY'] > 49)][['AVAILQTY', 'SUPPLYCOST']].merge(lineitem[(lineitem['DISCOUNT'] == 0.048191159460019076)], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['AVAILQTY'] >= 2955) & (partsupp['SUPPLYCOST'] > 49.85555880009812)].merge(supplier[(supplier['S_NATIONKEY'] > 13) & (supplier['S_ACCTBAL'] == 6692.964567977332)][['S_PHONE', 'S_NAME', 'S_ADDRESS']].merge(lineitem[['TAX']], left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['EXTENDEDPRICE']).agg('sum', numeric_only=True)

customer.merge(nation[['N_NAME', 'N_COMMENT', 'N_NATIONKEY']].merge(supplier[['S_SUPPKEY']].merge(partsupp[['SUPPLYCOST', 'P_COMMENT', 'PS_PARTKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[(supplier['S_NATIONKEY'] <= 17)].merge(partsupp[(partsupp['SUPPLYCOST'] >= 653.6239859701802)][['PS_PARTKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[['N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY')

region.merge(nation[(nation['N_NAME'] != 'F') | (nation['N_NATIONKEY'] < 18)].merge(region[['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].merge(nation[(nation['N_NAME'] == 'P')][['N_NAME', 'N_COMMENT', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NATIONKEY', 'N_REGIONKEY']].merge(region.merge(nation[(nation['N_COMMENT'] != 'i')], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[(supplier['S_PHONE'] == '2') | (supplier['S_NATIONKEY'] < 4)].merge(nation[(nation['N_NAME'] != 'C') & (nation['N_NAME'] != 'C')], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

supplier[(supplier['S_SUPPKEY'] >= 45) & (supplier['S_NATIONKEY'] < 10)][['S_NATIONKEY', 'S_COMMENT', 'S_SUPPKEY', 'S_ADDRESS']].merge(nation.merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(region[(region['R_COMMENT'] == 'h') | (region['R_NAME'] == 'M')].merge(nation[(nation['N_NATIONKEY'] < 20)], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[(customer['C_PHONE'].str.startswith('27-'))].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['AVAILQTY'] <= 2265)][['P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_NATIONKEY']).agg('mean', numeric_only=True)

supplier.merge(partsupp.merge(lineitem[(lineitem['COMMITDATE'] > '1992-05-15')][['L_COMMENT']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_NATIONKEY', 'S_PHONE']).agg('sum', numeric_only=True)

partsupp[['PS_SUPPKEY', 'PS_PARTKEY', 'SUPPLYCOST', 'AVAILQTY', 'P_COMMENT']].merge(part[(part['BRAND'].isin(['Brand#22', 'Brand#54', 'Brand#11', 'Brand#43', 'Brand#33', 'Brand#15', 'Brand#32', 'Brand#25', 'Brand#23', 'Brand#13', 'Brand#45', 'Brand#31', 'Brand#35', 'Brand#51', 'Brand#44', 'Brand#14', 'Brand#24', 'Brand#12', 'Brand#52', 'Brand#21'])) | (part['RETAILPRICE'] >= 1062.1094710324835)].merge(partsupp[(partsupp['SUPPLYCOST'] != 446.16699343235916) | (partsupp['AVAILQTY'] < 2029)][['P_COMMENT', 'SUPPLYCOST', 'PS_PARTKEY']].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(supplier[['S_SUPPKEY', 'S_COMMENT']].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['P_COMMENT', 'SUPPLYCOST']).agg('mean', numeric_only=True)

nation[(nation['N_COMMENT'].str.startswith('y')) | (nation['N_NAME'] == 'B') | (nation['N_NATIONKEY'] >= 8)].merge(customer[(customer['MKTSEGMENT'].isin(['AUTOMOBILE'])) & (customer['C_PHONE'] != '2')][['MKTSEGMENT']].merge(orders.merge(lineitem[(lineitem['SHIPDATE'] != '1998-10-30')], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_ORDERKEY').merge(partsupp, left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

lineitem[(lineitem['LINESTATUS'] == 'F')].merge(partsupp.merge(lineitem[['RETURNFLAG']].merge(customer[['MKTSEGMENT', 'C_NATIONKEY', 'C_ADDRESS', 'C_NAME']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(orders[['TOTALPRICE', 'O_COMMENT', 'CLERK', 'ORDERDATE']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['SUPPLYCOST'] < 804.2477555974771) | (partsupp['SUPPLYCOST'] < 982.9692613409663)][['PS_PARTKEY', 'AVAILQTY', 'SUPPLYCOST', 'P_COMMENT']].merge(lineitem[['COMMITDATE', 'RETURNFLAG', 'L_COMMENT']].merge(part[['P_PARTKEY', 'TYPE', 'CONTAINER']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY')

supplier[['S_PHONE', 'S_COMMENT']]

supplier[(supplier['S_PHONE'].str.startswith('14-')) | (supplier['S_SUPPKEY'] < 90) & (supplier['S_NAME'] == 'S')].merge(partsupp[(partsupp['PS_PARTKEY'] != 1) & (partsupp['AVAILQTY'] < 8131)].merge(lineitem.merge(orders[(orders['CLERK'] != 'C')][['TOTALPRICE', 'O_CUSTKEY', 'ORDERSTATUS']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[(part['BRAND'] == 'Brand#33') & (part['CONTAINER'].str.startswith('LG'))][['MFGR', 'CONTAINER']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_PHONE', 'S_ACCTBAL']).agg('max', numeric_only=True)

lineitem[(lineitem['SHIPMODE'].isin(['AIR', 'REG AIR', 'TRUCK'])) | (lineitem['L_PARTKEY'] != 170349) & (lineitem['SHIPINSTRUCT'].isin(['NONE', 'TAKE BACK RETURN', 'DELIVER IN PERSON'])) | (lineitem['L_PARTKEY'] > 10151)][['L_COMMENT', 'SHIPINSTRUCT', 'LINENUMBER', 'L_ORDERKEY', 'DISCOUNT']].groupby(by=['SHIPINSTRUCT']).agg('max', numeric_only=True)

orders[(orders['ORDERDATE'] == '1998-07-21')][['SHIPPRIORITY', 'ORDERPRIORITY', 'TOTALPRICE', 'CLERK']].merge(customer[(customer['C_COMMENT'] != 'p')].merge(orders.merge(lineitem[(lineitem['L_COMMENT'] == ' ca')], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders.merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_ORDERKEY', right_on='C_CUSTKEY')

supplier[(supplier['S_NATIONKEY'] <= 5) | (supplier['S_ADDRESS'].str.startswith('h'))][['S_COMMENT', 'S_ACCTBAL', 'S_ADDRESS', 'S_PHONE', 'S_NAME']].merge(part[(part['P_NAME'] == 's') | (part['CONTAINER'].str.startswith('WRAP'))].merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['AVAILQTY'] >= 4613) | (partsupp['SUPPLYCOST'] < 213.85277753000716)], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='S_SUPPKEY', right_on='P_PARTKEY').merge(customer.merge(nation[['N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY']].merge(region[(region['R_REGIONKEY'] != 2)], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[['O_COMMENT', 'ORDERSTATUS', 'TOTALPRICE', 'ORDERDATE']].merge(supplier[['S_ADDRESS']], left_on='O_ORDERKEY', right_on='S_SUPPKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='S_SUPPKEY', right_on='C_CUSTKEY').groupby(by=['S_ACCTBAL', 'S_NAME']).agg('sum', numeric_only=True)

part[(part['SIZE'] >= 22)].merge(partsupp.merge(part[(part['CONTAINER'] == 'MED')][['CONTAINER']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['SUPPLYCOST'] < 267.6266188820347)], left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['P_PARTKEY', 'TYPE']).agg('min', numeric_only=True)

nation[(nation['N_NAME'] == 'M')][['N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']].merge(supplier[(supplier['S_NATIONKEY'] == 18)][['S_NAME']], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region.merge(nation[(nation['N_COMMENT'] != 'r')][['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY']].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] == 'F') & (nation['N_REGIONKEY'] >= 3)][['N_NATIONKEY', 'N_REGIONKEY']].merge(customer[(customer['C_NATIONKEY'] < 6)][['C_ACCTBAL', 'C_PHONE']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY')

lineitem[(lineitem['L_SUPPKEY'] > 5164) & (lineitem['SHIPINSTRUCT'].isin(['COLLECT COD', 'NONE', 'DELIVER IN PERSON'])) & (lineitem['L_COMMENT'].str.startswith('v'))].merge(partsupp[['PS_PARTKEY', 'PS_SUPPKEY', 'P_COMMENT']].merge(part[['SIZE', 'MFGR', 'BRAND', 'RETAILPRICE']].merge(partsupp[(partsupp['AVAILQTY'] < 8483)][['SUPPLYCOST', 'P_COMMENT']], left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'] == 'e')][['PS_PARTKEY', 'AVAILQTY']], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(orders[['O_ORDERKEY', 'TOTALPRICE', 'ORDERPRIORITY', 'O_COMMENT']].merge(lineitem[['LINESTATUS']].merge(partsupp[(partsupp['P_COMMENT'] != 'u')][['P_COMMENT', 'PS_PARTKEY', 'SUPPLYCOST']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY')

partsupp[['PS_PARTKEY', 'P_COMMENT']].merge(part[(part['RETAILPRICE'] < 962.7375655235213)][['PT_COMMENT']], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['L_PARTKEY'] < 189873) | (lineitem['EXTENDEDPRICE'] == 6340.514134592631)][['QUANTITY', 'LINENUMBER']], left_on='PS_PARTKEY', right_on='L_PARTKEY')

customer.merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['ORDERSTATUS'].isin(['F', 'O', 'P'])) & (orders['ORDERPRIORITY'] != '2-HIGH')].merge(customer.merge(nation[(nation['N_REGIONKEY'] >= 3) & (nation['N_COMMENT'].str.startswith('l'))][['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT', 'N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation.merge(customer[(customer['MKTSEGMENT'] == 'BUILDING')][['C_COMMENT', 'C_NAME', 'C_NATIONKEY']].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[(customer['C_PHONE'].str.startswith('25-'))].merge(orders[(orders['ORDERDATE'] == '1992-01-13')], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

partsupp[(partsupp['AVAILQTY'] <= 3968)].merge(lineitem.merge(orders[(orders['TOTALPRICE'] < 319611.4772431614) | (orders['CLERK'] == 'C')][['O_CUSTKEY', 'O_ORDERKEY', 'TOTALPRICE']].merge(customer[['C_ACCTBAL', 'C_ADDRESS']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').groupby(by=['P_COMMENT']).agg('mean', numeric_only=True)

supplier[(supplier['S_ACCTBAL'] == 2350.3998614882867) | (supplier['S_SUPPKEY'] <= 92)].merge(nation[(nation['N_COMMENT'] == 't') & (nation['N_COMMENT'] == 's')][['N_COMMENT']].merge(orders.merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='N_NATIONKEY', right_on='O_ORDERKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['AVAILQTY'] < 4666) | (partsupp['AVAILQTY'] == 3775)].merge(part[(part['SIZE'] >= 13) | (part['PT_COMMENT'] == 'y')][['MFGR', 'RETAILPRICE']], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[['L_SUPPKEY', 'SHIPMODE', 'LINESTATUS']].merge(partsupp[(partsupp['PS_PARTKEY'] <= 21)][['PS_PARTKEY', 'SUPPLYCOST', 'AVAILQTY', 'PS_SUPPKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

lineitem[(lineitem['SHIPINSTRUCT'] == 'NONE') & (lineitem['TAX'] > 0.025389742554321134) & (lineitem['DISCOUNT'] > 0.01806468652914812) & (lineitem['L_PARTKEY'] > 143006)][['LINENUMBER', 'L_ORDERKEY', 'RECEIPTDATE', 'L_COMMENT', 'L_PARTKEY']].merge(partsupp[(partsupp['PS_SUPPKEY'] <= 2809)][['PS_SUPPKEY', 'PS_PARTKEY']].merge(part[['P_NAME', 'PT_COMMENT', 'SIZE', 'P_PARTKEY']].merge(partsupp[(partsupp['PS_PARTKEY'] > 5)], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(supplier[['S_ACCTBAL', 'S_NATIONKEY', 'S_SUPPKEY', 'S_PHONE']].merge(nation[(nation['N_COMMENT'] != 'i') | (nation['N_NAME'] == 'K')][['N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_SUPPKEY', 'AVAILQTY', 'PS_PARTKEY']].merge(lineitem.merge(partsupp[(partsupp['PS_SUPPKEY'] > 2537)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[['SHIPDATE']].merge(supplier, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY')

partsupp[(partsupp['AVAILQTY'] < 8471) | (partsupp['P_COMMENT'].str.startswith('f')) & (partsupp['PS_SUPPKEY'] < 4974)][['PS_SUPPKEY']].merge(lineitem[(lineitem['RETURNFLAG'] == 'N')], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').groupby(by=['PS_SUPPKEY']).agg('count')

orders[(orders['O_ORDERKEY'] < 315) | (orders['TOTALPRICE'] < 306562.05341795593) & (orders['TOTALPRICE'] != 332209.33775118284)].merge(lineitem[(lineitem['TAX'] != 0.014057408916445144)][['COMMITDATE']].merge(orders[(orders['O_ORDERKEY'] >= 768)][['O_CUSTKEY', 'CLERK', 'O_COMMENT']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY').merge(orders[['O_ORDERKEY', 'ORDERPRIORITY', 'ORDERSTATUS']].merge(lineitem[(lineitem['LINESTATUS'] == 'F') & (lineitem['EXTENDEDPRICE'] >= 86607.6569120333)], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY')

part[['P_NAME', 'BRAND', 'TYPE', 'RETAILPRICE', 'MFGR']]

lineitem[(lineitem['L_PARTKEY'] < 91868) & (lineitem['SHIPDATE'] != '1998-10-30')][['RECEIPTDATE', 'TAX', 'L_ORDERKEY']].merge(orders[['SHIPPRIORITY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['O_COMMENT'].str.startswith('w')) & (orders['ORDERPRIORITY'] != '2-HIGH')], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['O_COMMENT'] == 'ly ')].merge(customer.merge(orders[(orders['TOTALPRICE'] > 215591.7622930093) | (orders['O_CUSTKEY'] == 142002)], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem.merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY')

partsupp.merge(supplier[(supplier['S_NAME'].str.startswith('S'))][['S_SUPPKEY', 'S_ACCTBAL']].merge(partsupp[(partsupp['SUPPLYCOST'] < 551.9836464274679) & (partsupp['AVAILQTY'] > 3195)].merge(lineitem[(lineitem['LINESTATUS'] != 'O') | (lineitem['RETURNFLAG'] != 'A')], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['PS_PARTKEY', 'SUPPLYCOST']).agg('sum', numeric_only=True)

lineitem[(lineitem['EXTENDEDPRICE'] <= 78137.0802256818) & (lineitem['QUANTITY'] < 48) & (lineitem['L_PARTKEY'] == 125409) | (lineitem['L_PARTKEY'] < 24284)][['L_ORDERKEY', 'SHIPDATE', 'L_SUPPKEY']].merge(orders.merge(customer[(customer['C_NAME'] == 'C')][['C_PHONE']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').groupby(by=['L_SUPPKEY']).agg('sum', numeric_only=True)

customer[['MKTSEGMENT', 'C_PHONE', 'C_CUSTKEY']].merge(orders[(orders['CLERK'] != 'C') | (orders['O_CUSTKEY'] == 29961)], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['SHIPPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['O_COMMENT'].str.startswith('y')) | (orders['ORDERSTATUS'].isin(['P', 'F', 'O']))].merge(lineitem[['TAX', 'L_SUPPKEY', 'RECEIPTDATE', 'SHIPMODE']].merge(partsupp[['AVAILQTY', 'P_COMMENT']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_CUSTKEY']).agg('sum', numeric_only=True)

region[(region['R_REGIONKEY'] >= 0)]

nation[(nation['N_NAME'].str.startswith('C')) | (nation['N_REGIONKEY'] > 1)][['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT', 'N_NAME']].merge(region[['R_COMMENT', 'R_REGIONKEY']].merge(nation[(nation['N_NATIONKEY'] > 17)].merge(customer[(customer['C_COMMENT'].str.startswith('c'))][['C_ACCTBAL', 'C_PHONE', 'C_ADDRESS']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY')

region[(region['R_COMMENT'] == 'h') & (region['R_COMMENT'] != 'l') | (region['R_COMMENT'].str.startswith('l')) & (region['R_REGIONKEY'] != 2)].merge(nation[['N_REGIONKEY', 'N_NAME', 'N_COMMENT', 'N_NATIONKEY']].merge(region[['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[['C_NATIONKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(supplier[['S_NAME', 'S_COMMENT', 'S_PHONE', 'S_SUPPKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

region[(region['R_NAME'].str.startswith('AFR'))][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_NAME'] != 'G')][['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] != 'h')], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] == 'r')][['N_NATIONKEY', 'N_NAME', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

lineitem.merge(orders[['CLERK', 'O_ORDERKEY']].merge(lineitem[(lineitem['L_PARTKEY'] != 88887) & (lineitem['RECEIPTDATE'] < '1992-05-02')][['QUANTITY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp.merge(lineitem[['L_ORDERKEY', 'L_PARTKEY', 'TAX']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier[(supplier['S_NATIONKEY'] < 4) & (supplier['S_ADDRESS'].str.startswith('7'))][['S_NAME']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] > 1956) | (partsupp['P_COMMENT'] == 'the')][['SUPPLYCOST', 'P_COMMENT']].merge(lineitem[(lineitem['L_COMMENT'].str.startswith('d')) | (lineitem['RECEIPTDATE'] < '1998-11-06')][['L_ORDERKEY', 'COMMITDATE', 'SHIPINSTRUCT', 'L_PARTKEY']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(customer.merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='C_CUSTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY')

lineitem.merge(orders.merge(lineitem.merge(orders[(orders['CLERK'] != 'C')][['TOTALPRICE']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_PHONE'] == '1')].merge(nation[['N_COMMENT', 'N_NAME', 'N_REGIONKEY', 'N_NATIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['AVAILQTY'] <= 7426) & (partsupp['PS_PARTKEY'] > 10)], left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['RECEIPTDATE', 'SHIPINSTRUCT']).agg('count')

region.merge(nation[['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] == 2) & (nation['N_REGIONKEY'] >= 3)][['N_COMMENT']].merge(region[['R_COMMENT', 'R_NAME']], left_on='N_NATIONKEY', right_on='R_REGIONKEY').merge(supplier[(supplier['S_NAME'] != 'S')].merge(partsupp[(partsupp['PS_PARTKEY'] < 33)][['PS_SUPPKEY', 'PS_PARTKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_SUPPKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_COMMENT', 'N_NATIONKEY']].merge(customer[['C_NAME', 'C_PHONE']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

customer.groupby(by=['MKTSEGMENT', 'C_CUSTKEY']).agg('max', numeric_only=True)

region.merge(nation[(nation['N_NATIONKEY'] >= 2)].merge(customer[(customer['MKTSEGMENT'] != 'MACHINERY') & (customer['C_ACCTBAL'] < 6122.5231287068345)].merge(nation[(nation['N_NAME'] == 'B')], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] >= 15) & (nation['N_NATIONKEY'] != 14)].merge(region[['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation[(nation['N_REGIONKEY'] < 1) | (nation['N_COMMENT'].str.startswith('c'))], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[(customer['C_NAME'] == 'C')], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] == 'S') | (nation['N_NATIONKEY'] <= 19)][['N_COMMENT']].merge(supplier[['S_SUPPKEY', 'S_PHONE']].merge(partsupp[(partsupp['P_COMMENT'] == 'the') & (partsupp['PS_SUPPKEY'] >= 1373)][['SUPPLYCOST', 'P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_SUPPKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

lineitem[(lineitem['LINESTATUS'] == 'F') & (lineitem['EXTENDEDPRICE'] >= 49212.128162284826) | (lineitem['TAX'] < 0.03260383530617156) & (lineitem['L_PARTKEY'] <= 168957)][['L_COMMENT', 'EXTENDEDPRICE']]

supplier[['S_COMMENT', 'S_NATIONKEY']]

lineitem[(lineitem['L_ORDERKEY'] == 166)][['L_ORDERKEY', 'COMMITDATE']].merge(orders.merge(customer[(customer['MKTSEGMENT'] != 'FURNITURE') & (customer['C_PHONE'] != '18-')][['C_PHONE', 'C_COMMENT', 'C_CUSTKEY']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['O_CUSTKEY'] == 2803) | (orders['O_COMMENT'] != 'l')][['CLERK', 'ORDERPRIORITY', 'O_CUSTKEY', 'ORDERSTATUS']].merge(customer[(customer['C_PHONE'] == '2') & (customer['C_NAME'].str.startswith('C'))][['C_NATIONKEY', 'C_PHONE', 'C_ADDRESS']], left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[['C_COMMENT', 'C_NATIONKEY', 'C_CUSTKEY', 'C_NAME']].merge(nation[['N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['TOTALPRICE'] != 301836.3861458221)], left_on='L_ORDERKEY', right_on='O_ORDERKEY')

lineitem[(lineitem['TAX'] < 0.07468988504468686) & (lineitem['SHIPMODE'] == 'TRUCK')][['LINENUMBER', 'QUANTITY', 'LINESTATUS', 'SHIPINSTRUCT', 'TAX']].merge(supplier[(supplier['S_NAME'] != 'S')][['S_SUPPKEY', 'S_NAME', 'S_COMMENT']].merge(partsupp[['PS_PARTKEY', 'P_COMMENT', 'SUPPLYCOST', 'PS_SUPPKEY']].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT']].merge(lineitem[(lineitem['L_ORDERKEY'] != 174)][['LINENUMBER', 'TAX', 'L_ORDERKEY']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY').merge(nation.merge(region.merge(nation[(nation['N_REGIONKEY'] <= 2) & (nation['N_REGIONKEY'] != 0)], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_REGIONKEY'] == 3) | (region['R_COMMENT'] != 'u')][['R_REGIONKEY', 'R_NAME']].merge(nation[(nation['N_REGIONKEY'] < 3)], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY')

region[(region['R_COMMENT'] != 'u') & (region['R_NAME'] != 'E') & (region['R_REGIONKEY'] >= 2) & (region['R_REGIONKEY'] > 2)].merge(nation[(nation['N_REGIONKEY'] != 2)][['N_NAME', 'N_NATIONKEY']].merge(supplier[['S_SUPPKEY', 'S_ACCTBAL', 'S_NAME', 'S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier.merge(nation[['N_REGIONKEY', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(customer.merge(nation[(nation['N_NAME'] == 'M')], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(customer[(customer['C_NATIONKEY'] == 19) & (customer['MKTSEGMENT'] != 'AUTOMOBILE')][['C_PHONE']].merge(part[(part['MFGR'] != 'Manufacturer#2') & (part['P_NAME'].str.startswith('l'))][['PT_COMMENT', 'MFGR', 'BRAND', 'RETAILPRICE']], left_on='C_CUSTKEY', right_on='P_PARTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

customer[(customer['C_NAME'] == 'C') & (customer['C_ADDRESS'] != '8') | (customer['C_ACCTBAL'] >= 489.07008901492736)].groupby(by=['MKTSEGMENT', 'C_CUSTKEY']).agg('sum', numeric_only=True)

orders[['ORDERPRIORITY', 'O_CUSTKEY', 'CLERK', 'SHIPPRIORITY', 'ORDERSTATUS']].merge(customer[(customer['C_ACCTBAL'] <= 7408.564462940289)].merge(orders[(orders['O_COMMENT'].str.startswith('r')) | (orders['ORDERPRIORITY'].isin(['1-URGENT', '2-HIGH']))], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer.merge(orders[['O_CUSTKEY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[['MKTSEGMENT', 'C_ACCTBAL', 'C_NAME', 'C_NATIONKEY']], left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['CLERK']).agg('sum', numeric_only=True)

customer[['C_COMMENT', 'C_PHONE', 'C_NATIONKEY']].groupby(by=['C_NATIONKEY']).agg('min', numeric_only=True)

region[(region['R_COMMENT'].str.startswith('g'))][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].merge(nation[(nation['N_NAME'].str.startswith('P'))], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

nation[(nation['N_NATIONKEY'] > 8) | (nation['N_REGIONKEY'] >= 3) | (nation['N_REGIONKEY'] == 0)].merge(supplier[(supplier['S_ADDRESS'].str.startswith('i')) | (supplier['S_ACCTBAL'] != -428.4059571498799)].merge(nation[['N_COMMENT', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[['R_NAME']].merge(lineitem[(lineitem['TAX'] != 0.058827698621365505)][['TAX', 'SHIPDATE', 'QUANTITY']].merge(partsupp[(partsupp['AVAILQTY'] <= 4978)][['PS_PARTKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='R_REGIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(nation[(nation['N_COMMENT'] != 'n')].merge(region[(region['R_NAME'].str.startswith('AME')) & (region['R_COMMENT'] != 'g')], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_NATIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_NATIONKEY']).agg('min', numeric_only=True)

nation[(nation['N_REGIONKEY'] >= 3) | (nation['N_NAME'] == 'P') & (nation['N_NATIONKEY'] >= 1) | (nation['N_NAME'].str.startswith('S'))][['N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']]

partsupp.merge(lineitem[(lineitem['SHIPINSTRUCT'].isin(['NONE', 'COLLECT COD']))].merge(partsupp[(partsupp['P_COMMENT'].str.startswith('e'))][['SUPPLYCOST']].merge(supplier, left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[['LINENUMBER', 'EXTENDEDPRICE', 'SHIPINSTRUCT']].merge(region[(region['R_NAME'] != 'ASI') & (region['R_REGIONKEY'] > 1)][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY')

supplier[(supplier['S_NATIONKEY'] < 20)][['S_SUPPKEY', 'S_PHONE', 'S_NATIONKEY', 'S_NAME']].merge(partsupp[(partsupp['AVAILQTY'] >= 9927) & (partsupp['SUPPLYCOST'] != 689.6708937032871)][['P_COMMENT', 'PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY']].merge(lineitem[(lineitem['L_COMMENT'] == 'l') | (lineitem['SHIPMODE'] == 'RAIL')][['L_COMMENT']].merge(customer, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_PHONE']).agg('min', numeric_only=True)

partsupp[['P_COMMENT', 'SUPPLYCOST', 'PS_PARTKEY', 'PS_SUPPKEY']].merge(supplier[(supplier['S_SUPPKEY'] != 116)][['S_NAME']].merge(region[(region['R_NAME'] != 'AFR') | (region['R_NAME'] != 'AFR')][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].merge(nation[['N_NATIONKEY', 'N_COMMENT', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='S_SUPPKEY', right_on='R_REGIONKEY').merge(lineitem.merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY')

region[(region['R_REGIONKEY'] != 0) | (region['R_NAME'].str.startswith('E')) & (region['R_REGIONKEY'] == 2)][['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].merge(nation[(nation['N_NAME'] != 'R')], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'].str.startswith('e'))].merge(region.merge(nation[['N_REGIONKEY', 'N_COMMENT', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY', 'R_COMMENT']).agg('sum', numeric_only=True)

region[['R_REGIONKEY', 'R_NAME', 'R_COMMENT']]

customer[['C_NATIONKEY']].merge(nation.merge(supplier[['S_ACCTBAL', 'S_NAME', 'S_COMMENT', 'S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[['R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_NATIONKEY']).agg('min', numeric_only=True)

partsupp[(partsupp['SUPPLYCOST'] > 561.0078086300801) | (partsupp['AVAILQTY'] >= 728) | (partsupp['P_COMMENT'] != 'g') & (partsupp['PS_SUPPKEY'] <= 5867)].merge(supplier[['S_PHONE', 'S_NATIONKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(part[(part['PT_COMMENT'].str.startswith('h'))], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem.merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').groupby(by=['PS_SUPPKEY', 'AVAILQTY']).agg('sum', numeric_only=True)

partsupp[(partsupp['PS_SUPPKEY'] > 1635) & (partsupp['P_COMMENT'].str.startswith('u')) | (partsupp['AVAILQTY'] > 5458) & (partsupp['SUPPLYCOST'] >= 547.2978833992869)][['P_COMMENT', 'SUPPLYCOST', 'PS_PARTKEY', 'PS_SUPPKEY', 'AVAILQTY']].merge(part.merge(partsupp[(partsupp['PS_SUPPKEY'] <= 287)][['PS_SUPPKEY', 'PS_PARTKEY', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['AVAILQTY', 'PS_PARTKEY']).agg('mean', numeric_only=True)

orders[['ORDERDATE', 'TOTALPRICE']].groupby(by=['TOTALPRICE', 'ORDERDATE']).agg('mean', numeric_only=True)

partsupp.merge(lineitem.merge(partsupp[(partsupp['PS_PARTKEY'] != 7)].merge(part[(part['P_NAME'].str.startswith('a')) & (part['CONTAINER'] != 'SM')][['P_NAME', 'TYPE', 'CONTAINER', 'P_PARTKEY']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp.merge(lineitem[['QUANTITY', 'RETURNFLAG']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem.merge(partsupp.merge(part[['BRAND']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY')

lineitem[(lineitem['L_COMMENT'] != 'lit')][['L_PARTKEY', 'COMMITDATE', 'LINENUMBER', 'SHIPDATE', 'LINESTATUS']].groupby(by=['COMMITDATE']).agg('max', numeric_only=True)

supplier[(supplier['S_SUPPKEY'] > 196) & (supplier['S_SUPPKEY'] > 117)].merge(nation[(nation['N_NATIONKEY'] < 19) & (nation['N_REGIONKEY'] < 2)], left_on='S_NATIONKEY', right_on='N_NATIONKEY')

nation[(nation['N_NATIONKEY'] != 9) & (nation['N_NAME'].str.startswith('I')) & (nation['N_NAME'] != 'V')].merge(region[(region['R_COMMENT'] != 'l')], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[(customer['C_COMMENT'].str.startswith('u')) & (customer['C_NAME'] != 'C')], left_on='N_NATIONKEY', right_on='C_NATIONKEY')

partsupp.merge(lineitem[['L_PARTKEY', 'DISCOUNT', 'TAX', 'LINENUMBER']].merge(partsupp[(partsupp['AVAILQTY'] == 6437) | (partsupp['P_COMMENT'] == 't')][['PS_SUPPKEY', 'SUPPLYCOST', 'PS_PARTKEY', 'P_COMMENT']].merge(lineitem[(lineitem['SHIPMODE'] != 'MAIL')], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier[(supplier['S_NATIONKEY'] <= 13) & (supplier['S_PHONE'] != '1')][['S_SUPPKEY', 'S_NAME', 'S_ACCTBAL', 'S_ADDRESS']].merge(partsupp[(partsupp['AVAILQTY'] < 306)].merge(lineitem[(lineitem['L_PARTKEY'] > 154871)], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem.merge(partsupp[['PS_SUPPKEY', 'PS_PARTKEY', 'SUPPLYCOST', 'P_COMMENT']].merge(lineitem[(lineitem['LINESTATUS'] != 'O') | (lineitem['L_COMMENT'] != 'o')], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').groupby(by=['PS_PARTKEY', 'P_COMMENT']).agg('count')

orders[['ORDERDATE', 'CLERK', 'O_COMMENT']].merge(customer.merge(nation[(nation['N_NATIONKEY'] <= 7) | (nation['N_NATIONKEY'] == 6)].merge(supplier[(supplier['S_PHONE'].str.startswith('3'))][['S_NATIONKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[(orders['O_ORDERKEY'] != 415)].merge(lineitem[(lineitem['DISCOUNT'] == 0.013687794076154936) | (lineitem['SHIPDATE'] == '1998-10-30')], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_ORDERKEY', right_on='C_CUSTKEY').merge(supplier.merge(nation[(nation['N_REGIONKEY'] != 2) | (nation['N_NATIONKEY'] == 17)][['N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_COMMENT'] == 'h')], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='S_SUPPKEY').merge(nation[(nation['N_NATIONKEY'] > 10)][['N_NAME', 'N_NATIONKEY', 'N_COMMENT']].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[(customer['C_CUSTKEY'] != 40)][['C_NATIONKEY', 'C_COMMENT', 'C_ADDRESS']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='O_ORDERKEY', right_on='N_NATIONKEY')

part[['PT_COMMENT', 'MFGR', 'P_PARTKEY']].merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_SUPPKEY', 'AVAILQTY']].merge(lineitem[['QUANTITY', 'L_PARTKEY']].merge(partsupp[(partsupp['SUPPLYCOST'] != 256.6161789480639)], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_PARTKEY', 'P_COMMENT', 'AVAILQTY', 'SUPPLYCOST']].merge(part[(part['SIZE'] < 38) | (part['RETAILPRICE'] > 916.7241907813041)][['PT_COMMENT', 'TYPE', 'P_PARTKEY']], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[['L_PARTKEY', 'LINENUMBER', 'RETURNFLAG', 'L_ORDERKEY']].merge(orders[(orders['ORDERSTATUS'].isin(['O', 'P', 'F']))], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

partsupp[(partsupp['PS_PARTKEY'] != 47) | (partsupp['PS_SUPPKEY'] == 4535) & (partsupp['AVAILQTY'] <= 5187) | (partsupp['PS_PARTKEY'] < 12)][['PS_PARTKEY', 'PS_SUPPKEY', 'SUPPLYCOST']].merge(part[(part['BRAND'].isin(['Brand#44', 'Brand#42', 'Brand#55', 'Brand#54', 'Brand#34', 'Brand#25', 'Brand#33', 'Brand#12', 'Brand#15', 'Brand#23'])) | (part['CONTAINER'] == 'MED')], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[['SHIPINSTRUCT', 'L_ORDERKEY', 'EXTENDEDPRICE']], left_on='PS_PARTKEY', right_on='L_PARTKEY')

nation[(nation['N_REGIONKEY'] != 1) | (nation['N_REGIONKEY'] <= 3)][['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME', 'N_COMMENT']]

partsupp.merge(part[(part['RETAILPRICE'] <= 914.0500158650442)].merge(partsupp[['P_COMMENT', 'PS_PARTKEY']].merge(part[['SIZE', 'P_PARTKEY']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['SUPPLYCOST'] > 27.90387788915713) | (partsupp['PS_SUPPKEY'] != 3412)][['P_COMMENT']].merge(customer[['C_NAME', 'C_PHONE', 'C_ADDRESS']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='C_CUSTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[(part['RETAILPRICE'] != 940.7821007052628) | (part['BRAND'] == 'Brand#32')], left_on='PS_PARTKEY', right_on='P_PARTKEY')

part[(part['SIZE'] > 5) & (part['P_PARTKEY'] <= 97) | (part['TYPE'].str.startswith('L')) & (part['TYPE'].str.startswith('S'))][['RETAILPRICE']].merge(region[(region['R_REGIONKEY'] >= 2)].merge(nation[(nation['N_NATIONKEY'] <= 12)][['N_NATIONKEY', 'N_COMMENT']].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NAME', 'N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='P_PARTKEY', right_on='R_REGIONKEY')

supplier[['S_NAME', 'S_PHONE', 'S_ACCTBAL']].merge(partsupp, left_on='S_SUPPKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(part[['RETAILPRICE']].merge(partsupp[(partsupp['P_COMMENT'] != 'j') | (partsupp['PS_SUPPKEY'] > 3403)].merge(lineitem[['L_PARTKEY', 'RECEIPTDATE', 'LINESTATUS', 'L_ORDERKEY']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='S_SUPPKEY', right_on='P_PARTKEY').merge(part[(part['BRAND'] != 'Brand#42')][['TYPE', 'MFGR', 'CONTAINER']].merge(nation[(nation['N_COMMENT'].str.startswith('c')) | (nation['N_NATIONKEY'] < 9)].merge(customer[['C_PHONE', 'C_NAME']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='P_PARTKEY', right_on='N_NATIONKEY'), left_on='S_SUPPKEY', right_on='P_PARTKEY')

partsupp[['SUPPLYCOST', 'AVAILQTY', 'PS_SUPPKEY', 'P_COMMENT', 'PS_PARTKEY']].merge(lineitem[(lineitem['EXTENDEDPRICE'] < 5382.337669993174)], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part.merge(partsupp[(partsupp['PS_SUPPKEY'] != 4049)].merge(supplier[(supplier['S_ADDRESS'] != 'R')][['S_SUPPKEY', 'S_NATIONKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY')

supplier.merge(partsupp.merge(lineitem.merge(partsupp[(partsupp['SUPPLYCOST'] <= 680.3299502004517) | (partsupp['PS_SUPPKEY'] < 482)], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[['P_PARTKEY']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['AVAILQTY', 'P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_NAME', 'S_NATIONKEY']).agg('mean', numeric_only=True)

part

partsupp.merge(supplier[['S_SUPPKEY', 'S_ACCTBAL', 'S_NAME', 'S_NATIONKEY']].merge(nation[(nation['N_COMMENT'].str.startswith('s')) & (nation['N_NAME'] != 'R')][['N_NAME', 'N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']].merge(customer[(customer['C_COMMENT'].str.startswith('y'))], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[['S_COMMENT']].merge(partsupp, left_on='S_SUPPKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(orders[(orders['O_CUSTKEY'] >= 59621) | (orders['ORDERSTATUS'] == 'P')], left_on='S_SUPPKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[(lineitem['L_SUPPKEY'] > 2405)][['COMMITDATE']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY')

supplier[(supplier['S_NATIONKEY'] == 19) | (supplier['S_SUPPKEY'] == 102)][['S_NATIONKEY', 'S_ACCTBAL']].merge(nation[(nation['N_REGIONKEY'] < 1)][['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_NATIONKEY', 'S_ACCTBAL']).agg('mean', numeric_only=True)

lineitem[(lineitem['SHIPDATE'] <= '1992-04-27') & (lineitem['DISCOUNT'] >= 0.08136297590978375)][['RETURNFLAG', 'L_ORDERKEY', 'L_COMMENT', 'RECEIPTDATE', 'QUANTITY']]

part[(part['RETAILPRICE'] <= 987.2080623489345) & (part['P_PARTKEY'] > 101) | (part['PT_COMMENT'].str.startswith('o'))][['SIZE', 'RETAILPRICE', 'P_PARTKEY']].groupby(by=['RETAILPRICE', 'SIZE']).agg('min', numeric_only=True)

lineitem[['L_PARTKEY', 'QUANTITY', 'L_COMMENT', 'L_ORDERKEY']].merge(orders[['ORDERPRIORITY', 'O_COMMENT', 'ORDERDATE', 'TOTALPRICE']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['ORDERPRIORITY'] == '4-NOT SPECIFIED')].merge(lineitem[(lineitem['L_ORDERKEY'] >= 67) | (lineitem['L_PARTKEY'] >= 13933)], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['SHIPINSTRUCT'].isin(['TAKE BACK RETURN'])) | (lineitem['L_COMMENT'].str.startswith('h'))][['RECEIPTDATE', 'L_ORDERKEY', 'SHIPDATE']].merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').groupby(by=['L_ORDERKEY', 'QUANTITY']).agg('sum', numeric_only=True)

lineitem[['SHIPMODE', 'LINENUMBER']].merge(supplier[(supplier['S_COMMENT'] == 'f')][['S_COMMENT', 'S_NAME', 'S_SUPPKEY', 'S_PHONE']].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY').groupby(by=['SHIPMODE', 'LINENUMBER']).agg('mean', numeric_only=True)

lineitem[['QUANTITY', 'SHIPMODE']].merge(region.merge(nation[(nation['N_NATIONKEY'] <= 2) | (nation['N_NATIONKEY'] >= 0)][['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY').merge(customer[['C_CUSTKEY', 'C_NAME', 'MKTSEGMENT', 'C_ACCTBAL']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY')

lineitem[['L_PARTKEY']].merge(partsupp.merge(supplier[(supplier['S_PHONE'].str.startswith('26-'))].merge(partsupp[['PS_PARTKEY', 'PS_SUPPKEY', 'SUPPLYCOST']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem.merge(partsupp[(partsupp['PS_SUPPKEY'] < 7389)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['SUPPLYCOST', 'AVAILQTY', 'PS_SUPPKEY', 'P_COMMENT']], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY')

orders[(orders['O_CUSTKEY'] > 30573)].merge(lineitem.merge(orders[(orders['O_ORDERKEY'] < 104) & (orders['O_COMMENT'] == 'n')], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer.merge(orders[(orders['SHIPPRIORITY'] > 0) & (orders['ORDERPRIORITY'] != '5-LOW')].merge(lineitem[(lineitem['EXTENDEDPRICE'] != 80454.70439666652)][['L_SUPPKEY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem.merge(partsupp[(partsupp['PS_SUPPKEY'] > 3706) & (partsupp['PS_PARTKEY'] >= 38)], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['TOTALPRICE']).agg('sum', numeric_only=True)

lineitem[['COMMITDATE']].merge(nation, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY').merge(partsupp[(partsupp['P_COMMENT'] != 'ly ') | (partsupp['SUPPLYCOST'] >= 916.8921506365531)].merge(supplier[(supplier['S_ACCTBAL'] >= 9050.62322518157) | (supplier['S_SUPPKEY'] >= 63)][['S_SUPPKEY']].merge(partsupp[['P_COMMENT', 'PS_PARTKEY', 'PS_SUPPKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[(supplier['S_PHONE'] != '17-') | (supplier['S_NAME'].str.startswith('S'))], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']).groupby(by=['COMMITDATE']).agg('min', numeric_only=True)

orders[(orders['TOTALPRICE'] <= 198676.09074429155) | (orders['ORDERPRIORITY'] == '2-HIGH') | (orders['ORDERDATE'] > '1998-07-21') & (orders['ORDERSTATUS'] == 'P')][['TOTALPRICE', 'ORDERPRIORITY', 'O_COMMENT', 'ORDERDATE', 'SHIPPRIORITY']].merge(partsupp[['PS_SUPPKEY']].merge(lineitem.merge(orders[['ORDERDATE', 'O_COMMENT']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['QUANTITY'] != 20)][['L_PARTKEY']].merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(region[(region['R_REGIONKEY'] > 1)].merge(nation[(nation['N_REGIONKEY'] < 3) | (nation['N_NAME'] != 'M')], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='O_ORDERKEY', right_on='R_REGIONKEY').groupby(by=['ORDERPRIORITY', 'ORDERDATE']).agg('count')

partsupp[(partsupp['AVAILQTY'] == 7047) | (partsupp['SUPPLYCOST'] < 200.73395641729195)].merge(supplier[['S_NAME', 'S_ADDRESS']].merge(partsupp[(partsupp['SUPPLYCOST'] != 442.81369729651726)][['AVAILQTY']], left_on='S_SUPPKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[(lineitem['L_COMMENT'].str.startswith(' ')) | (lineitem['RETURNFLAG'] == 'A')][['RECEIPTDATE', 'SHIPINSTRUCT']].merge(part[['PT_COMMENT']].merge(supplier[(supplier['S_ACCTBAL'] <= 3714.1708934843236)], left_on='P_PARTKEY', right_on='S_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier[(supplier['S_ACCTBAL'] > 3909.9789619992944) | (supplier['S_ADDRESS'] != 'd')].merge(partsupp[(partsupp['PS_PARTKEY'] > 34) & (partsupp['AVAILQTY'] > 4326)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_REGIONKEY'] > 2)], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY')

customer.groupby(by=['C_NATIONKEY', 'C_COMMENT']).agg('count')

orders.groupby(by=['SHIPPRIORITY', 'CLERK']).agg('max', numeric_only=True)

part.merge(partsupp[(partsupp['PS_SUPPKEY'] == 7271) & (partsupp['PS_SUPPKEY'] == 3726)], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['AVAILQTY'] <= 764) & (partsupp['P_COMMENT'].str.startswith(' th'))].merge(lineitem.merge(partsupp[['PS_PARTKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['RETAILPRICE']).agg('max', numeric_only=True)

part.merge(partsupp.merge(supplier[(supplier['S_SUPPKEY'] > 184)], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[(supplier['S_ACCTBAL'] != 3419.4022049599635) & (supplier['S_NAME'].str.startswith('S'))][['S_NAME', 'S_ADDRESS', 'S_COMMENT', 'S_SUPPKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

partsupp[(partsupp['SUPPLYCOST'] == 707.0683222840383) & (partsupp['SUPPLYCOST'] <= 347.4127832803608)][['PS_SUPPKEY', 'AVAILQTY', 'PS_PARTKEY']].merge(part[(part['MFGR'] == 'Manufacturer#4')].merge(partsupp[(partsupp['PS_PARTKEY'] > 30)][['PS_PARTKEY', 'PS_SUPPKEY', 'AVAILQTY']].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['P_COMMENT']].merge(nation, left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[(part['SIZE'] < 44)].merge(partsupp[(partsupp['SUPPLYCOST'] <= 90.15216826059904)][['PS_PARTKEY', 'AVAILQTY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['AVAILQTY', 'PS_PARTKEY']).agg('mean', numeric_only=True)

region[['R_COMMENT']].merge(customer[(customer['C_CUSTKEY'] == 81)].merge(nation[(nation['N_REGIONKEY'] >= 1) & (nation['N_REGIONKEY'] >= 1)], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='R_REGIONKEY', right_on='C_CUSTKEY').merge(supplier[(supplier['S_COMMENT'] == 'bli') | (supplier['S_COMMENT'].str.startswith('i'))].merge(nation[(nation['N_NATIONKEY'] != 3)][['N_REGIONKEY', 'N_NAME', 'N_COMMENT', 'N_NATIONKEY']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[['AVAILQTY', 'PS_SUPPKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='R_REGIONKEY', right_on='S_SUPPKEY').merge(supplier[(supplier['S_PHONE'].str.startswith('1')) & (supplier['S_SUPPKEY'] >= 107)].merge(nation[['N_NAME']].merge(region[(region['R_REGIONKEY'] >= 0) & (region['R_COMMENT'] != 'g')][['R_NAME']], left_on='N_NATIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] >= 5475)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='R_REGIONKEY', right_on='S_SUPPKEY')

region[(region['R_REGIONKEY'] == 0) | (region['R_COMMENT'].str.startswith('g')) & (region['R_COMMENT'] != 'g')][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_NAME'] == 'G') & (nation['N_REGIONKEY'] > 3)].merge(region[(region['R_NAME'].str.startswith('ASI')) | (region['R_COMMENT'] == 'u')], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_COMMENT'].str.startswith('l')) | (region['R_NAME'] == 'AME')].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'].str.startswith('o')) | (nation['N_COMMENT'].str.startswith('t'))], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

part[(part['SIZE'] >= 11) | (part['RETAILPRICE'] < 956.0611244877045) & (part['P_PARTKEY'] >= 94)].merge(partsupp[['PS_SUPPKEY', 'PS_PARTKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY')

part[(part['BRAND'].isin(['Brand#55', 'Brand#35', 'Brand#53', 'Brand#12', 'Brand#23', 'Brand#31', 'Brand#24', 'Brand#11', 'Brand#52', 'Brand#15', 'Brand#25', 'Brand#32', 'Brand#43', 'Brand#13', 'Brand#54', 'Brand#41'])) & (part['RETAILPRICE'] != 1092.3241388086076) & (part['CONTAINER'] != 'MED') & (part['SIZE'] == 23)][['PT_COMMENT', 'MFGR', 'TYPE']].groupby(by=['PT_COMMENT', 'MFGR']).agg('max', numeric_only=True)

nation[(nation['N_NATIONKEY'] <= 4) | (nation['N_NAME'].str.startswith('U')) & (nation['N_NAME'] == 'S') & (nation['N_REGIONKEY'] != 1)].groupby(by=['N_COMMENT']).agg('max', numeric_only=True)

lineitem[(lineitem['COMMITDATE'] < '1992-05-15') | (lineitem['SHIPDATE'] != '1998-10-30')]

part[(part['TYPE'].str.startswith('SMA'))].merge(partsupp[['PS_PARTKEY', 'AVAILQTY', 'SUPPLYCOST']].merge(lineitem[(lineitem['DISCOUNT'] < 0.07860848480466037)].merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['DISCOUNT'] == 0.04323447790671288)].merge(orders[(orders['ORDERSTATUS'] != 'P') & (orders['O_ORDERKEY'] <= 704)][['SHIPPRIORITY', 'ORDERSTATUS', 'ORDERDATE', 'CLERK']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

partsupp[(partsupp['PS_SUPPKEY'] >= 3751) & (partsupp['AVAILQTY'] <= 1625) | (partsupp['P_COMMENT'] == 'are') & (partsupp['P_COMMENT'].str.startswith('p'))][['AVAILQTY', 'SUPPLYCOST', 'PS_SUPPKEY', 'PS_PARTKEY', 'P_COMMENT']].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part.merge(partsupp[(partsupp['AVAILQTY'] == 528)].merge(supplier[(supplier['S_NAME'] == 'S') | (supplier['S_NATIONKEY'] <= 8)], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_SUPPKEY', 'PS_PARTKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['QUANTITY'] < 9) & (lineitem['QUANTITY'] < 7)][['RECEIPTDATE', 'L_SUPPKEY']].merge(partsupp[['SUPPLYCOST', 'PS_PARTKEY']].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['AVAILQTY'] <= 9097)][['PS_PARTKEY', 'PS_SUPPKEY']].merge(supplier[['S_ADDRESS', 'S_NATIONKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY')

customer[['C_NAME', 'C_PHONE', 'MKTSEGMENT']].merge(lineitem[(lineitem['LINESTATUS'] == 'O') & (lineitem['SHIPINSTRUCT'] == 'NONE')][['TAX', 'DISCOUNT', 'RETURNFLAG']].merge(customer, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY').merge(part.merge(partsupp[(partsupp['P_COMMENT'] == 'e')][['P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).groupby(by=['C_PHONE', 'C_NAME']).agg('count')

customer[(customer['MKTSEGMENT'].isin(['MACHINERY', 'HOUSEHOLD', 'FURNITURE'])) | (customer['C_ACCTBAL'] > 4387.891553178906) | (customer['C_ADDRESS'] != '6') | (customer['C_NATIONKEY'] == 14)][['C_COMMENT']].merge(partsupp[(partsupp['P_COMMENT'] == ',') & (partsupp['PS_PARTKEY'] >= 18)][['P_COMMENT']].merge(customer[['C_COMMENT', 'C_NATIONKEY']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='C_CUSTKEY').merge(supplier[['S_NATIONKEY', 'S_SUPPKEY', 'S_PHONE']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='S_SUPPKEY'), left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(region[(region['R_COMMENT'] == 'l') & (region['R_NAME'] == 'M')][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].merge(nation[(nation['N_COMMENT'] == 'n') & (nation['N_COMMENT'].str.startswith('v'))][['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='C_CUSTKEY', right_on='R_REGIONKEY')

nation.merge(customer[(customer['MKTSEGMENT'] != 'FURNITURE')].merge(nation[(nation['N_NATIONKEY'] != 21) & (nation['N_COMMENT'].str.startswith('e'))], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

part[['PT_COMMENT', 'P_NAME', 'SIZE']].merge(lineitem, left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'])

customer[(customer['C_ADDRESS'].str.startswith('P')) & (customer['C_NATIONKEY'] < 14) | (customer['C_ADDRESS'] == 'R')][['C_ACCTBAL', 'C_ADDRESS', 'C_COMMENT']].merge(region[(region['R_COMMENT'] != 'g')][['R_NAME']].merge(lineitem[['RETURNFLAG', 'EXTENDEDPRICE']].merge(customer[(customer['MKTSEGMENT'] != 'FURNITURE') | (customer['C_ADDRESS'] != '0')], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='R_REGIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='C_CUSTKEY', right_on='R_REGIONKEY').merge(orders[(orders['O_COMMENT'] != ' re')][['CLERK', 'ORDERSTATUS', 'TOTALPRICE']].merge(part[['RETAILPRICE', 'BRAND', 'P_PARTKEY']], left_on='O_ORDERKEY', right_on='P_PARTKEY'), left_on='C_CUSTKEY', right_on='O_ORDERKEY').merge(supplier[['S_ADDRESS', 'S_PHONE', 'S_COMMENT']].merge(orders[(orders['TOTALPRICE'] <= 274194.6793942019) & (orders['ORDERDATE'] >= '1992-01-13')][['CLERK', 'TOTALPRICE', 'O_COMMENT', 'O_ORDERKEY']].merge(lineitem[(lineitem['L_SUPPKEY'] > 8723)], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='S_SUPPKEY', right_on='O_ORDERKEY').merge(region[['R_NAME', 'R_REGIONKEY']], left_on='S_SUPPKEY', right_on='R_REGIONKEY'), left_on='C_CUSTKEY', right_on='S_SUPPKEY').groupby(by=['C_COMMENT', 'C_ACCTBAL']).agg('mean', numeric_only=True)

part.merge(partsupp.merge(supplier[(supplier['S_COMMENT'].str.startswith('c')) & (supplier['S_NATIONKEY'] >= 16)], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[(supplier['S_ADDRESS'].str.startswith('b'))][['S_NAME', 'S_SUPPKEY', 'S_ACCTBAL', 'S_NATIONKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['AVAILQTY'] > 8302)].merge(lineitem[(lineitem['LINESTATUS'] != 'O') | (lineitem['COMMITDATE'] != '1998-10-16')][['TAX', 'RECEIPTDATE', 'SHIPMODE']].merge(region[(region['R_NAME'].str.startswith('E'))][['R_REGIONKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

region[(region['R_NAME'] != 'AME') & (region['R_NAME'] != 'ASI') & (region['R_NAME'] != 'AFR')].merge(nation[(nation['N_NAME'] != 'G')].merge(region[(region['R_NAME'] == 'AFR')][['R_REGIONKEY', 'R_COMMENT', 'R_NAME']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer.merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_REGIONKEY', 'N_NAME']].merge(region[['R_REGIONKEY', 'R_COMMENT', 'R_NAME']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation[(nation['N_REGIONKEY'] == 0) & (nation['N_NATIONKEY'] == 9)], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

partsupp.merge(lineitem[['DISCOUNT', 'SHIPINSTRUCT', 'L_PARTKEY']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier[['S_NAME', 'S_COMMENT', 'S_ACCTBAL', 'S_ADDRESS']].merge(nation[(nation['N_NATIONKEY'] <= 4)].merge(supplier[(supplier['S_NATIONKEY'] > 17) & (supplier['S_SUPPKEY'] < 161)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_SUPPKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['P_COMMENT']).agg('count')

part[(part['P_PARTKEY'] == 145) | (part['CONTAINER'] != 'WRAP')].merge(partsupp[(partsupp['PS_PARTKEY'] > 48) & (partsupp['SUPPLYCOST'] < 631.5433594728871)][['SUPPLYCOST']].merge(orders[(orders['ORDERDATE'] >= '1998-07-21')][['O_ORDERKEY', 'O_CUSTKEY']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='O_ORDERKEY').merge(lineitem[(lineitem['COMMITDATE'] != '1998-10-16') & (lineitem['LINESTATUS'] == 'F')].merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='P_PARTKEY', right_on='PS_PARTKEY')

supplier.merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_COMMENT']).agg('max', numeric_only=True)

lineitem[(lineitem['L_COMMENT'].str.startswith(',')) | (lineitem['SHIPINSTRUCT'] != 'TAKE BACK RETURN') & (lineitem['L_COMMENT'] != 'f')].merge(orders[(orders['O_CUSTKEY'] >= 89358)][['ORDERSTATUS']].merge(lineitem[(lineitem['EXTENDEDPRICE'] >= 19575.11590672074) | (lineitem['LINESTATUS'] == 'F')][['L_PARTKEY', 'QUANTITY', 'SHIPINSTRUCT']].merge(partsupp[['P_COMMENT']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['AVAILQTY'] >= 81) | (partsupp['PS_SUPPKEY'] <= 5484)].merge(supplier.merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['DISCOUNT']).agg('sum', numeric_only=True)

lineitem[(lineitem['TAX'] < 0.031826980493948075) | (lineitem['COMMITDATE'] == '1998-10-16')][['SHIPMODE', 'L_ORDERKEY', 'L_SUPPKEY']].merge(orders[(orders['O_ORDERKEY'] == 786)][['CLERK', 'ORDERSTATUS']].merge(supplier.merge(nation[['N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='S_SUPPKEY').merge(region[['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].merge(nation[['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='O_ORDERKEY', right_on='R_REGIONKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders.merge(lineitem[['SHIPMODE', 'SHIPINSTRUCT']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[['C_ADDRESS']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').groupby(by=['L_SUPPKEY', 'SHIPMODE']).agg('count')

nation[(nation['N_REGIONKEY'] >= 0) & (nation['N_NAME'] == 'P') | (nation['N_NATIONKEY'] != 19)][['N_NATIONKEY', 'N_COMMENT', 'N_NAME']]

orders[(orders['O_COMMENT'] == 'h') | (orders['TOTALPRICE'] < 283846.46131108573)][['O_ORDERKEY', 'CLERK', 'SHIPPRIORITY', 'O_CUSTKEY']]

supplier[(supplier['S_COMMENT'].str.startswith('j')) | (supplier['S_ACCTBAL'] >= 1420.2053237164407)].groupby(by=['S_ACCTBAL', 'S_COMMENT']).agg('min', numeric_only=True)

customer[['C_NAME', 'MKTSEGMENT', 'C_ACCTBAL']].merge(lineitem[(lineitem['SHIPDATE'] >= '1998-10-30') | (lineitem['L_SUPPKEY'] != 6429)].merge(partsupp[(partsupp['AVAILQTY'] >= 592) | (partsupp['PS_SUPPKEY'] != 1562)][['SUPPLYCOST', 'AVAILQTY']].merge(supplier[['S_SUPPKEY', 'S_PHONE', 'S_ADDRESS', 'S_ACCTBAL']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['SUPPLYCOST', 'P_COMMENT', 'PS_PARTKEY', 'AVAILQTY']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(supplier[(supplier['S_PHONE'] == '32-')].merge(partsupp[(partsupp['P_COMMENT'].str.startswith('b'))][['PS_SUPPKEY', 'AVAILQTY', 'SUPPLYCOST']].merge(supplier[(supplier['S_ACCTBAL'] != 2464.9017462852926)], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='C_CUSTKEY', right_on='S_SUPPKEY').merge(orders[['ORDERSTATUS', 'O_CUSTKEY', 'TOTALPRICE', 'SHIPPRIORITY']].merge(customer.merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[['C_CUSTKEY', 'MKTSEGMENT', 'C_ADDRESS', 'C_NATIONKEY']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_ORDERKEY')

customer[(customer['C_NATIONKEY'] != 3) | (customer['C_COMMENT'].str.startswith('y')) | (customer['C_ACCTBAL'] >= 5108.840967938957)].merge(orders[['ORDERDATE', 'O_CUSTKEY', 'ORDERPRIORITY', 'O_ORDERKEY']].merge(lineitem[(lineitem['RETURNFLAG'] == 'A') | (lineitem['RECEIPTDATE'] <= '1992-05-02')], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_NATIONKEY'] >= 4) & (nation['N_NATIONKEY'] > 14)][['N_NAME', 'N_COMMENT']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders.merge(lineitem[(lineitem['SHIPINSTRUCT'] != 'DELIVER IN PERSON')].merge(partsupp[['SUPPLYCOST', 'AVAILQTY', 'PS_PARTKEY', 'PS_SUPPKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_NATIONKEY']).agg('max', numeric_only=True)

part[['BRAND', 'P_PARTKEY', 'RETAILPRICE', 'MFGR']].merge(partsupp[['PS_PARTKEY', 'SUPPLYCOST']].merge(part[(part['SIZE'] >= 12) & (part['P_PARTKEY'] < 142)][['CONTAINER']].merge(region[(region['R_COMMENT'].str.startswith('u'))][['R_NAME', 'R_COMMENT', 'R_REGIONKEY']], left_on='P_PARTKEY', right_on='R_REGIONKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['L_COMMENT'].str.startswith('f')) & (lineitem['SHIPINSTRUCT'] == 'NONE')].merge(partsupp[['PS_SUPPKEY', 'PS_PARTKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['AVAILQTY', 'PS_SUPPKEY', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY')

part[(part['P_NAME'] == 'l')][['MFGR', 'P_PARTKEY', 'PT_COMMENT', 'CONTAINER']].groupby(by=['MFGR', 'P_PARTKEY']).agg('sum', numeric_only=True)

supplier[(supplier['S_COMMENT'].str.startswith(',')) & (supplier['S_ACCTBAL'] >= 8210.749620192246)].merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_NATIONKEY']).agg('count')

customer[(customer['C_ADDRESS'] == ',') | (customer['MKTSEGMENT'].isin(['HOUSEHOLD', 'MACHINERY', 'AUTOMOBILE', 'FURNITURE', 'BUILDING'])) | (customer['C_NATIONKEY'] > 18)][['C_CUSTKEY', 'C_PHONE', 'C_ACCTBAL', 'C_NATIONKEY', 'C_COMMENT']].merge(nation[(nation['N_NAME'].str.startswith('P')) | (nation['N_NAME'] == 'E')][['N_COMMENT', 'N_NATIONKEY', 'N_NAME']].merge(supplier[(supplier['S_PHONE'].str.startswith('1')) | (supplier['S_NATIONKEY'] >= 4)][['S_SUPPKEY', 'S_COMMENT', 'S_NATIONKEY', 'S_PHONE']].merge(nation[(nation['N_REGIONKEY'] >= 1)][['N_REGIONKEY', 'N_NAME', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_NAME', 'N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NAME'].str.startswith('F')) | (nation['N_REGIONKEY'] > 2)][['N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY')

region[(region['R_REGIONKEY'] != 2) | (region['R_COMMENT'] != 'l')][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY')

region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation[['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']].merge(region.merge(nation[(nation['N_NATIONKEY'] < 16) | (nation['N_COMMENT'] != 's')], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] != 1) & (nation['N_NATIONKEY'] >= 6)].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] >= 7)], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('max', numeric_only=True)

partsupp[(partsupp['P_COMMENT'].str.startswith('c')) | (partsupp['PS_SUPPKEY'] <= 7367)]

supplier[(supplier['S_SUPPKEY'] >= 125) & (supplier['S_NATIONKEY'] != 14) | (supplier['S_ACCTBAL'] <= 8797.393306654352) | (supplier['S_PHONE'].str.startswith('32-'))][['S_SUPPKEY']].merge(partsupp[['AVAILQTY', 'PS_SUPPKEY', 'SUPPLYCOST']].merge(lineitem[(lineitem['L_ORDERKEY'] <= 44) & (lineitem['SHIPINSTRUCT'].isin(['DELIVER IN PERSON', 'TAKE BACK RETURN', 'COLLECT COD', 'NONE']))][['SHIPMODE', 'QUANTITY']].merge(orders, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['PS_PARTKEY', 'P_COMMENT']].merge(part[['TYPE', 'PT_COMMENT', 'P_PARTKEY', 'CONTAINER']].merge(partsupp[(partsupp['P_COMMENT'].str.startswith('n')) & (partsupp['PS_PARTKEY'] <= 37)][['P_COMMENT', 'PS_PARTKEY', 'PS_SUPPKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_SUPPKEY']).agg('mean', numeric_only=True)

nation[['N_COMMENT', 'N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']].merge(customer.merge(orders[(orders['TOTALPRICE'] > 246535.24383135856) & (orders['SHIPPRIORITY'] >= 0)], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['ORDERPRIORITY'] == '1-URGENT')][['O_ORDERKEY']].merge(lineitem[['SHIPINSTRUCT', 'SHIPDATE', 'RETURNFLAG']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[['S_NATIONKEY', 'S_NAME']].merge(nation[(nation['N_NAME'].str.startswith('M'))][['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT', 'N_NAME']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[['R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_REGIONKEY']).agg('sum', numeric_only=True)

part[['BRAND', 'P_PARTKEY', 'CONTAINER', 'PT_COMMENT']]

part[(part['SIZE'] < 44) | (part['MFGR'] != 'Manufacturer#3') & (part['BRAND'] == 'Brand#51') | (part['PT_COMMENT'].str.startswith('h'))][['P_NAME', 'CONTAINER']].merge(supplier[(supplier['S_PHONE'].str.startswith('32-')) & (supplier['S_ACCTBAL'] <= 7295.198718791397)].merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_REGIONKEY'] >= 1) | (nation['N_COMMENT'] != 'r')][['N_COMMENT']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='P_PARTKEY', right_on='S_SUPPKEY')

supplier[(supplier['S_SUPPKEY'] == 179) | (supplier['S_PHONE'] != '28-') | (supplier['S_ADDRESS'].str.startswith('9')) & (supplier['S_NAME'] == 'S')][['S_NAME']].merge(partsupp[['P_COMMENT']].merge(supplier[(supplier['S_COMMENT'] != 'bli')][['S_ACCTBAL']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(region, left_on='S_SUPPKEY', right_on='R_REGIONKEY').merge(orders[['ORDERSTATUS', 'O_COMMENT']].merge(part[['SIZE', 'P_NAME']], left_on='O_ORDERKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='O_ORDERKEY').groupby(by=['S_NAME']).agg('sum', numeric_only=True)

orders[(orders['ORDERSTATUS'] == 'O') & (orders['SHIPPRIORITY'] != 0)].merge(lineitem[(lineitem['L_ORDERKEY'] > 126)].merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['ORDERDATE'] == '1998-07-21')][['CLERK', 'ORDERDATE']].merge(nation[(nation['N_REGIONKEY'] > 2) | (nation['N_COMMENT'] == 'y')][['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']], left_on='O_ORDERKEY', right_on='N_NATIONKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_CUSTKEY'] != 45) | (customer['C_NATIONKEY'] != 12)][['C_CUSTKEY', 'C_ADDRESS', 'MKTSEGMENT', 'C_NATIONKEY']].merge(orders[(orders['O_COMMENT'] != ' ') & (orders['CLERK'] == 'C')].merge(customer[(customer['C_COMMENT'].str.startswith('e'))][['C_NAME', 'C_NATIONKEY', 'C_ADDRESS', 'C_CUSTKEY']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['TOTALPRICE', 'CLERK', 'O_CUSTKEY']].merge(customer[(customer['MKTSEGMENT'].isin(['HOUSEHOLD', 'BUILDING'])) & (customer['C_NAME'].str.startswith('C'))], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_ADDRESS'] != 'o') | (customer['C_ACCTBAL'] != 6285.631161752183)][['C_ACCTBAL', 'C_NATIONKEY', 'C_PHONE']], left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['ORDERPRIORITY']).agg('min', numeric_only=True)

part[(part['SIZE'] == 15)][['MFGR', 'BRAND']].merge(nation.merge(supplier[(supplier['S_SUPPKEY'] != 196) | (supplier['S_NAME'].str.startswith('S'))], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[['MKTSEGMENT', 'C_COMMENT', 'C_ACCTBAL', 'C_NATIONKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='P_PARTKEY', right_on='N_NATIONKEY').merge(customer.merge(orders[(orders['O_ORDERKEY'] <= 490)], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['TOTALPRICE'] == 64605.432099574544) | (orders['TOTALPRICE'] < 92410.11386157466)].merge(lineitem[(lineitem['L_COMMENT'] != ' ')][['L_COMMENT', 'TAX']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='P_PARTKEY', right_on='C_CUSTKEY')

customer[(customer['C_NATIONKEY'] == 10)][['C_CUSTKEY', 'C_COMMENT', 'C_NAME']].merge(orders[['ORDERDATE', 'SHIPPRIORITY', 'CLERK', 'O_ORDERKEY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['SHIPPRIORITY'] >= 0) | (orders['CLERK'] != 'C')][['ORDERSTATUS', 'ORDERPRIORITY', 'O_COMMENT', 'ORDERDATE']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders.merge(customer[['C_PHONE', 'C_ADDRESS', 'MKTSEGMENT', 'C_COMMENT']], left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[(lineitem['RECEIPTDATE'] == '1998-11-06')].merge(partsupp[['AVAILQTY']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_COMMENT', 'C_CUSTKEY']).agg('max', numeric_only=True)

part[(part['P_NAME'] != 'blu') | (part['P_NAME'] == 'm')][['SIZE', 'TYPE', 'MFGR']]

region[['R_NAME', 'R_REGIONKEY']].merge(nation.merge(customer[['C_CUSTKEY', 'C_ACCTBAL']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'].str.startswith('c'))][['N_NAME', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

region[['R_COMMENT', 'R_NAME']].merge(supplier[(supplier['S_NAME'] != 'S')].merge(nation[(nation['N_COMMENT'] != 'o')][['N_NATIONKEY', 'N_NAME']].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='R_REGIONKEY', right_on='S_SUPPKEY').groupby(by=['R_NAME']).agg('mean', numeric_only=True)

part.merge(partsupp[['AVAILQTY', 'PS_SUPPKEY']].merge(supplier.merge(nation[['N_NAME']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'].str.startswith('l')) | (partsupp['SUPPLYCOST'] >= 968.9481089969354)][['PS_PARTKEY', 'PS_SUPPKEY']].merge(supplier[(supplier['S_SUPPKEY'] < 158) | (supplier['S_COMMENT'] == 'b')].merge(partsupp[(partsupp['AVAILQTY'] < 7771) | (partsupp['PS_SUPPKEY'] <= 3986)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

region[(region['R_COMMENT'] != 'g') | (region['R_REGIONKEY'] < 1) | (region['R_REGIONKEY'] < 0)].groupby(by=['R_REGIONKEY']).agg('sum', numeric_only=True)

region[(region['R_NAME'] == 'M') & (region['R_REGIONKEY'] == 1)][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_NATIONKEY'] == 0) | (nation['N_NAME'] == 'M')][['N_NATIONKEY', 'N_NAME', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] != 'n') | (nation['N_REGIONKEY'] == 3)].merge(region.merge(nation[['N_NAME', 'N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('mean', numeric_only=True)

lineitem[(lineitem['L_ORDERKEY'] >= 77) | (lineitem['RETURNFLAG'] == 'N')]

partsupp[['PS_SUPPKEY', 'P_COMMENT', 'AVAILQTY', 'PS_PARTKEY']].merge(supplier.merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY')

supplier[(supplier['S_NATIONKEY'] != 14) & (supplier['S_ADDRESS'].str.startswith('0'))][['S_COMMENT', 'S_ADDRESS', 'S_NATIONKEY', 'S_ACCTBAL', 'S_SUPPKEY']].merge(partsupp[(partsupp['P_COMMENT'].str.startswith('g'))], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_ADDRESS']).agg('mean', numeric_only=True)

nation[(nation['N_COMMENT'] == 't') | (nation['N_NAME'].str.startswith('K')) | (nation['N_REGIONKEY'] != 0)][['N_COMMENT', 'N_NAME']]

partsupp[(partsupp['P_COMMENT'].str.startswith('bli'))][['PS_PARTKEY', 'PS_SUPPKEY', 'AVAILQTY', 'P_COMMENT', 'SUPPLYCOST']]

supplier[(supplier['S_SUPPKEY'] >= 50)][['S_NATIONKEY', 'S_NAME', 'S_SUPPKEY', 'S_PHONE', 'S_ADDRESS']].groupby(by=['S_NATIONKEY', 'S_NAME']).agg('sum', numeric_only=True)

partsupp[['SUPPLYCOST']].merge(supplier.merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(region[(region['R_NAME'] != 'AME') & (region['R_REGIONKEY'] > 0)][['R_REGIONKEY', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='S_SUPPKEY')

supplier[['S_PHONE', 'S_SUPPKEY', 'S_ACCTBAL', 'S_ADDRESS', 'S_COMMENT']]

part[(part['CONTAINER'] == 'WRAP') & (part['RETAILPRICE'] >= 1028.3619273044292) | (part['SIZE'] != 36) & (part['TYPE'] != 'SMA')][['BRAND', 'RETAILPRICE', 'CONTAINER', 'TYPE']].groupby(by=['RETAILPRICE', 'CONTAINER']).agg('min', numeric_only=True)

orders

region[(region['R_NAME'].str.startswith('AFR')) & (region['R_REGIONKEY'] == 1) | (region['R_REGIONKEY'] > 3) & (region['R_REGIONKEY'] < 2)][['R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_NAME'] == 'A')].merge(customer[(customer['C_NAME'] != 'C')], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] == 1) & (nation['N_COMMENT'] == 'c')].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

lineitem[['SHIPMODE', 'L_SUPPKEY', 'EXTENDEDPRICE', 'RETURNFLAG']].merge(partsupp.merge(supplier[(supplier['S_NATIONKEY'] <= 13)].merge(partsupp[(partsupp['P_COMMENT'].str.startswith('h'))], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY')

region[(region['R_REGIONKEY'] == 3)][['R_REGIONKEY']].merge(nation[(nation['N_NAME'] != 'F') | (nation['N_COMMENT'] == 'o')][['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT', 'N_NAME']].merge(supplier[['S_ACCTBAL', 'S_ADDRESS']].merge(partsupp[['PS_PARTKEY', 'AVAILQTY', 'P_COMMENT']], left_on='S_SUPPKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[(customer['C_COMMENT'].str.startswith('h'))].merge(nation[(nation['N_COMMENT'] != 'h')], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('count')

lineitem[(lineitem['SHIPMODE'] == 'FOB')][['TAX', 'L_SUPPKEY']].groupby(by=['TAX']).agg('min', numeric_only=True)

customer[['MKTSEGMENT', 'C_NATIONKEY', 'C_PHONE', 'C_CUSTKEY']].groupby(by=['MKTSEGMENT', 'C_NATIONKEY']).agg('count')

customer[(customer['C_PHONE'].str.startswith('13-')) & (customer['C_COMMENT'] != ',')][['C_NATIONKEY', 'C_ACCTBAL', 'MKTSEGMENT']].groupby(by=['C_NATIONKEY']).agg('mean', numeric_only=True)

partsupp[(partsupp['PS_SUPPKEY'] < 2018) & (partsupp['AVAILQTY'] != 9216) | (partsupp['PS_SUPPKEY'] <= 1093) | (partsupp['PS_SUPPKEY'] > 2269)].merge(lineitem[['COMMITDATE', 'LINENUMBER', 'DISCOUNT', 'LINESTATUS']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[['P_NAME', 'MFGR', 'SIZE', 'CONTAINER']], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['LINENUMBER'] == 5) & (lineitem['RETURNFLAG'] == 'R')][['L_COMMENT', 'COMMITDATE', 'RECEIPTDATE', 'L_PARTKEY']].merge(partsupp[(partsupp['AVAILQTY'] > 1411) & (partsupp['AVAILQTY'] == 3648)][['PS_SUPPKEY', 'SUPPLYCOST']].merge(supplier[(supplier['S_NAME'].str.startswith('S')) | (supplier['S_NATIONKEY'] >= 18)], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY')

part.merge(partsupp[(partsupp['P_COMMENT'] == 'q')], left_on='P_PARTKEY', right_on='PS_PARTKEY')

nation[(nation['N_NAME'] != 'B')][['N_COMMENT', 'N_NAME', 'N_NATIONKEY']]

supplier[(supplier['S_ACCTBAL'] == 5559.435203185489) | (supplier['S_COMMENT'] == 'k') & (supplier['S_SUPPKEY'] != 172)][['S_SUPPKEY']].merge(partsupp[(partsupp['AVAILQTY'] <= 4806)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['SUPPLYCOST'] >= 645.8195645245629) | (partsupp['AVAILQTY'] >= 4832)][['P_COMMENT', 'PS_SUPPKEY', 'PS_PARTKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['AVAILQTY'] <= 5176)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

part[(part['RETAILPRICE'] > 1021.6412557429387)].groupby(by=['SIZE']).agg('min', numeric_only=True)

nation.merge(supplier[['S_COMMENT']].merge(partsupp[(partsupp['PS_PARTKEY'] <= 5) & (partsupp['SUPPLYCOST'] > 912.51224896128)][['PS_SUPPKEY', 'P_COMMENT', 'PS_PARTKEY']], left_on='S_SUPPKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[(supplier['S_ADDRESS'].str.startswith('i')) | (supplier['S_PHONE'] != '14-')][['S_SUPPKEY', 'S_NATIONKEY']].merge(nation[(nation['N_NAME'] == 'K')].merge(supplier[(supplier['S_ACCTBAL'] >= 3800.8216071510515)][['S_SUPPKEY', 'S_COMMENT', 'S_PHONE', 'S_ACCTBAL']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(region[['R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY')

region[['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].merge(nation[(nation['N_NATIONKEY'] == 1) | (nation['N_NATIONKEY'] != 20)][['N_NATIONKEY', 'N_NAME', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

nation[(nation['N_NATIONKEY'] > 7) | (nation['N_COMMENT'] == 'u')].merge(region.merge(nation.merge(region[['R_REGIONKEY', 'R_NAME', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(customer[(customer['C_CUSTKEY'] >= 82) | (customer['C_NAME'].str.startswith('C'))], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY')

lineitem

partsupp[(partsupp['PS_PARTKEY'] == 3) & (partsupp['PS_PARTKEY'] >= 43) | (partsupp['P_COMMENT'] == ';') & (partsupp['PS_PARTKEY'] >= 19)].merge(lineitem[(lineitem['L_ORDERKEY'] > 63)].merge(partsupp[(partsupp['AVAILQTY'] >= 9954)][['AVAILQTY', 'PS_PARTKEY', 'SUPPLYCOST']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[['P_NAME', 'RETAILPRICE', 'P_PARTKEY', 'BRAND']], left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['P_COMMENT']).agg('max', numeric_only=True)

partsupp[(partsupp['SUPPLYCOST'] < 50.10194935155749)][['P_COMMENT', 'AVAILQTY']].merge(region[['R_REGIONKEY', 'R_COMMENT', 'R_NAME']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='R_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] > 10)].merge(region.merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[['MKTSEGMENT', 'C_ADDRESS']].merge(region[(region['R_REGIONKEY'] == 3)][['R_REGIONKEY', 'R_COMMENT', 'R_NAME']], left_on='C_CUSTKEY', right_on='R_REGIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY').merge(part[(part['RETAILPRICE'] >= 1091.7711018525374) & (part['P_PARTKEY'] != 6)], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='P_PARTKEY').groupby(by=['AVAILQTY']).agg('max', numeric_only=True)

supplier[(supplier['S_ADDRESS'] != '2') | (supplier['S_SUPPKEY'] <= 114) | (supplier['S_COMMENT'] == '!') | (supplier['S_ADDRESS'] != 'G')][['S_ADDRESS', 'S_NATIONKEY', 'S_SUPPKEY', 'S_ACCTBAL']].merge(partsupp[['SUPPLYCOST', 'PS_SUPPKEY', 'PS_PARTKEY', 'AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp.merge(supplier[(supplier['S_PHONE'] != '14-')].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[(lineitem['DISCOUNT'] == 0.020321365048929632)][['SHIPINSTRUCT', 'L_SUPPKEY', 'SHIPMODE', 'RETURNFLAG']].merge(partsupp[(partsupp['PS_SUPPKEY'] < 5145)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

partsupp[(partsupp['PS_SUPPKEY'] < 3786) | (partsupp['P_COMMENT'] != ' th') & (partsupp['SUPPLYCOST'] > 312.6899306742836)].merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier[['S_ACCTBAL', 'S_SUPPKEY', 'S_PHONE', 'S_ADDRESS']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY')

orders[(orders['SHIPPRIORITY'] > 0)][['O_CUSTKEY', 'ORDERPRIORITY']].merge(customer[['C_NAME', 'C_ADDRESS', 'C_COMMENT']].merge(lineitem, left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['MKTSEGMENT'] != 'HOUSEHOLD') | (customer['C_ACCTBAL'] > 453.87708525344306)][['C_COMMENT', 'C_NAME', 'C_ACCTBAL']].merge(supplier[(supplier['S_NAME'].str.startswith('S'))], left_on='C_CUSTKEY', right_on='S_SUPPKEY').merge(part[(part['RETAILPRICE'] >= 1024.4762353605179) & (part['PT_COMMENT'].str.startswith('c'))], left_on='C_CUSTKEY', right_on='P_PARTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['O_CUSTKEY']).agg('mean', numeric_only=True)

region[(region['R_COMMENT'] == 'h') | (region['R_COMMENT'] != 'l') | (region['R_COMMENT'].str.startswith('l'))].merge(nation[['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_COMMENT']].merge(orders[(orders['O_CUSTKEY'] != 2512)], left_on='N_NATIONKEY', right_on='O_ORDERKEY').merge(partsupp[['AVAILQTY']].merge(customer[(customer['MKTSEGMENT'] == 'AUTOMOBILE')][['C_ADDRESS', 'C_ACCTBAL', 'C_PHONE', 'C_NATIONKEY']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='C_CUSTKEY'), left_on='N_NATIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME', 'R_REGIONKEY']).agg('max', numeric_only=True)

nation[(nation['N_REGIONKEY'] < 2) | (nation['N_NATIONKEY'] > 15) | (nation['N_NATIONKEY'] == 9) | (nation['N_REGIONKEY'] > 1)].merge(region[['R_NAME', 'R_REGIONKEY', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier.merge(partsupp[['P_COMMENT', 'SUPPLYCOST', 'AVAILQTY', 'PS_SUPPKEY']].merge(lineitem[(lineitem['L_COMMENT'].str.startswith('a'))][['SHIPDATE', 'L_SUPPKEY', 'DISCOUNT']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[(customer['C_PHONE'].str.startswith('27-'))].merge(orders.merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['O_CUSTKEY'] == 46192) & (orders['SHIPPRIORITY'] != 0)][['ORDERPRIORITY', 'TOTALPRICE', 'SHIPPRIORITY', 'CLERK']].merge(customer[(customer['MKTSEGMENT'] != 'MACHINERY') | (customer['MKTSEGMENT'] == 'BUILDING')][['C_CUSTKEY', 'C_ADDRESS', 'C_PHONE', 'C_NAME']], left_on='O_ORDERKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

nation[(nation['N_NAME'] == 'R') | (nation['N_NAME'] != 'S') & (nation['N_NAME'] == 'B') & (nation['N_REGIONKEY'] <= 2)][['N_NAME', 'N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']].merge(customer[(customer['C_COMMENT'] == 'k') & (customer['MKTSEGMENT'].isin(['AUTOMOBILE', 'FURNITURE', 'HOUSEHOLD', 'BUILDING', 'MACHINERY']))][['C_NATIONKEY', 'C_PHONE', 'C_NAME', 'MKTSEGMENT']].merge(nation[['N_COMMENT']].merge(part[['TYPE']], left_on='N_NATIONKEY', right_on='P_PARTKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_SUPPKEY'] >= 49) & (supplier['S_SUPPKEY'] > 6)][['S_PHONE', 'S_SUPPKEY', 'S_ACCTBAL', 'S_NATIONKEY']].merge(nation[(nation['N_COMMENT'] == 'u')][['N_NATIONKEY', 'N_COMMENT']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_REGIONKEY']).agg('max', numeric_only=True)

part

orders.groupby(by=['O_ORDERKEY']).agg('max', numeric_only=True)

nation.merge(supplier[(supplier['S_NATIONKEY'] >= 1)][['S_COMMENT', 'S_ADDRESS', 'S_SUPPKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[(region['R_COMMENT'] != 'u') | (region['R_REGIONKEY'] == 1)][['R_NAME']].merge(part[(part['P_NAME'] == 'l') & (part['P_NAME'] != 'blu')][['MFGR', 'SIZE', 'P_PARTKEY', 'BRAND']], left_on='R_REGIONKEY', right_on='P_PARTKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_COMMENT']).agg('count')

part[(part['PT_COMMENT'] == 'g') | (part['TYPE'] != 'STA')]

partsupp.merge(lineitem[(lineitem['SHIPMODE'] != 'TRUCK') | (lineitem['LINENUMBER'] < 1)][['QUANTITY', 'TAX']].merge(partsupp[['AVAILQTY']].merge(part, left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='P_PARTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[(part['RETAILPRICE'] == 929.540161711065) & (part['TYPE'].str.startswith('S'))].merge(partsupp[(partsupp['AVAILQTY'] == 4592) | (partsupp['PS_SUPPKEY'] >= 3490)], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_PARTKEY'] < 2)][['PS_SUPPKEY', 'P_COMMENT', 'AVAILQTY', 'PS_PARTKEY']].merge(lineitem[(lineitem['DISCOUNT'] > 0.05822431123854521) & (lineitem['SHIPMODE'].isin(['FOB', 'TRUCK', 'RAIL', 'MAIL']))], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['PS_SUPPKEY']).agg('count')

customer[(customer['MKTSEGMENT'] == 'HOUSEHOLD') | (customer['C_NAME'] == 'C') & (customer['C_NAME'] == 'C') & (customer['C_CUSTKEY'] >= 71)].groupby(by=['C_PHONE']).agg('min', numeric_only=True)

part[(part['P_PARTKEY'] == 12)][['SIZE', 'CONTAINER']]

nation[(nation['N_NAME'] != 'I') & (nation['N_NATIONKEY'] < 7) & (nation['N_REGIONKEY'] == 1)].merge(supplier[['S_PHONE', 'S_NATIONKEY', 'S_NAME']], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region.merge(nation[['N_NAME']].merge(customer, left_on='N_NATIONKEY', right_on='C_CUSTKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY')

orders[['ORDERSTATUS', 'ORDERDATE']].merge(nation.merge(customer.merge(orders[(orders['SHIPPRIORITY'] == 0) | (orders['SHIPPRIORITY'] != 0)], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[['S_NAME', 'S_NATIONKEY', 'S_COMMENT']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='O_ORDERKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['AVAILQTY'] >= 9979)].merge(lineitem[(lineitem['SHIPDATE'] < '1998-10-30') | (lineitem['SHIPDATE'] == '1998-10-30')][['SHIPMODE', 'L_PARTKEY']].merge(partsupp[(partsupp['P_COMMENT'] != 'j')][['P_COMMENT', 'PS_PARTKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem.merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(supplier, left_on='O_ORDERKEY', right_on='S_SUPPKEY').groupby(by=['ORDERSTATUS', 'ORDERDATE']).agg('min', numeric_only=True)

supplier[['S_COMMENT']].merge(customer[['C_COMMENT', 'C_CUSTKEY']].merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['O_CUSTKEY', 'O_ORDERKEY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='S_SUPPKEY', right_on='C_CUSTKEY').merge(orders[['CLERK', 'SHIPPRIORITY', 'TOTALPRICE']].merge(nation[(nation['N_COMMENT'] != 'v') & (nation['N_NAME'] == 'P')][['N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY', 'N_NAME']].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='O_ORDERKEY', right_on='N_NATIONKEY').merge(customer[['C_NAME', 'C_ACCTBAL', 'C_COMMENT']].merge(nation[['N_REGIONKEY', 'N_NATIONKEY']], left_on='C_CUSTKEY', right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='C_CUSTKEY'), left_on='S_SUPPKEY', right_on='O_ORDERKEY')

region[(region['R_REGIONKEY'] > 2) & (region['R_NAME'] != 'E') & (region['R_NAME'] != 'ASI')][['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY')

supplier.groupby(by=['S_ACCTBAL']).agg('mean', numeric_only=True)

customer.merge(orders[(orders['ORDERSTATUS'] == 'O')][['ORDERDATE', 'SHIPPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[['N_NATIONKEY']].merge(supplier[(supplier['S_SUPPKEY'] != 91)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

lineitem.merge(partsupp[(partsupp['PS_SUPPKEY'] >= 2046)].merge(lineitem[(lineitem['LINENUMBER'] <= 1) | (lineitem['SHIPMODE'].isin(['RAIL', 'MAIL']))].merge(partsupp[(partsupp['SUPPLYCOST'] == 977.5817974294889)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(orders[['ORDERPRIORITY', 'O_COMMENT', 'O_ORDERKEY', 'ORDERSTATUS']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders.merge(customer[['C_ADDRESS', 'C_PHONE', 'C_COMMENT']].merge(lineitem[['L_ORDERKEY', 'DISCOUNT', 'SHIPINSTRUCT']], left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY')

supplier.merge(nation[(nation['N_COMMENT'].str.startswith('c'))][['N_NATIONKEY', 'N_NAME', 'N_COMMENT']].merge(supplier[(supplier['S_SUPPKEY'] < 168)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp.merge(lineitem[(lineitem['QUANTITY'] != 47)][['COMMITDATE', 'L_COMMENT']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[['N_COMMENT', 'N_NAME']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_NATIONKEY', 'S_NAME']).agg('min', numeric_only=True)

nation[(nation['N_REGIONKEY'] < 0) & (nation['N_REGIONKEY'] != 0) & (nation['N_NATIONKEY'] > 2) | (nation['N_COMMENT'] == 'n')][['N_NATIONKEY', 'N_REGIONKEY']].merge(supplier[(supplier['S_PHONE'].str.startswith('1'))][['S_PHONE', 'S_SUPPKEY', 'S_NATIONKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY')

region

lineitem[['DISCOUNT', 'EXTENDEDPRICE']].merge(part.merge(partsupp[(partsupp['AVAILQTY'] < 8022) | (partsupp['PS_PARTKEY'] <= 24)][['AVAILQTY']].merge(supplier, left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY').merge(nation[(nation['N_REGIONKEY'] == 1)].merge(supplier[['S_COMMENT', 'S_SUPPKEY', 'S_ADDRESS', 'S_NAME']], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[(customer['C_NATIONKEY'] >= 3) & (customer['MKTSEGMENT'] != 'BUILDING')].merge(nation[(nation['N_COMMENT'] == ' ')][['N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY').groupby(by=['EXTENDEDPRICE']).agg('min', numeric_only=True)

supplier[(supplier['S_ADDRESS'] == 'r') & (supplier['S_PHONE'].str.startswith('26-')) | (supplier['S_NATIONKEY'] == 3) | (supplier['S_NATIONKEY'] <= 19)][['S_NAME', 'S_PHONE', 'S_ACCTBAL']].groupby(by=['S_NAME', 'S_ACCTBAL']).agg('mean', numeric_only=True)

part.merge(partsupp.merge(lineitem[['L_SUPPKEY', 'L_ORDERKEY']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_SUPPKEY', 'AVAILQTY', 'PS_PARTKEY']].merge(lineitem[['L_PARTKEY', 'L_SUPPKEY', 'SHIPDATE', 'DISCOUNT']].merge(partsupp[(partsupp['PS_SUPPKEY'] <= 4607) | (partsupp['PS_SUPPKEY'] == 6174)], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

part[(part['PT_COMMENT'].str.startswith('p')) | (part['PT_COMMENT'] == 'w') | (part['CONTAINER'].str.startswith('MED')) | (part['BRAND'] == 'Brand#33')].merge(partsupp[(partsupp['SUPPLYCOST'] > 588.1013924790856)][['SUPPLYCOST']].merge(lineitem[(lineitem['L_COMMENT'] != 'o')][['TAX', 'SHIPMODE', 'SHIPDATE']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(region, left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='R_REGIONKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] != 6000) & (partsupp['PS_SUPPKEY'] < 112)], left_on='P_PARTKEY', right_on='PS_PARTKEY')

supplier[(supplier['S_PHONE'] == '28-')].merge(partsupp[['SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT', 'AVAILQTY']].merge(supplier.merge(nation[(nation['N_REGIONKEY'] != 1) & (nation['N_COMMENT'].str.startswith('h'))][['N_NAME', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[(supplier['S_COMMENT'] == 'e')][['S_NAME', 'S_ADDRESS']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation.merge(customer[['C_COMMENT']].merge(nation[['N_REGIONKEY', 'N_NAME', 'N_COMMENT', 'N_NATIONKEY']], left_on='C_CUSTKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[['C_NATIONKEY', 'C_COMMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_ACCTBAL']).agg('count')

orders[(orders['CLERK'].str.startswith('C')) | (orders['SHIPPRIORITY'] != 0) & (orders['CLERK'] != 'C')][['ORDERPRIORITY', 'ORDERSTATUS', 'O_CUSTKEY', 'TOTALPRICE']].merge(customer[(customer['C_CUSTKEY'] > 15)][['C_PHONE', 'C_ADDRESS', 'C_NAME']].merge(orders[(orders['TOTALPRICE'] > 264341.6915581407)].merge(lineitem[['RECEIPTDATE', 'COMMITDATE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_ORDERKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_NATIONKEY'] < 13)][['MKTSEGMENT']], left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_NAME'] != 'C') | (customer['C_NAME'] != 'C')][['C_NATIONKEY', 'MKTSEGMENT', 'C_COMMENT']], left_on='O_CUSTKEY', right_on='C_CUSTKEY')

partsupp.merge(part[['MFGR']].merge(customer.merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='P_PARTKEY', right_on='C_CUSTKEY').merge(region[(region['R_NAME'] != 'E') | (region['R_REGIONKEY'] != 2)][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation[(nation['N_NATIONKEY'] >= 18) | (nation['N_NATIONKEY'] != 4)][['N_NATIONKEY', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='P_PARTKEY', right_on='R_REGIONKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['SHIPMODE'] != 'RAIL')].merge(partsupp.merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').groupby(by=['P_COMMENT', 'AVAILQTY']).agg('count')

orders[['CLERK', 'ORDERSTATUS', 'TOTALPRICE', 'ORDERPRIORITY']].merge(customer.merge(orders[['CLERK', 'O_CUSTKEY', 'SHIPPRIORITY', 'ORDERDATE']].merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['O_ORDERKEY'] != 132) & (orders['O_COMMENT'] != 'h')][['SHIPPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_ORDERKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_PHONE'].str.startswith('25-')) & (customer['C_ACCTBAL'] != 4225.650890468965)][['C_PHONE', 'C_COMMENT', 'C_NATIONKEY']], left_on='O_ORDERKEY', right_on='C_CUSTKEY')

region[['R_REGIONKEY', 'R_COMMENT']].merge(nation[(nation['N_NAME'].str.startswith('C'))][['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT', 'N_NAME']].merge(supplier[['S_ADDRESS']].merge(customer[['C_PHONE', 'C_CUSTKEY']], left_on='S_SUPPKEY', right_on='C_CUSTKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] == 'r') & (nation['N_NATIONKEY'] < 5)][['N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT', 'R_REGIONKEY']).agg('min', numeric_only=True)

lineitem[['TAX', 'RETURNFLAG']].merge(supplier[(supplier['S_COMMENT'] == 's') & (supplier['S_PHONE'] != '2')][['S_NATIONKEY', 'S_PHONE']].merge(nation.merge(customer[['C_CUSTKEY', 'C_NAME', 'C_ADDRESS', 'C_ACCTBAL']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY').merge(partsupp.merge(supplier[['S_ADDRESS']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(customer[(customer['C_PHONE'].str.startswith('13-'))][['C_PHONE', 'C_NATIONKEY', 'C_NAME', 'MKTSEGMENT']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY').groupby(by=['RETURNFLAG']).agg('sum', numeric_only=True)

part.groupby(by=['RETAILPRICE', 'MFGR']).agg('max', numeric_only=True)

nation[(nation['N_NAME'] == 'M') & (nation['N_NAME'] == 'S') & (nation['N_COMMENT'].str.startswith('r'))][['N_NAME', 'N_REGIONKEY', 'N_COMMENT']].merge(region[(region['R_COMMENT'] == 'h')], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[['R_COMMENT', 'R_NAME']].merge(partsupp[(partsupp['SUPPLYCOST'] == 953.7000239153682) & (partsupp['PS_PARTKEY'] > 23)][['PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY']], left_on='R_REGIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_NAME', 'N_COMMENT']).agg('mean', numeric_only=True)

part[(part['PT_COMMENT'] == 'n')][['CONTAINER', 'MFGR']]

part.merge(partsupp[(partsupp['SUPPLYCOST'] == 755.4165345461894) | (partsupp['PS_PARTKEY'] == 4)], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_PARTKEY', 'P_COMMENT']].merge(part[['RETAILPRICE']].merge(region[['R_REGIONKEY']], left_on='P_PARTKEY', right_on='R_REGIONKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] >= 1909) & (partsupp['PS_SUPPKEY'] != 3199)][['SUPPLYCOST', 'PS_PARTKEY']].merge(part[(part['CONTAINER'].str.startswith('SM'))], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[(part['PT_COMMENT'] == 'i')][['PT_COMMENT', 'MFGR']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['PT_COMMENT', 'P_PARTKEY']).agg('min', numeric_only=True)

lineitem[(lineitem['DISCOUNT'] < 0.036694135807785876) & (lineitem['TAX'] > 0.06935391451308967) | (lineitem['L_COMMENT'].str.startswith('d'))][['LINENUMBER']].merge(orders.merge(customer[(customer['C_PHONE'].str.startswith('2')) | (customer['MKTSEGMENT'] == 'BUILDING')], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY').merge(part.merge(partsupp[(partsupp['P_COMMENT'].str.startswith('l'))], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY').groupby(by=['LINENUMBER']).agg('mean', numeric_only=True)

nation.merge(customer[['C_NATIONKEY', 'C_NAME', 'C_ACCTBAL']].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[['C_COMMENT', 'C_NATIONKEY']].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[['C_COMMENT', 'MKTSEGMENT', 'C_NATIONKEY']].merge(nation[(nation['N_NAME'] == 'S') | (nation['N_COMMENT'] == 'r')].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY']].merge(region[(region['R_NAME'] == 'ASI') & (region['R_COMMENT'] == 'u')][['R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_COMMENT']).agg('count')

nation[['N_REGIONKEY', 'N_COMMENT', 'N_NAME', 'N_NATIONKEY']].merge(supplier[(supplier['S_NAME'].str.startswith('S'))][['S_ADDRESS', 'S_NATIONKEY']].merge(nation[(nation['N_NATIONKEY'] >= 23)][['N_NAME', 'N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']].merge(region[['R_NAME', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']].merge(supplier[(supplier['S_ACCTBAL'] <= 8126.77885362601)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[['S_ACCTBAL', 'S_NATIONKEY']].merge(nation[['N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[(region['R_COMMENT'] == 'l') | (region['R_NAME'].str.startswith('A'))][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].merge(nation[(nation['N_REGIONKEY'] > 2) & (nation['N_NAME'] != 'G')][['N_COMMENT', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(supplier[['S_SUPPKEY', 'S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_NATIONKEY', 'N_NAME']).agg('sum', numeric_only=True)

part[['P_PARTKEY']].merge(partsupp[(partsupp['PS_SUPPKEY'] < 3630)].merge(lineitem[['SHIPINSTRUCT', 'L_SUPPKEY']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[(part['BRAND'] != 'Brand#15')].merge(partsupp[['AVAILQTY']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['P_PARTKEY']).agg('min', numeric_only=True)

partsupp.merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[['CONTAINER', 'BRAND', 'MFGR']].merge(lineitem[(lineitem['L_PARTKEY'] < 140919)][['L_COMMENT', 'COMMITDATE', 'L_ORDERKEY', 'L_SUPPKEY']], left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(nation[['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY']], left_on='P_PARTKEY', right_on='N_NATIONKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['PS_SUPPKEY']).agg('max', numeric_only=True)

supplier[(supplier['S_ACCTBAL'] != 9539.95571553011) & (supplier['S_COMMENT'] == 'k') | (supplier['S_ACCTBAL'] > 2805.485368683423)][['S_ADDRESS', 'S_NAME', 'S_ACCTBAL', 'S_SUPPKEY', 'S_COMMENT']].merge(partsupp[(partsupp['PS_PARTKEY'] != 23)][['PS_PARTKEY', 'P_COMMENT', 'AVAILQTY', 'PS_SUPPKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] >= 4313) | (partsupp['SUPPLYCOST'] < 180.26034332961055)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] > 5179)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_ACCTBAL']).agg('mean', numeric_only=True)

lineitem.merge(orders[(orders['O_ORDERKEY'] >= 171)].merge(lineitem[['SHIPINSTRUCT', 'EXTENDEDPRICE']].merge(partsupp, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[['AVAILQTY', 'SUPPLYCOST', 'P_COMMENT', 'PS_SUPPKEY']].merge(supplier[['S_ACCTBAL', 'S_ADDRESS', 'S_SUPPKEY', 'S_NATIONKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_SUPPKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['EXTENDEDPRICE']).agg('count')

lineitem[(lineitem['LINESTATUS'] == 'F') | (lineitem['SHIPDATE'] >= '1992-04-27') & (lineitem['L_ORDERKEY'] != 188) | (lineitem['L_SUPPKEY'] == 1078)][['SHIPINSTRUCT', 'L_PARTKEY', 'TAX']].merge(partsupp[(partsupp['AVAILQTY'] != 790)], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'] == 'k') & (partsupp['AVAILQTY'] >= 4434)].merge(supplier[['S_ADDRESS', 'S_SUPPKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['L_PARTKEY']).agg('max', numeric_only=True)

supplier.merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_PARTKEY'] < 10) & (partsupp['PS_SUPPKEY'] < 2640)].merge(lineitem[(lineitem['RECEIPTDATE'] > '1998-11-06')].merge(orders[(orders['O_CUSTKEY'] <= 53852)][['SHIPPRIORITY', 'O_COMMENT', 'O_ORDERKEY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[(part['MFGR'] == 'Manufacturer#3')][['P_NAME', 'BRAND', 'TYPE', 'MFGR']].merge(partsupp[(partsupp['SUPPLYCOST'] < 729.5709938207523)][['PS_SUPPKEY', 'SUPPLYCOST', 'PS_PARTKEY', 'P_COMMENT']], left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_COMMENT', 'S_PHONE']).agg('mean', numeric_only=True)

partsupp[['PS_SUPPKEY', 'PS_PARTKEY']].merge(lineitem[(lineitem['SHIPMODE'] == 'REG AIR') & (lineitem['SHIPINSTRUCT'].isin(['DELIVER IN PERSON', 'TAKE BACK RETURN', 'COLLECT COD', 'NONE']))][['DISCOUNT']].merge(nation[(nation['N_NATIONKEY'] == 7)][['N_NATIONKEY', 'N_NAME', 'N_COMMENT']].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY').merge(nation, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier[['S_ACCTBAL']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem.merge(partsupp[(partsupp['AVAILQTY'] >= 6189) | (partsupp['PS_PARTKEY'] >= 47)].merge(lineitem[(lineitem['DISCOUNT'] < 0.0618914563704883)], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(orders[['TOTALPRICE', 'ORDERSTATUS', 'SHIPPRIORITY', 'ORDERDATE']].merge(part, left_on='O_ORDERKEY', right_on='P_PARTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY')

orders[(orders['O_COMMENT'] == 'the')][['ORDERPRIORITY']].groupby(by=['ORDERPRIORITY']).agg('sum', numeric_only=True)

lineitem

orders[(orders['CLERK'].str.startswith('C')) & (orders['O_ORDERKEY'] > 381) & (orders['CLERK'].str.startswith('C')) | (orders['O_CUSTKEY'] < 54683)].merge(customer[(customer['C_ACCTBAL'] < 1277.414834622035)][['C_ADDRESS']].merge(nation.merge(customer[(customer['C_ACCTBAL'] != 4567.912490777234) | (customer['C_NAME'] == 'C')], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_CUSTKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['ORDERDATE']).agg('mean', numeric_only=True)

orders.merge(lineitem[['QUANTITY', 'SHIPINSTRUCT', 'LINESTATUS']].merge(nation, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['LINENUMBER'] != 3) | (lineitem['L_COMMENT'].str.startswith('s'))][['COMMITDATE', 'EXTENDEDPRICE', 'SHIPMODE', 'L_PARTKEY']].merge(partsupp[['P_COMMENT', 'PS_SUPPKEY', 'AVAILQTY', 'SUPPLYCOST']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_COMMENT'].str.startswith('k'))].merge(nation[['N_COMMENT', 'N_REGIONKEY']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['ORDERDATE']).agg('count')

region[['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].merge(nation[(nation['N_COMMENT'] == 'h') | (nation['N_COMMENT'] == 't')].merge(region[(region['R_NAME'] == 'M') | (region['R_COMMENT'] != 'h')].merge(nation[(nation['N_REGIONKEY'] == 3)][['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[(supplier['S_ACCTBAL'] != 700.6358102969748) & (supplier['S_SUPPKEY'] >= 23)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

part[(part['BRAND'] != 'Brand#32') | (part['SIZE'] < 7)].merge(partsupp[['PS_SUPPKEY']].merge(supplier[(supplier['S_ACCTBAL'] != 8759.041845694084)], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem.merge(orders[(orders['O_ORDERKEY'] <= 267)], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

part[(part['BRAND'] != 'Brand#24') | (part['MFGR'] != 'Manufacturer#3') & (part['P_PARTKEY'] == 92) & (part['BRAND'] == 'Brand#44')]

supplier[(supplier['S_ACCTBAL'] != 4712.024127288886) | (supplier['S_PHONE'] == '28-')][['S_NAME', 'S_SUPPKEY', 'S_ACCTBAL']].merge(partsupp[['AVAILQTY', 'P_COMMENT', 'PS_SUPPKEY', 'SUPPLYCOST']].merge(supplier[['S_PHONE', 'S_ACCTBAL', 'S_NATIONKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[['TAX']].merge(supplier[(supplier['S_SUPPKEY'] == 99) & (supplier['S_ADDRESS'] == 'k')][['S_ACCTBAL']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_ACCTBAL', 'S_SUPPKEY']).agg('count')

lineitem[(lineitem['SHIPDATE'] > '1992-04-27')].groupby(by=['L_ORDERKEY']).agg('mean', numeric_only=True)

nation.merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[(customer['C_NATIONKEY'] >= 16)], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_NATIONKEY', 'N_NAME']).agg('min', numeric_only=True)

partsupp.merge(part[(part['SIZE'] != 35)].merge(partsupp[(partsupp['AVAILQTY'] < 3807)][['PS_PARTKEY', 'SUPPLYCOST', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(supplier.merge(nation[(nation['N_COMMENT'].str.startswith('y')) & (nation['N_COMMENT'] == ' ')], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['SUPPLYCOST']).agg('count')

part.groupby(by=['PT_COMMENT', 'MFGR']).agg('min', numeric_only=True)

region.merge(nation[(nation['N_NAME'].str.startswith('B')) & (nation['N_NATIONKEY'] <= 17)][['N_REGIONKEY', 'N_NAME', 'N_COMMENT']].merge(region[['R_NAME', 'R_REGIONKEY', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_COMMENT'] == 'l') | (region['R_REGIONKEY'] <= 2)].merge(nation[['N_REGIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NATIONKEY', 'N_NAME', 'N_REGIONKEY']].merge(region[(region['R_REGIONKEY'] < 2) & (region['R_COMMENT'] != 'h')].merge(nation[['N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(customer.merge(orders[(orders['SHIPPRIORITY'] >= 0) | (orders['ORDERSTATUS'].isin(['O', 'P']))][['ORDERSTATUS', 'O_CUSTKEY', 'TOTALPRICE', 'O_ORDERKEY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('sum', numeric_only=True)

partsupp.merge(lineitem.merge(partsupp[['PS_SUPPKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(orders[(orders['ORDERSTATUS'] != 'P') & (orders['O_COMMENT'].str.startswith('y'))].merge(customer[(customer['C_COMMENT'] == 'c') & (customer['C_ACCTBAL'] <= 3526.100495857011)], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['L_SUPPKEY'] > 4626) | (lineitem['RECEIPTDATE'] != '1992-05-02')][['L_ORDERKEY', 'QUANTITY', 'TAX', 'L_SUPPKEY']].merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['SUPPLYCOST', 'PS_SUPPKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY')

lineitem[(lineitem['L_SUPPKEY'] <= 7884) | (lineitem['DISCOUNT'] == 0.012790426021116097) & (lineitem['L_COMMENT'] == 'n') | (lineitem['RECEIPTDATE'] <= '1992-05-02')].merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(orders[(orders['O_COMMENT'] != 'ly ') & (orders['CLERK'] != 'C')], left_on='L_ORDERKEY', right_on='O_ORDERKEY').groupby(by=['LINESTATUS', 'LINENUMBER']).agg('mean', numeric_only=True)

lineitem[(lineitem['L_COMMENT'].str.startswith('u')) & (lineitem['L_COMMENT'] == 'e') | (lineitem['SHIPINSTRUCT'].isin(['NONE', 'DELIVER IN PERSON', 'COLLECT COD'])) | (lineitem['SHIPMODE'] == 'MAIL')][['SHIPDATE', 'L_SUPPKEY', 'LINESTATUS']].merge(partsupp[['AVAILQTY', 'SUPPLYCOST']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['SHIPDATE']).agg('min', numeric_only=True)

region[(region['R_COMMENT'] == 'h') & (region['R_NAME'] != 'AME')][['R_NAME', 'R_COMMENT', 'R_REGIONKEY']]

customer[(customer['C_ADDRESS'] != 'U') & (customer['C_NAME'] != 'C') & (customer['C_ADDRESS'] != 'U')].merge(nation[['N_COMMENT', 'N_NAME', 'N_REGIONKEY']].merge(region[['R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_NATIONKEY'] >= 21)][['N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[['R_REGIONKEY', 'R_NAME']].merge(nation[['N_NAME', 'N_COMMENT', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_REGIONKEY'] != 2) | (nation['N_REGIONKEY'] >= 2)][['N_NATIONKEY']].merge(customer[['C_COMMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_NAME']).agg('mean', numeric_only=True)

customer[(customer['C_NATIONKEY'] > 18)].merge(nation[(nation['N_NATIONKEY'] == 5)].merge(region[(region['R_REGIONKEY'] <= 0) & (region['R_COMMENT'] == 'g')][['R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[(customer['C_COMMENT'].str.startswith(','))].merge(orders[['ORDERPRIORITY', 'O_COMMENT', 'SHIPPRIORITY', 'O_ORDERKEY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

customer[(customer['C_PHONE'] == '1') | (customer['C_NATIONKEY'] == 17)].merge(nation.merge(region[['R_NAME', 'R_COMMENT', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

region[['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation.merge(region[(region['R_COMMENT'] != 'u') & (region['R_COMMENT'].str.startswith('u'))][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[(supplier['S_PHONE'].str.startswith('3'))].merge(partsupp[(partsupp['AVAILQTY'] <= 9249)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

nation[['N_REGIONKEY', 'N_NAME']].merge(region[(region['R_NAME'] != 'M') & (region['R_REGIONKEY'] <= 3)][['R_NAME']].merge(customer, left_on='R_REGIONKEY', right_on='C_CUSTKEY').merge(partsupp[(partsupp['P_COMMENT'] != 'h') | (partsupp['SUPPLYCOST'] != 322.48494724633633)][['PS_PARTKEY', 'AVAILQTY']].merge(lineitem[(lineitem['RECEIPTDATE'] > '1992-05-02')][['LINESTATUS']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='R_REGIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_COMMENT'] != 'u') & (region['R_COMMENT'] != 'h')].merge(nation[(nation['N_NATIONKEY'] == 21)][['N_NAME', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_COMMENT', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[['R_REGIONKEY', 'R_COMMENT', 'R_NAME']].merge(nation[(nation['N_NATIONKEY'] >= 15)][['N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY')

supplier[(supplier['S_NATIONKEY'] >= 21)].merge(nation[(nation['N_NAME'].str.startswith('I'))][['N_REGIONKEY', 'N_NAME', 'N_COMMENT', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_NAME']).agg('sum', numeric_only=True)

customer.merge(orders[(orders['ORDERDATE'] == '1998-07-21') & (orders['O_CUSTKEY'] <= 98919)].merge(lineitem[['EXTENDEDPRICE', 'SHIPDATE']].merge(part[(part['SIZE'] >= 29) & (part['MFGR'] == 'Manufacturer#5')][['BRAND']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_NATIONKEY']).agg('max', numeric_only=True)

customer.merge(orders.merge(customer[(customer['C_PHONE'] != '2')].merge(orders[(orders['ORDERPRIORITY'] != '2-HIGH') & (orders['ORDERSTATUS'].isin(['O', 'P']))], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_REGIONKEY'] < 2) | (nation['N_NAME'] != 'B')][['N_REGIONKEY', 'N_NAME']].merge(region[(region['R_COMMENT'] != 'l') | (region['R_COMMENT'] != 'h')][['R_NAME']].merge(lineitem, left_on='R_REGIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_NAME', 'C_PHONE']).agg('max', numeric_only=True)

orders.merge(customer[(customer['C_COMMENT'] != 'n') | (customer['C_NAME'] != 'C')][['MKTSEGMENT', 'C_CUSTKEY', 'C_PHONE', 'C_NAME']].merge(orders[(orders['ORDERSTATUS'] != 'F') | (orders['ORDERPRIORITY'] != '3-MEDIUM')][['ORDERPRIORITY', 'O_ORDERKEY', 'O_CUSTKEY']].merge(lineitem[(lineitem['TAX'] <= 0.04471847242163566)], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[['COMMITDATE']].merge(region.merge(nation[(nation['N_NAME'] == 'S') & (nation['N_NATIONKEY'] >= 7)], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY').merge(orders[(orders['ORDERDATE'] == '1998-07-21') & (orders['O_ORDERKEY'] == 82)][['O_CUSTKEY', 'O_ORDERKEY', 'ORDERSTATUS', 'TOTALPRICE']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem.merge(orders[['SHIPPRIORITY']].merge(supplier, left_on='O_ORDERKEY', right_on='S_SUPPKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['TOTALPRICE'] <= 37512.02456964006)][['O_CUSTKEY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['O_ORDERKEY', 'CLERK']).agg('count')

nation[['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']]

lineitem[(lineitem['RETURNFLAG'] == 'R') | (lineitem['L_ORDERKEY'] <= 36)].merge(partsupp[(partsupp['P_COMMENT'] != 'bli')][['SUPPLYCOST', 'AVAILQTY', 'PS_PARTKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['EXTENDEDPRICE', 'SHIPMODE']).agg('sum', numeric_only=True)

supplier[(supplier['S_NAME'] != 'S')].merge(partsupp.merge(supplier.merge(partsupp[(partsupp['PS_SUPPKEY'] <= 1117)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_REGIONKEY'] == 2)][['N_NAME', 'N_COMMENT', 'N_REGIONKEY']].merge(region[(region['R_REGIONKEY'] >= 2)][['R_COMMENT', 'R_REGIONKEY']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_NAME'] != 'AFR') | (region['R_COMMENT'] == 'l')][['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY')

lineitem[(lineitem['QUANTITY'] <= 11) | (lineitem['RECEIPTDATE'] < '1992-05-02') & (lineitem['RECEIPTDATE'] > '1992-05-02') | (lineitem['SHIPMODE'] != 'RAIL')]

partsupp[['PS_PARTKEY', 'P_COMMENT', 'PS_SUPPKEY']]

part[(part['CONTAINER'] == 'WRAP')][['PT_COMMENT', 'P_NAME', 'TYPE', 'MFGR', 'CONTAINER']].merge(supplier.merge(partsupp.merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='P_PARTKEY', right_on='S_SUPPKEY').groupby(by=['CONTAINER', 'MFGR']).agg('sum', numeric_only=True)

region[(region['R_COMMENT'].str.startswith('u'))][['R_REGIONKEY', 'R_NAME']].merge(nation[['N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY']].merge(supplier[(supplier['S_NAME'] == 'S') & (supplier['S_ADDRESS'] != 'W')][['S_ACCTBAL', 'S_SUPPKEY', 'S_NATIONKEY']].merge(nation[['N_COMMENT', 'N_NAME', 'N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[(customer['C_NAME'] != 'C') & (customer['C_CUSTKEY'] > 52)].merge(nation[['N_COMMENT', 'N_NATIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] <= 2) | (nation['N_NATIONKEY'] != 17)].merge(customer[['C_NATIONKEY', 'C_COMMENT', 'MKTSEGMENT', 'C_PHONE']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] >= 19)].merge(customer[(customer['C_ADDRESS'] == ',')][['C_NAME', 'C_ADDRESS', 'C_CUSTKEY', 'C_PHONE']].merge(orders[(orders['O_ORDERKEY'] > 77)][['SHIPPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_NAME'] == 'AME') | (region['R_COMMENT'].str.startswith('u'))][['R_REGIONKEY', 'R_COMMENT', 'R_NAME']].merge(nation[['N_COMMENT', 'N_NATIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

orders[(orders['O_COMMENT'] != 'a') | (orders['O_CUSTKEY'] < 99193) & (orders['TOTALPRICE'] < 189575.67645691955)][['O_ORDERKEY', 'O_CUSTKEY', 'SHIPPRIORITY', 'TOTALPRICE']].groupby(by=['TOTALPRICE']).agg('min', numeric_only=True)

nation[(nation['N_COMMENT'].str.startswith('t'))].merge(customer.merge(nation[(nation['N_NATIONKEY'] > 0) | (nation['N_COMMENT'] != 'n')][['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT', 'N_NAME']].merge(region[(region['R_NAME'] == 'ASI')], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

lineitem[(lineitem['L_PARTKEY'] > 68888) & (lineitem['LINESTATUS'] == 'O') | (lineitem['COMMITDATE'] >= '1992-05-15')].merge(orders[(orders['O_ORDERKEY'] >= 208)].merge(customer[['C_ACCTBAL', 'C_CUSTKEY', 'C_ADDRESS']].merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['P_COMMENT'].str.startswith('.'))][['P_COMMENT', 'PS_PARTKEY', 'SUPPLYCOST']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY')

orders[(orders['O_ORDERKEY'] != 169) & (orders['ORDERSTATUS'].isin(['P'])) & (orders['O_CUSTKEY'] < 103250) | (orders['ORDERSTATUS'] != 'O')][['CLERK', 'SHIPPRIORITY']].merge(lineitem[(lineitem['DISCOUNT'] > 0.03163858172401307)][['LINENUMBER']].merge(orders[(orders['O_COMMENT'] == ' re')][['O_COMMENT', 'ORDERDATE', 'SHIPPRIORITY', 'ORDERSTATUS']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(region.merge(nation.merge(region[['R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='O_ORDERKEY', right_on='R_REGIONKEY').groupby(by=['CLERK', 'SHIPPRIORITY']).agg('max', numeric_only=True)

orders.merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer.merge(nation[(nation['N_NAME'].str.startswith('J')) | (nation['N_NAME'] != 'S')][['N_COMMENT', 'N_REGIONKEY']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem.merge(partsupp[['SUPPLYCOST']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY')

part[['RETAILPRICE', 'BRAND', 'P_PARTKEY']].merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY')

supplier[(supplier['S_NATIONKEY'] == 6) | (supplier['S_NAME'] != 'S') | (supplier['S_COMMENT'].str.startswith('s'))][['S_ACCTBAL', 'S_PHONE', 'S_SUPPKEY', 'S_NATIONKEY', 'S_COMMENT']].merge(nation[['N_COMMENT', 'N_NAME', 'N_REGIONKEY', 'N_NATIONKEY']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_NATIONKEY']).agg('max', numeric_only=True)

lineitem[(lineitem['L_ORDERKEY'] == 192) & (lineitem['SHIPDATE'] < '1992-04-27') | (lineitem['SHIPINSTRUCT'] == 'COLLECT COD')].groupby(by=['DISCOUNT', 'SHIPMODE']).agg('min', numeric_only=True)

orders[['SHIPPRIORITY', 'CLERK', 'TOTALPRICE', 'O_CUSTKEY']].merge(customer[(customer['C_CUSTKEY'] < 97) | (customer['C_ACCTBAL'] != 1620.1952068613728)], left_on='O_CUSTKEY', right_on='C_CUSTKEY')

supplier

part[(part['PT_COMMENT'] == 'w') | (part['PT_COMMENT'] == 'p')].groupby(by=['RETAILPRICE', 'PT_COMMENT']).agg('count')

region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']]

orders.merge(customer.merge(orders[(orders['ORDERPRIORITY'] != '2-HIGH') & (orders['TOTALPRICE'] == 204855.69456732334)][['ORDERDATE']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

part[['MFGR', 'PT_COMMENT']].merge(supplier[['S_ADDRESS', 'S_SUPPKEY', 'S_PHONE']].merge(partsupp[['P_COMMENT']].merge(orders[['ORDERSTATUS']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='O_ORDERKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='P_PARTKEY', right_on='S_SUPPKEY').merge(region.merge(nation[(nation['N_REGIONKEY'] < 2) | (nation['N_NATIONKEY'] <= 14)], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_REGIONKEY']].merge(region[(region['R_NAME'].str.startswith('AFR'))], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='P_PARTKEY', right_on='R_REGIONKEY').merge(customer, left_on='P_PARTKEY', right_on='C_CUSTKEY').groupby(by=['PT_COMMENT']).agg('min', numeric_only=True)

part.merge(partsupp[(partsupp['P_COMMENT'] == 'o')][['P_COMMENT']].merge(customer[(customer['C_PHONE'] == '18-')].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='C_CUSTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] < 6205) | (partsupp['P_COMMENT'] != 'j')][['PS_SUPPKEY', 'AVAILQTY', 'PS_PARTKEY', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(part[['MFGR', 'BRAND', 'RETAILPRICE', 'P_NAME']].merge(customer[['MKTSEGMENT']], left_on='P_PARTKEY', right_on='C_CUSTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['SHIPMODE'] == 'AIR')].merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['BRAND']).agg('max', numeric_only=True)

supplier[(supplier['S_SUPPKEY'] > 119) & (supplier['S_NATIONKEY'] != 18) | (supplier['S_NAME'] != 'S') & (supplier['S_ADDRESS'] == 'N')].merge(partsupp[(partsupp['SUPPLYCOST'] < 402.4138224560694)][['PS_SUPPKEY', 'P_COMMENT', 'SUPPLYCOST', 'PS_PARTKEY']].merge(part[(part['TYPE'] != 'SMA')].merge(partsupp[['AVAILQTY', 'SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_NAME'] != 'S') | (nation['N_REGIONKEY'] >= 3)][['N_REGIONKEY', 'N_COMMENT']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_COMMENT']).agg('mean', numeric_only=True)

region.merge(nation[(nation['N_NAME'] == 'C')][['N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME', 'R_COMMENT']).agg('max', numeric_only=True)

nation[(nation['N_COMMENT'] != 's') | (nation['N_COMMENT'] == 'c') & (nation['N_COMMENT'] != ' ')][['N_NATIONKEY', 'N_REGIONKEY']].merge(customer[(customer['MKTSEGMENT'] == 'MACHINERY')][['C_NATIONKEY', 'C_COMMENT', 'C_ADDRESS']].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_COMMENT'] == 'h') | (region['R_COMMENT'] == 'g')].merge(nation[['N_NAME', 'N_COMMENT']].merge(supplier[['S_SUPPKEY', 'S_ADDRESS']], left_on='N_NATIONKEY', right_on='S_SUPPKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] != 'S') | (nation['N_COMMENT'] != 'r')][['N_NATIONKEY']].merge(customer[['C_ADDRESS', 'MKTSEGMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_REGIONKEY', 'N_NATIONKEY']).agg('mean', numeric_only=True)

lineitem[(lineitem['RETURNFLAG'].isin(['N', 'R', 'A'])) | (lineitem['SHIPMODE'] == 'FOB') | (lineitem['DISCOUNT'] == 0.01439800247240427) | (lineitem['L_SUPPKEY'] == 2625)].groupby(by=['RECEIPTDATE', 'SHIPINSTRUCT']).agg('mean', numeric_only=True)

partsupp[['P_COMMENT', 'SUPPLYCOST', 'PS_SUPPKEY']].merge(supplier[(supplier['S_ACCTBAL'] < 4840.6659035185385) & (supplier['S_SUPPKEY'] > 164)].merge(nation[(nation['N_NAME'].str.startswith('F'))].merge(customer[(customer['C_NATIONKEY'] >= 4)][['C_PHONE']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[(supplier['S_NAME'].str.startswith('S')) & (supplier['S_NAME'] == 'S')][['S_ADDRESS', 'S_PHONE', 'S_NAME']].merge(orders.merge(customer[(customer['C_PHONE'].str.startswith('22-'))][['C_ACCTBAL', 'C_NATIONKEY', 'C_NAME', 'C_CUSTKEY']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='S_SUPPKEY', right_on='O_ORDERKEY').merge(lineitem[(lineitem['L_COMMENT'] != 's. ') & (lineitem['SHIPINSTRUCT'].isin(['COLLECT COD', 'TAKE BACK RETURN']))][['RECEIPTDATE', 'SHIPMODE', 'RETURNFLAG', 'L_PARTKEY']], left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[['S_NATIONKEY', 'S_SUPPKEY']].merge(nation[(nation['N_COMMENT'] == 'n')].merge(customer[['C_NAME', 'C_PHONE']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY')

region[(region['R_COMMENT'] != 'l')][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']]

region[(region['R_COMMENT'] != 'u') | (region['R_COMMENT'] == 'u') | (region['R_REGIONKEY'] < 3) & (region['R_NAME'].str.startswith('M'))].merge(nation[(nation['N_NAME'] != 'K') | (nation['N_REGIONKEY'] == 3)].merge(customer[(customer['C_ACCTBAL'] > 2325.6453335953693) & (customer['C_ADDRESS'] != 'Q')][['C_PHONE']].merge(part[['P_PARTKEY', 'RETAILPRICE', 'P_NAME', 'TYPE']], left_on='C_CUSTKEY', right_on='P_PARTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_NAME'] == 'E') & (region['R_COMMENT'] != 'g')], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_COMMENT', 'N_NAME', 'N_NATIONKEY']].merge(customer[['C_NAME']].merge(partsupp[['AVAILQTY', 'PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY']], left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(supplier[(supplier['S_ADDRESS'].str.startswith('Q')) | (supplier['S_ACCTBAL'] <= 5974.905672870881)].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME', 'R_COMMENT']).agg('max', numeric_only=True)

part[(part['RETAILPRICE'] != 920.2442693321104) & (part['RETAILPRICE'] >= 993.8503956838173) | (part['P_PARTKEY'] != 125) & (part['TYPE'].str.startswith('STA'))].merge(partsupp[(partsupp['PS_PARTKEY'] <= 44) & (partsupp['SUPPLYCOST'] < 433.6221556570102)][['PS_SUPPKEY', 'PS_PARTKEY']].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem.merge(orders[(orders['CLERK'] == 'C')], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

lineitem.merge(orders.merge(lineitem[['L_ORDERKEY', 'RECEIPTDATE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY')

customer[(customer['C_COMMENT'].str.startswith('t')) & (customer['C_NATIONKEY'] < 1) | (customer['C_ADDRESS'].str.startswith('4')) & (customer['C_NATIONKEY'] == 22)][['C_ACCTBAL', 'C_NATIONKEY']]

nation[['N_NAME', 'N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[(region['R_NAME'] != 'A') | (region['R_COMMENT'] != 'h')].merge(nation[(nation['N_COMMENT'] == 'p')][['N_NAME', 'N_COMMENT', 'N_REGIONKEY']].merge(region[(region['R_NAME'].str.startswith('ASI')) & (region['R_COMMENT'] != 'u')], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier.merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY')

customer.groupby(by=['C_NATIONKEY', 'C_NAME']).agg('max', numeric_only=True)

nation[['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME']].merge(region[(region['R_REGIONKEY'] <= 0)].merge(nation[['N_REGIONKEY']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[(customer['C_ACCTBAL'] > 7346.359837475435)][['C_PHONE', 'C_NATIONKEY', 'C_ACCTBAL']].merge(nation[(nation['N_REGIONKEY'] < 0)][['N_NATIONKEY', 'N_REGIONKEY']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NAME'] != 'K') | (nation['N_NAME'] == 'A')][['N_NATIONKEY', 'N_REGIONKEY']].merge(customer[(customer['C_CUSTKEY'] != 95) | (customer['C_PHONE'] == '18-')][['C_NAME']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region.merge(nation[['N_NAME', 'N_REGIONKEY', 'N_COMMENT']].merge(region[(region['R_NAME'].str.startswith('A')) & (region['R_COMMENT'] == 'h')][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_NAME']).agg('max', numeric_only=True)

nation[(nation['N_COMMENT'] == 'r')][['N_REGIONKEY']].merge(region[(region['R_NAME'] != 'E')][['R_NAME']].merge(orders, left_on='R_REGIONKEY', right_on='O_ORDERKEY').merge(part[(part['BRAND'].isin(['Brand#13', 'Brand#14', 'Brand#53', 'Brand#51', 'Brand#43', 'Brand#23', 'Brand#55', 'Brand#31', 'Brand#33', 'Brand#22', 'Brand#35', 'Brand#44', 'Brand#15', 'Brand#54', 'Brand#41', 'Brand#52', 'Brand#11', 'Brand#32', 'Brand#45'])) & (part['P_NAME'] != 'lem')][['PT_COMMENT', 'CONTAINER', 'P_PARTKEY']], left_on='R_REGIONKEY', right_on='P_PARTKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_NAME'].str.startswith('AME'))].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_COMMENT'] != 'l')], left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_REGIONKEY']).agg('max', numeric_only=True)

region[['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_REGIONKEY'] >= 1)][['N_NATIONKEY', 'N_COMMENT', 'N_NAME']].merge(customer.merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT', 'N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT', 'R_REGIONKEY']).agg('max', numeric_only=True)

partsupp[['SUPPLYCOST', 'P_COMMENT']].merge(nation.merge(region.merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[['R_COMMENT', 'R_REGIONKEY', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY').merge(part[['CONTAINER', 'MFGR', 'BRAND']].merge(orders, left_on='P_PARTKEY', right_on='O_ORDERKEY').merge(customer[(customer['C_ADDRESS'].str.startswith('T'))][['C_ACCTBAL', 'C_CUSTKEY']], left_on='P_PARTKEY', right_on='C_CUSTKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='P_PARTKEY').merge(supplier[['S_ACCTBAL', 'S_ADDRESS']].merge(region[['R_COMMENT', 'R_NAME']].merge(orders[(orders['O_COMMENT'].str.startswith('c'))][['SHIPPRIORITY', 'ORDERPRIORITY', 'O_COMMENT']], left_on='R_REGIONKEY', right_on='O_ORDERKEY'), left_on='S_SUPPKEY', right_on='R_REGIONKEY').merge(nation, left_on='S_SUPPKEY', right_on='N_NATIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='S_SUPPKEY')

supplier[(supplier['S_COMMENT'].str.startswith('y')) | (supplier['S_SUPPKEY'] <= 166)][['S_NAME']].merge(lineitem[(lineitem['EXTENDEDPRICE'] < 12007.862419694933) | (lineitem['L_SUPPKEY'] == 6236)][['L_COMMENT']].merge(orders.merge(customer[(customer['C_ACCTBAL'] >= 372.09627977275886) & (customer['C_PHONE'].str.startswith('1'))][['C_NAME', 'C_ADDRESS', 'MKTSEGMENT']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(region[(region['R_REGIONKEY'] < 0)], left_on='S_SUPPKEY', right_on='R_REGIONKEY').merge(region[['R_COMMENT', 'R_REGIONKEY', 'R_NAME']], left_on='S_SUPPKEY', right_on='R_REGIONKEY').groupby(by=['S_NAME']).agg('count')

lineitem[(lineitem['EXTENDEDPRICE'] <= 15411.574711324925) & (lineitem['LINESTATUS'].isin(['O'])) | (lineitem['SHIPMODE'].isin(['MAIL', 'SHIP'])) | (lineitem['COMMITDATE'] <= '1992-05-15')]

part.merge(partsupp[['PS_PARTKEY', 'SUPPLYCOST']].merge(lineitem.merge(partsupp[(partsupp['SUPPLYCOST'] > 108.57519496098011) | (partsupp['PS_PARTKEY'] > 17)], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[['RETAILPRICE', 'SIZE', 'BRAND']].merge(region[(region['R_REGIONKEY'] > 2) | (region['R_REGIONKEY'] == 0)], left_on='P_PARTKEY', right_on='R_REGIONKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

partsupp[(partsupp['AVAILQTY'] == 3213)].merge(supplier.merge(nation[(nation['N_COMMENT'] == 's') | (nation['N_NATIONKEY'] == 10)], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NAME'] != 'R') & (nation['N_COMMENT'].str.startswith('n'))][['N_REGIONKEY', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier.merge(partsupp[(partsupp['P_COMMENT'] == 'r')][['AVAILQTY']].merge(part[['TYPE', 'MFGR', 'RETAILPRICE']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_NAME'] == 'J')][['N_NAME', 'N_COMMENT', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY')

partsupp[(partsupp['SUPPLYCOST'] == 979.1636021793133) | (partsupp['SUPPLYCOST'] != 493.44130096778633)]

supplier[['S_COMMENT', 'S_SUPPKEY']].merge(partsupp[(partsupp['P_COMMENT'] == 'u')].merge(lineitem[['SHIPMODE', 'EXTENDEDPRICE', 'L_COMMENT']].merge(orders[(orders['O_CUSTKEY'] != 50387)][['SHIPPRIORITY', 'ORDERDATE', 'CLERK', 'O_COMMENT']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] != 5246)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

supplier.merge(nation[(nation['N_REGIONKEY'] == 0) & (nation['N_NAME'] == 'A')], left_on='S_NATIONKEY', right_on='N_NATIONKEY')

region[(region['R_NAME'].str.startswith('M')) | (region['R_NAME'] != 'AME') & (region['R_NAME'].str.startswith('M')) & (region['R_NAME'].str.startswith('E'))][['R_COMMENT', 'R_REGIONKEY']].groupby(by=['R_COMMENT']).agg('mean', numeric_only=True)

partsupp[['PS_SUPPKEY', 'P_COMMENT', 'SUPPLYCOST']].merge(supplier[(supplier['S_NATIONKEY'] != 6) & (supplier['S_ADDRESS'] != 'q')][['S_COMMENT', 'S_PHONE']].merge(orders[['TOTALPRICE', 'SHIPPRIORITY']].merge(nation[(nation['N_NAME'] == 'A')], left_on='O_ORDERKEY', right_on='N_NATIONKEY'), left_on='S_SUPPKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[(lineitem['L_ORDERKEY'] != 64) & (lineitem['EXTENDEDPRICE'] != 24579.238344324018)].merge(partsupp[['PS_PARTKEY', 'P_COMMENT', 'PS_SUPPKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_PARTKEY'] > 21)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').groupby(by=['PS_SUPPKEY', 'P_COMMENT']).agg('max', numeric_only=True)

supplier[['S_SUPPKEY', 'S_PHONE', 'S_NAME', 'S_ACCTBAL']].merge(partsupp[(partsupp['AVAILQTY'] >= 4260)][['PS_PARTKEY']].merge(part[['MFGR', 'BRAND', 'CONTAINER']].merge(customer[['C_CUSTKEY', 'C_ADDRESS', 'C_ACCTBAL']], left_on='P_PARTKEY', right_on='C_CUSTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp.merge(supplier.merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(part[(part['P_NAME'] != 'blu') & (part['CONTAINER'] != 'MED')][['RETAILPRICE', 'MFGR']].merge(orders[(orders['TOTALPRICE'] == 338971.379749262) & (orders['TOTALPRICE'] == 328092.42447639536)], left_on='P_PARTKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

nation[(nation['N_NAME'] != 'I') | (nation['N_COMMENT'] == 's') & (nation['N_COMMENT'] == 'c')][['N_NAME', 'N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']].merge(customer[(customer['C_ADDRESS'].str.startswith('X')) & (customer['C_NATIONKEY'] == 17)][['C_ACCTBAL', 'C_PHONE', 'C_NATIONKEY']].merge(nation[(nation['N_NATIONKEY'] <= 6) & (nation['N_NATIONKEY'] < 13)].merge(supplier[(supplier['S_NATIONKEY'] != 14)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

partsupp[(partsupp['SUPPLYCOST'] > 457.8182199382159) | (partsupp['PS_SUPPKEY'] <= 5794) & (partsupp['AVAILQTY'] == 4329) | (partsupp['PS_PARTKEY'] != 25)].groupby(by=['AVAILQTY', 'PS_PARTKEY']).agg('min', numeric_only=True)

orders[['O_COMMENT', 'SHIPPRIORITY']].groupby(by=['SHIPPRIORITY', 'O_COMMENT']).agg('sum', numeric_only=True)

nation.merge(customer[(customer['C_NATIONKEY'] >= 4)][['C_ADDRESS', 'C_CUSTKEY', 'C_COMMENT']].merge(orders[(orders['ORDERPRIORITY'] != '2-HIGH')], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_COMMENT'] != 'd') & (supplier['S_PHONE'] == '1')], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[['MKTSEGMENT', 'C_COMMENT', 'C_NATIONKEY', 'C_ACCTBAL']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_COMMENT']).agg('sum', numeric_only=True)

customer[['C_ADDRESS']].groupby(by=['C_ADDRESS']).agg('mean', numeric_only=True)

supplier.merge(nation[['N_NAME', 'N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NAME'].str.startswith('G')) | (nation['N_NATIONKEY'] >= 13)].merge(supplier[(supplier['S_SUPPKEY'] != 148)][['S_PHONE', 'S_ADDRESS', 'S_COMMENT']], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['AVAILQTY'] < 4390) & (partsupp['SUPPLYCOST'] == 581.8661297806724)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

nation[(nation['N_NAME'] == 'G') & (nation['N_COMMENT'] != 'u') | (nation['N_REGIONKEY'] <= 0) | (nation['N_NATIONKEY'] >= 16)][['N_REGIONKEY']].groupby(by=['N_REGIONKEY']).agg('mean', numeric_only=True)

orders[(orders['ORDERDATE'] != '1992-01-13')].groupby(by=['O_CUSTKEY']).agg('count')

orders[['O_ORDERKEY', 'ORDERSTATUS', 'SHIPPRIORITY', 'ORDERPRIORITY']].merge(lineitem[['L_PARTKEY', 'SHIPINSTRUCT']].merge(partsupp[(partsupp['SUPPLYCOST'] >= 578.1968374119294) & (partsupp['PS_PARTKEY'] != 2)].merge(supplier[['S_NATIONKEY', 'S_PHONE', 'S_ACCTBAL']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['O_ORDERKEY', 'ORDERSTATUS']).agg('sum', numeric_only=True)

orders[(orders['O_CUSTKEY'] > 31450) & (orders['ORDERPRIORITY'] == '3-MEDIUM') | (orders['ORDERSTATUS'] == 'P') | (orders['ORDERSTATUS'].isin(['F', 'P']))]

supplier[(supplier['S_COMMENT'] == 't') & (supplier['S_PHONE'].str.startswith('3')) & (supplier['S_NATIONKEY'] <= 22) | (supplier['S_ADDRESS'] == 'T')].merge(nation[(nation['N_NAME'].str.startswith('G')) & (nation['N_COMMENT'] == 'i')].merge(supplier[(supplier['S_ACCTBAL'] < 4602.765350281196)][['S_ADDRESS', 'S_ACCTBAL', 'S_NAME', 'S_NATIONKEY']].merge(nation[(nation['N_NAME'] == 'I')][['N_NAME']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NAME'].str.startswith('G'))], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['AVAILQTY'] != 8459)][['P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_NATIONKEY', 'S_NAME']).agg('mean', numeric_only=True)

nation.groupby(by=['N_REGIONKEY', 'N_COMMENT']).agg('mean', numeric_only=True)

region[['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation[(nation['N_NATIONKEY'] < 20) | (nation['N_NATIONKEY'] <= 10)][['N_NATIONKEY', 'N_NAME', 'N_COMMENT', 'N_REGIONKEY']].merge(region[(region['R_NAME'].str.startswith('AME'))], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_REGIONKEY'] != 1)][['R_REGIONKEY', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] != 'G')].merge(supplier.merge(partsupp[(partsupp['SUPPLYCOST'] < 174.2259452768881) | (partsupp['SUPPLYCOST'] >= 797.2991302788342)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[(region['R_NAME'] == 'E')], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_REGIONKEY', 'N_NAME', 'N_COMMENT', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('sum', numeric_only=True)

region[['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].merge(nation[(nation['N_COMMENT'].str.startswith('i')) & (nation['N_NAME'] != 'C')].merge(region[(region['R_REGIONKEY'] >= 1)], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

lineitem[(lineitem['SHIPDATE'] != '1998-10-30') | (lineitem['LINENUMBER'] < 5) | (lineitem['SHIPINSTRUCT'] == 'NONE')][['L_SUPPKEY', 'DISCOUNT', 'SHIPINSTRUCT']]

partsupp[(partsupp['PS_SUPPKEY'] < 602) | (partsupp['PS_PARTKEY'] <= 18) | (partsupp['PS_PARTKEY'] == 13) | (partsupp['P_COMMENT'].str.startswith('l'))].merge(lineitem[['RETURNFLAG']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier[(supplier['S_COMMENT'] == 'h')].merge(partsupp[(partsupp['PS_PARTKEY'] >= 21)].merge(part[(part['TYPE'] != 'STA')][['PT_COMMENT', 'RETAILPRICE', 'MFGR']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(part.merge(partsupp[(partsupp['PS_PARTKEY'] != 16) & (partsupp['P_COMMENT'] == 'e')][['AVAILQTY', 'SUPPLYCOST', 'PS_PARTKEY']].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['AVAILQTY']).agg('sum', numeric_only=True)

orders[(orders['O_CUSTKEY'] >= 133784)][['ORDERPRIORITY', 'TOTALPRICE']].merge(customer[(customer['C_ACCTBAL'] < 1206.379249687307)].merge(nation[['N_NAME', 'N_COMMENT', 'N_NATIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_COMMENT'].str.startswith('g'))], left_on='O_ORDERKEY', right_on='C_CUSTKEY').groupby(by=['TOTALPRICE', 'ORDERPRIORITY']).agg('count')

supplier[['S_SUPPKEY', 'S_COMMENT', 'S_PHONE', 'S_NAME']].merge(partsupp.merge(supplier[(supplier['S_SUPPKEY'] <= 1)], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[(lineitem['SHIPDATE'] <= '1992-04-27')][['QUANTITY', 'L_PARTKEY', 'DISCOUNT']].merge(partsupp[['SUPPLYCOST']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

region[(region['R_REGIONKEY'] == 2) & (region['R_COMMENT'] == 'l')].merge(nation[['N_NATIONKEY']].merge(supplier[(supplier['S_PHONE'] == '26-') & (supplier['S_NAME'].str.startswith('S'))].merge(partsupp[(partsupp['PS_SUPPKEY'] >= 853) | (partsupp['P_COMMENT'] == ';')][['AVAILQTY', 'PS_SUPPKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY', 'R_NAME']).agg('mean', numeric_only=True)

part.merge(partsupp[(partsupp['PS_SUPPKEY'] <= 6558) & (partsupp['AVAILQTY'] < 9503)].merge(part[(part['CONTAINER'].str.startswith('JUMBO')) | (part['CONTAINER'].str.startswith('MED'))][['PT_COMMENT']].merge(partsupp, left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(supplier.merge(nation[(nation['N_NAME'] != 'B')], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

region[(region['R_COMMENT'].str.startswith('g'))].merge(nation[(nation['N_COMMENT'] == ' ') | (nation['N_REGIONKEY'] == 3)].merge(customer[['MKTSEGMENT', 'C_ADDRESS', 'C_CUSTKEY']].merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_PHONE'] == '26-')][['S_NAME', 'S_COMMENT', 'S_PHONE']].merge(lineitem[['LINESTATUS', 'QUANTITY', 'RETURNFLAG', 'L_SUPPKEY']], left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('max', numeric_only=True)

lineitem.merge(partsupp[['PS_PARTKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(orders[['CLERK', 'O_COMMENT', 'ORDERDATE']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[['PS_PARTKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['L_ORDERKEY']).agg('min', numeric_only=True)

supplier[(supplier['S_NATIONKEY'] != 10) | (supplier['S_PHONE'].str.startswith('3')) | (supplier['S_COMMENT'] != 'a')][['S_COMMENT', 'S_ACCTBAL', 'S_NAME', 'S_PHONE', 'S_SUPPKEY']]

customer[(customer['C_NATIONKEY'] >= 0) | (customer['C_NAME'] != 'C') & (customer['C_ADDRESS'] == 'o') | (customer['C_COMMENT'] == 'n')][['C_ACCTBAL', 'C_NATIONKEY', 'C_PHONE']].merge(nation[(nation['N_NAME'].str.startswith('K')) | (nation['N_COMMENT'].str.startswith('e'))][['N_NAME', 'N_COMMENT', 'N_NATIONKEY']].merge(customer[(customer['C_PHONE'].str.startswith('25-'))][['C_NAME', 'MKTSEGMENT', 'C_ADDRESS', 'C_PHONE']].merge(part[(part['P_PARTKEY'] != 112)], left_on='C_CUSTKEY', right_on='P_PARTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NAME'] != 'P')].merge(supplier[['S_COMMENT']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NAME'] == 'U')], left_on='C_NATIONKEY', right_on='N_NATIONKEY')

nation[['N_NATIONKEY']].merge(supplier[(supplier['S_ADDRESS'].str.startswith('x')) & (supplier['S_COMMENT'] != 't')], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier.merge(nation[(nation['N_REGIONKEY'] < 3)][['N_NATIONKEY', 'N_REGIONKEY']].merge(region[['R_NAME', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] <= 3963) | (partsupp['AVAILQTY'] < 4154)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY')

orders[(orders['ORDERDATE'] >= '1992-01-13') & (orders['ORDERPRIORITY'].isin(['5-LOW', '2-HIGH', '1-URGENT', '4-NOT SPECIFIED'])) & (orders['SHIPPRIORITY'] == 0)][['O_CUSTKEY', 'CLERK', 'ORDERSTATUS', 'O_COMMENT']].merge(customer.merge(nation[(nation['N_COMMENT'].str.startswith(' '))].merge(customer[(customer['C_ADDRESS'] == 'v') | (customer['C_PHONE'].str.startswith('22-'))], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

nation[(nation['N_COMMENT'] == 'c')]

supplier[['S_ADDRESS', 'S_SUPPKEY', 'S_COMMENT', 'S_ACCTBAL']].merge(partsupp[['AVAILQTY']].merge(lineitem[(lineitem['LINESTATUS'] == 'O')][['SHIPINSTRUCT']].merge(nation[['N_REGIONKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(lineitem, left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['AVAILQTY'] >= 7611)].merge(supplier[['S_ACCTBAL']].merge(region[['R_COMMENT', 'R_REGIONKEY', 'R_NAME']], left_on='S_SUPPKEY', right_on='R_REGIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(part[['P_PARTKEY', 'SIZE']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['SUPPLYCOST', 'PS_PARTKEY', 'PS_SUPPKEY', 'AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_SUPPKEY']).agg('sum', numeric_only=True)

supplier

region[(region['R_NAME'].str.startswith('ASI'))][['R_REGIONKEY', 'R_COMMENT', 'R_NAME']].groupby(by=['R_REGIONKEY', 'R_COMMENT']).agg('min', numeric_only=True)

nation[(nation['N_REGIONKEY'] > 0) | (nation['N_NAME'].str.startswith('U')) & (nation['N_NATIONKEY'] >= 9) & (nation['N_NAME'] == 'R')][['N_COMMENT', 'N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']].merge(customer[(customer['C_NAME'] == 'C') | (customer['C_PHONE'].str.startswith('25-'))][['C_CUSTKEY', 'C_COMMENT', 'C_PHONE', 'C_NAME']].merge(orders.merge(customer[(customer['C_ACCTBAL'] >= 4440.594901360317) | (customer['C_NAME'] != 'C')], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[(customer['C_PHONE'].str.startswith('27-'))][['C_NATIONKEY', 'C_ACCTBAL', 'C_COMMENT', 'C_PHONE']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_COMMENT', 'N_NATIONKEY']).agg('mean', numeric_only=True)

lineitem[(lineitem['SHIPINSTRUCT'] != 'DELIVER IN PERSON')].merge(orders[['O_ORDERKEY', 'CLERK']].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['SHIPMODE'].isin(['TRUCK', 'SHIP', 'REG AIR', 'AIR'])) & (lineitem['L_SUPPKEY'] <= 2492)][['L_SUPPKEY', 'L_COMMENT', 'QUANTITY', 'DISCOUNT']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[['P_COMMENT']].merge(nation[(nation['N_NAME'] == 'G')].merge(customer[['C_CUSTKEY', 'C_ACCTBAL', 'C_COMMENT', 'MKTSEGMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY').merge(nation[(nation['N_NAME'] != 'P')], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] == 3322) & (partsupp['AVAILQTY'] > 6751)][['PS_PARTKEY', 'P_COMMENT']].merge(part[(part['PT_COMMENT'] == 'e')][['P_PARTKEY', 'RETAILPRICE']].merge(partsupp[(partsupp['P_COMMENT'] == ',') | (partsupp['P_COMMENT'] != 'h')], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['DISCOUNT'] == 0.03985425256183339) & (lineitem['RETURNFLAG'].isin(['R', 'N', 'A']))][['SHIPINSTRUCT', 'DISCOUNT']].merge(supplier[(supplier['S_SUPPKEY'] <= 94) | (supplier['S_ACCTBAL'] != -596.0208296494451)], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY')

lineitem[(lineitem['L_SUPPKEY'] != 3481) & (lineitem['SHIPMODE'].isin(['MAIL'])) & (lineitem['RETURNFLAG'] != 'N')].merge(partsupp[(partsupp['P_COMMENT'] != 'd')].merge(part[(part['CONTAINER'] == 'SM')][['MFGR', 'CONTAINER', 'RETAILPRICE', 'TYPE']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_PARTKEY'] == 20) & (partsupp['P_COMMENT'].str.startswith('i'))].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(orders[(orders['O_ORDERKEY'] > 242)].merge(customer[['C_ADDRESS']], left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[['L_COMMENT', 'TAX', 'RECEIPTDATE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY')

part[(part['PT_COMMENT'] == 'u') | (part['RETAILPRICE'] == 1027.91209033034) | (part['TYPE'] == 'STA')][['SIZE', 'P_NAME']].merge(supplier[['S_ADDRESS', 'S_ACCTBAL', 'S_SUPPKEY']].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['SUPPLYCOST'] <= 299.41635530241615) | (partsupp['P_COMMENT'] != 'l')], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='P_PARTKEY', right_on='S_SUPPKEY').merge(region[(region['R_REGIONKEY'] > 1) & (region['R_REGIONKEY'] < 0)], left_on='P_PARTKEY', right_on='R_REGIONKEY').merge(partsupp, left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY'])

orders[['CLERK', 'TOTALPRICE', 'ORDERSTATUS', 'O_COMMENT', 'ORDERDATE']].merge(customer.merge(nation[(nation['N_NAME'].str.startswith('V')) | (nation['N_COMMENT'] == 'y')][['N_COMMENT']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='C_CUSTKEY').merge(nation[(nation['N_COMMENT'].str.startswith(' '))][['N_REGIONKEY']].merge(region[(region['R_COMMENT'] != 'u') & (region['R_NAME'] == 'AFR')][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[['R_COMMENT', 'R_REGIONKEY', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='O_ORDERKEY', right_on='N_NATIONKEY')

customer[(customer['C_CUSTKEY'] != 61)][['C_NATIONKEY', 'C_ADDRESS', 'C_PHONE', 'C_CUSTKEY']].groupby(by=['C_CUSTKEY']).agg('min', numeric_only=True)

orders[(orders['ORDERDATE'] < '1998-07-21')][['ORDERDATE', 'O_COMMENT', 'ORDERSTATUS']].groupby(by=['ORDERDATE']).agg('mean', numeric_only=True)

orders[['SHIPPRIORITY', 'O_ORDERKEY', 'ORDERSTATUS', 'ORDERDATE', 'O_COMMENT']].merge(lineitem[(lineitem['L_SUPPKEY'] > 5518)].merge(partsupp[(partsupp['SUPPLYCOST'] == 501.9284346125423) | (partsupp['P_COMMENT'].str.startswith('s'))][['PS_PARTKEY', 'AVAILQTY']].merge(part[['TYPE', 'BRAND', 'MFGR']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['SUPPLYCOST'] < 617.1125194814525)].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY')

customer[(customer['C_CUSTKEY'] > 43)].groupby(by=['C_PHONE']).agg('mean', numeric_only=True)

part[(part['RETAILPRICE'] > 902.2656150785374) & (part['P_NAME'].str.startswith('o')) | (part['PT_COMMENT'] == 'ss ')][['P_NAME', 'BRAND']].merge(orders[(orders['TOTALPRICE'] >= 187619.73410901276) & (orders['O_COMMENT'] == 'i')], left_on='P_PARTKEY', right_on='O_ORDERKEY').groupby(by=['P_NAME', 'BRAND']).agg('count')

partsupp[['SUPPLYCOST', 'AVAILQTY', 'P_COMMENT', 'PS_SUPPKEY', 'PS_PARTKEY']].merge(supplier[(supplier['S_NAME'] == 'S')][['S_ACCTBAL', 'S_COMMENT', 'S_SUPPKEY', 'S_ADDRESS']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[['TAX', 'QUANTITY', 'EXTENDEDPRICE', 'L_COMMENT']].merge(region[['R_REGIONKEY', 'R_NAME']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[['P_PARTKEY', 'SIZE']], left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['P_COMMENT', 'PS_SUPPKEY']).agg('sum', numeric_only=True)

nation[(nation['N_NATIONKEY'] == 10) & (nation['N_REGIONKEY'] != 2) | (nation['N_NATIONKEY'] == 19)][['N_COMMENT']].merge(region[['R_COMMENT']].merge(supplier[['S_ADDRESS', 'S_PHONE', 'S_ACCTBAL']].merge(lineitem[['SHIPDATE', 'RETURNFLAG']], left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='R_REGIONKEY', right_on='S_SUPPKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] < 6155) & (partsupp['AVAILQTY'] == 163)], left_on='R_REGIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='N_NATIONKEY', right_on='R_REGIONKEY').merge(lineitem[(lineitem['RETURNFLAG'] != 'N')][['RECEIPTDATE']].merge(partsupp[(partsupp['PS_PARTKEY'] != 1) & (partsupp['P_COMMENT'] != 'a')][['PS_PARTKEY', 'PS_SUPPKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(nation[['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME']].merge(customer[(customer['C_NATIONKEY'] < 1) | (customer['C_ADDRESS'].str.startswith('X'))][['C_PHONE', 'C_ADDRESS', 'C_NATIONKEY', 'C_NAME']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).groupby(by=['N_COMMENT']).agg('sum', numeric_only=True)

orders[['ORDERSTATUS', 'O_CUSTKEY', 'ORDERPRIORITY', 'O_ORDERKEY', 'SHIPPRIORITY']].merge(customer[(customer['C_COMMENT'] != ',') & (customer['C_NAME'].str.startswith('C'))][['C_PHONE', 'MKTSEGMENT', 'C_COMMENT', 'C_NATIONKEY']].merge(nation[(nation['N_REGIONKEY'] >= 1) | (nation['N_COMMENT'] == ' ')].merge(customer[(customer['C_ACCTBAL'] <= 3365.35877652981) & (customer['C_NAME'].str.startswith('C'))], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NATIONKEY'] <= 7) & (nation['N_NAME'].str.startswith('B'))][['N_NAME', 'N_COMMENT']].merge(partsupp[(partsupp['SUPPLYCOST'] >= 510.8571367645939)], left_on='N_NATIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[['L_ORDERKEY']].merge(orders[['ORDERSTATUS']].merge(part[(part['TYPE'].str.startswith('P')) & (part['MFGR'] == 'Manufacturer#5')], left_on='O_ORDERKEY', right_on='P_PARTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['SHIPINSTRUCT'].isin(['TAKE BACK RETURN', 'COLLECT COD', 'NONE', 'DELIVER IN PERSON']))][['L_ORDERKEY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY')

customer[(customer['C_ADDRESS'] != ',') & (customer['C_COMMENT'].str.startswith('r'))][['C_NAME', 'C_COMMENT', 'C_PHONE', 'C_ADDRESS', 'C_ACCTBAL']].groupby(by=['C_COMMENT', 'C_ADDRESS']).agg('max', numeric_only=True)

partsupp[(partsupp['PS_PARTKEY'] > 16)][['PS_SUPPKEY', 'PS_PARTKEY', 'AVAILQTY', 'SUPPLYCOST', 'P_COMMENT']].merge(lineitem[['LINENUMBER']].merge(nation[(nation['N_NATIONKEY'] != 19) & (nation['N_NAME'].str.startswith('E'))][['N_COMMENT', 'N_NAME', 'N_REGIONKEY', 'N_NATIONKEY']].merge(region[['R_REGIONKEY', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').groupby(by=['PS_PARTKEY', 'AVAILQTY']).agg('min', numeric_only=True)

region[(region['R_COMMENT'] != 'l') | (region['R_NAME'].str.startswith('A')) & (region['R_NAME'] != 'A')][['R_COMMENT', 'R_REGIONKEY']].merge(nation[['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']].merge(supplier[(supplier['S_ADDRESS'] == 'B') | (supplier['S_PHONE'].str.startswith('26-'))].merge(partsupp[(partsupp['P_COMMENT'].str.startswith('j'))], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[['C_PHONE']].merge(nation[(nation['N_NATIONKEY'] != 5) & (nation['N_COMMENT'].str.startswith('n'))][['N_REGIONKEY']], left_on='C_CUSTKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] != 'M') | (nation['N_NAME'] == 'B')][['N_NATIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('min', numeric_only=True)

region[(region['R_REGIONKEY'] != 1)].merge(nation[(nation['N_COMMENT'] != 'e') | (nation['N_NAME'].str.startswith('F'))], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

supplier.groupby(by=['S_NATIONKEY', 'S_PHONE']).agg('mean', numeric_only=True)

partsupp.merge(part[['CONTAINER']].merge(orders[(orders['SHIPPRIORITY'] <= 0)][['SHIPPRIORITY', 'ORDERDATE', 'O_ORDERKEY', 'O_CUSTKEY']], left_on='P_PARTKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['P_COMMENT']).agg('sum', numeric_only=True)

customer

customer[(customer['C_NAME'].str.startswith('C')) & (customer['MKTSEGMENT'] != 'HOUSEHOLD') & (customer['C_NATIONKEY'] != 14) & (customer['C_ACCTBAL'] < 3807.09183982947)][['C_ACCTBAL', 'C_CUSTKEY', 'C_NATIONKEY', 'C_NAME', 'C_COMMENT']].merge(nation[(nation['N_COMMENT'] != 'r') | (nation['N_COMMENT'].str.startswith('l'))].merge(supplier[(supplier['S_PHONE'] != '32-') | (supplier['S_ADDRESS'].str.startswith('P'))].merge(partsupp[(partsupp['P_COMMENT'] != 'i') | (partsupp['PS_PARTKEY'] != 10)][['AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NATIONKEY'] >= 14) | (nation['N_NAME'] == 'G')][['N_REGIONKEY', 'N_NATIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

nation[['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT']].merge(customer[(customer['C_NAME'].str.startswith('C'))][['C_NAME', 'MKTSEGMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[(region['R_REGIONKEY'] < 2) & (region['R_REGIONKEY'] != 0)].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_REGIONKEY']).agg('mean', numeric_only=True)

supplier[(supplier['S_PHONE'].str.startswith('28-'))][['S_NATIONKEY']].merge(nation[['N_NAME', 'N_COMMENT', 'N_REGIONKEY']].merge(region[['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_NATIONKEY']).agg('min', numeric_only=True)

supplier[(supplier['S_NAME'].str.startswith('S')) & (supplier['S_COMMENT'] != 'u')][['S_ACCTBAL', 'S_SUPPKEY', 'S_PHONE', 'S_NATIONKEY', 'S_ADDRESS']].merge(partsupp[['P_COMMENT']].merge(region[(region['R_REGIONKEY'] > 0)], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='R_REGIONKEY').merge(region[['R_COMMENT', 'R_REGIONKEY']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='R_REGIONKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['P_COMMENT'].str.startswith('.')) | (partsupp['AVAILQTY'] < 3047)].merge(lineitem[(lineitem['TAX'] > 0.008286355907453595)][['QUANTITY', 'EXTENDEDPRICE', 'DISCOUNT', 'TAX']].merge(partsupp[['P_COMMENT', 'PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation.merge(supplier.merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[(region['R_COMMENT'] == 'l')][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_ACCTBAL']).agg('max', numeric_only=True)

orders[['TOTALPRICE', 'ORDERSTATUS', 'ORDERPRIORITY', 'ORDERDATE']].merge(partsupp, left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(nation[['N_NATIONKEY', 'N_NAME', 'N_COMMENT']].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='O_ORDERKEY', right_on='N_NATIONKEY')

customer[['C_NAME', 'C_NATIONKEY', 'C_ADDRESS', 'C_PHONE']].merge(nation.merge(customer[(customer['C_COMMENT'].str.startswith('g')) | (customer['MKTSEGMENT'] == 'AUTOMOBILE')][['C_NAME', 'C_NATIONKEY']].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[['C_NAME', 'C_CUSTKEY', 'C_PHONE', 'C_NATIONKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NATIONKEY'] > 8)].merge(supplier.merge(partsupp[(partsupp['P_COMMENT'] != 'x') | (partsupp['PS_SUPPKEY'] > 2839)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_COMMENT'].str.startswith('l')) & (nation['N_NAME'] != 'C')][['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT', 'N_NAME']].merge(region[['R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

partsupp[(partsupp['AVAILQTY'] >= 4653) & (partsupp['PS_PARTKEY'] <= 2)].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY')

supplier[(supplier['S_ADDRESS'].str.startswith('8')) | (supplier['S_PHONE'] == '26-')].merge(partsupp[(partsupp['P_COMMENT'].str.startswith('j')) | (partsupp['SUPPLYCOST'] > 798.0662883341545)].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['L_SUPPKEY'] < 2168)], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_NATIONKEY'] == 3) | (nation['N_NATIONKEY'] < 15)].merge(region[(region['R_COMMENT'] != 'l')][['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation[(nation['N_REGIONKEY'] >= 2) | (nation['N_NATIONKEY'] <= 22)], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp.merge(lineitem[['QUANTITY', 'SHIPDATE', 'L_SUPPKEY', 'L_PARTKEY']].merge(partsupp[(partsupp['SUPPLYCOST'] < 343.8894451782886) | (partsupp['AVAILQTY'] != 5167)], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[['QUANTITY', 'LINESTATUS']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

supplier[(supplier['S_PHONE'] == '2') & (supplier['S_ACCTBAL'] != 2373.260655976109) | (supplier['S_SUPPKEY'] > 195) | (supplier['S_NATIONKEY'] < 20)][['S_NAME', 'S_ACCTBAL', 'S_NATIONKEY', 'S_SUPPKEY']].merge(nation[(nation['N_REGIONKEY'] > 2)][['N_NATIONKEY', 'N_REGIONKEY']].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

partsupp[(partsupp['P_COMMENT'].str.startswith('b')) & (partsupp['AVAILQTY'] > 7778) | (partsupp['SUPPLYCOST'] >= 626.8204638568777)][['PS_SUPPKEY', 'PS_PARTKEY', 'P_COMMENT', 'SUPPLYCOST']].merge(lineitem[(lineitem['L_COMMENT'] == 'd') & (lineitem['L_ORDERKEY'] <= 1)][['LINESTATUS', 'TAX', 'EXTENDEDPRICE']].merge(customer[(customer['C_PHONE'] != '25-') | (customer['C_NATIONKEY'] >= 3)].merge(nation[(nation['N_NATIONKEY'] != 0)][['N_REGIONKEY', 'N_COMMENT']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY')

orders[['O_COMMENT', 'ORDERPRIORITY']].merge(supplier.merge(partsupp[(partsupp['PS_PARTKEY'] < 9)].merge(lineitem[['RETURNFLAG']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] >= 5760) & (partsupp['P_COMMENT'].str.startswith('v'))].merge(lineitem[(lineitem['L_PARTKEY'] > 41940) | (lineitem['QUANTITY'] >= 6)], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='S_SUPPKEY')

orders[['SHIPPRIORITY', 'CLERK', 'O_CUSTKEY', 'ORDERDATE']].merge(customer.merge(orders[['TOTALPRICE', 'ORDERPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['SHIPPRIORITY', 'TOTALPRICE', 'ORDERSTATUS']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_COMMENT'] != 'f') | (customer['C_ACCTBAL'] < 2943.01905260685)][['C_ADDRESS', 'MKTSEGMENT']], left_on='O_CUSTKEY', right_on='C_CUSTKEY')

region[['R_REGIONKEY', 'R_COMMENT', 'R_NAME']].merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] != 'r')][['N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NAME', 'N_COMMENT', 'N_NATIONKEY']].merge(supplier[(supplier['S_NAME'] != 'S')], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[['S_NAME', 'S_ADDRESS']].merge(partsupp[['SUPPLYCOST']], left_on='S_SUPPKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT', 'R_REGIONKEY']).agg('sum', numeric_only=True)

customer[(customer['C_NAME'] == 'C') & (customer['C_CUSTKEY'] >= 62) & (customer['C_COMMENT'] != 'u')][['C_ADDRESS', 'C_CUSTKEY']].merge(orders[(orders['O_COMMENT'].str.startswith('w'))], left_on='C_CUSTKEY', right_on='O_CUSTKEY')

nation.merge(customer[(customer['C_ADDRESS'].str.startswith('n'))].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[['S_COMMENT']].merge(nation[(nation['N_NATIONKEY'] >= 14) | (nation['N_REGIONKEY'] >= 0)], left_on='S_SUPPKEY', right_on='N_NATIONKEY').merge(orders[(orders['O_COMMENT'] != 'd') & (orders['TOTALPRICE'] > 185026.85373633195)], left_on='S_SUPPKEY', right_on='O_ORDERKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_REGIONKEY', 'N_COMMENT']).agg('count')

lineitem[['L_SUPPKEY', 'LINENUMBER', 'QUANTITY', 'SHIPDATE']].merge(partsupp[(partsupp['AVAILQTY'] > 1766) | (partsupp['AVAILQTY'] > 4419)].merge(lineitem[(lineitem['DISCOUNT'] <= 0.0904636423576171)][['DISCOUNT']].merge(partsupp[(partsupp['P_COMMENT'] == 'the') & (partsupp['PS_SUPPKEY'] == 6601)], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['PS_PARTKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['PS_PARTKEY', 'P_COMMENT', 'AVAILQTY', 'PS_SUPPKEY']].merge(supplier[['S_ACCTBAL', 'S_COMMENT']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY')

orders[(orders['ORDERDATE'] < '1998-07-21')][['O_CUSTKEY']].merge(customer[(customer['C_NAME'] == 'C')].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_CUSTKEY'] != 99) & (customer['C_NATIONKEY'] == 21)].merge(nation[(nation['N_NATIONKEY'] == 16) | (nation['N_COMMENT'] == 'y')][['N_NAME', 'N_COMMENT']].merge(supplier[['S_ADDRESS', 'S_ACCTBAL', 'S_COMMENT']], left_on='N_NATIONKEY', right_on='S_SUPPKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_COMMENT'] == 'n')][['MKTSEGMENT', 'C_NAME', 'C_COMMENT', 'C_ACCTBAL']].merge(lineitem[(lineitem['QUANTITY'] == 8) & (lineitem['LINENUMBER'] <= 5)][['L_ORDERKEY', 'QUANTITY', 'EXTENDEDPRICE']].merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(orders[(orders['O_COMMENT'].str.startswith('r')) | (orders['ORDERDATE'] != '1992-01-13')].merge(customer[['MKTSEGMENT', 'C_ACCTBAL']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_ORDERKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

orders[['O_ORDERKEY', 'O_COMMENT']]

part[(part['PT_COMMENT'].str.startswith('s')) | (part['MFGR'].isin(['Manufacturer#5', 'Manufacturer#3', 'Manufacturer#1', 'Manufacturer#2', 'Manufacturer#4']))].merge(partsupp[(partsupp['P_COMMENT'] == 'c') & (partsupp['SUPPLYCOST'] < 818.8004546007882)].merge(supplier[['S_COMMENT', 'S_SUPPKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(part[(part['BRAND'] != 'Brand#54')], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

partsupp[['P_COMMENT']].merge(nation.merge(region[(region['R_COMMENT'].str.startswith('l'))], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY').groupby(by=['P_COMMENT']).agg('min', numeric_only=True)

orders[(orders['ORDERPRIORITY'] != '2-HIGH')][['O_CUSTKEY', 'ORDERSTATUS']].merge(customer[(customer['C_ADDRESS'].str.startswith('3')) | (customer['C_PHONE'].str.startswith('18-'))][['C_CUSTKEY', 'C_PHONE']].merge(orders[['ORDERSTATUS']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

region[(region['R_NAME'].str.startswith('ASI')) & (region['R_NAME'].str.startswith('ASI'))].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] != 2) & (nation['N_NAME'] != 'C')][['N_COMMENT']].merge(part, left_on='N_NATIONKEY', right_on='P_PARTKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME', 'R_REGIONKEY']).agg('mean', numeric_only=True)

partsupp[(partsupp['SUPPLYCOST'] != 955.5797120642003)][['PS_PARTKEY', 'P_COMMENT', 'PS_SUPPKEY']].merge(part[(part['MFGR'] != 'Manufacturer#3') & (part['MFGR'].isin(['Manufacturer#3', 'Manufacturer#1', 'Manufacturer#4']))][['PT_COMMENT', 'P_NAME', 'CONTAINER', 'P_PARTKEY']].merge(partsupp[(partsupp['PS_SUPPKEY'] > 4223)][['P_COMMENT', 'PS_PARTKEY', 'SUPPLYCOST']].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_PARTKEY'] <= 23) | (partsupp['P_COMMENT'] == 'c')], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[(part['BRAND'] != 'Brand#21')][['BRAND']], left_on='PS_PARTKEY', right_on='P_PARTKEY')

nation.merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[(region['R_REGIONKEY'] > 0) | (region['R_NAME'].str.startswith('A'))][['R_COMMENT', 'R_NAME']].merge(customer[(customer['C_NATIONKEY'] >= 22)][['C_NAME']], left_on='R_REGIONKEY', right_on='C_CUSTKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_NAME']).agg('max', numeric_only=True)

partsupp.merge(lineitem[['L_COMMENT', 'TAX', 'DISCOUNT']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['RECEIPTDATE'] > '1992-05-02') & (lineitem['COMMITDATE'] <= '1998-10-16')].merge(partsupp[['AVAILQTY', 'SUPPLYCOST', 'PS_PARTKEY', 'P_COMMENT']].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').groupby(by=['P_COMMENT']).agg('max', numeric_only=True)

partsupp.merge(lineitem.merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['SUPPLYCOST', 'PS_SUPPKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY')

part[(part['P_PARTKEY'] == 153) | (part['CONTAINER'].str.startswith('SM')) | (part['TYPE'] != 'STA') & (part['CONTAINER'].str.startswith('SM'))][['MFGR', 'P_NAME', 'CONTAINER', 'RETAILPRICE']].merge(region[(region['R_REGIONKEY'] >= 3)][['R_NAME']].merge(nation[(nation['N_REGIONKEY'] > 2)], left_on='R_REGIONKEY', right_on='N_NATIONKEY').merge(lineitem[['SHIPMODE']], left_on='R_REGIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='P_PARTKEY', right_on='R_REGIONKEY').merge(supplier[(supplier['S_NATIONKEY'] == 0)].merge(partsupp[(partsupp['SUPPLYCOST'] <= 363.18249441663096) | (partsupp['PS_SUPPKEY'] < 5278)].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='P_PARTKEY', right_on='S_SUPPKEY').groupby(by=['RETAILPRICE']).agg('mean', numeric_only=True)

partsupp[(partsupp['AVAILQTY'] > 3148)][['P_COMMENT', 'PS_PARTKEY', 'AVAILQTY', 'PS_SUPPKEY']]

orders[(orders['O_COMMENT'] == ',') | (orders['CLERK'] != 'C')].merge(lineitem[(lineitem['RECEIPTDATE'] != '1992-05-02') | (lineitem['TAX'] < 0.01119561871015497)][['RETURNFLAG']].merge(supplier[['S_NAME', 'S_SUPPKEY', 'S_COMMENT']].merge(partsupp[(partsupp['PS_SUPPKEY'] != 4579) | (partsupp['AVAILQTY'] <= 4623)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY').merge(partsupp[(partsupp['AVAILQTY'] <= 7601)][['P_COMMENT', 'AVAILQTY']].merge(lineitem[(lineitem['TAX'] <= 0.06845259611374534) & (lineitem['RECEIPTDATE'] > '1998-11-06')], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='O_ORDERKEY', right_on='L_ORDERKEY')

part.groupby(by=['CONTAINER']).agg('sum', numeric_only=True)

region[(region['R_COMMENT'].str.startswith('u')) | (region['R_REGIONKEY'] < 1)][['R_REGIONKEY', 'R_COMMENT']].merge(nation[(nation['N_NAME'] == 'I') & (nation['N_REGIONKEY'] == 2)][['N_NATIONKEY', 'N_NAME', 'N_REGIONKEY']].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[(customer['MKTSEGMENT'].isin(['BUILDING', 'HOUSEHOLD', 'AUTOMOBILE', 'FURNITURE', 'MACHINERY'])) & (customer['C_NAME'] == 'C')][['MKTSEGMENT', 'C_ADDRESS', 'C_PHONE', 'C_ACCTBAL']].merge(lineitem[(lineitem['TAX'] < 0.07465879100174436) | (lineitem['RECEIPTDATE'] <= '1998-11-06')][['L_ORDERKEY', 'RETURNFLAG', 'L_SUPPKEY', 'L_COMMENT']], left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] != 'U') | (nation['N_REGIONKEY'] <= 1)].merge(customer.merge(orders[(orders['CLERK'] != 'C') | (orders['SHIPPRIORITY'] >= 0)], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer.merge(nation[(nation['N_NAME'].str.startswith('M')) & (nation['N_NATIONKEY'] == 7)], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'].str.startswith('M')) & (nation['N_REGIONKEY'] == 0)][['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

customer

lineitem[(lineitem['LINESTATUS'] != 'O')][['L_PARTKEY', 'RECEIPTDATE', 'LINENUMBER']].merge(partsupp[(partsupp['PS_SUPPKEY'] != 4968)][['PS_SUPPKEY']].merge(lineitem[(lineitem['SHIPDATE'] != '1998-10-30') & (lineitem['L_COMMENT'] == 'a')], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier[(supplier['S_PHONE'].str.startswith('17-')) & (supplier['S_COMMENT'] != 's')], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_PARTKEY'] > 27) & (partsupp['SUPPLYCOST'] > 489.132960266291)].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY')

partsupp[(partsupp['P_COMMENT'] == 'a') & (partsupp['SUPPLYCOST'] != 789.5940284081753)][['P_COMMENT', 'PS_PARTKEY']].merge(part.merge(partsupp[['AVAILQTY', 'SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[['MFGR']], left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['PS_PARTKEY', 'P_COMMENT']).agg('count')

region.merge(nation[(nation['N_NATIONKEY'] > 1) & (nation['N_NAME'] == 'P')][['N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_COMMENT', 'N_REGIONKEY']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

nation[(nation['N_REGIONKEY'] == 0) & (nation['N_NATIONKEY'] > 0)][['N_REGIONKEY']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[['R_NAME']].merge(nation[['N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_NATIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY')

supplier[(supplier['S_NATIONKEY'] == 4) & (supplier['S_NAME'].str.startswith('S'))][['S_ACCTBAL', 'S_NAME', 'S_COMMENT', 'S_ADDRESS', 'S_NATIONKEY']].merge(nation.merge(customer[(customer['C_CUSTKEY'] < 21)].merge(nation[(nation['N_REGIONKEY'] <= 0)][['N_COMMENT', 'N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_ADDRESS']).agg('min', numeric_only=True)

partsupp[['PS_SUPPKEY', 'AVAILQTY', 'PS_PARTKEY']]

orders[['CLERK', 'TOTALPRICE', 'ORDERDATE', 'O_ORDERKEY']].groupby(by=['TOTALPRICE']).agg('sum', numeric_only=True)

nation.groupby(by=['N_COMMENT', 'N_REGIONKEY']).agg('min', numeric_only=True)

customer.merge(orders.merge(customer[(customer['C_NAME'].str.startswith('C')) & (customer['C_PHONE'] != '13-')], left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_ACCTBAL'] < 5385.316057911651)][['C_ADDRESS', 'C_ACCTBAL', 'C_CUSTKEY', 'C_PHONE']].merge(orders[(orders['ORDERSTATUS'] == 'O')][['TOTALPRICE', 'O_CUSTKEY', 'CLERK']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_NATIONKEY'] == 14) | (nation['N_COMMENT'] != 'a')], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[(orders['TOTALPRICE'] == 217410.7445090058)][['SHIPPRIORITY', 'O_ORDERKEY']].merge(lineitem[(lineitem['L_SUPPKEY'] < 8900)], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['LINENUMBER'] == 1) | (lineitem['L_PARTKEY'] != 29222)][['LINENUMBER']].merge(nation[(nation['N_NAME'] != 'M')][['N_NATIONKEY', 'N_REGIONKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

customer.groupby(by=['C_COMMENT']).agg('sum', numeric_only=True)

customer[['C_CUSTKEY', 'C_COMMENT', 'C_PHONE', 'C_ADDRESS']]

partsupp.merge(lineitem.merge(partsupp[(partsupp['SUPPLYCOST'] > 172.81436410304923)], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY')

part[(part['P_PARTKEY'] < 128) | (part['BRAND'] == 'Brand#13') & (part['TYPE'] == 'P')][['P_PARTKEY', 'P_NAME']]

partsupp

part[(part['P_NAME'] != 'bis')].merge(partsupp[(partsupp['SUPPLYCOST'] != 649.9676184715582) & (partsupp['SUPPLYCOST'] != 363.7590762366944)][['PS_PARTKEY', 'AVAILQTY']].merge(part[['CONTAINER', 'PT_COMMENT', 'BRAND']], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem.merge(partsupp[['P_COMMENT', 'PS_PARTKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['MFGR', 'BRAND']).agg('max', numeric_only=True)

part[(part['P_NAME'].str.startswith('b')) | (part['TYPE'] == 'P') | (part['MFGR'] == 'Manufacturer#5')].merge(partsupp[(partsupp['AVAILQTY'] != 5924)].merge(part[['TYPE', 'MFGR', 'CONTAINER', 'P_NAME']].merge(partsupp[['PS_SUPPKEY', 'AVAILQTY', 'P_COMMENT']], left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(supplier[(supplier['S_ADDRESS'] == 's') & (supplier['S_SUPPKEY'] == 74)].merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_PARTKEY'] <= 11)][['AVAILQTY']].merge(region[(region['R_NAME'] == 'AME') | (region['R_REGIONKEY'] != 1)][['R_NAME']].merge(customer[(customer['C_CUSTKEY'] >= 27) & (customer['C_CUSTKEY'] <= 9)], left_on='R_REGIONKEY', right_on='C_CUSTKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='R_REGIONKEY').merge(part.merge(partsupp[(partsupp['SUPPLYCOST'] != 790.5554707597129)], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_PARTKEY'] >= 3) & (partsupp['PS_PARTKEY'] >= 30)][['PS_PARTKEY', 'PS_SUPPKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY')

part[(part['PT_COMMENT'] == 'kag') | (part['PT_COMMENT'].str.startswith('l')) | (part['PT_COMMENT'] == 'k') | (part['SIZE'] <= 39)][['RETAILPRICE', 'P_NAME', 'MFGR']].merge(lineitem[(lineitem['TAX'] < 0.0166408241992064) & (lineitem['L_PARTKEY'] > 94953)], left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(orders[['TOTALPRICE', 'CLERK', 'SHIPPRIORITY']].merge(region[(region['R_REGIONKEY'] < 2) & (region['R_COMMENT'] != 'g')][['R_NAME']].merge(customer[(customer['C_ADDRESS'].str.startswith('J'))], left_on='R_REGIONKEY', right_on='C_CUSTKEY'), left_on='O_ORDERKEY', right_on='R_REGIONKEY').merge(region[['R_COMMENT']], left_on='O_ORDERKEY', right_on='R_REGIONKEY'), left_on='P_PARTKEY', right_on='O_ORDERKEY')

part

part[(part['RETAILPRICE'] >= 984.7203697009463)].merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_PARTKEY'] >= 44) | (partsupp['AVAILQTY'] > 5720)][['AVAILQTY', 'PS_PARTKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['AVAILQTY', 'P_COMMENT', 'SUPPLYCOST', 'PS_SUPPKEY']].merge(lineitem[(lineitem['TAX'] == 0.019633760281143744)][['COMMITDATE', 'SHIPDATE', 'RECEIPTDATE', 'QUANTITY']].merge(supplier[(supplier['S_SUPPKEY'] != 52)], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['PT_COMMENT']).agg('min', numeric_only=True)

supplier[(supplier['S_COMMENT'] == 'r') & (supplier['S_PHONE'].str.startswith('1')) & (supplier['S_ADDRESS'] == 'W') | (supplier['S_NATIONKEY'] == 15)].merge(partsupp[(partsupp['P_COMMENT'] == 'f')][['SUPPLYCOST', 'AVAILQTY']].merge(orders[(orders['CLERK'].str.startswith('C'))], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='O_ORDERKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[['N_NAME', 'N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY']].merge(region[(region['R_REGIONKEY'] < 2) & (region['R_REGIONKEY'] == 1)][['R_NAME', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region.merge(nation[['N_NAME', 'N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_NAME', 'S_NATIONKEY']).agg('min', numeric_only=True)

customer.merge(orders[['CLERK', 'TOTALPRICE', 'ORDERPRIORITY']].merge(customer, left_on='O_ORDERKEY', right_on='C_CUSTKEY').merge(nation.merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='O_ORDERKEY', right_on='N_NATIONKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

supplier[(supplier['S_COMMENT'] != 'n') | (supplier['S_COMMENT'] != '!') | (supplier['S_NATIONKEY'] <= 15) | (supplier['S_NAME'] == 'S')][['S_NATIONKEY', 'S_ACCTBAL', 'S_COMMENT', 'S_NAME', 'S_SUPPKEY']]

lineitem[['LINESTATUS', 'COMMITDATE', 'RECEIPTDATE', 'EXTENDEDPRICE']].groupby(by=['EXTENDEDPRICE', 'COMMITDATE']).agg('count')

orders.merge(lineitem.merge(partsupp[['PS_SUPPKEY', 'SUPPLYCOST']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY')

region[(region['R_NAME'] != 'M') & (region['R_REGIONKEY'] <= 1)][['R_NAME']].merge(partsupp[(partsupp['P_COMMENT'] == 'are')].merge(supplier[['S_ACCTBAL', 'S_COMMENT', 'S_ADDRESS']].merge(lineitem[['RETURNFLAG', 'LINESTATUS', 'L_ORDERKEY', 'SHIPINSTRUCT']], left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[(lineitem['L_ORDERKEY'] < 57) | (lineitem['RETURNFLAG'] == 'A')].merge(partsupp[(partsupp['SUPPLYCOST'] < 582.9152666869911)][['PS_SUPPKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='R_REGIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(customer[(customer['C_PHONE'].str.startswith('2'))][['C_CUSTKEY']].merge(orders[['ORDERPRIORITY']].merge(part[['SIZE', 'RETAILPRICE', 'BRAND', 'P_NAME']], left_on='O_ORDERKEY', right_on='P_PARTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='R_REGIONKEY', right_on='C_CUSTKEY').merge(part.merge(partsupp[(partsupp['PS_PARTKEY'] == 29)][['P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='R_REGIONKEY', right_on='P_PARTKEY').groupby(by=['R_NAME']).agg('sum', numeric_only=True)

region[(region['R_NAME'] != 'A') | (region['R_REGIONKEY'] <= 0)].merge(nation[['N_REGIONKEY']].merge(region[(region['R_REGIONKEY'] > 0) | (region['R_REGIONKEY'] >= 0)][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_COMMENT'] == 't')][['N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(region[(region['R_REGIONKEY'] > 2)], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[['R_REGIONKEY', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('count')

customer.merge(orders.merge(lineitem[(lineitem['SHIPMODE'].isin(['RAIL', 'AIR', 'TRUCK', 'FOB', 'MAIL', 'SHIP', 'REG AIR'])) & (lineitem['SHIPINSTRUCT'] != 'NONE')][['L_SUPPKEY', 'SHIPMODE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_PHONE', 'MKTSEGMENT']).agg('sum', numeric_only=True)

supplier[['S_PHONE', 'S_ADDRESS', 'S_ACCTBAL', 'S_NAME', 'S_NATIONKEY']]

orders[(orders['ORDERSTATUS'].isin(['F'])) & (orders['ORDERPRIORITY'] == '2-HIGH') | (orders['ORDERSTATUS'].isin(['P', 'O', 'F']))][['O_ORDERKEY', 'TOTALPRICE', 'O_CUSTKEY', 'ORDERDATE']].merge(customer[(customer['C_COMMENT'].str.startswith('a')) | (customer['C_NATIONKEY'] != 14)][['C_COMMENT', 'C_NAME']].merge(lineitem[['SHIPMODE', 'L_COMMENT', 'LINESTATUS']], left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(region, left_on='C_CUSTKEY', right_on='R_REGIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['ORDERDATE']).agg('mean', numeric_only=True)

orders[['ORDERSTATUS', 'ORDERPRIORITY']].merge(partsupp.merge(supplier[(supplier['S_NAME'].str.startswith('S'))][['S_ADDRESS', 'S_COMMENT']].merge(lineitem, left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).groupby(by=['ORDERPRIORITY']).agg('mean', numeric_only=True)

region[(region['R_REGIONKEY'] < 2) | (region['R_NAME'] != 'AME') & (region['R_REGIONKEY'] != 0)][['R_REGIONKEY', 'R_NAME']].merge(nation[['N_NAME', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(customer[['C_PHONE', 'C_ADDRESS']].merge(part[(part['CONTAINER'].str.startswith('LG')) & (part['SIZE'] >= 6)], left_on='C_CUSTKEY', right_on='P_PARTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_SUPPKEY'] == 150)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

customer[(customer['C_CUSTKEY'] < 71) & (customer['C_ACCTBAL'] == 4321.182577019364)].merge(nation[(nation['N_COMMENT'] == 'c') & (nation['N_COMMENT'].str.startswith('l'))][['N_NAME', 'N_COMMENT', 'N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY')

lineitem[(lineitem['SHIPINSTRUCT'] != 'DELIVER IN PERSON') | (lineitem['SHIPDATE'] == '1992-04-27') & (lineitem['LINESTATUS'] == 'O')][['L_ORDERKEY', 'TAX']].groupby(by=['L_ORDERKEY']).agg('sum', numeric_only=True)

orders.merge(customer[(customer['C_NAME'].str.startswith('C'))].merge(orders[['ORDERPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[['N_NATIONKEY', 'N_NAME']].merge(supplier[(supplier['S_NATIONKEY'] < 5)], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[['MKTSEGMENT']].merge(region[(region['R_REGIONKEY'] < 1)].merge(nation[['N_REGIONKEY', 'N_NAME', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='C_CUSTKEY', right_on='R_REGIONKEY').merge(nation, left_on='C_CUSTKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[(lineitem['LINENUMBER'] <= 1)][['LINENUMBER', 'QUANTITY', 'COMMITDATE']].merge(orders[['TOTALPRICE', 'SHIPPRIORITY', 'O_COMMENT']].merge(supplier[['S_NATIONKEY']], left_on='O_ORDERKEY', right_on='S_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY')

nation[(nation['N_COMMENT'] == 'h') | (nation['N_NAME'].str.startswith('S')) & (nation['N_REGIONKEY'] == 1) | (nation['N_NAME'] == 'C')].groupby(by=['N_NATIONKEY', 'N_COMMENT']).agg('mean', numeric_only=True)

nation[(nation['N_NAME'] == 'C')][['N_REGIONKEY', 'N_NATIONKEY']].merge(customer[['C_PHONE', 'C_COMMENT']].merge(nation[['N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY']], left_on='C_CUSTKEY', right_on='N_NATIONKEY').merge(nation[['N_COMMENT', 'N_NAME', 'N_NATIONKEY']].merge(supplier[['S_ADDRESS', 'S_ACCTBAL']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_CUSTKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[(customer['MKTSEGMENT'] != 'HOUSEHOLD') & (customer['C_NAME'] != 'C')][['C_PHONE']].merge(orders[['SHIPPRIORITY']], left_on='C_CUSTKEY', right_on='O_ORDERKEY').merge(orders.merge(lineitem[(lineitem['SHIPINSTRUCT'] != 'DELIVER IN PERSON') & (lineitem['SHIPDATE'] < '1992-04-27')][['L_PARTKEY', 'SHIPMODE', 'L_ORDERKEY', 'EXTENDEDPRICE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_ORDERKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_NATIONKEY', 'N_REGIONKEY']).agg('mean', numeric_only=True)

supplier[(supplier['S_ADDRESS'] == 'B') | (supplier['S_NATIONKEY'] >= 5) & (supplier['S_SUPPKEY'] != 15) | (supplier['S_NAME'].str.startswith('S'))].merge(partsupp.merge(lineitem[['SHIPMODE']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_ACCTBAL']).agg('mean', numeric_only=True)

customer[(customer['C_ADDRESS'] != 'L') | (customer['C_CUSTKEY'] != 23) | (customer['C_CUSTKEY'] <= 48)]

part[['P_PARTKEY', 'CONTAINER', 'BRAND', 'PT_COMMENT']].merge(partsupp[(partsupp['PS_PARTKEY'] < 29) | (partsupp['PS_SUPPKEY'] > 7085)], left_on='P_PARTKEY', right_on='PS_PARTKEY')

part[['P_NAME']].merge(partsupp[(partsupp['PS_SUPPKEY'] <= 1773) & (partsupp['P_COMMENT'] != 'are')].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[['S_ACCTBAL', 'S_ADDRESS', 'S_COMMENT']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(region.merge(nation.merge(supplier[['S_NATIONKEY', 'S_ACCTBAL']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_COMMENT', 'N_REGIONKEY', 'N_NAME']].merge(region[(region['R_REGIONKEY'] >= 1)], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='P_PARTKEY', right_on='R_REGIONKEY').merge(partsupp[(partsupp['SUPPLYCOST'] != 142.56775949408507)].merge(lineitem[(lineitem['L_SUPPKEY'] >= 4158)][['TAX']].merge(customer[['C_COMMENT', 'C_NATIONKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['QUANTITY'] < 11) | (lineitem['DISCOUNT'] > 0.0648497536199444)].merge(partsupp[(partsupp['AVAILQTY'] <= 5058)][['PS_SUPPKEY', 'PS_PARTKEY', 'P_COMMENT']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).groupby(by=['P_NAME']).agg('count')

customer[(customer['C_CUSTKEY'] == 53) & (customer['C_COMMENT'] == 'h') | (customer['C_ADDRESS'] == 'v')].merge(orders[(orders['O_ORDERKEY'] == 273)][['O_COMMENT', 'CLERK', 'ORDERPRIORITY']].merge(part[(part['P_NAME'] == 'n') & (part['PT_COMMENT'].str.startswith('u'))], left_on='O_ORDERKEY', right_on='P_PARTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation.merge(region[(region['R_NAME'].str.startswith('E'))].merge(nation[['N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[(supplier['S_COMMENT'] == 'o')], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_NATIONKEY']).agg('count')

part[['BRAND', 'PT_COMMENT', 'P_NAME', 'P_PARTKEY']]

region.merge(nation[(nation['N_NAME'].str.startswith('M')) | (nation['N_NATIONKEY'] <= 1)].merge(customer[(customer['MKTSEGMENT'].isin(['BUILDING', 'MACHINERY']))], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY')

region[(region['R_REGIONKEY'] <= 0)].merge(nation[(nation['N_REGIONKEY'] == 0)], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] != 2) & (nation['N_NAME'].str.startswith('J'))].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

region[(region['R_COMMENT'] != 'h') & (region['R_REGIONKEY'] > 1)][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_NATIONKEY'] != 18)][['N_COMMENT', 'N_NAME']].merge(orders[['ORDERSTATUS', 'O_ORDERKEY']], left_on='N_NATIONKEY', right_on='O_ORDERKEY').merge(orders[(orders['CLERK'] != 'C')].merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='N_NATIONKEY', right_on='O_ORDERKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT']).agg('count')

part[(part['BRAND'] != 'Brand#14')][['P_NAME', 'P_PARTKEY', 'TYPE']].merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY')

region[['R_REGIONKEY', 'R_NAME']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NAME', 'N_REGIONKEY', 'N_COMMENT']].merge(region[(region['R_REGIONKEY'] > 2)].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_NAME'] != 'AME') & (region['R_REGIONKEY'] <= 1)].merge(nation[['N_NATIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME', 'R_REGIONKEY']).agg('min', numeric_only=True)

lineitem[(lineitem['L_ORDERKEY'] <= 89) & (lineitem['EXTENDEDPRICE'] == 48579.79283991931)].merge(partsupp[(partsupp['PS_SUPPKEY'] > 4881) | (partsupp['AVAILQTY'] <= 1952)][['PS_SUPPKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(lineitem[(lineitem['L_SUPPKEY'] <= 1508)][['L_SUPPKEY', 'LINENUMBER', 'L_COMMENT']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY')

lineitem[(lineitem['L_ORDERKEY'] < 77) & (lineitem['L_PARTKEY'] == 180141) & (lineitem['L_PARTKEY'] < 84057)][['L_SUPPKEY', 'L_PARTKEY', 'LINENUMBER', 'COMMITDATE', 'LINESTATUS']].merge(partsupp[['P_COMMENT', 'AVAILQTY', 'SUPPLYCOST']], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['LINENUMBER', 'COMMITDATE']).agg('count')

orders.merge(lineitem[['COMMITDATE', 'L_ORDERKEY', 'RETURNFLAG', 'L_PARTKEY']].merge(partsupp[(partsupp['PS_PARTKEY'] == 21)], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_NATIONKEY'] > 8) & (customer['C_ADDRESS'] != 'f')], left_on='O_CUSTKEY', right_on='C_CUSTKEY')

customer[['C_NAME']].merge(lineitem[(lineitem['TAX'] <= 0.0667271929155687)][['QUANTITY', 'L_PARTKEY']].merge(partsupp[(partsupp['SUPPLYCOST'] >= 982.376983148599) | (partsupp['P_COMMENT'] == ' ')].merge(lineitem[(lineitem['L_COMMENT'].str.startswith('d')) & (lineitem['L_ORDERKEY'] != 127)], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['SUPPLYCOST'] == 691.7428673345097) | (partsupp['AVAILQTY'] <= 1235)][['P_COMMENT', 'PS_PARTKEY', 'PS_SUPPKEY', 'SUPPLYCOST']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(supplier[(supplier['S_ADDRESS'] == 'F')], left_on='C_CUSTKEY', right_on='S_SUPPKEY').merge(partsupp.merge(part[(part['RETAILPRICE'] < 1028.420954027445) & (part['MFGR'].isin(['Manufacturer#3', 'Manufacturer#5', 'Manufacturer#2', 'Manufacturer#1', 'Manufacturer#4']))][['CONTAINER']].merge(region[(region['R_NAME'] != 'M') & (region['R_NAME'] == 'AME')][['R_NAME', 'R_REGIONKEY']], left_on='P_PARTKEY', right_on='R_REGIONKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='C_CUSTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).groupby(by=['C_NAME']).agg('max', numeric_only=True)

nation[(nation['N_NAME'].str.startswith('S')) | (nation['N_NAME'] == 'J') & (nation['N_REGIONKEY'] == 0)].merge(region[(region['R_COMMENT'] != 'h')][['R_COMMENT', 'R_NAME']].merge(nation[(nation['N_NAME'] == 'P')].merge(customer[(customer['MKTSEGMENT'].isin(['MACHINERY', 'BUILDING', 'HOUSEHOLD', 'FURNITURE']))], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_NATIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier.merge(nation[(nation['N_NATIONKEY'] < 10)].merge(region[(region['R_COMMENT'] == 'g')], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[['R_REGIONKEY', 'R_COMMENT']].merge(nation[['N_REGIONKEY']].merge(region[(region['R_COMMENT'] == 'l')], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_COMMENT', 'N_NATIONKEY']).agg('max', numeric_only=True)

partsupp.merge(supplier[['S_ACCTBAL']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['P_COMMENT']).agg('mean', numeric_only=True)

customer[(customer['C_ADDRESS'].str.startswith('U')) & (customer['C_NATIONKEY'] < 1) | (customer['C_COMMENT'] != 'n')][['C_NAME']].merge(supplier.merge(partsupp[(partsupp['P_COMMENT'] == 'k') & (partsupp['P_COMMENT'] != 'x')][['PS_SUPPKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] < 4732) | (partsupp['SUPPLYCOST'] != 614.9504261662539)][['SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT']].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='C_CUSTKEY', right_on='S_SUPPKEY').merge(supplier[(supplier['S_SUPPKEY'] == 59)].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='C_CUSTKEY', right_on='S_SUPPKEY')

orders[(orders['O_CUSTKEY'] > 110061) & (orders['ORDERSTATUS'].isin(['O', 'P', 'F']))][['ORDERSTATUS', 'SHIPPRIORITY']].groupby(by=['ORDERSTATUS', 'SHIPPRIORITY']).agg('min', numeric_only=True)

supplier[(supplier['S_COMMENT'] == 'y') & (supplier['S_NATIONKEY'] > 4)][['S_NAME', 'S_ADDRESS', 'S_ACCTBAL', 'S_PHONE', 'S_NATIONKEY']]

partsupp.merge(lineitem[(lineitem['SHIPMODE'] != 'TRUCK') | (lineitem['RETURNFLAG'].isin(['A']))][['L_ORDERKEY', 'LINENUMBER', 'LINESTATUS']].merge(orders[(orders['O_COMMENT'] != 'n') | (orders['ORDERDATE'] > '1992-01-13')][['SHIPPRIORITY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['ORDERDATE'] > '1992-01-13') | (orders['SHIPPRIORITY'] > 0)], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier[(supplier['S_NAME'] != 'S') & (supplier['S_PHONE'].str.startswith('3'))][['S_SUPPKEY', 'S_ADDRESS', 'S_ACCTBAL']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY')

orders[(orders['ORDERDATE'] > '1998-07-21')][['O_ORDERKEY', 'ORDERSTATUS', 'TOTALPRICE', 'ORDERPRIORITY', 'O_COMMENT']].groupby(by=['O_COMMENT', 'O_ORDERKEY']).agg('count')

lineitem[(lineitem['SHIPMODE'] != 'SHIP') | (lineitem['SHIPMODE'].isin(['TRUCK'])) | (lineitem['RETURNFLAG'] != 'A')][['RECEIPTDATE', 'L_PARTKEY']].merge(partsupp[['AVAILQTY', 'PS_PARTKEY', 'PS_SUPPKEY']].merge(lineitem[['QUANTITY', 'SHIPINSTRUCT']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY')

supplier[(supplier['S_ACCTBAL'] >= 7898.414729925605)][['S_SUPPKEY', 'S_ADDRESS', 'S_NAME', 'S_ACCTBAL', 'S_NATIONKEY']].merge(partsupp[(partsupp['SUPPLYCOST'] > 834.4759346037744) & (partsupp['SUPPLYCOST'] != 477.84639569551683)].merge(part[(part['P_NAME'].str.startswith('w')) & (part['RETAILPRICE'] <= 916.3182264780347)][['RETAILPRICE', 'CONTAINER']].merge(partsupp[['PS_PARTKEY']], left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(supplier[(supplier['S_SUPPKEY'] > 164) & (supplier['S_SUPPKEY'] >= 185)], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[['N_COMMENT', 'N_NAME']].merge(orders[(orders['TOTALPRICE'] != 45001.51804256465) | (orders['O_ORDERKEY'] >= 692)][['O_CUSTKEY', 'ORDERPRIORITY', 'O_COMMENT']], left_on='N_NATIONKEY', right_on='O_ORDERKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY')

supplier.groupby(by=['S_NATIONKEY', 'S_PHONE']).agg('min', numeric_only=True)

lineitem[(lineitem['SHIPINSTRUCT'].isin(['COLLECT COD', 'NONE', 'TAKE BACK RETURN'])) | (lineitem['EXTENDEDPRICE'] < 68601.33660400123)]

supplier.merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT', 'N_NAME']].merge(region[(region['R_NAME'].str.startswith('A'))].merge(nation[['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_ADDRESS']).agg('count')

supplier.merge(partsupp[(partsupp['AVAILQTY'] != 2674)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

supplier[(supplier['S_COMMENT'] != '.') & (supplier['S_ACCTBAL'] >= 3506.3653508128573) & (supplier['S_SUPPKEY'] < 182)].merge(partsupp[(partsupp['AVAILQTY'] > 3779) & (partsupp['SUPPLYCOST'] < 43.598543534572286)][['AVAILQTY', 'SUPPLYCOST', 'PS_PARTKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation.merge(region[['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_COMMENT'] != 'h') | (region['R_REGIONKEY'] == 2)][['R_REGIONKEY']].merge(nation[(nation['N_NATIONKEY'] == 15)], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY')

customer[(customer['C_NATIONKEY'] > 11) & (customer['C_ACCTBAL'] != 1478.2669709715883) | (customer['C_NATIONKEY'] != 11) | (customer['C_COMMENT'] == 'i')].merge(nation[(nation['N_REGIONKEY'] >= 1)][['N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY']].merge(region[(region['R_REGIONKEY'] > 1)][['R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[(supplier['S_ADDRESS'].str.startswith(' '))][['S_SUPPKEY', 'S_NATIONKEY', 'S_PHONE']].merge(partsupp[(partsupp['AVAILQTY'] > 6967)][['AVAILQTY', 'SUPPLYCOST', 'P_COMMENT', 'PS_SUPPKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[(orders['TOTALPRICE'] > 340760.53011431714) & (orders['SHIPPRIORITY'] != 0)], left_on='C_CUSTKEY', right_on='O_CUSTKEY')

customer[(customer['MKTSEGMENT'] == 'MACHINERY') | (customer['C_NAME'] != 'C') | (customer['C_NAME'].str.startswith('C'))].merge(orders[['SHIPPRIORITY']].merge(customer[(customer['C_NAME'] != 'C') | (customer['C_COMMENT'].str.startswith('y'))][['C_PHONE']], left_on='O_ORDERKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_REGIONKEY'] == 3) | (nation['N_COMMENT'].str.startswith('l'))].merge(region.merge(nation[(nation['N_NAME'] == 'P') & (nation['N_NAME'] == 'V')][['N_REGIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_COMMENT'] == 'l') | (region['R_COMMENT'] != 'h')].merge(nation[['N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

partsupp[(partsupp['AVAILQTY'] < 3593) | (partsupp['SUPPLYCOST'] == 622.0011802196177)].merge(supplier[(supplier['S_SUPPKEY'] == 173)].merge(partsupp[(partsupp['AVAILQTY'] == 2953)][['P_COMMENT']].merge(supplier[(supplier['S_COMMENT'] != 'h')], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[(lineitem['L_ORDERKEY'] <= 98)], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[['EXTENDEDPRICE', 'DISCOUNT', 'COMMITDATE']].merge(region[(region['R_NAME'] == 'AME') | (region['R_NAME'] != 'AME')], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY')

lineitem[(lineitem['TAX'] >= 0.02278090235837679) & (lineitem['LINENUMBER'] == 5)].groupby(by=['LINESTATUS']).agg('mean', numeric_only=True)

supplier[(supplier['S_ADDRESS'] == '9')].merge(nation[(nation['N_REGIONKEY'] == 1)][['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']].merge(customer[(customer['C_PHONE'] == '25-') & (customer['C_COMMENT'] == 'f')], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation, left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(supplier[(supplier['S_NAME'] == 'S')][['S_SUPPKEY', 'S_NAME', 'S_COMMENT', 'S_NATIONKEY']].merge(partsupp[['PS_PARTKEY', 'PS_SUPPKEY', 'SUPPLYCOST', 'AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_ADDRESS']).agg('mean', numeric_only=True)

part[(part['TYPE'] == 'P') | (part['BRAND'].isin(['Brand#32', 'Brand#14', 'Brand#25', 'Brand#35', 'Brand#42', 'Brand#51', 'Brand#53', 'Brand#12', 'Brand#45', 'Brand#23', 'Brand#44', 'Brand#31', 'Brand#24', 'Brand#21', 'Brand#13', 'Brand#43', 'Brand#34', 'Brand#55', 'Brand#52', 'Brand#41', 'Brand#11', 'Brand#15', 'Brand#22'])) & (part['TYPE'] == 'STA')].merge(partsupp[['PS_PARTKEY', 'SUPPLYCOST']], left_on='P_PARTKEY', right_on='PS_PARTKEY')

part[(part['TYPE'] == 'STA')][['MFGR', 'TYPE', 'P_NAME', 'PT_COMMENT', 'P_PARTKEY']].merge(partsupp[(partsupp['PS_PARTKEY'] == 35) & (partsupp['AVAILQTY'] > 8901)].merge(lineitem[(lineitem['L_PARTKEY'] == 159378)][['RECEIPTDATE', 'RETURNFLAG', 'L_SUPPKEY']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['LINESTATUS'].isin(['O', 'F'])) & (lineitem['EXTENDEDPRICE'] == 41133.967729051015)].merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

part[(part['CONTAINER'] != 'LG') & (part['RETAILPRICE'] != 1094.008429214255) & (part['P_NAME'].str.startswith('k')) | (part['TYPE'] != 'L')].merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(part[['TYPE', 'BRAND', 'SIZE']].merge(lineitem[['RETURNFLAG', 'COMMITDATE', 'SHIPDATE']], left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[(part['P_PARTKEY'] == 148) | (part['CONTAINER'] == 'SM')][['TYPE', 'P_NAME', 'RETAILPRICE']].merge(lineitem[['RECEIPTDATE', 'DISCOUNT']], left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['AVAILQTY'] == 4502) & (partsupp['PS_PARTKEY'] >= 47)][['PS_SUPPKEY', 'P_COMMENT', 'AVAILQTY', 'PS_PARTKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY')

part.groupby(by=['MFGR']).agg('count')

customer[['MKTSEGMENT', 'C_PHONE', 'C_NATIONKEY', 'C_COMMENT']].merge(nation.merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(region[['R_COMMENT', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

orders[(orders['ORDERPRIORITY'].isin(['5-LOW', '2-HIGH'])) | (orders['CLERK'].str.startswith('C')) & (orders['ORDERPRIORITY'] == '5-LOW')].merge(customer.merge(nation[(nation['N_REGIONKEY'] >= 0)][['N_NATIONKEY', 'N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_REGIONKEY'] < 3) & (nation['N_COMMENT'] != 's')][['N_NAME', 'N_NATIONKEY']].merge(supplier[(supplier['S_ACCTBAL'] >= 4871.299007551783) & (supplier['S_NATIONKEY'] > 9)][['S_ADDRESS', 'S_ACCTBAL']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[(lineitem['DISCOUNT'] == 0.09573652755731915)][['QUANTITY', 'LINENUMBER', 'SHIPDATE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY')

nation.merge(customer[['C_ADDRESS']], left_on='N_NATIONKEY', right_on='C_NATIONKEY')

customer.merge(orders[(orders['O_ORDERKEY'] == 37) & (orders['SHIPPRIORITY'] <= 0)].merge(customer.merge(nation[(nation['N_REGIONKEY'] < 1)][['N_REGIONKEY', 'N_NAME', 'N_COMMENT', 'N_NATIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[['C_ADDRESS', 'C_ACCTBAL', 'C_NATIONKEY']].merge(nation[(nation['N_NATIONKEY'] >= 5) | (nation['N_COMMENT'] != 'i')], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[['O_CUSTKEY', 'ORDERSTATUS', 'ORDERPRIORITY', 'O_ORDERKEY']].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['MKTSEGMENT', 'C_ADDRESS']).agg('max', numeric_only=True)

partsupp.merge(part[(part['RETAILPRICE'] != 1008.7047851336289) & (part['P_PARTKEY'] > 8)], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(supplier[['S_NAME', 'S_ACCTBAL']].merge(nation, left_on='S_SUPPKEY', right_on='N_NATIONKEY').merge(part[(part['PT_COMMENT'].str.startswith('i'))].merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='S_SUPPKEY', right_on='P_PARTKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(part[(part['PT_COMMENT'] != 'e') | (part['TYPE'] == 'E')][['P_PARTKEY', 'SIZE', 'CONTAINER', 'PT_COMMENT']].merge(partsupp[(partsupp['P_COMMENT'].str.startswith('j'))].merge(part[['MFGR', 'P_NAME', 'CONTAINER', 'RETAILPRICE']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY')

orders.merge(customer[(customer['C_ADDRESS'] == 'n') & (customer['C_ACCTBAL'] != 2534.903312769388)][['C_PHONE', 'C_CUSTKEY']].merge(orders.merge(customer[(customer['MKTSEGMENT'].isin(['FURNITURE', 'AUTOMOBILE', 'BUILDING', 'MACHINERY']))], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders[(orders['ORDERPRIORITY'] != '3-MEDIUM')][['O_CUSTKEY', 'O_COMMENT']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

orders

region[['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].merge(nation[['N_NAME']].merge(region.merge(nation[(nation['N_NATIONKEY'] < 13)][['N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_NATIONKEY', right_on='R_REGIONKEY').merge(orders[(orders['ORDERPRIORITY'] == '5-LOW') | (orders['ORDERPRIORITY'] != '3-MEDIUM')].merge(lineitem[(lineitem['EXTENDEDPRICE'] >= 59430.474599248046)], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='N_NATIONKEY', right_on='O_ORDERKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

part[(part['P_PARTKEY'] > 189)][['P_PARTKEY', 'SIZE']].merge(partsupp[(partsupp['P_COMMENT'] != 'u') & (partsupp['AVAILQTY'] >= 4938)].merge(part[['P_PARTKEY']], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(supplier[(supplier['S_COMMENT'].str.startswith('c'))][['S_ACCTBAL', 'S_SUPPKEY', 'S_ADDRESS', 'S_COMMENT']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['SUPPLYCOST'] != 798.5594345821613)][['P_COMMENT', 'AVAILQTY']].merge(nation.merge(customer[['C_NAME', 'MKTSEGMENT', 'C_PHONE']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='N_NATIONKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['SIZE']).agg('min', numeric_only=True)

customer[['C_ACCTBAL']].merge(lineitem[['SHIPDATE', 'SHIPMODE']], left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(part, left_on='C_CUSTKEY', right_on='P_PARTKEY').merge(region[['R_REGIONKEY', 'R_COMMENT', 'R_NAME']], left_on='C_CUSTKEY', right_on='R_REGIONKEY').groupby(by=['C_ACCTBAL']).agg('sum', numeric_only=True)

supplier

customer[(customer['C_NATIONKEY'] <= 20) | (customer['C_NAME'].str.startswith('C')) & (customer['C_CUSTKEY'] <= 9) | (customer['C_NAME'] != 'C')][['C_PHONE', 'C_CUSTKEY', 'C_NATIONKEY', 'C_COMMENT']].merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_NATIONKEY', 'C_COMMENT']).agg('max', numeric_only=True)

part.merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'] == 'f') & (partsupp['PS_PARTKEY'] <= 12)].merge(lineitem[['L_PARTKEY', 'RETURNFLAG']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[['MFGR']].merge(lineitem[(lineitem['LINESTATUS'] == 'F')][['SHIPDATE', 'L_ORDERKEY', 'EXTENDEDPRICE', 'LINENUMBER']], left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['AVAILQTY', 'SUPPLYCOST']], left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['MFGR', 'RETAILPRICE']).agg('min', numeric_only=True)

nation[['N_REGIONKEY', 'N_COMMENT', 'N_NATIONKEY', 'N_NAME']].merge(region[['R_NAME']].merge(supplier[(supplier['S_PHONE'] != '32-') & (supplier['S_ADDRESS'].str.startswith('N'))][['S_SUPPKEY', 'S_NAME']].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='R_REGIONKEY', right_on='S_SUPPKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_NAME'] == 'AME')][['R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[(customer['C_COMMENT'] == 'y') | (customer['C_CUSTKEY'] != 57)][['C_NATIONKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_NATIONKEY', 'N_NAME']).agg('max', numeric_only=True)

partsupp[(partsupp['AVAILQTY'] < 2799) | (partsupp['AVAILQTY'] == 4162) | (partsupp['PS_PARTKEY'] >= 36) | (partsupp['AVAILQTY'] < 7739)].merge(part[(part['CONTAINER'].str.startswith('WRAP')) & (part['P_PARTKEY'] != 32)], left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['SUPPLYCOST']).agg('mean', numeric_only=True)

partsupp[(partsupp['P_COMMENT'].str.startswith('v'))][['AVAILQTY', 'PS_SUPPKEY', 'PS_PARTKEY', 'P_COMMENT', 'SUPPLYCOST']].groupby(by=['AVAILQTY', 'PS_SUPPKEY']).agg('sum', numeric_only=True)

nation.merge(supplier.merge(nation[(nation['N_REGIONKEY'] < 3) & (nation['N_NATIONKEY'] < 23)].merge(supplier[(supplier['S_ADDRESS'] == 'e') & (supplier['S_SUPPKEY'] >= 86)][['S_ACCTBAL', 'S_COMMENT', 'S_ADDRESS']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier.merge(nation.merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_NAME']).agg('mean', numeric_only=True)

customer[(customer['C_NATIONKEY'] != 8) | (customer['C_NATIONKEY'] <= 3) | (customer['MKTSEGMENT'] == 'AUTOMOBILE')].merge(orders[(orders['CLERK'].str.startswith('C'))][['TOTALPRICE', 'ORDERSTATUS']].merge(supplier[['S_ACCTBAL', 'S_NATIONKEY', 'S_SUPPKEY']].merge(partsupp[(partsupp['PS_PARTKEY'] >= 1) | (partsupp['AVAILQTY'] != 4330)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='S_SUPPKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_NATIONKEY']).agg('count')

part[['RETAILPRICE']].merge(orders.merge(lineitem[['EXTENDEDPRICE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='P_PARTKEY', right_on='O_ORDERKEY').merge(region[(region['R_REGIONKEY'] != 0)].merge(nation[(nation['N_COMMENT'].str.startswith('t'))], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='P_PARTKEY', right_on='R_REGIONKEY').merge(orders, left_on='P_PARTKEY', right_on='O_ORDERKEY').groupby(by=['RETAILPRICE']).agg('max', numeric_only=True)

region[['R_REGIONKEY', 'R_NAME', 'R_COMMENT']].merge(nation[(nation['N_REGIONKEY'] <= 3)][['N_REGIONKEY', 'N_NAME', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

partsupp[(partsupp['AVAILQTY'] > 6349)].merge(lineitem[(lineitem['DISCOUNT'] != 0.026132942086917212)][['LINENUMBER', 'L_COMMENT']].merge(nation, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['RECEIPTDATE'] > '1998-11-06')].merge(orders[(orders['SHIPPRIORITY'] < 0) & (orders['SHIPPRIORITY'] != 0)].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['PS_PARTKEY'] < 10)].merge(lineitem[(lineitem['EXTENDEDPRICE'] >= 30869.979858559258) | (lineitem['LINESTATUS'] != 'O')], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[['RETURNFLAG']].merge(nation.merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY')

supplier

orders[(orders['O_COMMENT'] != 'k') & (orders['TOTALPRICE'] < 302581.3292242961)].merge(customer[(customer['MKTSEGMENT'].isin(['BUILDING', 'HOUSEHOLD', 'AUTOMOBILE', 'FURNITURE']))].merge(nation.merge(region[(region['R_NAME'] != 'AME') | (region['R_REGIONKEY'] <= 2)][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[(orders['O_CUSTKEY'] < 71102) & (orders['O_ORDERKEY'] != 474)].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer.merge(orders[(orders['O_CUSTKEY'] >= 105594)][['O_CUSTKEY', 'ORDERDATE', 'O_COMMENT', 'O_ORDERKEY']].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

lineitem.merge(partsupp[['SUPPLYCOST', 'PS_PARTKEY']].merge(lineitem[(lineitem['LINESTATUS'].isin(['O']))][['EXTENDEDPRICE']].merge(customer[['C_ACCTBAL', 'C_CUSTKEY', 'C_PHONE', 'C_NATIONKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(part[['SIZE', 'BRAND', 'RETAILPRICE']].merge(supplier, left_on='P_PARTKEY', right_on='S_SUPPKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] <= 4447)], left_on='L_PARTKEY', right_on='PS_PARTKEY')

region[(region['R_COMMENT'].str.startswith('u')) | (region['R_NAME'].str.startswith('AME')) | (region['R_REGIONKEY'] > 2) | (region['R_COMMENT'] != 'l')].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY')

supplier[(supplier['S_ACCTBAL'] <= 2362.3627112544964) & (supplier['S_ADDRESS'] != 'K') | (supplier['S_NATIONKEY'] >= 5) & (supplier['S_NAME'] != 'S')][['S_NAME', 'S_ACCTBAL']].merge(nation[(nation['N_NAME'].str.startswith('M'))], left_on='S_SUPPKEY', right_on='N_NATIONKEY').groupby(by=['S_ACCTBAL']).agg('count')

lineitem[['QUANTITY', 'RECEIPTDATE']].groupby(by=['QUANTITY', 'RECEIPTDATE']).agg('sum', numeric_only=True)

nation.merge(supplier.merge(partsupp.merge(lineitem[['RECEIPTDATE']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['AVAILQTY'] <= 7256)].merge(lineitem[(lineitem['SHIPDATE'] >= '1992-04-27')][['L_ORDERKEY']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_NATIONKEY']).agg('min', numeric_only=True)

lineitem[(lineitem['L_ORDERKEY'] < 37) | (lineitem['RECEIPTDATE'] >= '1992-05-02') & (lineitem['SHIPINSTRUCT'].isin(['COLLECT COD', 'DELIVER IN PERSON', 'NONE', 'TAKE BACK RETURN']))][['LINENUMBER', 'L_PARTKEY', 'SHIPINSTRUCT', 'DISCOUNT']].merge(partsupp[(partsupp['AVAILQTY'] <= 2792) & (partsupp['PS_PARTKEY'] <= 48)][['PS_PARTKEY', 'PS_SUPPKEY', 'AVAILQTY', 'P_COMMENT']].merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY')

lineitem[(lineitem['TAX'] == 0.052205846164089964) & (lineitem['SHIPINSTRUCT'].isin(['COLLECT COD', 'TAKE BACK RETURN', 'NONE', 'DELIVER IN PERSON'])) & (lineitem['EXTENDEDPRICE'] == 35847.74232283874) & (lineitem['L_COMMENT'].str.startswith('j'))][['RECEIPTDATE', 'DISCOUNT', 'L_ORDERKEY']].merge(orders.merge(customer[(customer['C_NATIONKEY'] >= 15)], left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[['C_CUSTKEY', 'C_COMMENT', 'C_ADDRESS', 'C_NATIONKEY']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').groupby(by=['L_ORDERKEY']).agg('sum', numeric_only=True)

lineitem[['QUANTITY', 'L_PARTKEY', 'L_COMMENT', 'TAX', 'L_SUPPKEY']].merge(partsupp[(partsupp['P_COMMENT'].str.startswith('the')) | (partsupp['P_COMMENT'] == 'u')], left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['QUANTITY', 'L_PARTKEY']).agg('sum', numeric_only=True)

lineitem[(lineitem['SHIPMODE'] != 'REG AIR') | (lineitem['LINESTATUS'] == 'F')][['COMMITDATE', 'RECEIPTDATE', 'SHIPMODE']].merge(region[['R_REGIONKEY']].merge(nation.merge(supplier[['S_ADDRESS']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY').merge(part[(part['MFGR'] != 'Manufacturer#3') | (part['MFGR'].isin(['Manufacturer#1', 'Manufacturer#2']))][['CONTAINER']].merge(customer[(customer['C_CUSTKEY'] == 18) | (customer['C_COMMENT'] == 'o')][['C_NATIONKEY', 'C_CUSTKEY', 'MKTSEGMENT', 'C_COMMENT']], left_on='P_PARTKEY', right_on='C_CUSTKEY').merge(lineitem[(lineitem['SHIPINSTRUCT'].isin(['TAKE BACK RETURN', 'COLLECT COD', 'DELIVER IN PERSON', 'NONE']))], left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY')

part.merge(partsupp[(partsupp['AVAILQTY'] < 1025) | (partsupp['SUPPLYCOST'] != 813.4782697186614)].merge(lineitem[(lineitem['L_COMMENT'] != 'p')][['L_COMMENT', 'EXTENDEDPRICE', 'SHIPMODE']].merge(nation, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['MFGR']).agg('count')

customer[(customer['C_COMMENT'].str.startswith('f'))].merge(nation[(nation['N_COMMENT'].str.startswith('s'))].merge(customer[(customer['C_NATIONKEY'] > 5) | (customer['C_PHONE'] == '2')], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[(orders['ORDERPRIORITY'] != '3-MEDIUM') | (orders['SHIPPRIORITY'] >= 0)][['O_CUSTKEY', 'ORDERPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[(nation['N_REGIONKEY'] <= 1)], left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_ACCTBAL', 'C_COMMENT']).agg('count')

region.merge(nation[(nation['N_NAME'].str.startswith('R'))].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[['S_COMMENT']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(region[(region['R_REGIONKEY'] < 3)], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(customer[(customer['MKTSEGMENT'].isin(['HOUSEHOLD', 'MACHINERY', 'BUILDING', 'AUTOMOBILE']))], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

customer[['MKTSEGMENT', 'C_NATIONKEY', 'C_CUSTKEY', 'C_PHONE', 'C_COMMENT']].merge(orders[['ORDERSTATUS', 'O_ORDERKEY', 'CLERK']].merge(lineitem[['SHIPMODE', 'LINESTATUS', 'QUANTITY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_NATIONKEY']).agg('max', numeric_only=True)

orders[(orders['CLERK'].str.startswith('C')) | (orders['O_COMMENT'].str.startswith('uri')) | (orders['O_CUSTKEY'] > 87268) | (orders['ORDERSTATUS'] == 'O')][['O_CUSTKEY', 'SHIPPRIORITY', 'ORDERDATE']].merge(customer[['C_ACCTBAL', 'C_CUSTKEY']].merge(orders[(orders['O_COMMENT'] == 'o') | (orders['TOTALPRICE'] == 331366.013775826)][['O_CUSTKEY', 'O_ORDERKEY', 'TOTALPRICE']].merge(customer[(customer['C_NAME'].str.startswith('C'))][['C_PHONE', 'MKTSEGMENT', 'C_ACCTBAL', 'C_ADDRESS']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_PHONE'] == '22-') | (customer['C_COMMENT'] != 'g')][['C_PHONE', 'C_NATIONKEY', 'C_CUSTKEY']].merge(orders[(orders['O_ORDERKEY'] <= 768) & (orders['TOTALPRICE'] < 320906.30698753183)].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation.merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[(customer['C_CUSTKEY'] <= 63)], left_on='O_CUSTKEY', right_on='C_CUSTKEY')

region[(region['R_COMMENT'] != 'u') & (region['R_REGIONKEY'] >= 0) & (region['R_COMMENT'] == 'g')].merge(nation[(nation['N_NATIONKEY'] <= 22) & (nation['N_NATIONKEY'] > 11)][['N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(customer[(customer['C_NAME'] != 'C') & (customer['C_COMMENT'].str.startswith('h'))][['C_PHONE', 'C_COMMENT', 'C_NAME']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY')

lineitem[(lineitem['TAX'] > 0.026871811421208758) & (lineitem['L_PARTKEY'] >= 36376) & (lineitem['RETURNFLAG'] != 'A')][['QUANTITY', 'L_COMMENT', 'L_SUPPKEY', 'SHIPDATE', 'TAX']].merge(partsupp[(partsupp['PS_PARTKEY'] != 20)].merge(lineitem[['SHIPINSTRUCT']], left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[['RECEIPTDATE', 'L_ORDERKEY']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['SUPPLYCOST'] > 398.34486850995364)].merge(lineitem[(lineitem['L_ORDERKEY'] != 31)].merge(partsupp[(partsupp['PS_SUPPKEY'] >= 1501)], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['QUANTITY'] <= 48)], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['PS_PARTKEY'] != 32) & (partsupp['PS_SUPPKEY'] < 451)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['L_SUPPKEY', 'SHIPDATE']).agg('count')

region[(region['R_REGIONKEY'] >= 0) & (region['R_NAME'].str.startswith('ASI'))][['R_REGIONKEY', 'R_COMMENT', 'R_NAME']].merge(nation[['N_REGIONKEY', 'N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_NAME']).agg('min', numeric_only=True)

part[(part['SIZE'] != 24) | (part['MFGR'] != 'Manufacturer#1') & (part['P_NAME'] != 'r') & (part['PT_COMMENT'] != 'f')].groupby(by=['CONTAINER', 'PT_COMMENT']).agg('mean', numeric_only=True)

part[(part['MFGR'] == 'Manufacturer#1') | (part['SIZE'] == 13)]

region.merge(nation[(nation['N_REGIONKEY'] != 3)], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

orders.groupby(by=['ORDERPRIORITY', 'ORDERSTATUS']).agg('sum', numeric_only=True)

nation[(nation['N_NAME'] == 'A') | (nation['N_COMMENT'] != 's') & (nation['N_REGIONKEY'] <= 1) & (nation['N_REGIONKEY'] != 0)].merge(customer[['MKTSEGMENT']].merge(nation.merge(supplier[['S_COMMENT']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_CUSTKEY', right_on='N_NATIONKEY').merge(part[['CONTAINER', 'BRAND', 'TYPE']].merge(nation[['N_NAME', 'N_COMMENT', 'N_REGIONKEY']], left_on='P_PARTKEY', right_on='N_NATIONKEY'), left_on='C_CUSTKEY', right_on='P_PARTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer.merge(nation[['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_COMMENT', 'N_NATIONKEY']).agg('mean', numeric_only=True)

orders[(orders['CLERK'] != 'C') & (orders['O_ORDERKEY'] == 611) & (orders['O_ORDERKEY'] == 242) & (orders['ORDERPRIORITY'].isin(['4-NOT SPECIFIED']))][['SHIPPRIORITY', 'O_COMMENT', 'ORDERPRIORITY', 'O_ORDERKEY']].merge(lineitem[(lineitem['L_ORDERKEY'] < 44) & (lineitem['QUANTITY'] >= 47)], left_on='O_ORDERKEY', right_on='L_ORDERKEY')

orders[(orders['SHIPPRIORITY'] < 0) | (orders['ORDERSTATUS'] == 'P')][['TOTALPRICE', 'SHIPPRIORITY', 'O_ORDERKEY', 'CLERK', 'ORDERPRIORITY']].merge(lineitem[['QUANTITY', 'L_PARTKEY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['COMMITDATE'] > '1998-10-16')].merge(orders[(orders['O_ORDERKEY'] < 746) | (orders['SHIPPRIORITY'] < 0)].merge(lineitem[(lineitem['L_ORDERKEY'] >= 124)][['SHIPINSTRUCT', 'L_SUPPKEY']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['ORDERPRIORITY'].isin(['5-LOW', '1-URGENT', '3-MEDIUM', '2-HIGH', '4-NOT SPECIFIED'])) & (orders['ORDERPRIORITY'] == '4-NOT SPECIFIED')][['O_CUSTKEY']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['SHIPMODE'] != 'SHIP') | (lineitem['SHIPDATE'] <= '1998-10-30')], left_on='O_ORDERKEY', right_on='L_ORDERKEY')

part.merge(partsupp[(partsupp['AVAILQTY'] < 5983)].merge(supplier[['S_NATIONKEY', 'S_ADDRESS']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['AVAILQTY', 'SUPPLYCOST', 'PS_SUPPKEY', 'PS_PARTKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['SUPPLYCOST'] < 611.2741030224944) & (partsupp['PS_PARTKEY'] > 14)][['SUPPLYCOST', 'AVAILQTY', 'PS_PARTKEY', 'PS_SUPPKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY')

part[(part['BRAND'] == 'Brand#34') | (part['RETAILPRICE'] > 973.718400201545) | (part['TYPE'] == 'STA')].merge(partsupp[(partsupp['SUPPLYCOST'] <= 501.05477062994373) | (partsupp['PS_SUPPKEY'] <= 681)].merge(supplier[(supplier['S_SUPPKEY'] > 199) | (supplier['S_ACCTBAL'] == 9341.570686774347)], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['AVAILQTY'] >= 4638) | (partsupp['PS_PARTKEY'] > 32)].merge(lineitem[['RECEIPTDATE', 'EXTENDEDPRICE', 'LINESTATUS', 'SHIPINSTRUCT']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] > 4394)], left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['BRAND', 'PT_COMMENT']).agg('count')

lineitem.groupby(by=['COMMITDATE', 'SHIPDATE']).agg('sum', numeric_only=True)

orders[(orders['SHIPPRIORITY'] <= 0)]

region[['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].merge(nation[['N_COMMENT', 'N_NAME', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] == 'U') & (nation['N_NAME'].str.startswith('K'))][['N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']].merge(region[(region['R_REGIONKEY'] <= 2) | (region['R_NAME'].str.startswith('AME'))][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].merge(nation[['N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[(region['R_COMMENT'].str.startswith('u')) & (region['R_NAME'] == 'A')].merge(nation[['N_NAME', 'N_COMMENT', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY', 'R_NAME']).agg('mean', numeric_only=True)

lineitem[['COMMITDATE', 'SHIPINSTRUCT', 'SHIPDATE', 'TAX', 'RECEIPTDATE']].merge(customer[(customer['C_COMMENT'].str.startswith('w'))][['C_ACCTBAL', 'C_NATIONKEY', 'C_NAME', 'C_ADDRESS']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY').merge(partsupp[(partsupp['P_COMMENT'] != 'j')].merge(lineitem[(lineitem['COMMITDATE'] < '1992-05-15')].merge(partsupp[['PS_SUPPKEY', 'PS_PARTKEY']], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY'])

region[(region['R_REGIONKEY'] == 2)].merge(nation[(nation['N_NAME'].str.startswith('B'))], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(customer[(customer['C_NATIONKEY'] <= 22) | (customer['C_COMMENT'] != 'd')], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[['C_ADDRESS']].merge(supplier[(supplier['S_ADDRESS'].str.startswith('D'))], left_on='C_CUSTKEY', right_on='S_SUPPKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation.merge(region[(region['R_NAME'].str.startswith('A')) & (region['R_NAME'] != 'AME')][['R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(customer[(customer['C_CUSTKEY'] == 94)][['C_ADDRESS', 'C_CUSTKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('min', numeric_only=True)

supplier[(supplier['S_NATIONKEY'] >= 13) & (supplier['S_ADDRESS'].str.startswith('Q')) | (supplier['S_NATIONKEY'] == 9)].merge(nation[(nation['N_NAME'].str.startswith('S'))], left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_ADDRESS']).agg('max', numeric_only=True)

customer[(customer['C_COMMENT'] != ',') & (customer['C_COMMENT'] != 'p') & (customer['C_CUSTKEY'] >= 82) & (customer['C_ACCTBAL'] != 140.3363376508953)][['C_ADDRESS', 'MKTSEGMENT', 'C_NATIONKEY', 'C_COMMENT', 'C_CUSTKEY']].merge(orders[(orders['CLERK'].str.startswith('C'))].merge(lineitem.merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation[['N_COMMENT']].merge(lineitem[(lineitem['RETURNFLAG'] == 'A') & (lineitem['SHIPMODE'] == 'FOB')].merge(orders[['ORDERPRIORITY', 'O_COMMENT']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='N_NATIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[['ORDERPRIORITY', 'O_COMMENT', 'TOTALPRICE', 'O_ORDERKEY']].merge(lineitem[(lineitem['L_COMMENT'].str.startswith('a'))][['COMMITDATE', 'RETURNFLAG']].merge(part[(part['P_PARTKEY'] > 116)][['P_NAME', 'SIZE']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['MKTSEGMENT', 'C_COMMENT']).agg('count')

nation

orders[(orders['CLERK'].str.startswith('C')) & (orders['ORDERDATE'] == '1992-01-13') | (orders['CLERK'].str.startswith('C'))]

customer[(customer['C_NAME'] != 'C')][['C_PHONE']]

region

supplier[(supplier['S_NAME'].str.startswith('S'))][['S_ACCTBAL']].merge(partsupp[['P_COMMENT', 'PS_PARTKEY']].merge(part[(part['P_PARTKEY'] >= 120) | (part['P_NAME'] == 'o')].merge(partsupp[(partsupp['PS_SUPPKEY'] == 6911) | (partsupp['AVAILQTY'] > 8480)], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[(part['RETAILPRICE'] > 1004.1734463195395) | (part['RETAILPRICE'] <= 919.4028173484272)], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(part[(part['P_PARTKEY'] < 89) | (part['PT_COMMENT'].str.startswith('h'))][['PT_COMMENT']], left_on='S_SUPPKEY', right_on='P_PARTKEY').merge(lineitem.merge(orders.merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'])

region[(region['R_COMMENT'].str.startswith('h'))][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']]

partsupp[(partsupp['PS_SUPPKEY'] >= 5030) | (partsupp['SUPPLYCOST'] >= 509.19055719282755)].merge(lineitem[(lineitem['L_ORDERKEY'] == 164)].merge(partsupp[(partsupp['PS_SUPPKEY'] >= 6681) | (partsupp['SUPPLYCOST'] > 658.1379152042388)].merge(lineitem[['DISCOUNT']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['EXTENDEDPRICE'] < 76754.26134291283)][['RECEIPTDATE']], left_on='PS_PARTKEY', right_on='L_PARTKEY')

nation.merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[(region['R_NAME'] == 'A')][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].merge(nation[(nation['N_REGIONKEY'] >= 3)][['N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY')

nation[(nation['N_REGIONKEY'] != 1) & (nation['N_COMMENT'].str.startswith('s')) & (nation['N_NAME'].str.startswith('G')) & (nation['N_COMMENT'] != 's')][['N_NAME', 'N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY']].merge(customer[(customer['MKTSEGMENT'] == 'HOUSEHOLD')].merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

supplier[(supplier['S_ACCTBAL'] > 7750.457627269964) & (supplier['S_NATIONKEY'] <= 22)][['S_ACCTBAL', 'S_ADDRESS', 'S_NATIONKEY', 'S_PHONE', 'S_NAME']].groupby(by=['S_PHONE']).agg('min', numeric_only=True)

lineitem.merge(orders.merge(lineitem[(lineitem['RECEIPTDATE'] < '1998-11-06') & (lineitem['SHIPMODE'] == 'SHIP')][['L_ORDERKEY', 'L_SUPPKEY', 'L_COMMENT']].merge(partsupp[(partsupp['SUPPLYCOST'] >= 782.4883857947307)], left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').groupby(by=['RETURNFLAG']).agg('sum', numeric_only=True)

part[['P_NAME', 'TYPE', 'PT_COMMENT', 'MFGR', 'BRAND']].merge(lineitem[['DISCOUNT', 'TAX', 'LINESTATUS']].merge(part[(part['MFGR'] != 'Manufacturer#5') & (part['SIZE'] >= 43)][['TYPE', 'RETAILPRICE', 'PT_COMMENT']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(region[['R_REGIONKEY', 'R_COMMENT']].merge(nation[['N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']].merge(customer[['C_NATIONKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='P_PARTKEY', right_on='R_REGIONKEY').groupby(by=['BRAND']).agg('count')

part[(part['SIZE'] >= 12) & (part['SIZE'] <= 18)][['RETAILPRICE', 'BRAND']].groupby(by=['RETAILPRICE', 'BRAND']).agg('min', numeric_only=True)

customer[(customer['C_COMMENT'].str.startswith(' ')) | (customer['C_CUSTKEY'] > 15)]

orders.merge(lineitem[(lineitem['TAX'] <= 0.018137922355613113)][['L_COMMENT']].merge(customer[(customer['C_COMMENT'] != 'o')], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer.merge(orders[(orders['O_COMMENT'].str.startswith('q'))][['ORDERSTATUS', 'ORDERPRIORITY', 'O_ORDERKEY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[(lineitem['L_SUPPKEY'] != 316)][['SHIPMODE', 'RETURNFLAG']].merge(nation[(nation['N_NAME'] != 'S')].merge(supplier[(supplier['S_NAME'] == 'S') & (supplier['S_ADDRESS'] == 'h')][['S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['ORDERPRIORITY']).agg('min', numeric_only=True)

customer[(customer['C_ACCTBAL'] >= 1378.291662896043)][['C_COMMENT', 'C_ADDRESS']].merge(region.merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='C_CUSTKEY', right_on='R_REGIONKEY').merge(orders[(orders['ORDERSTATUS'] == 'P')][['O_ORDERKEY']], left_on='C_CUSTKEY', right_on='O_ORDERKEY').groupby(by=['C_ADDRESS', 'C_COMMENT']).agg('mean', numeric_only=True)

orders[['O_CUSTKEY']].merge(customer[(customer['MKTSEGMENT'] == 'BUILDING') & (customer['C_ACCTBAL'] >= 2453.00406672998)][['C_PHONE', 'C_COMMENT', 'C_CUSTKEY', 'C_NAME']].merge(orders[['CLERK', 'ORDERPRIORITY']].merge(region[(region['R_COMMENT'] == 'u') & (region['R_COMMENT'].str.startswith('g'))], left_on='O_ORDERKEY', right_on='R_REGIONKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['O_CUSTKEY']).agg('max', numeric_only=True)

part[['CONTAINER', 'P_NAME', 'BRAND', 'P_PARTKEY']].merge(partsupp[(partsupp['P_COMMENT'].str.startswith('are'))][['SUPPLYCOST', 'PS_SUPPKEY', 'P_COMMENT']].merge(supplier[['S_ADDRESS', 'S_COMMENT', 'S_ACCTBAL', 'S_NATIONKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[(lineitem['QUANTITY'] < 22)].merge(partsupp, left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

customer.merge(nation[(nation['N_NAME'] == 'J')].merge(customer[['C_ADDRESS']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[['S_NATIONKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation.merge(region[['R_NAME', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders.merge(customer[['C_COMMENT', 'C_ACCTBAL']], left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[['C_CUSTKEY', 'C_NAME', 'C_PHONE', 'C_ADDRESS']].merge(orders[(orders['ORDERSTATUS'] != 'O')][['ORDERSTATUS']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY')

nation.merge(customer[(customer['MKTSEGMENT'] != 'HOUSEHOLD')][['C_CUSTKEY', 'C_NAME', 'C_NATIONKEY', 'C_PHONE']].merge(nation[(nation['N_NAME'] == 'J')][['N_COMMENT']].merge(customer[(customer['C_COMMENT'] == '.') & (customer['C_ADDRESS'] == '3')][['C_CUSTKEY', 'C_NAME', 'C_ACCTBAL']], left_on='N_NATIONKEY', right_on='C_CUSTKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_COMMENT', 'N_REGIONKEY']).agg('sum', numeric_only=True)

partsupp[['PS_SUPPKEY', 'P_COMMENT', 'SUPPLYCOST', 'AVAILQTY', 'PS_PARTKEY']].merge(part[(part['BRAND'].isin(['Brand#24', 'Brand#35', 'Brand#53', 'Brand#11', 'Brand#54', 'Brand#51', 'Brand#14', 'Brand#13', 'Brand#52', 'Brand#21', 'Brand#42', 'Brand#45', 'Brand#34', 'Brand#15'])) & (part['BRAND'].isin(['Brand#43', 'Brand#22', 'Brand#13', 'Brand#52', 'Brand#11', 'Brand#25', 'Brand#21', 'Brand#54', 'Brand#33', 'Brand#12', 'Brand#14', 'Brand#42', 'Brand#51', 'Brand#55', 'Brand#31', 'Brand#24', 'Brand#34', 'Brand#15', 'Brand#44', 'Brand#23', 'Brand#35', 'Brand#53']))][['P_NAME', 'BRAND']], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['L_PARTKEY'] < 196388) | (lineitem['L_ORDERKEY'] == 121)].merge(partsupp[['AVAILQTY', 'SUPPLYCOST']].merge(region[['R_NAME', 'R_COMMENT']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='R_REGIONKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem.merge(partsupp.merge(part[(part['P_NAME'].str.startswith('y')) & (part['RETAILPRICE'] <= 945.4156433444115)][['TYPE', 'P_PARTKEY']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['P_COMMENT'] != 'y') & (partsupp['PS_SUPPKEY'] < 6316)][['AVAILQTY', 'PS_PARTKEY']].merge(lineitem[['L_COMMENT', 'L_SUPPKEY', 'RECEIPTDATE']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').groupby(by=['P_COMMENT', 'PS_SUPPKEY']).agg('sum', numeric_only=True)

lineitem[['SHIPDATE', 'SHIPMODE', 'L_ORDERKEY']].merge(orders.merge(customer[(customer['C_PHONE'] == '13-') & (customer['C_CUSTKEY'] < 51)][['MKTSEGMENT']].merge(part[(part['BRAND'] != 'Brand#33') & (part['CONTAINER'] != 'LG')], left_on='C_CUSTKEY', right_on='P_PARTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer[['C_NATIONKEY', 'C_CUSTKEY', 'C_NAME']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders[(orders['ORDERDATE'] <= '1992-01-13')], left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY').groupby(by=['SHIPDATE', 'L_ORDERKEY']).agg('sum', numeric_only=True)

supplier[(supplier['S_ADDRESS'] == 'F')].groupby(by=['S_ACCTBAL', 'S_NAME']).agg('sum', numeric_only=True)

part

nation.merge(region[(region['R_COMMENT'].str.startswith('h'))].merge(nation[(nation['N_NATIONKEY'] != 0) | (nation['N_REGIONKEY'] >= 0)].merge(supplier[['S_NATIONKEY', 'S_NAME']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region.merge(nation[(nation['N_REGIONKEY'] <= 1) | (nation['N_COMMENT'].str.startswith('h'))][['N_REGIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_REGIONKEY', 'N_COMMENT']].merge(region[['R_NAME', 'R_REGIONKEY', 'R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY')

lineitem.groupby(by=['RECEIPTDATE', 'SHIPINSTRUCT']).agg('count')

orders[['O_ORDERKEY', 'CLERK', 'ORDERPRIORITY', 'O_CUSTKEY']].merge(lineitem[['SHIPMODE']].merge(part[['TYPE', 'SIZE', 'BRAND']].merge(supplier, left_on='P_PARTKEY', right_on='S_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY').merge(supplier[(supplier['S_NAME'].str.startswith('S')) & (supplier['S_SUPPKEY'] == 195)][['S_ACCTBAL', 'S_NAME']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[(lineitem['SHIPINSTRUCT'].isin(['DELIVER IN PERSON', 'TAKE BACK RETURN']))][['SHIPINSTRUCT']].merge(nation, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY').merge(region[(region['R_NAME'].str.startswith('AFR'))].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_ACCTBAL'] == 7164.898113833512) | (customer['C_NATIONKEY'] < 2)][['MKTSEGMENT', 'C_COMMENT']].merge(lineitem[(lineitem['QUANTITY'] == 10)][['LINENUMBER', 'QUANTITY']], left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(orders, left_on='C_CUSTKEY', right_on='O_ORDERKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

lineitem[(lineitem['TAX'] > 0.046143229708964)][['SHIPMODE', 'COMMITDATE', 'DISCOUNT']].merge(supplier[(supplier['S_ADDRESS'] == '8')].merge(partsupp[(partsupp['PS_PARTKEY'] < 29) & (partsupp['SUPPLYCOST'] >= 952.5002982344272)].merge(part[['SIZE', 'P_PARTKEY', 'TYPE', 'CONTAINER']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY').merge(partsupp[['SUPPLYCOST', 'PS_PARTKEY', 'PS_SUPPKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(supplier[(supplier['S_ACCTBAL'] >= 1112.9830718033852) & (supplier['S_SUPPKEY'] == 5)].merge(partsupp[['PS_SUPPKEY', 'AVAILQTY', 'SUPPLYCOST']].merge(lineitem, left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp.merge(lineitem[['TAX', 'SHIPDATE']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY').groupby(by=['SHIPMODE']).agg('min', numeric_only=True)

nation[(nation['N_NAME'].str.startswith('S'))].groupby(by=['N_NATIONKEY', 'N_NAME']).agg('mean', numeric_only=True)

orders[(orders['SHIPPRIORITY'] < 0) | (orders['CLERK'] != 'C')].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(lineitem[['QUANTITY', 'RETURNFLAG', 'SHIPMODE', 'EXTENDEDPRICE']].merge(region[(region['R_NAME'] != 'E') & (region['R_NAME'] == 'E')], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_ACCTBAL'] < 7889.9894868355095) & (customer['MKTSEGMENT'] == 'FURNITURE')].merge(orders[(orders['O_ORDERKEY'] > 684) | (orders['CLERK'] == 'C')], left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(orders.merge(customer[['C_COMMENT', 'C_PHONE']], left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY')

part[(part['SIZE'] >= 44) & (part['SIZE'] < 48) | (part['PT_COMMENT'] == 's') & (part['BRAND'] != 'Brand#23')].merge(partsupp[(partsupp['PS_PARTKEY'] < 17) | (partsupp['AVAILQTY'] > 8342)].merge(supplier[(supplier['S_ADDRESS'] == 'G')].merge(nation[(nation['N_COMMENT'] != 't')], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(supplier[(supplier['S_ADDRESS'] != 'O')][['S_NATIONKEY', 'S_COMMENT']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(part[(part['P_NAME'] == 'v') | (part['SIZE'] != 16)].merge(partsupp[(partsupp['PS_SUPPKEY'] <= 7312)], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['SUPPLYCOST'] == 500.6352494210719)].merge(lineitem.merge(partsupp[(partsupp['AVAILQTY'] < 8391)], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['COMMITDATE'] <= '1992-05-15')].merge(orders[(orders['ORDERPRIORITY'].isin(['2-HIGH', '3-MEDIUM', '1-URGENT', '4-NOT SPECIFIED', '5-LOW'])) & (orders['TOTALPRICE'] >= 218966.00680905132)], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

part.merge(partsupp[['PS_SUPPKEY']].merge(supplier[['S_NAME']].merge(part[(part['P_PARTKEY'] >= 14)], left_on='S_SUPPKEY', right_on='P_PARTKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['P_NAME', 'RETAILPRICE']).agg('count')

nation[['N_NAME']]

orders[(orders['ORDERPRIORITY'] != '1-URGENT') & (orders['ORDERSTATUS'].isin(['O'])) & (orders['O_CUSTKEY'] != 108782)][['ORDERSTATUS', 'TOTALPRICE']].merge(part[['MFGR']], left_on='O_ORDERKEY', right_on='P_PARTKEY')

part.groupby(by=['PT_COMMENT']).agg('sum', numeric_only=True)

part.groupby(by=['TYPE', 'RETAILPRICE']).agg('mean', numeric_only=True)

partsupp[(partsupp['SUPPLYCOST'] == 201.54360245459785) & (partsupp['AVAILQTY'] <= 3381)].merge(lineitem[['QUANTITY', 'L_COMMENT']].merge(partsupp[(partsupp['PS_PARTKEY'] != 40)], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(supplier.merge(partsupp[(partsupp['AVAILQTY'] > 9025)].merge(lineitem[(lineitem['SHIPINSTRUCT'].isin(['TAKE BACK RETURN', 'NONE', 'DELIVER IN PERSON'])) & (lineitem['QUANTITY'] >= 44)][['SHIPMODE', 'L_ORDERKEY', 'COMMITDATE', 'RETURNFLAG']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').groupby(by=['PS_SUPPKEY']).agg('min', numeric_only=True)

part[['CONTAINER', 'PT_COMMENT', 'P_PARTKEY']].merge(partsupp[(partsupp['PS_SUPPKEY'] == 6655) | (partsupp['SUPPLYCOST'] == 111.76501729459439)][['SUPPLYCOST']], left_on='P_PARTKEY', right_on='PS_PARTKEY')

nation.merge(customer[(customer['C_ACCTBAL'] <= 6688.995713864179)].merge(orders.merge(lineitem[(lineitem['L_COMMENT'] != 'y') & (lineitem['L_PARTKEY'] <= 121596)][['LINENUMBER', 'SHIPMODE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_NAME']).agg('count')

part[['PT_COMMENT', 'TYPE', 'CONTAINER', 'P_PARTKEY', 'BRAND']].merge(partsupp[(partsupp['P_COMMENT'] == 'the')].merge(lineitem[(lineitem['SHIPINSTRUCT'] == 'NONE')], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['SUPPLYCOST'] > 274.8101496373163)][['PS_PARTKEY', 'P_COMMENT', 'SUPPLYCOST']], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY').merge(lineitem[(lineitem['L_PARTKEY'] > 115285) | (lineitem['RETURNFLAG'].isin(['N', 'R', 'A']))][['L_ORDERKEY', 'DISCOUNT', 'LINENUMBER', 'QUANTITY']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

nation[(nation['N_NAME'] != 'S') & (nation['N_REGIONKEY'] > 3) | (nation['N_NAME'] != 'M') | (nation['N_NAME'] != 'B')].merge(supplier[['S_ACCTBAL', 'S_COMMENT']].merge(region[(region['R_REGIONKEY'] > 2) & (region['R_NAME'] != 'ASI')].merge(nation[['N_NATIONKEY', 'N_COMMENT', 'N_REGIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='S_SUPPKEY', right_on='R_REGIONKEY').merge(customer[['C_NAME', 'C_ACCTBAL', 'MKTSEGMENT']].merge(supplier[(supplier['S_COMMENT'] == 'the') | (supplier['S_COMMENT'].str.startswith('es '))], left_on='C_CUSTKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='C_CUSTKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_NATIONKEY']).agg('count')

lineitem[(lineitem['QUANTITY'] == 4) | (lineitem['L_PARTKEY'] != 166617) | (lineitem['EXTENDEDPRICE'] == 8579.709174733589) | (lineitem['SHIPINSTRUCT'].isin(['COLLECT COD']))][['SHIPMODE', 'EXTENDEDPRICE']].merge(nation[(nation['N_REGIONKEY'] <= 1)].merge(supplier[['S_NAME']].merge(customer[['C_ACCTBAL', 'C_PHONE']], left_on='S_SUPPKEY', right_on='C_CUSTKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY')

orders[(orders['O_ORDERKEY'] >= 208) | (orders['O_CUSTKEY'] != 17936) | (orders['TOTALPRICE'] == 219832.60944336402)].merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem.merge(orders, left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] != 1630) & (partsupp['PS_SUPPKEY'] != 3331)].merge(supplier[(supplier['S_ACCTBAL'] > 7526.286705854643)][['S_ADDRESS', 'S_NATIONKEY', 'S_SUPPKEY']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['ORDERSTATUS', 'SHIPPRIORITY']).agg('sum', numeric_only=True)

orders[(orders['ORDERSTATUS'].isin(['F', 'O'])) & (orders['ORDERDATE'] < '1998-07-21')].merge(customer[['MKTSEGMENT', 'C_ADDRESS', 'C_ACCTBAL', 'C_NAME']], left_on='O_CUSTKEY', right_on='C_CUSTKEY')

nation[(nation['N_NATIONKEY'] < 6) & (nation['N_COMMENT'].str.startswith('s'))][['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME', 'N_COMMENT']].merge(supplier[(supplier['S_NATIONKEY'] <= 17)].merge(partsupp[(partsupp['PS_SUPPKEY'] != 7370)][['PS_PARTKEY', 'PS_SUPPKEY', 'P_COMMENT', 'SUPPLYCOST']].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[['N_REGIONKEY', 'N_COMMENT']].merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[(supplier['S_NATIONKEY'] > 1)][['S_SUPPKEY', 'S_NAME']], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(region[(region['R_NAME'] == 'AFR') | (region['R_NAME'] == 'A')][['R_COMMENT', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY').groupby(by=['N_NATIONKEY']).agg('min', numeric_only=True)

region[(region['R_COMMENT'].str.startswith('h'))][['R_COMMENT', 'R_NAME', 'R_REGIONKEY']].merge(nation, left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_REGIONKEY']].merge(region[['R_COMMENT']].merge(partsupp, left_on='R_REGIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[['R_REGIONKEY', 'R_COMMENT', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_REGIONKEY'] <= 3)][['N_REGIONKEY', 'N_NATIONKEY']].merge(customer[(customer['MKTSEGMENT'] == 'AUTOMOBILE') | (customer['C_CUSTKEY'] > 7)][['C_COMMENT', 'C_ACCTBAL', 'C_CUSTKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer.merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT']).agg('mean', numeric_only=True)

customer[(customer['C_NAME'] != 'C') & (customer['C_NAME'] != 'C') & (customer['C_ACCTBAL'] >= 4492.784537554422) & (customer['C_ACCTBAL'] == 9202.291741160223)][['C_CUSTKEY', 'C_PHONE']].merge(orders.merge(lineitem[['SHIPMODE', 'RECEIPTDATE']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_PHONE', 'C_CUSTKEY']).agg('max', numeric_only=True)

part[['RETAILPRICE', 'CONTAINER']].merge(lineitem.merge(partsupp[(partsupp['PS_SUPPKEY'] != 5257)][['P_COMMENT', 'PS_PARTKEY', 'AVAILQTY', 'SUPPLYCOST']].merge(part[(part['MFGR'] == 'Manufacturer#1') | (part['BRAND'].isin(['Brand#42', 'Brand#15']))][['PT_COMMENT', 'P_NAME', 'SIZE', 'RETAILPRICE']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(partsupp.merge(lineitem[(lineitem['L_PARTKEY'] >= 48504)], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem, left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(orders[(orders['SHIPPRIORITY'] > 0)][['TOTALPRICE', 'ORDERSTATUS']].merge(lineitem[['L_ORDERKEY', 'L_PARTKEY']].merge(partsupp[(partsupp['PS_PARTKEY'] < 24) & (partsupp['PS_PARTKEY'] >= 8)], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='P_PARTKEY', right_on='O_ORDERKEY').groupby(by=['RETAILPRICE', 'CONTAINER']).agg('max', numeric_only=True)

partsupp[(partsupp['PS_SUPPKEY'] != 5856) | (partsupp['PS_PARTKEY'] != 30) | (partsupp['PS_SUPPKEY'] != 2742)][['PS_SUPPKEY']].groupby(by=['PS_SUPPKEY']).agg('min', numeric_only=True)

orders[['SHIPPRIORITY', 'O_COMMENT', 'CLERK', 'O_ORDERKEY']].merge(lineitem[['QUANTITY', 'L_ORDERKEY', 'L_PARTKEY', 'DISCOUNT']].merge(partsupp[(partsupp['PS_SUPPKEY'] != 7496)], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').groupby(by=['O_COMMENT']).agg('sum', numeric_only=True)

region[['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].merge(nation[['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY']].merge(customer.merge(nation[(nation['N_NAME'].str.startswith('B')) | (nation['N_REGIONKEY'] < 1)], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] <= 19)].merge(customer[(customer['MKTSEGMENT'] == 'FURNITURE')][['C_CUSTKEY', 'C_PHONE', 'C_NAME']].merge(orders, left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_REGIONKEY']).agg('sum', numeric_only=True)

lineitem[['LINESTATUS', 'LINENUMBER', 'L_PARTKEY', 'COMMITDATE', 'DISCOUNT']].merge(partsupp[(partsupp['SUPPLYCOST'] <= 18.49767210280474) & (partsupp['P_COMMENT'] != 'q')][['SUPPLYCOST', 'PS_PARTKEY', 'PS_SUPPKEY']].merge(supplier[(supplier['S_NATIONKEY'] <= 9)][['S_ACCTBAL', 'S_ADDRESS', 'S_PHONE', 'S_COMMENT']].merge(customer[(customer['C_COMMENT'].str.startswith('p')) | (customer['C_ACCTBAL'] == 5633.579312992614)], left_on='S_SUPPKEY', right_on='C_CUSTKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier[(supplier['S_NATIONKEY'] >= 6)][['S_COMMENT', 'S_ADDRESS', 'S_ACCTBAL']].merge(nation[(nation['N_COMMENT'] == 's')][['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT']], left_on='S_SUPPKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['AVAILQTY', 'PS_PARTKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY').groupby(by=['LINENUMBER']).agg('max', numeric_only=True)

lineitem[['EXTENDEDPRICE', 'L_SUPPKEY', 'LINESTATUS', 'L_COMMENT']].groupby(by=['LINESTATUS', 'L_SUPPKEY']).agg('sum', numeric_only=True)

supplier[(supplier['S_ADDRESS'].str.startswith('L')) | (supplier['S_PHONE'] != '3') | (supplier['S_COMMENT'].str.startswith('al '))].merge(partsupp.merge(part[(part['SIZE'] >= 32)][['TYPE', 'P_PARTKEY', 'SIZE']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[['AVAILQTY', 'PS_SUPPKEY', 'PS_PARTKEY']].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

lineitem.merge(partsupp[(partsupp['P_COMMENT'].str.startswith('ly '))][['PS_SUPPKEY', 'P_COMMENT', 'AVAILQTY']].merge(lineitem[(lineitem['LINENUMBER'] >= 4) | (lineitem['EXTENDEDPRICE'] == 88025.52564912463)][['COMMITDATE', 'SHIPDATE', 'DISCOUNT']].merge(partsupp[(partsupp['P_COMMENT'] != ' th')][['AVAILQTY', 'SUPPLYCOST', 'PS_PARTKEY']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY')

region[['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation.merge(supplier[['S_COMMENT']].merge(region, left_on='S_SUPPKEY', right_on='R_REGIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[['S_NAME', 'S_SUPPKEY']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NATIONKEY']].merge(customer.merge(orders[(orders['ORDERSTATUS'] != 'O')][['ORDERPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_ACCTBAL'] == 9611.490225445194) & (supplier['S_NAME'] == 'S')][['S_NATIONKEY', 'S_ADDRESS', 'S_NAME']].merge(nation[['N_NAME', 'N_REGIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NATIONKEY', 'N_NAME', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT']).agg('sum', numeric_only=True)

part[(part['P_NAME'] == 'd') | (part['MFGR'] != 'Manufacturer#2') & (part['PT_COMMENT'] == 't') | (part['TYPE'] == 'M')].merge(partsupp[['PS_SUPPKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY')

nation.groupby(by=['N_REGIONKEY']).agg('mean', numeric_only=True)

nation[(nation['N_REGIONKEY'] >= 2) | (nation['N_REGIONKEY'] >= 2) & (nation['N_COMMENT'] != 'e') & (nation['N_NATIONKEY'] < 13)][['N_NATIONKEY', 'N_REGIONKEY', 'N_COMMENT']].merge(customer[(customer['C_COMMENT'].str.startswith('t'))][['C_NAME', 'C_NATIONKEY', 'MKTSEGMENT', 'C_COMMENT']].merge(nation[(nation['N_NAME'] == 'G')].merge(region[['R_REGIONKEY', 'R_COMMENT', 'R_NAME']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_COMMENT'] == 'c')][['N_COMMENT', 'N_NATIONKEY', 'N_NAME']].merge(customer[['C_NAME', 'C_PHONE', 'MKTSEGMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').groupby(by=['N_REGIONKEY', 'N_COMMENT']).agg('max', numeric_only=True)

orders[(orders['ORDERDATE'] != '1998-07-21') | (orders['ORDERDATE'] == '1998-07-21')].groupby(by=['SHIPPRIORITY', 'O_CUSTKEY']).agg('mean', numeric_only=True)

supplier[(supplier['S_ADDRESS'] == 'y')][['S_NATIONKEY', 'S_ADDRESS', 'S_ACCTBAL', 'S_PHONE', 'S_SUPPKEY']].merge(nation[(nation['N_COMMENT'] != 'l')], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[['PS_SUPPKEY', 'PS_PARTKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_ADDRESS', 'S_NATIONKEY']).agg('sum', numeric_only=True)

nation[(nation['N_REGIONKEY'] <= 2) | (nation['N_COMMENT'] == 'e') & (nation['N_NAME'] != 'V')].merge(supplier[(supplier['S_PHONE'] != '17-')], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer[['C_NATIONKEY', 'C_NAME', 'C_CUSTKEY', 'MKTSEGMENT']], left_on='N_NATIONKEY', right_on='C_NATIONKEY')

orders.merge(customer[(customer['C_ACCTBAL'] <= 7973.966711835119)][['C_NAME', 'C_NATIONKEY', 'C_PHONE', 'C_COMMENT']].merge(nation[(nation['N_REGIONKEY'] == 1)][['N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_COMMENT'] != 'i') | (nation['N_REGIONKEY'] != 3)], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer.merge(orders.merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['O_CUSTKEY', 'ORDERDATE']).agg('mean', numeric_only=True)

nation[(nation['N_REGIONKEY'] <= 1) & (nation['N_NAME'] != 'R')][['N_NAME', 'N_NATIONKEY', 'N_COMMENT']].merge(supplier[['S_NAME', 'S_COMMENT']], left_on='N_NATIONKEY', right_on='S_NATIONKEY').groupby(by=['N_NATIONKEY']).agg('mean', numeric_only=True)

region.merge(nation[['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']].merge(customer[(customer['C_NAME'] == 'C') & (customer['C_PHONE'] == '22-')][['C_ADDRESS', 'C_PHONE', 'C_NATIONKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').groupby(by=['R_COMMENT', 'R_NAME']).agg('mean', numeric_only=True)

supplier[['S_PHONE', 'S_ACCTBAL', 'S_SUPPKEY', 'S_NATIONKEY']].merge(partsupp[(partsupp['PS_SUPPKEY'] != 2713)], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation.merge(supplier[['S_NAME', 'S_ADDRESS', 'S_COMMENT']], left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier.merge(partsupp[(partsupp['PS_PARTKEY'] >= 2) & (partsupp['SUPPLYCOST'] > 226.9057772003229)][['P_COMMENT', 'SUPPLYCOST']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp.merge(lineitem[(lineitem['EXTENDEDPRICE'] < 81494.98812429434)][['SHIPINSTRUCT', 'TAX', 'SHIPMODE', 'QUANTITY']].merge(part[(part['P_PARTKEY'] == 164) | (part['P_NAME'] != 'g')], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='P_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

partsupp[['P_COMMENT']]

region[(region['R_COMMENT'].str.startswith('h')) & (region['R_NAME'].str.startswith('E')) | (region['R_COMMENT'] == 'l')].merge(nation[(nation['N_COMMENT'] == 'r') & (nation['N_NAME'] != 'J')][['N_COMMENT', 'N_NAME', 'N_NATIONKEY', 'N_REGIONKEY']].merge(region[(region['R_NAME'].str.startswith('AFR'))], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NATIONKEY', 'N_REGIONKEY', 'N_NAME', 'N_COMMENT']].merge(customer[(customer['C_ADDRESS'] != 'D') | (customer['C_CUSTKEY'] < 6)].merge(nation[['N_NATIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_SUPPKEY'] >= 183) & (supplier['S_NAME'] == 'S')][['S_SUPPKEY']].merge(partsupp[['AVAILQTY', 'P_COMMENT', 'PS_SUPPKEY', 'PS_PARTKEY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NAME'] == 'V') & (nation['N_NATIONKEY'] < 0)], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

supplier[(supplier['S_COMMENT'] != 'v') | (supplier['S_SUPPKEY'] < 196)].merge(partsupp[['P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_REGIONKEY'] > 0)].merge(customer[(customer['MKTSEGMENT'].isin(['AUTOMOBILE', 'HOUSEHOLD', 'BUILDING']))], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[(customer['C_NAME'] == 'C') & (customer['C_ADDRESS'] != 'u')], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY')

orders[['ORDERSTATUS', 'SHIPPRIORITY', 'ORDERPRIORITY']].merge(region[(region['R_COMMENT'].str.startswith('g')) & (region['R_REGIONKEY'] == 0)], left_on='O_ORDERKEY', right_on='R_REGIONKEY').merge(customer[(customer['MKTSEGMENT'] != 'HOUSEHOLD')].merge(nation[(nation['N_NATIONKEY'] == 15) | (nation['N_REGIONKEY'] >= 1)], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(orders[(orders['TOTALPRICE'] > 96177.25506457426) & (orders['O_CUSTKEY'] == 43407)][['ORDERSTATUS']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='O_ORDERKEY', right_on='C_CUSTKEY').merge(partsupp[['AVAILQTY', 'PS_PARTKEY', 'PS_SUPPKEY', 'P_COMMENT']], left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).groupby(by=['SHIPPRIORITY']).agg('max', numeric_only=True)

part[(part['PT_COMMENT'].str.startswith('ly '))].merge(partsupp.merge(part.merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[['PS_PARTKEY', 'SUPPLYCOST', 'PS_SUPPKEY']].merge(lineitem[['RECEIPTDATE', 'TAX', 'COMMITDATE']].merge(orders[['ORDERSTATUS', 'TOTALPRICE']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

part.merge(partsupp[(partsupp['PS_PARTKEY'] < 15) & (partsupp['PS_PARTKEY'] >= 1)].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['AVAILQTY'] != 9865) & (partsupp['PS_PARTKEY'] >= 49)][['P_COMMENT']].merge(orders.merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='O_ORDERKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY')

part.merge(partsupp[(partsupp['PS_SUPPKEY'] < 5992)][['P_COMMENT']].merge(region[(region['R_COMMENT'] == 'h') | (region['R_COMMENT'] != 'h')][['R_NAME', 'R_COMMENT']], left_on=['PS_PARTKEY', 'PS_SUPPKEY'], right_on='R_REGIONKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['AVAILQTY'] >= 6159) & (partsupp['PS_PARTKEY'] > 19)][['PS_PARTKEY', 'AVAILQTY', 'P_COMMENT']].merge(part, left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[(part['P_PARTKEY'] > 138) | (part['MFGR'].isin(['Manufacturer#5', 'Manufacturer#4', 'Manufacturer#2', 'Manufacturer#1', 'Manufacturer#3']))][['PT_COMMENT']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['MFGR', 'CONTAINER']).agg('mean', numeric_only=True)

region[(region['R_NAME'] == 'AFR')][['R_NAME', 'R_COMMENT', 'R_REGIONKEY']].merge(nation.merge(customer[['C_COMMENT']].merge(region[(region['R_REGIONKEY'] <= 3) | (region['R_COMMENT'].str.startswith('g'))][['R_REGIONKEY']], left_on='C_CUSTKEY', right_on='R_REGIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[(nation['N_NATIONKEY'] > 23) | (nation['N_NAME'] != 'K')][['N_NAME', 'N_REGIONKEY', 'N_NATIONKEY', 'N_COMMENT']].merge(region[(region['R_NAME'].str.startswith('AFR'))][['R_COMMENT']], left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='R_REGIONKEY', right_on='N_REGIONKEY').merge(nation[['N_NATIONKEY', 'N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY')

supplier[(supplier['S_ACCTBAL'] < 4079.455211332428) | (supplier['S_COMMENT'] != 'w')].merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp.merge(part[(part['P_PARTKEY'] >= 51)][['SIZE', 'P_PARTKEY', 'PT_COMMENT']].merge(partsupp[(partsupp['SUPPLYCOST'] > 920.0055271905487) & (partsupp['AVAILQTY'] < 2983)][['AVAILQTY', 'SUPPLYCOST', 'PS_PARTKEY', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(supplier[['S_NATIONKEY', 'S_ACCTBAL', 'S_SUPPKEY', 'S_COMMENT']].merge(partsupp[(partsupp['AVAILQTY'] < 3132) | (partsupp['P_COMMENT'].str.startswith('v'))], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['P_COMMENT'].str.startswith('o')) & (partsupp['P_COMMENT'] == 'are')][['AVAILQTY', 'PS_SUPPKEY', 'SUPPLYCOST']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY')

part[(part['TYPE'] == 'L') | (part['MFGR'].isin(['Manufacturer#1', 'Manufacturer#4', 'Manufacturer#3', 'Manufacturer#2', 'Manufacturer#5'])) | (part['P_NAME'].str.startswith('c'))][['RETAILPRICE', 'SIZE']].merge(supplier.merge(partsupp, left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(nation[(nation['N_COMMENT'] != 't')].merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='P_PARTKEY', right_on='S_SUPPKEY').merge(customer, left_on='P_PARTKEY', right_on='C_CUSTKEY').merge(region.merge(nation[(nation['N_NAME'] != 'G')][['N_NAME', 'N_NATIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='P_PARTKEY', right_on='R_REGIONKEY')

customer[(customer['C_ADDRESS'].str.startswith('S')) & (customer['C_NAME'].str.startswith('C')) & (customer['MKTSEGMENT'].isin(['AUTOMOBILE', 'BUILDING', 'FURNITURE']))].merge(orders.merge(customer[(customer['C_NAME'] == 'C') | (customer['C_ADDRESS'] == '7')][['C_PHONE', 'C_CUSTKEY']], left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(customer, left_on='O_CUSTKEY', right_on='C_CUSTKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').merge(nation.merge(region[['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation[(nation['N_REGIONKEY'] >= 2) & (nation['N_NATIONKEY'] >= 6)][['N_COMMENT']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(supplier[(supplier['S_SUPPKEY'] >= 74)][['S_COMMENT', 'S_SUPPKEY']].merge(partsupp[['AVAILQTY', 'PS_PARTKEY', 'P_COMMENT']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_REGIONKEY', 'N_COMMENT', 'N_NAME', 'N_NATIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY')

region[['R_COMMENT', 'R_REGIONKEY', 'R_NAME']]

orders[['O_CUSTKEY', 'O_ORDERKEY', 'TOTALPRICE']].merge(customer[['C_PHONE', 'C_NAME']].merge(orders[(orders['CLERK'] != 'C') | (orders['ORDERDATE'] == '1992-01-13')], left_on='C_CUSTKEY', right_on='O_ORDERKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').merge(lineitem[(lineitem['L_COMMENT'] != 'lit') | (lineitem['L_ORDERKEY'] < 129)][['DISCOUNT']].merge(region[(region['R_REGIONKEY'] == 2)], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY'), left_on='O_ORDERKEY', right_on='L_ORDERKEY').merge(customer[(customer['C_ACCTBAL'] == 926.2135504754312)][['MKTSEGMENT', 'C_CUSTKEY', 'C_NATIONKEY', 'C_PHONE']], left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['TOTALPRICE']).agg('sum', numeric_only=True)

part[(part['CONTAINER'] != 'SM') | (part['MFGR'] != 'Manufacturer#4') | (part['TYPE'] == 'SMA')].merge(partsupp[(partsupp['SUPPLYCOST'] <= 818.5387867917924)][['PS_PARTKEY', 'P_COMMENT']], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp.merge(lineitem[(lineitem['LINESTATUS'].isin(['O'])) & (lineitem['COMMITDATE'] >= '1998-10-16')].merge(orders[(orders['ORDERDATE'] < '1998-07-21')], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(part.merge(partsupp[(partsupp['P_COMMENT'] != 'd') & (partsupp['SUPPLYCOST'] == 18.500869523336267)], left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['SIZE', 'BRAND']).agg('count')

supplier.merge(nation[['N_NAME', 'N_COMMENT', 'N_NATIONKEY']], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(partsupp[(partsupp['P_COMMENT'] == 'c') & (partsupp['AVAILQTY'] != 8406)].merge(lineitem[['L_PARTKEY', 'COMMITDATE', 'SHIPMODE', 'LINESTATUS']].merge(partsupp[['PS_PARTKEY', 'P_COMMENT', 'PS_SUPPKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['SHIPMODE'] != 'REG AIR')][['L_PARTKEY', 'L_COMMENT']].merge(partsupp[['PS_SUPPKEY']], left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_ADDRESS']).agg('mean', numeric_only=True)

supplier.merge(partsupp[['PS_SUPPKEY']].merge(lineitem[(lineitem['SHIPINSTRUCT'] != 'NONE') & (lineitem['COMMITDATE'] != '1992-05-15')][['DISCOUNT', 'L_ORDERKEY', 'SHIPMODE']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['COMMITDATE'] <= '1992-05-15') & (lineitem['LINENUMBER'] <= 2)][['LINENUMBER', 'L_SUPPKEY']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY').merge(partsupp[(partsupp['SUPPLYCOST'] < 884.1108135025493) & (partsupp['AVAILQTY'] <= 7277)][['PS_SUPPKEY', 'SUPPLYCOST', 'PS_PARTKEY', 'AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['S_ACCTBAL', 'S_NATIONKEY']).agg('count')

supplier[(supplier['S_PHONE'] == '14-') | (supplier['S_NAME'] == 'S') | (supplier['S_SUPPKEY'] > 120)][['S_COMMENT', 'S_NAME', 'S_NATIONKEY']].merge(nation.merge(supplier[['S_PHONE', 'S_NAME', 'S_COMMENT']].merge(lineitem[(lineitem['RETURNFLAG'] != 'R')][['TAX']], left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer, left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NATIONKEY'] >= 23)], left_on='S_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_REGIONKEY'] == 3) | (nation['N_NAME'] == 'J')][['N_NATIONKEY']].merge(customer[['C_NATIONKEY', 'C_CUSTKEY', 'C_PHONE']].merge(orders[(orders['CLERK'].str.startswith('C'))][['SHIPPRIORITY']], left_on='C_CUSTKEY', right_on='O_CUSTKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[['C_ADDRESS', 'C_PHONE', 'C_NATIONKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['S_NATIONKEY']).agg('sum', numeric_only=True)

orders[['O_COMMENT', 'ORDERSTATUS']].merge(partsupp[(partsupp['PS_SUPPKEY'] > 3900)][['SUPPLYCOST', 'AVAILQTY', 'P_COMMENT', 'PS_PARTKEY']].merge(part[(part['P_NAME'].str.startswith('cor')) & (part['P_PARTKEY'] == 33)].merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[(part['RETAILPRICE'] <= 1093.97845120357) & (part['TYPE'] == 'E')][['PT_COMMENT', 'BRAND']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']).merge(customer[['C_NAME', 'C_NATIONKEY']].merge(nation, left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_ORDERKEY', right_on='C_CUSTKEY').merge(lineitem[['LINENUMBER']], left_on='O_ORDERKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'])

customer[(customer['C_ADDRESS'].str.startswith('a'))][['MKTSEGMENT']].merge(part[(part['PT_COMMENT'] == 'c')][['SIZE', 'CONTAINER', 'BRAND', 'P_PARTKEY']], left_on='C_CUSTKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['RECEIPTDATE'] >= '1998-11-06') & (lineitem['COMMITDATE'] <= '1992-05-15')][['LINESTATUS', 'L_PARTKEY']].merge(partsupp[['PS_SUPPKEY']].merge(supplier[(supplier['S_NATIONKEY'] > 20)][['S_PHONE', 'S_ACCTBAL', 'S_ADDRESS']], left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(nation[(nation['N_REGIONKEY'] >= 0) | (nation['N_COMMENT'] != 'e')].merge(region[['R_NAME']].merge(lineitem[['COMMITDATE']], left_on='R_REGIONKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on='C_CUSTKEY', right_on='N_NATIONKEY')

lineitem.merge(partsupp[(partsupp['PS_SUPPKEY'] <= 6702)].merge(part[['P_PARTKEY', 'RETAILPRICE', 'PT_COMMENT']], left_on='PS_PARTKEY', right_on='P_PARTKEY').merge(part[(part['BRAND'] != 'Brand#14') | (part['RETAILPRICE'] < 1056.0428594821765)][['BRAND', 'TYPE', 'RETAILPRICE']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY')

part[(part['P_PARTKEY'] < 153) | (part['MFGR'].isin(['Manufacturer#1'])) | (part['TYPE'] == 'M')].merge(partsupp[(partsupp['SUPPLYCOST'] >= 774.8294772454019)].merge(lineitem[(lineitem['SHIPMODE'] == 'FOB')][['L_ORDERKEY']].merge(orders[['CLERK', 'O_ORDERKEY', 'ORDERDATE']], left_on='L_ORDERKEY', right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY').groupby(by=['PT_COMMENT', 'BRAND']).agg('mean', numeric_only=True)

orders[(orders['CLERK'] == 'C')][['SHIPPRIORITY', 'ORDERDATE']]

customer[(customer['C_ADDRESS'] != 'O') | (customer['C_PHONE'] != '25-') & (customer['C_PHONE'] != '25-') & (customer['C_NATIONKEY'] >= 8)][['C_NAME', 'C_ACCTBAL', 'C_PHONE', 'C_CUSTKEY']].merge(orders[['O_COMMENT']].merge(customer, left_on='O_ORDERKEY', right_on='C_CUSTKEY').merge(nation[(nation['N_REGIONKEY'] != 3) & (nation['N_NAME'] != 'A')][['N_COMMENT', 'N_NAME', 'N_REGIONKEY', 'N_NATIONKEY']], left_on='O_ORDERKEY', right_on='N_NATIONKEY'), left_on='C_CUSTKEY', right_on='O_CUSTKEY').groupby(by=['C_PHONE']).agg('mean', numeric_only=True)

nation[['N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY']].groupby(by=['N_REGIONKEY', 'N_COMMENT']).agg('min', numeric_only=True)

partsupp[(partsupp['PS_PARTKEY'] < 13) & (partsupp['PS_SUPPKEY'] > 1457) & (partsupp['SUPPLYCOST'] == 890.9394532116972)].merge(lineitem[['TAX']].merge(customer[['MKTSEGMENT', 'C_ACCTBAL']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY').merge(orders[(orders['O_CUSTKEY'] > 117326) | (orders['ORDERPRIORITY'] != '2-HIGH')][['O_ORDERKEY', 'CLERK']].merge(lineitem, left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='O_ORDERKEY'), left_on='PS_PARTKEY', right_on='L_PARTKEY').groupby(by=['AVAILQTY', 'P_COMMENT']).agg('min', numeric_only=True)

partsupp[['SUPPLYCOST', 'P_COMMENT', 'PS_PARTKEY', 'PS_SUPPKEY']]

partsupp[['AVAILQTY', 'PS_SUPPKEY']].merge(supplier[['S_ADDRESS', 'S_NATIONKEY']].merge(nation[(nation['N_REGIONKEY'] > 1)].merge(customer[['C_PHONE', 'C_ADDRESS', 'C_COMMENT', 'C_NATIONKEY']], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='S_NATIONKEY', right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY').merge(lineitem[['RETURNFLAG', 'DISCOUNT', 'RECEIPTDATE']].merge(customer[['C_CUSTKEY', 'C_NATIONKEY', 'C_NAME', 'C_COMMENT']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='C_CUSTKEY').merge(supplier, left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY')

lineitem[['QUANTITY', 'L_PARTKEY', 'COMMITDATE', 'SHIPINSTRUCT', 'EXTENDEDPRICE']].merge(partsupp[(partsupp['P_COMMENT'].str.startswith('s')) | (partsupp['PS_SUPPKEY'] < 7464)][['P_COMMENT', 'PS_SUPPKEY', 'AVAILQTY']], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_PARTKEY'] != 12) & (partsupp['SUPPLYCOST'] == 144.8244393597997)].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY')

region.groupby(by=['R_NAME', 'R_REGIONKEY']).agg('min', numeric_only=True)

lineitem[(lineitem['SHIPMODE'] != 'REG AIR') & (lineitem['L_COMMENT'] == 'e') & (lineitem['RETURNFLAG'] == 'N')][['LINENUMBER', 'LINESTATUS', 'L_COMMENT']].merge(supplier[(supplier['S_NAME'] != 'S') | (supplier['S_PHONE'] != '28-')], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='S_SUPPKEY').merge(nation.merge(region, left_on='N_REGIONKEY', right_on='R_REGIONKEY').merge(region[['R_COMMENT', 'R_REGIONKEY', 'R_NAME']].merge(nation[(nation['N_NAME'].str.startswith('U'))][['N_NATIONKEY', 'N_NAME']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='N_REGIONKEY', right_on='R_REGIONKEY'), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY').merge(region[['R_NAME']].merge(partsupp[['P_COMMENT', 'PS_SUPPKEY']], left_on='R_REGIONKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='R_REGIONKEY').groupby(by=['LINESTATUS', 'L_COMMENT']).agg('max', numeric_only=True)

customer[['C_PHONE']].merge(lineitem[(lineitem['RETURNFLAG'].isin(['R', 'N']))][['RECEIPTDATE', 'EXTENDEDPRICE', 'COMMITDATE']], left_on='C_CUSTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).groupby(by=['C_PHONE']).agg('count')

nation.merge(supplier[(supplier['S_ADDRESS'] == 'h') | (supplier['S_ADDRESS'] == 'r')].merge(partsupp.merge(part[(part['SIZE'] >= 38) & (part['PT_COMMENT'].str.startswith('s'))][['RETAILPRICE', 'BRAND', 'CONTAINER', 'MFGR']], left_on='PS_PARTKEY', right_on='P_PARTKEY'), left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(customer.merge(nation[(nation['N_COMMENT'] != 'h')].merge(supplier, left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY')

nation[(nation['N_NAME'].str.startswith('U')) | (nation['N_COMMENT'] != ' ') | (nation['N_NAME'].str.startswith('P'))][['N_NATIONKEY']].merge(customer.merge(nation[(nation['N_REGIONKEY'] == 0)], left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[(nation['N_NATIONKEY'] > 7) & (nation['N_COMMENT'] != 'n')][['N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(supplier[(supplier['S_SUPPKEY'] <= 165) & (supplier['S_SUPPKEY'] <= 155)][['S_ACCTBAL', 'S_PHONE']].merge(orders.merge(lineitem[(lineitem['L_PARTKEY'] < 68356) | (lineitem['RETURNFLAG'] == 'A')][['RETURNFLAG']], left_on='O_ORDERKEY', right_on='L_ORDERKEY'), left_on='S_SUPPKEY', right_on='O_ORDERKEY'), left_on='N_NATIONKEY', right_on='S_NATIONKEY').merge(supplier[['S_COMMENT', 'S_NATIONKEY', 'S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY')

lineitem[(lineitem['SHIPINSTRUCT'] == 'COLLECT COD')].merge(orders[['SHIPPRIORITY', 'ORDERSTATUS']].merge(region[['R_REGIONKEY', 'R_COMMENT', 'R_NAME']].merge(nation[['N_REGIONKEY']], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='O_ORDERKEY', right_on='R_REGIONKEY').merge(region[['R_NAME', 'R_REGIONKEY']].merge(nation[(nation['N_COMMENT'] == 'v') & (nation['N_COMMENT'].str.startswith('i'))], left_on='R_REGIONKEY', right_on='N_REGIONKEY'), left_on='O_ORDERKEY', right_on='R_REGIONKEY'), left_on='L_ORDERKEY', right_on='O_ORDERKEY').merge(partsupp.merge(lineitem[(lineitem['DISCOUNT'] == 0.030123054249821327)][['L_PARTKEY', 'RECEIPTDATE', 'COMMITDATE', 'L_SUPPKEY']], left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(supplier.merge(partsupp[(partsupp['PS_SUPPKEY'] > 4855)][['PS_PARTKEY', 'PS_SUPPKEY', 'AVAILQTY']], left_on='S_SUPPKEY', right_on='PS_SUPPKEY'), left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_SUPPKEY', right_on='PS_SUPPKEY').groupby(by=['L_ORDERKEY', 'RECEIPTDATE']).agg('min', numeric_only=True)

partsupp[(partsupp['PS_SUPPKEY'] == 4334)][['PS_SUPPKEY', 'SUPPLYCOST', 'P_COMMENT', 'PS_PARTKEY', 'AVAILQTY']].merge(lineitem[(lineitem['L_SUPPKEY'] != 1281)], left_on='PS_PARTKEY', right_on='L_PARTKEY')

supplier[['S_ADDRESS']].merge(lineitem, left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(part[(part['P_PARTKEY'] >= 195) & (part['P_NAME'].str.startswith('f'))][['P_PARTKEY']], left_on='S_SUPPKEY', right_on='P_PARTKEY').merge(lineitem[(lineitem['COMMITDATE'] >= '1998-10-16') | (lineitem['EXTENDEDPRICE'] > 49622.287129853954)][['EXTENDEDPRICE', 'RECEIPTDATE', 'L_COMMENT']], left_on='S_SUPPKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'])

lineitem

lineitem[['EXTENDEDPRICE', 'LINESTATUS', 'L_SUPPKEY']]

part[['TYPE', 'CONTAINER', 'P_NAME', 'BRAND']].merge(lineitem[['COMMITDATE', 'EXTENDEDPRICE', 'L_PARTKEY', 'SHIPMODE']].merge(partsupp[(partsupp['SUPPLYCOST'] > 680.5975678645615) | (partsupp['SUPPLYCOST'] == 236.1614101114619)][['P_COMMENT']], left_on='L_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_SUPPKEY'] != 896) | (partsupp['SUPPLYCOST'] > 333.1789554254955)].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='L_PARTKEY', right_on='PS_PARTKEY'), left_on='P_PARTKEY', right_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY']).merge(supplier, left_on='P_PARTKEY', right_on='S_SUPPKEY').merge(orders[(orders['ORDERDATE'] < '1992-01-13')][['TOTALPRICE', 'CLERK', 'O_COMMENT', 'ORDERDATE']].merge(region[(region['R_NAME'] != 'AFR') & (region['R_NAME'] != 'AME')][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']], left_on='O_ORDERKEY', right_on='R_REGIONKEY').merge(partsupp[(partsupp['P_COMMENT'].str.startswith(';'))], left_on='O_ORDERKEY', right_on=['PS_PARTKEY', 'PS_SUPPKEY']), left_on='P_PARTKEY', right_on='O_ORDERKEY')

customer[(customer['C_PHONE'].str.startswith('18-')) | (customer['C_ACCTBAL'] == 4788.196242365647) & (customer['C_ADDRESS'] == 'a') & (customer['C_NATIONKEY'] <= 22)].merge(nation[(nation['N_REGIONKEY'] > 1) & (nation['N_COMMENT'].str.startswith('p'))][['N_REGIONKEY', 'N_COMMENT', 'N_NAME', 'N_NATIONKEY']].merge(customer[['MKTSEGMENT', 'C_ADDRESS']], left_on='N_NATIONKEY', right_on='C_NATIONKEY').merge(customer[(customer['C_CUSTKEY'] <= 14) | (customer['MKTSEGMENT'] == 'FURNITURE')].merge(nation[(nation['N_NATIONKEY'] < 17)][['N_REGIONKEY', 'N_COMMENT', 'N_NAME']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY')

customer[(customer['C_ADDRESS'] != 'f') & (customer['C_ADDRESS'] != 's') | (customer['MKTSEGMENT'] != 'AUTOMOBILE') | (customer['C_COMMENT'] != 'l')].merge(nation.merge(customer[(customer['C_NAME'] != 'C') & (customer['MKTSEGMENT'] != 'MACHINERY')], left_on='N_NATIONKEY', right_on='C_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').groupby(by=['C_ADDRESS', 'C_CUSTKEY']).agg('max', numeric_only=True)

partsupp[(partsupp['SUPPLYCOST'] >= 369.7820915801648) & (partsupp['P_COMMENT'].str.startswith('f')) | (partsupp['AVAILQTY'] < 4292)].merge(part.merge(partsupp[(partsupp['PS_PARTKEY'] >= 1)][['PS_SUPPKEY']].merge(supplier, left_on='PS_SUPPKEY', right_on='S_SUPPKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY'), left_on='PS_PARTKEY', right_on='P_PARTKEY').groupby(by=['PS_SUPPKEY']).agg('min', numeric_only=True)

orders[(orders['ORDERSTATUS'] == 'F') & (orders['ORDERPRIORITY'] == '2-HIGH')].merge(customer[(customer['C_ACCTBAL'] < 5761.132335187356) & (customer['C_NAME'] == 'C')].merge(nation.merge(supplier[['S_SUPPKEY', 'S_COMMENT', 'S_NAME', 'S_PHONE']], left_on='N_NATIONKEY', right_on='S_NATIONKEY'), left_on='C_NATIONKEY', right_on='N_NATIONKEY').merge(nation[['N_COMMENT', 'N_NATIONKEY', 'N_REGIONKEY']], left_on='C_NATIONKEY', right_on='N_NATIONKEY'), left_on='O_CUSTKEY', right_on='C_CUSTKEY').groupby(by=['ORDERSTATUS', 'O_CUSTKEY']).agg('mean', numeric_only=True)

region[(region['R_COMMENT'].str.startswith('h')) | (region['R_REGIONKEY'] == 0) & (region['R_NAME'] != 'AME')][['R_NAME', 'R_REGIONKEY', 'R_COMMENT']].groupby(by=['R_NAME', 'R_REGIONKEY']).agg('mean', numeric_only=True)

part[(part['CONTAINER'] != 'WRAP') | (part['TYPE'] != 'E')].merge(partsupp[(partsupp['P_COMMENT'].str.startswith('v')) | (partsupp['PS_PARTKEY'] > 22)].merge(lineitem[(lineitem['RETURNFLAG'] != 'A')][['DISCOUNT', 'SHIPDATE']].merge(nation[(nation['N_REGIONKEY'] == 1)][['N_COMMENT', 'N_REGIONKEY', 'N_NATIONKEY', 'N_NAME']], left_on=['L_ORDERKEY', 'L_PARTKEY', 'L_SUPPKEY'], right_on='N_NATIONKEY'), left_on='PS_SUPPKEY', right_on='L_SUPPKEY').merge(lineitem[(lineitem['L_SUPPKEY'] != 279)][['QUANTITY', 'LINESTATUS', 'DISCOUNT', 'RECEIPTDATE']], left_on='PS_PARTKEY', right_on='L_PARTKEY'), left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp[(partsupp['PS_PARTKEY'] != 20) | (partsupp['PS_SUPPKEY'] == 232)][['AVAILQTY', 'SUPPLYCOST', 'PS_PARTKEY', 'PS_SUPPKEY']], left_on='P_PARTKEY', right_on='PS_PARTKEY').merge(partsupp, left_on='P_PARTKEY', right_on='PS_PARTKEY')